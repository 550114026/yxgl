if (typeof Mobi == "undefined") {
    Mobi = {}
}
Mobi.getPreviewWindow = function() {
    var b = Fai.top.document.getElementById("mobiReviewPageFrame");
    var a = !b ? window: b.contentWindow;
    return a
};
Mobi.getPreviewDocument = function() {
    var a = Mobi.getPreviewWindow().document;
    return a
};
Mobi.getPreviewObject = function(a) {
    if (!a) {
        return
    }
    return Mobi.getPreviewDocument().getElementById(a)
};
Mobi.getPreviewObjectClass = function(a) {
    if (!a) {
        return
    }
    return Mobi.getPreviewDocument().getElementsByClassName(a)
};
Mobi.getJQMobi = function() {
    var b = Mobi.getPreviewWindow(),
        a = b.jm;
    return a
};
Mobi.unifiedAttrVal = function(b, d, a) {
    var c = b.find(d);
    var e = 0;
    c.each(function() {
        var f = jm(this).css(a);
        f = parseInt(f);
        if (f > e) {
            e = f
        }
    });
    c.each(function() {
        jm(this).css(a, e + "px")
    })
};
Mobi.orientationchange = function() {
    var a = "onorientationchange" in window,
        b = a ? "orientationchange": "resize";
    window.addEventListener(b,
        function() {
            Mobi.orientationFunctions()
        },
        false)
};
Mobi.orientationFunctions = function() {
    Mobi.logoSizeCompressByMargin();
    Mobi.titlePositionRefreshByLogo()
};
Mobi.createElementByHtml = function(a) {
    var b = document.createElement("div");
    b.innerHTML = a;
    b = b.firstChild;
    b.parentNode.removeChild(b);
    return b
};
Mobi.isNull = function(a) {
    return (typeof a == "undefined") || (a == null)
};
Mobi.addInterval = function(d, c, a) {
    if (Mobi.isNull(Mobi.intervalFunc)) {
        Mobi.intervalFunc = new Array()
    }
    for (var b = 0; b < Mobi.intervalFunc.length; ++b) {
        if (Mobi.intervalFunc[b].id == d) {
            Mobi.intervalFunc.splice(b, 1);
            break
        }
    }
    Mobi.intervalFunc.push({
        id: d,
        func: c,
        interval: a,
        type: 1
    })
};
Mobi.startInterval = function(c) {
    if (Mobi.isNull(Mobi.intervalFunc)) {
        return
    }
    for (var b = 0; b < Mobi.intervalFunc.length; ++b) {
        var a = Mobi.intervalFunc[b];
        if (c == null || a.id == c) {
            if (a.timer) {
                clearInterval(a.timer)
            }
            if (a.type == 1) {
                a.timer = setInterval(a.func, a.interval)
            } else {
                a.timer = setTimeout(a.func, a.interval)
            }
        }
    }
};
Mobi.bindTouchAndClickEvent = function(c, d, b) {
    var a = b ? "." + b: "";
    if (jm.os.supportsTouch) {
        c.unbind("touchstart" + a);
        c.bind("touchstart" + a, d)
    } else {
        c.unbind("mousedown" + a);
        c.bind("mousedown" + a, d)
    }
};
Mobi.onTouchAndClickEvent = function(a, b) {
    if (jm.os.supportsTouch) {
        jm("body").off("touchstart", a);
        jm("body").on("touchstart", a, b)
    } else {
        jm("body").off("mousedown", a);
        jm("body").on("mousedown", a, b)
    }
};
Mobi.bindTransitionEnd = function(c, d) {
    if (!c) {
        return
    }
    var a = c;
    if (Object.prototype.toString.call(a) === "[object String]") {
        a = jm(c)
    }
    var b = Mobi.getTransitionEndEventName();
    a.unbind(b);
    a.bind(b, d)
};
Mobi.autoFixGWebTop = function(f) {
    if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
        jm("#fk-gWebPlaceholdPT").remove();
        return
    }
    var l = Mobi.webTop(),
        h = Mobi.getPreviewObject("g_web"),
        //k = Mobi.getPreviewObject("webTop"),
        j = Mobi.getPreviewObject("webBodyBackground"),
        e = Mobi.getPreviewObject("webHeaderBox");
    e.style.top = "";
    //k.style.top = "";
    if (f !== 2 && f !== 7 && f !== 8) {
        var d = Mobi.getPreviewObject("fk-gWebPlaceholdPT");
        if (d) {
            d.style.height = l + "px"
        } else {
            d = jm("<div id='fk-gWebPlaceholdPT' style='height:" + l + "px;'></div>");
            jm(h).prepend(d)
        }
        return
    }
    if (f == 7) {
        var c = jm("#webHeader"),
            b = Mobi.getPreviewObject("navbar");
        if (l > 0) {
            b.style.top = l + "px"
        }
        if (c.css("display") === "none") {
            return
        }
    }
    e.style.top = l + "px";
    //k.style.top = l + "px";
    var d = Mobi.getPreviewObject("fk-gWebPlaceholdPT");
    var a = Mobi.getPreviewObject("webHeader");
    if (d) {
        d.style.height = (a.offsetHeight + l) + "px"
    } else {
        d = jm("<div id='fk-gWebPlaceholdPT' style='height:" + (a.offsetHeight + l) + "px;'></div>");
        jm(h).prepend(d)
    }
};
Mobi.webTop = function() {
    var b = 0,
        a = Mobi.getPreviewObject("mobiTipsMarquee");
    if (!a) {
        return b
    } else {
        var c = Mobi.getPreviewObject("webTips").offsetHeight;
        b = c;
        return b
    }
};
Mobi.topTipMarquee = function() {
    var d = Mobi.getPreviewObject("mobiTipsMarquee");
    if (!d) {
        return false
    }
    var f = Mobi.getPreviewObjectClass("J_marquee")[0],
        j = d.querySelectorAll("li"),
        b = jm(f).width(),
        h = f.offsetWidth,
        a = false,
        c = [],
        k = 0;
    for (var e = 0; e < j.length; e++) {
        c[e] = parseInt(j[e].offsetWidth);
        if (b > c[e]) {
            k = (e == 0) ? b: parseInt(k) + c[e]
        } else {
            k = (e == 0) ? c[e] : parseInt(k) + c[e]
        }
    }
    if (j.length == 1 && c[0] < b) {} else {
        Mobi.copyTipsDom(j, d);
        a = true
    }
    if (a) {
        Mobi.initTipsMarquee(k)
    }
};
Mobi.copyTipsDom = function(h, b) {
    var a = h.length - 1,
        e = Mobi.getPreviewObjectClass("J_marqueeContainer")[0],
        f = Mobi.createElementByHtml("<ul class='marquee j-marquee J_marquee' id='J_mobiTipsMarqueeCopy'></ul>"),
        c;
    e.appendChild(f);
    for (var d = 0; d <= a; d++) {
        c = jm(h[d]).clone();
        jm(f).append(c)
    }
};
Mobi.initTipsMarquee = function(f) {
    var e = 0,
        d = Mobi.getPreviewObjectClass("J_marqueeContainer")[0],
        a = Mobi.getPreviewObject("mobiTipsMarquee"),
        b = Mobi.getPreviewObject("J_mobiTipsMarqueeCopy"),
        c;
    jm(a).addClass("j-marquee");
    jm(a).css({
        width: f + "px",
        left: "0",
        top: "0"
    });
    c = a.offsetWidth;
    jm(b).css({
        width: f + "px",
        left: c + "px",
        top: "0"
    });
    Mobi.setParentMarquee(a, b)
};
Mobi.setParentMarquee = function(b, c) {
    var a = b.offsetWidth,
        e = c.offsetWidth,
        f = a + e,
        d = Mobi.getPreviewObjectClass("J_marqueeContainer")[0],
        h = 70;
    jm(d).css({
        width: f + "px",
        left: "0",
        top: "0"
    });
    d.setAttribute("style", d.getAttribute("style") + Mobi.marqueeAnimation(f, h))
};
Mobi.marqueeAnimation = function(b, c) {
    var a = "mobi_notice_right_to_left_50";
    return "-webkit-animation: " + a + " " + b / c + "s linear 1s infinite;-moz-animation:    " + a + " " + b / c + "s linear 1s infinite;-o-animation:      " + a + " " + b / c + "s linear 1s infinite;animation:         " + a + " " + b / c + "s linear 1s infinite;"
};
Mobi.ingTigs = function(k, j) {
    var e = (k == null || k == "") ? "正在处理...": k;
    var d = Fai.top.document.body.clientWidth;
    var a = Fai.top.document.body.clientHeight;
    var f = "";
    f = "<div id='mobiIng' class='mobiIng'></div>";
    if (jm("#mobiIng").length == 0) {
        jm(f).appendTo("body")
    }
    var b = jm("#mobiIng");
    var c = parseInt(Math.random() * 10000);
    var h = '<div id="' + c + '" class="mobiTips"><div id="mobiMsg' + c + '" class="mobiMsg">' + e + "</div></div>";
    b.find(".mobiTips").remove();
    jm("#mobiIngTigs").find(".mobiTips").remove();
    jm(h).appendTo(b);
    window.setTimeout(function() {
            b.css("visibility", "hidden");
            b.css("opacity", "0")
        },
        2500);
    window.setTimeout(function() {
            jm("#" + c).remove();
            b.css("visibility", "visible");
            b.css("opacity", "1")
        },
        3000)
};
Mobi.ing = function(q, r, n) {
    var e = (q == null || q == "") ? "正在处理...": q;
    var p = "";
    var f = false;
    if (r == "" || r == null || r == 0) {
        p = "<div class='icon-errorTigs'></div>"
    } else {
        if (r == 1) {
            p = "<div class='icon-succeedTigs'></div>"
        } else {
            if (r == -1) {
                p = ""
            }
        }
    }
    n = n ? n: false;
    var d = Fai.top.document.body.clientWidth;
    var a = Fai.top.document.body.clientHeight;
    var l = jm("body").attr("class");
    var k = "";
    if (l.indexOf("2052") >= 0) {
        k = parseFloat(q.length);
        if (k > 13 && k < 39) {
            k = 15;
            e = q.substring(0, 13) + "<br>" + q.substring(13)
        } else {
            if (k > 39) {
                k = 15;
                e = q.substring(0, 13) + "<br>" + q.substring(13, 39) + "<br>" + q.substring(39)
            }
        }
    } else {
        k = parseFloat(q.length) / 2;
        if (k > 15) {
            var j = q.substring(0, 30).lastIndexOf(" ");
            if (q.charAt(30) != "" && k < 50) {
                if (j < 15) {
                    j = 30
                }
                e = q.substring(0, j) + "<br>" + q.substring(j)
            } else {
                if (k > 50) {
                    var h = q.substring(30, 50).lastIndexOf(" ");
                    e = q.substring(0, j) + "<br>" + q.substring(j, h) + "<br>" + q.substring(h)
                }
            }
            k = 15
        }
    }
    k += "rem";
    var m = "";
    m = "<div id='mobiIngTigs' class='mobiIngTigs'></div>";
    if (jm("#mobiIngTigs").length == 0) {
        jm(m).appendTo("body")
    } else {
        f = true
    }
    var b = jm("#mobiIngTigs");
    var c = parseInt(Math.random() * 10000);
    var o = '<div id="' + c + '" class="mobiTips" style=\'width:' + k + "; '><div id=\"mobiMsg" + c + '" class="mobiMsg">' + p + "<div class=''>" + e + "</div></div></div>";
    b.html(o);
    if (f) {
        b.css("visibility", "inherit");
        b.css("opacity", "1")
    }
    if (!n) {
        window.setTimeout(function() {
                b.css("visibility", "hidden");
                b.css("opacity", "0")
            },
            1500);
        window.setTimeout(function() {
                jm("#" + c).remove();
                b.remove()
            },
            2500)
    }
};
Mobi.initForms = function() {
    var e = document.querySelector("#webModuleContainer"),
        d = e.querySelectorAll(".form"),
        a = 1;
    for (var c = 0; c < d.length; c++) {
        var b = d[c],
            f = b.getAttribute("id");
        if (f) {
            f = f.replace("module", "");
            if (b.getAttribute("_autoHeight") != 1 && !(jm(b).hasClass("formStyle52") || jm(b).hasClass("formStyle53"))) {
                Mobi.setModuleHeight2(f, b.clientHeight, Fai.top.moduleManageFontSize["module" + f])
            }
        }
    }
};
Mobi.fixFontSizeDeviation = function() {
    var k = document.querySelector("#webModuleContainer"),
        q = k.querySelectorAll(".form");
    for (var v = 0; v < q.length; v++) {
        var c = q[v],
            o = c.getAttribute("id"),
            h = jm(c),
            C = h.find(".jz_mergeBorderStyle").length > 0 || h.hasClass("formStyle51") || h.hasClass("formStyle52") || h.hasClass("formStyle53") || h.hasClass("formStyle54");
        if (o) {
            o = o.replace("module", "");
            var c = Mobi.getPreviewObject("module" + o);
            if (!c) {
                continue
            }
            var f = c.querySelector(".formMiddleContent"),
                e = c.querySelector(".photoModule"),
                w = jm(c).css("margin-left"),
                r = jm(c).css("margin-right"),
                p = jm(c).css("margin-top"),
                a = jm(c).css("margin-bottom"),
                s = jm(f).css("margin-left"),
                n = jm(f).css("margin-right"),
                m = jm(f).css("margin-top"),
                y = jm(f).css("margin-bottom"),
                B = jm(f).attr("_innerType"),
                d,
                x,
                u,
                b,
                l;
            if (!f) {
                continue
            }
            var A, t, z, j;
            A = c.querySelector(".formBannerTitle");
            if (A) {
                t = jm(A).find(".titleCenter");
                z = jm(A).find(".titleTextIcon");
                j = jm(A).css("height")
            }
            if (B == 0 && !C) {
                if (!Fai.top._manageMode) {
                    f.style.marginBottom = "0.5rem";
                    jm(".formMiddle" + o).css({
                        paddingBottom: "0.25rem"
                    })
                } else {
                    Fai.top.Mobi.setModuleStyleCss(o, ".formMiddleContent" + o, "margin-bottom", "0.5rem");
                    Fai.top.Mobi.setModuleStyleCss(o, ".formMiddle" + o, "padding-bottom", "0.25rem")
                }
            }
            if (w != "0px") {
                c.style.marginLeft = parseInt(w.replace("px", "")) / _htmlFontSize + "rem"
            }
            if (r != "0px") {
                c.style.marginRight = parseInt(r.replace("px", "")) / _htmlFontSize + "rem"
            }
            if (p != "0px") {
                c.style.marginTop = parseInt(p.replace("px", "")) / _htmlFontSize + "rem"
            }
            if (a != "0px") {
                c.style.marginBottom = parseInt(a.replace("px", "")) / _htmlFontSize + "rem"
            }
            if (A && j) {
                d = j.replace("px", "") / _htmlFontSize;
                A.style.height = d + "rem"
            }
            if (A && z && t && A.getAttribute("_bannerAutoHeight") == 0) {
                if (!Fai.top._manageMode) {
                    t.css("height", d + "rem");
                    t.css("line-height", d + "rem");
                    z.css("height", d + "rem");
                    z.css("line-height", d + "rem")
                } else {
                    Fai.top.Mobi.setModuleStyleCssList(o, [{
                        cls: ".formBannerTitle" + o + " .titleCenter" + o,
                        key: "height",
                        value: d + "rem"
                    },
                        {
                            cls: ".formBannerTitle" + o + " .titleCenter" + o,
                            key: "line-height",
                            value: d + "rem"
                        },
                        {
                            cls: ".formBannerTitle" + o + " .titleTextIcon" + o,
                            key: "height",
                            value: d + "rem"
                        },
                        {
                            cls: ".formBannerTitle" + o + " .titleTextIcon" + o,
                            key: "line-height",
                            value: d + "rem"
                        }])
                }
            }
            if (s != "0px") {
                x = parseInt(s.replace("px", "")) / _htmlFontSize;
                if (!Fai.top._manageMode) {
                    f.style.marginLeft = x + "rem"
                } else {
                    Fai.top.Mobi.setModuleStyleCss(o, ".formMiddleContent" + o, "margin-left", x + "rem")
                }
            }
            if (n != "0px") {
                u = parseInt(n.replace("px", "")) / _htmlFontSize;
                if (!Fai.top._manageMode) {
                    f.style.marginRight = u + "rem"
                } else {
                    Fai.top.Mobi.setModuleStyleCss(o, ".formMiddleContent" + o, "margin-right", u + "rem")
                }
            }
            if (m != "0px") {
                b = parseInt(m.replace("px", "")) / _htmlFontSize;
                if (!Fai.top._manageMode) {
                    f.style.marginTop = b + "rem"
                } else {
                    Fai.top.Mobi.setModuleStyleCss(o, ".formMiddleContent" + o, "margin-top", b + "rem")
                }
            } else {
                if (m == "0px") {
                    if (!jm(c).hasClass("formStyle41") || !jm(c).hasClass("formStyle50")) {
                        if (!Fai.top._manageMode) {
                            jm(e).css("marginTop", "0")
                        } else {
                            Fai.top.Mobi.setModuleStyleCss(o, ".photoModule", "margin-top", "0")
                        }
                    }
                }
            }
            if (y != "0px") {
                l = parseInt(y.replace("px", "")) / _htmlFontSize;
                if (!Fai.top._manageMode) {
                    f.style.marginBottom = l + "rem"
                } else {
                    Fai.top.Mobi.setModuleStyleCss(o, ".formMiddleContent" + o, "margin-bottom", l + "rem")
                }
            } else {
                if (y == "0px") {
                    if (!Fai.top._manageMode) {
                        jm(e).css("marginBottom", "0");
                        jm(".formMiddle" + o).css("paddingBottom", "0")
                    } else {
                        Fai.top.Mobi.setModuleStyleCss(o, ".photoModule", "margin-bottom", "0");
                        Fai.top.Mobi.setModuleStyleCss(o, ".formMiddle" + o, "padding-bottom", "0")
                    }
                }
            }
        }
    }
};
Mobi.topContentFixedAutoHidden = function(b) {
    if (b == 0 || b == 2) {
        var e = Mobi.getPreviewObject("webHeaderBox"),
            c = e.style.top,
            f = document.querySelector("#webTips") ? true: false,
            h = {},
            d = Mobi.getPreviewObject("g_web"),
            a = d.style.top;
        e.setAttribute("showNav", "true");
        d.style[jm.feat.cssPrefix + "Transition"] = "top 350ms";
        d.addEventListener("touchstart",
            function(j) {
                h.y1 = j.touches[0].pageY
            },
            false);
        d.addEventListener("touchmove",
            function(j) {
                h.y2 = j.touches[0].pageY
            },
            false);
        d.addEventListener("touchend",
            function(k) {
                var j = h.y1 - h.y2;
                if (j > 0) {
                    if (e.getAttribute("showNav") == "true") {
                        e.setAttribute("showNav", "false");
                        e.style.opacity = 0;
                        e.style.zIndex = -1
                    }
                } else {
                    if (e.getAttribute("showNav") == "false") {
                        e.setAttribute("showNav", "true");
                        e.style.opacity = 1;
                        e.style.zIndex = 5
                    }
                }
            },
            false)
    }
};
Mobi.onlineServiceInputWord = function() {
    if (!Fai.top._manageMode && !jm.os.supportsTouch) {
        return
    }
    if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
        return
    }
    var k = document.querySelectorAll("input[type='text']"),
        h = document.querySelectorAll("textArea"),
        f = [],
        a = document.getElementById("webCustomerServiceBox"),
        d = "",
        e = false;
    if (a) {
        e = a.querySelectorAll(".service").length > 0 ? true: false
    }
    if (!a || !e) {
        return
    }
    for (var c = 0; c < k.length; c++) {
        f.push(k[c])
    }
    for (var b = 0; b < h.length; b++) {
        f.push(h[b])
    }
    for (var c = 0; c < f.length; c++) {
        f[c].addEventListener("blur",
            function() {
                a.style.display = d
            },
            false);
        f[c].addEventListener("focus",
            function() {
                d = jm("#webCustomerServiceBox").css("display");
                a.style.display = "none"
            },
            false)
    }
};
var ajaxDone = true;
Mobi.createFullScreenDiv = function(b, c, a) {
    if (!ajaxDone) {
        return
    }
    if (!c) {
        Mobi.ing(LS.mallStlSubmitError);
        return
    }
    if (!a) {
        Mobi.ing(LS.mallStlSubmitError);
        return
    }
    if (jm("#" + b).length > 0) {
        jm("#" + b).remove()
    }
    jm("#fullScreenDivCotainer").append("<div id='" + b + "' class='fullScreenDiv webBackground webContainerBox moduleContent categoryModel'></div>");
    jm("#" + b).css("background-image", "none");
    jm("#" + b).css("background-image", jm("#webBodyBackground").css("background-image"));
    jm.ajax({
        type: "post",
        url: "ajax/other_h.jsp?cmd=" + c,
        data: a,
        error: function() {
            Mobi.closeLoading();
            Mobi.ing(LS.systemError);
            ajaxDone = true
        },
        success: function(d) {
            var e = jm.parseJSON(d);
            if (e.success) {
                jm("#" + b).append(e.html);
                jm("#" + b).addClass("showFullScreen");
                Mobi.getPreviewObject(b).focus();
                Mobi.switchJump();
                Mobi.initModulePhotoSwipe(b)
            }
            ajaxDone = true;
            Mobi.closeLoading()
        }
    })
};
Mobi.createInnerScreenDiv = function(a, e, m, c, j) {
    if (!ajaxDone) {
        return
    }
    if (!c) {
        Mobi.ing(LS.mallStlSubmitError);
        return
    }
    if (!j) {
        Mobi.ing(LS.mallStlSubmitError);
        return
    }
    var l = document.getElementById("ngGroupDiv").className;
    var b = new RegExp("ngTag", "g");
    if (l.match(b)) {
        for (var d = 0; d < m; ++d) {
            if (jm("#line" + d).hasClass("ngLine-bg")) {
                jm("#line" + d).removeClass("ngLine-bg");
                break
            }
        }
        for (var d = 0; d < m; ++d) {
            jm("#ngName" + d).css({
                width: "90%"
            });
            jm("#ngMark" + d).css({
                "float": "right"
            });
            jm("#line" + d).css({
                color: "black"
            })
        }
        jm("#ngGroupDiv").removeClass("ngTag");
        jm("#ngGroupDiv").text("");
        jm("#ngGroupDiv").css({
            "margin-top": "0px"
        })
    }
    Mobi.showLoading();
    var f = document.getElementById("ngList" + a).offsetHeight;
    jm("#ngGroupDiv").addClass("ngTag");
    setTimeout(function() {
            for (var h = 0; h < m; ++h) {
                jm("#ngName" + h).css({
                    width: "34%"
                });
                jm("#ngMark" + h).css({
                    "float": "left"
                });
                if (e == h) {
                    jm("#ngMark" + h).css("color", "white")
                } else {
                    jm("#line" + h).css({
                        color: "#555555"
                    });
                    jm("#ngMark" + h).css({
                        color: "#555555"
                    })
                }
            }
        },
        90);
    setTimeout(function() {
            jm("#line" + e).addClass("ngLine-bg");
            jm("#ngGroupDiv").css({
                "min-height": f + "px",
                "margin-top": "-" + f + "px"
            })
        },
        100);
    jm.ajax({
        type: "post",
        url: "ajax/other_h.jsp?cmd=" + c,
        data: j,
        error: function() {
            Mobi.closeLoading();
            Mobi.ing(LS.systemError);
            ajaxDone = true
        },
        success: function(h) {
            var k = jm.parseJSON(h);
            if (k.success) {
                jm("#ngGroupDiv").append(k.html)
            }
            ajaxDone = true;
            Mobi.closeLoading()
        }
    })
};
Mobi.getCommentDiv = function(c, e, d) {
    if (!c) {
        Mobi.ing(LS.mallStlSubmitError);
        return
    }
    if (isNaN(e)) {
        Mobi.ing(LS.mallStlSubmitError);
        return
    }
    if (jm("#comemtDiv").length === 0) {
        jm("#fullScreenDivCotainer").append("<div class='fullScreenDiv webContainerBox moduleContent'  style='overflow-y: scroll;background:#fff;' id='comemtDiv'></div>")
    } else {
        jm("#comemtDiv").html("")
    }
    var a = "id=" + e;
    if (!isNaN(d)) {
        a += ("&pageno=" + d)
    }
    Mobi.mobiHideScroll();
    Mobi.showLoading();
    var b = jm("html").css("font-size");
    b = b.substring(0, b.length - 2);
    jm.ajax({
        type: "post",
        url: "ajax/other_h.jsp?cmd=" + c + "&rem=" + b,
        data: a,
        error: function() {
            Mobi.closeLoading();
            Mobi.ing(LS.systemError)
        },
        success: function(f) {
            var h = jm.parseJSON(f);
            if (h.success) {
                jm("#comemtDiv").append(h.html);
                jm("#comemtDiv").addClass("showFullScreen")
            }
            Mobi.closeLoading();
            Mobi.hidePlaceholder();
            setTimeout(function() {
                    var k = jm(".ct-s-content-m");
                    if (typeof(k) != "undefined" && k != null) {
                        for (var l = 0; l < k.length; l++) {
                            var j = k.eq(l)[0].querySelectorAll("img");
                            if (typeof(j) != "undefined" && j != null && j.length > 0) {
                                Mobi.bindCommImgShow(j)
                            }
                        }
                    }
                },
                100)
        }
    })
};
Mobi.removeCommentDiv = function() {
    Mobi.mobiShowScroll();
    jm("#comemtDiv").remove();
    window.location.reload()
};
Mobi.productGroupCollapse = function(e) {
    var d = jm("#pgBox");
    var l = jm("#pgBox2");
    var j = Mobi.getPreviewObject("group_" + groupId);
    var k = jm("#pgBox2_Item" + groupId);
    var f = jm("#pgSelect");
    var a = parseInt(d.height());
    var h = parseInt(l.height());
    var c = a > h ? a: h;
    jm("#pgBox2").children(".pgBox2Item").removeClass("pgBox2ItemCollapse");
    d.addClass("pgBoxCollapse");
    l.addClass("pgBox2Collapse");
    l.css("height", c + "px");
    k.addClass("pgBox2ItemCollapse");
    var b = parseInt(j.offsetTop) + 4;
    if (f.length > 0) {
        f.css("top", b + "px")
    } else {
        d.prepend("<div id='pgSelect' class='pgSelect' style='top:" + b + "px'></div>")
    }
    setTimeout(function() {},
        100)
};
Mobi.disableSafeMode = function() {
    var b = Fai.top.$("#mobiReviewPageFrame").attr("src"),
        d,
        f,
        e = b.indexOf("?"),
        c = Fai.top.location.href || "";
    if (e != -1) {
        d = b.substring(0, e);
        f = b.substring(e + 1);
        if (f.indexOf("_safeMode=true") > -1 && f.length > 15) {
            d += "?" + b.substring(e + 1).replace("&_safeMode=true", "").replace("_safeMode=true&", "").replace("_safeMode=true", "")
        }
    }
    Fai.top.$("#mobiReviewPageFrame").attr("src", d);
    location.hash = a(d);
    Fai.top.location.href = c.replace("_safeMode=true", "_safeMode=false");
    function a(r) {
        if (r) {
            var n = r.indexOf("#"),
                o = r.indexOf(".jsp"),
                p = r.indexOf("?"),
                q = r.substring(n + 2, o),
                h = {},
                l = "",
                j,
                k,
                m;
            if (p != -1) {
                j = r.substring(p + 1).split("&");
                for (m = 0; m < j.length; m++) {
                    if (j.length == 0) {
                        continue
                    }
                    k = j[m].split("=");
                    h[k[0]] = k[1]
                }
                l += "&data=" + jm.toJSON(h)
            }
            return "appId=" + q + l
        }
    }
};
Mobi.switchJump = function() {
    var a = jm(".switchJump");
    jm.each(a,
        function(d, h) {
            if (d === "length") {
                return
            }
            var c = h.getAttribute("_t");
            var b = h.getAttribute("_mu") || h.getAttribute("mJUrl");
            var e = h.getAttribute("_mColHide");
            var f = h.getAttribute("href");
            if (c == 100 && b == null && f == null) {
                h.setAttribute("href", "javascript:void(0);");
                h.setAttribute("style", "text-decoration:none;");
                return
            }
            if (b == null && !e) {
                return
            }
            if (e) {
                h.setAttribute("href", "javascript:void(0);");
                h.setAttribute("style", "text-decoration:none;");
                return
            }
            if (b.substring(0, 10) == "javascript") {
                h.setAttribute("href", "javascript:;");
                h.setAttribute("onclick", b.substring(11) + "return false;")
            } else {
                h.setAttribute("href", b)
            }
        });
    Mobi.outerUrlJump()
};
Mobi.outerUrlJump = function() {
    if (!Fai.top._manageMode) {
        return
    }
    $("body").on("click", "a",
        function(c) {
            var a = $(this)[0].getAttribute("href");
            if (a === null) {
                return
            }
            var b = $(this)[0].getAttribute("target");
            if ((a.indexOf("http") != -1 || a.indexOf("https") != -1) && b != "_blank") {
                Fai.top.Fai.ing("管理状态不支持跳转外部链接", true);
                c.preventDefault()
            }
        })
};
Mobi.addParentDivToTable = function() {
    return;
    var a = jm(".newsContent table, .richContent table, .productDetailInfoPanel table");
    jm.each(a,
        function(b, d) {
            if (b === "length") {
                return
            }
            var c = jm(d);
            if (c.parent().attr("class") != "fk-divTableContainer") {
                var e = "<div id='fk-divTableContainer_" + b + "' class='fk-divTableContainer' style='overflow-y: auto; width: 100%; height: 100%;'></div>";
                jm(e).insertAfter(c);
                jm("#fk-divTableContainer_" + b).append(c)
            }
        })
};
Mobi.viewPageBeforeInit = function() {
    if (!Fai.top._manageMode && window.top !== window.self) {
        jm("#g_body").addClass("g_viewMode");
        jm("#webTips").css("display", "none")
    }
};
Mobi.getTransitionEndEventName = function() {
    var a, d, b = document.createElement("div"),
        c = {
            transition: "transitionend",
            OTransition: "otransitionend",
            MozTransition: "transitionend",
            WebkitTransition: "webkitTransitionEnd"
        };
    for (a in c) {
        if (c.hasOwnProperty(a) && b.style[a] !== d) {
            return c[a]
        }
    }
};
Mobi.prompt = function(l) {
    var f = {
        content: "",
        textClass: "",
        cancelClass: "",
    };
    var l = jm.extend(f, l);
    var c = Fai.top.document.body.clientWidth;
    var a = Fai.top.document.body.clientHeight;
    var b = parseInt(Math.random() * 10000);
    var j = "<div id='mobiPrompt" + b + "' class='mobiPrompt'></div>",
        h = "<div id='mobiPrompt_Bg" + b + "' class='mobiPrompt_Bg'></div>";
    jm(j).appendTo("body");
    jm(h).appendTo("body");
    var d = jm("#mobiPrompt" + b),
        k = jm("#mobiPrompt_Bg" + b);
    var e = [];
    e.push("<div class='mobiPrompt_inner'>");
    e.push("<div class=' mobiPrompt_content'>");
    e.push("<div class=''>" + l.content + "</div>");
    e.push("<div class='J-prompt-cancel icon-mobiPromptClose'></div>");
    e.push("</div>");
    e.push("<div class=' mobiPrompt_buttons '>");
    e.push("<div class='J-prompt-cancel mobiPromptCancel " + l.cancelClass + " icon-PromptCancel'></div>");
    e.push("<div class='J-prompt-save mobiPromptSave " + l.textClass + " icon-PromptSave'></div>");
    e.push("</div>");
    e.push("</div>");
    d.append(e.join(""));
    if (l.callback) {
        d.find(".J-prompt-save").on("click",
            function() {
                d.removeClass("mobiPromptShow");
                k.removeClass("mobiPromptBgShow");
                setTimeout(function() {
                        d.remove();
                        k.remove()
                    },
                    200);
                l.callback()
            })
    }
    if (l.cancelCallback) {
        d.find(".J-prompt-cancel").on("click",
            function() {
                d.removeClass("mobiPromptShow");
                k.removeClass("mobiPromptBgShow");
                setTimeout(function() {
                        d.remove();
                        k.remove()
                    },
                    200);
                l.cancelCallback()
            })
    } else {
        d.find(".J-prompt-cancel").on("click",
            function() {
                d.removeClass("mobiPromptShow");
                k.removeClass("mobiPromptBgShow");
                setTimeout(function() {
                        d.remove();
                        k.remove()
                    },
                    200)
            })
    }
    window.setTimeout(function() {
            k.addClass("mobiPromptBgShow");
            d.addClass("mobiPromptShow")
        },
        100)
};
Mobi.customPopup = function(n) {
    var f = {
        content: "",
    };
    var n = jm.extend(f, n);
    var d = Fai.top.document.body.clientWidth;
    var a = Fai.top.document.body.clientHeight;
    var b = parseInt(Math.random() * 10000);
    var m = "<div id='mobiPrelude" + b + "' class='mobiPrelude'></div>",
        k = "<div id='mobiPrompt" + b + "' class='mobiPrompt'></div>",
        h = "<div id='mobiPrompt_Bg" + b + "' class='mobiPrompt_Bg' style='opacity: 0.6;'></div>";
    jm(m).appendTo("body");
    jm(k).appendTo("body");
    jm(h).appendTo("body");
    var m = jm("#mobiPrelude" + b),
        c = jm("#mobiPrompt" + b),
        l = jm("#mobiPrompt_Bg" + b);
    var j = [];
    j.push("<div class='mobiPrelude_inner' style='background: transparent;'>");
    if (typeof n.prelude == "undefined" || n.prelude == null) {
        n.prelude = ""
    }
    j.push(n.prelude || "");
    j.push("</div>");
    m.append(j.join(""));
    var e = [];
    e.push("<div class='mobiPrompt_inner' style='background: transparent; box-shadow: none;'>");
    e.push(n.content);
    e.push("</div>");
    c.append(e.join(""));
    if (n.callback) {
        c.find(".J-prompt-callback").on("click",
            function() {
                m.removeClass("mobiPreludeShow");
                c.removeClass("mobiPromptShow");
                l.removeClass("mobiPromptBgShow");
                setTimeout(function() {
                        m.remove();
                        c.remove();
                        l.remove()
                    },
                    200);
                n.callback()
            })
    }
    if (n.cancelCallback) {
        c.find(".J-prompt-cancel").on("click",
            function() {
                m.removeClass("mobiPreludeShow");
                c.removeClass("mobiPromptShow");
                l.removeClass("mobiPromptBgShow");
                setTimeout(function() {
                        m.remove();
                        c.remove();
                        l.remove()
                    },
                    200);
                n.cancelCallback()
            })
    } else {
        c.find(".J-prompt-cancel").on("click",
            function() {
                m.removeClass("mobiPreludeShow");
                c.removeClass("mobiPromptShow");
                l.removeClass("mobiPromptBgShow");
                setTimeout(function() {
                        m.remove();
                        c.remove();
                        l.remove()
                    },
                    200)
            })
    }
    window.setTimeout(function() {
            l.addClass("mobiPromptBgShow");
            m.addClass("mobiPreludeShow");
            if ( !! n.mainFrameTimeout) {
                window.setTimeout(function() {
                        m.removeClass("mobiPreludeShow");
                        m.remove();
                        c.addClass("mobiPromptShow")
                    },
                    n.mainFrameTimeout)
            } else {
                c.addClass("mobiPromptShow")
            }
        },
        100)
};
Mobi.initWebPage = function(o) {
    var n = o.triggerId,
        e = o.panelId,
        d = o.pageHtml,
        h = o.pageHead,
        j = o.pageBg || false,
        c = o.returnSeltFun || false,
        a = o.closeWebPage,
        f = o.closeCallBack ||
            function() {},
        k = o.direction || "right",
        l = o.callback,
        m = false,
        b = 0;
    JMWebPagePanel = jm("#webPagePanel" + n);
    if (JMWebPagePanel.length !== 0) {
        JMWebPagePanel.remove()
    }
    jm("#" + n).bind("click",
        function(p) {
            Mobi.showPanel(o, true);
            if (!m) {
                l && l();
                m = true
            }
            window.scrollTo(0, b)
        });
    if (c) {
        return function() {
            Mobi.showPanel(o, true);
            if (!m) {
                l && l();
                m = true
            }
        }
    }
};
Mobi.showPanel = function(f, a) {
    var o = f.triggerId,
        w = f.panelId,
        s = f.pageHtml,
        b = f.pageBg,
        e = f.closeWebPage,
        n = f.closeCallBack ||
            function() {},
        t = f.direction || "right",
        l = f.callback,
        a = a || false;
    redo = f.redo || false;
    jm("#g_body").css("overflow-y", "hidden");
    var v, j = jm("#webPagePanel" + o);
    if (redo && j.length) {
        j.remove()
    }
    if (s) {
        v = jm(s);
        v = jm("#" + v[0].id)
    }
    var q = "webPagePanelRight";
    if (t === "left") {
        q = "webPagePanelLeft"
    } else {
        if (t === "top") {
            q = "webPagePanelTop"
        } else {
            if (t === "bottom") {
                q = "webPagePanelBottom"
            }
        }
    }
    var u = "";
    if (b) {
        u = "<div class='webPagePanelBg' style='z-index:999'></div>"
    }
    var d = 0;
    var c = 0;
    if (j.length == 0 || v == undefined || redo) {
        jm("#g_web").append("<div id='webPagePanel" + o + "' class='webPagePanel' style='z-index:1000'>" + u + "</div>");
        j = jm("#webPagePanel" + o);
        if (s) {
            j.append(s);
            jm(".swipImgBox").each(function(x, y) {
                if (y.children.length == 3) {
                    jm(y).children().css("margin-right", "0.6rem");
                    jm(y).children().find(".shareNewIcon").css("width", "3rem")
                }
            });
            v = jm(s);
            v = jm("#" + v[0].id)
        } else {
            if (!w) {
                alert("panelId is null")
            }
            v = jm("#" + w);
            j.append(v)
        }
        v.addClass(q);
        v.addClass("webPagePanel");
        j.show();
        v.show();
        setTimeout(function() {
            v.addClass("webPagePanelShow")
        });
        if (b) {
            Mobi.bindTouchAndClickEvent(jm("#webPagePanel" + o + " .webPagePanelBg"),
                function(x) {
                    v.removeClass("webPagePanelShow");
                    v.removeClass("webPagePanelShow");
                    jm("#g_body").css({
                        overflow: "",
                        height: "",
                        top: ""
                    });
                    jm("html").css({
                        overflow: "",
                    });
                    jm("#g_web").removeClass("gwNoScroll");
                    jm("#webPagePanel" + o).css("z-index", "-1");
                    window.scrollTo(0, c);
                    return false
                })
        }
        var h = e.split(",");
        for (var r = 0; r < h.length; r++) {
            var k = h[r].trim();
            Mobi.bindTouchAndClickEvent(jm(k),
                function(x) {
                    v.removeClass("webPagePanelShow");
                    jm("#g_body").css({
                        overflow: "",
                        height: "",
                        top: ""
                    });
                    jm("html").css({
                        overflow: "",
                    });
                    jm("#g_web").removeClass("gwNoScroll");
                    jm("#webPagePanel" + o).css("z-index", "-1");
                    window.scrollTo(0, c);
                    if (o == "userCommentId" || o == "postComment") {
                        jm("input,textarea").each(function(z, y) {
                            y.blur()
                        })
                    }
                    if (typeof n == "function") {
                        n()
                    }
                    return false
                });
            jm(k).unbind("click");
            jm(k).bind("click",
                function() {
                    v.removeClass("webPagePanelShow");
                    jm("#g_body").css({
                        overflow: "",
                        height: "",
                        top: ""
                    });
                    jm("html").css({
                        overflow: "",
                    });
                    jm("#g_web").removeClass("gwNoScroll");
                    jm("#webPagePanel" + o).css("z-index", "-1");
                    window.scrollTo(0, c);
                    if (o == "userCommentId" || o == "postComment") {
                        jm("input,textarea").each(function(y, x) {
                            x.blur()
                        })
                    }
                    if (typeof n == "function") {
                        n()
                    }
                    return false
                })
        }
        Mobi.bindTransitionEnd(v,
            function() {
                if (!v.hasClass("webPagePanelShow")) {
                    j.hide()
                }
            });
        if (l && !a) {
            l()
        }
    } else {
        j.show();
        v.addClass(q);
        setTimeout(function() {
                v.addClass("webPagePanelShow")
            },
            0)
    }
    c = window.scrollY;
    var p = jm(window).height();
    var m = p + "px";
    j.css("height", p + "px");
    j.css("z-index", "1000");
    Mobi.initShare("shareLinkWeixin", "", "shareLinkQQ");
    jm("#copy_url").bind("click",
        function() {
            var x = new ClipboardJS("#copy_url");
            x.on("success",
                function(y) {
                    Mobi.ing("复制成功", 1);
                    x.destroy();
                    y.clearSelection()
                });
            x.on("error",
                function(y) {
                    if (navigator.userAgent.indexOf("UCBrowser") > -1) {
                        Mobi.ing("复制成功", 1)
                    } else {
                        Mobi.ingTigs("该浏览器不支持复制链接的功能，请手动复制")
                    }
                    x.destroy()
                })
        })
};
Mobi.initProductGroundNav = function(f, b) {
    var d = jm("#module" + f),
        c = d.find(".productNewGroup"),
        e = c.find(".J_navOpenBtn"),
        a = c.find(".J_navHorizon");
    e.on("click",
        function() {
            var h = c.find(".J_navMask");
            if (e.hasClass("faisco-icons-downward1")) {
                e.removeClass("faisco-icons-downward1").addClass("faisco-icons-upward1");
                a.addClass("f-navOpenStyle");
                if (h.length > 0) {
                    h.show()
                } else {
                    c.append("<div class='J_navMask f-navMask'></div>");
                    c.find(".J_navMask").on("click",
                        function() {
                            e.trigger("click")
                        })
                }
            } else {
                h.hide();
                e.removeClass("faisco-icons-upward1 f-navOpenStyle").addClass("faisco-icons-downward1");
                a.removeClass("f-navOpenStyle")
            }
        })
};
Mobi.initProductGroup = function(l, t, b) {
    if (t == 1 || l == 0) {
        return false
    }
    var m = window.innerHeight ? window.innerHeight: window.screen.height;
    var d = jm("#module22");
    var k = jm(".productNewGroup");
    var r = k.attr("_prUrl") || "";
    var n = d.height(),
        s = false,
        e,
        w,
        q,
        h,
        y,
        a,
        x;
    if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
        s = true
    }
    if (s) {
        e = k.find(".firstGroup");
        jm("#webFooter").find(".footerMenu").hide();
        jm("#webFooter").find(".technical").hide();
        k.height(jm("body").height() - jm("#webHeaderBox").height() - jm("#fixedAreaBox").height() + "px")
    }
    var o = jm(k).find(".J_itemImage");
    for (var u = 0; u < o.length; u++) {
        var c = o[u];
        v(c)
    }
    k.css("height", (m - n) + "px");
    w = k.find(".firstGroup .firstGroupItem");
    w.off(".productNewGroup").on("click.productNewGroup",
        function() {
            var B = k.find(".firstGroup .checkedItem"),
                z = k.find(".unFirstGroup .checkedPanel");
            var C = jm(this),
                E = jm(C).attr("data-id"),
                D = jm("#sed_" + E),
                A,
                F;
            if (!D.html() && r) {
                window.location.href = r + "?groupId=" + E;
                return false
            }
            if (jm(this).hasClass("checkedItem")) {
                return false
            }
            B.removeClass("checkedItem");
            z.removeClass("checkedPanel");
            C.addClass("checkedItem");
            D.addClass("checkedPanel");
            B.find(".firstGroupName").removeClass("f-fontColor");
            C.find(".firstGroupName").addClass("f-fontColor");
            if (s) {
                a = 0;
                A = w.find(".J_navSelect").removeClass("fk-navSelect");
                C.find(".J_navSelect").addClass("fk-navSelect");
                a = jm("body")[0].clientWidth / 2 - C[0].getBoundingClientRect().left;
                clearInterval(F);
                if (a > 0) {
                    F = setInterval(function() {
                            if (a > 0) {
                                a--;
                                e[0].scrollLeft--
                            } else {
                                clearInterval(F)
                            }
                        },
                        1)
                } else {
                    F = setInterval(function() {
                            if (a < 0) {
                                a++;
                                e[0].scrollLeft++
                            } else {
                                clearInterval(F)
                            }
                        },
                        1)
                }
            }
        });
    if (l != 5 && l != 6) {
        Mobi.SimpleDrag.__create(k.find(".firstGroupList"))
    } else {
        q = 0;
        w.each(function(z, A) {
            y = jm(A);
            h = A.offsetWidth + 2 + parseFloat(y.css("margin-right").replace("px", ""));
            q += h
        });
        k.find(".firstGroupList").width(q + "px")
    }
    if (!b || (!s && l != 1)) {
        return
    }
    var p = jm(k).find(".J_groupItem");
    var f = {
        key: "productGroup",
        targets: p,
        type: Mobi.QuickIn.TYPE.FU,
        popupWindowOption: {
            settings: {
                title: "添加图片",
                maxSize: 5,
                type: ["jpg", "jpeg", "bmp", "png", "gif"],
                imgMode: 2,
                maxChoiceList: 1,
                netFileMode: true,
                openIcon: true,
                tabIndex: 0
            },
            closeFunc: j
        }
    };
    function j(G, A) {
        if (G.length == 0 || !A.fileId || A.fileId.length == 0) {
            return
        }
        var E = parseInt(jm(G).parent().attr("data-id"));
        var z = A.fileId;
        var D = A.filePath;
        var F = A.isDefaultColor;
        var B = A.color;
        var C = "ajax/productGroup_h.jsp?cmd=setSingle&id=" + E + "&mIcon=" + z;
        if (!F) {
            C = C + "&mIconColor=" + Fai.top.Fai.encodeUrl(B)
        }
        jm.ajax({
            url: C,
            type: "get",
            error: function() {
                top.Fai.ing("服务繁忙，请稍候重试", false)
            },
            success: function(H) {
                var K = $.parseJSON(H);
                if (K.success) {
                    var L = jm(G).parent().find(".J_itemImage");
                    var J = jm(L).parent();
                    var I = s ? "f-itemImg": "itemImage";
                    J.empty();
                    if (top.Fai.isFontIcon(z)) {
                        if (!F) {
                            J.append("<span class='J_itemImage " + I + " " + D + "' style='color:" + B + "'></span>")
                        } else {
                            J.append("<span class='J_itemImage " + I + " " + D + "'></span>")
                        }
                    } else {
                        J.append("<img  class='J_itemImage " + I + "' src='" + D + "' data-w='" + A.fileWidth + "' data-h='" + A.fileHeight + "' />")
                    }
                    v(jm(J).find(".J_itemImage"));
                    top.Fai.ing(K.msg, true)
                } else {
                    top.Fai.ing(K.msg, true)
                }
            }
        })
    }
    Mobi.QuickIn.__createInstance(f);
    function v(C) {
        var B = parseInt(jm(C).attr("data-w")),
            D = parseInt(jm(C).attr("data-h")),
            A = s ? "3.0rem": "2.8rem",
            z = s ? "3.0rem": "2.9rem";
        if (B >= D) {
            jm(C).css("width", A).css("height", "auto").css("vertical-align", "middle")
        } else {
            if (D > B) {
                jm(C).css("width", "auto").css("height", z).css("display", "block").css("margin", "0 auto")
            }
        }
    }
};
Mobi.QuickIn = {
    TYPE: {
        FU: 1
    },
    __data: {},
    __html: {},
    __func: {},
    __createInstance: new Function()
}; (function(f, a) {
    function c() {
        if (!a.__data.init) {
            b()
        }
        a.__data.init = true
    }
    function b() {
        a.__data.count = 0;
        a.__data.init = false;
        a.__data.instances = {};
        a.__html = "<div class='quick_in' data-id='_$dataId' data-type='_$dataType'></div>"
    }
    a.__createInstance = function(j) {
        e(j)
    };
    function e(j) {
        d(j);
        h()
    }
    function d(j) {
        var m = a.__html.replace("_$dataId", a.__data.count).replace("_$dataType", j.type);
        for (var k = 0; k < j.targets.length; k++) {
            var l = j.targets[k];
            f(l).append(m)
        }
        a.__data.instances[a.__data.count] = j
    }
    function h() {
        var j = a.__data.instances[a.__data.count];
        var k;
        f(j.targets).find(".quick_in").unbind("click.quickIn").bind("click.quickIn",
            function(n) {
                k = f(this);
                var l = f(k).parents(".thirdGroupImageItem").find(".itemImage");
                switch (j.type) {
                    case Mobi.QuickIn.TYPE.FU:
                        top.Mobi.fileUpload2("", f.extend({
                                oldIcon: {
                                    filePath: o(l),
                                    color: l.css("color"),
                                }
                            },
                            j.popupWindowOption.settings), m);
                        break;
                    default:
                        alert("not found quickIn type!");
                        break
                }
                function o(q) {
                    var p = "";
                    try {
                        p = q.attr("class").match(/faisco-icons-\w{7}/ig).pop()
                    } finally {
                        return p
                    }
                }
                function m(p) {
                    var q = f.parseJSON(p);
                    if (q) {
                        j.popupWindowOption.closeFunc(k, q.data[0])
                    }
                }
            });
        f(j.targets).off(".quickIn").on("mouseenter.quickIn",
            function() {
                f(this).find(".quick_in").show()
            }).on("mouseleave",
            function() {
                f(this).find(".quick_in").hide()
            })
    }
    c()
})(jm, Mobi.QuickIn);
Mobi.SimpleDrag = {
    __data: {},
    __func: {},
    __create: new Function()
}; (function(f, c, d) {
    c.__create = function(n) {
        k(n)
    };
    function k(o) {
        var n = {};
        a(n, o);
        f(o).css("transform", "translateY(0px)");
        f(o).off(".simpleDrag");
        f(o).on("mousedown.simpleDrag",
            function(p) {
                b(p, n, this)
            }).on("touchstart.simpleDrag",
            function(p) {
                b(p, n, this)
            }).on("mouseup.simpleDrag",
            function(p) {
                e(p, n, this)
            }).on("touchend.simpleDrag",
            function(p) {
                e(p, n, this)
            }).on("mousemove.simpleDrag",
            function(p) {
                j(p, n, this);
                p.preventDefault()
            }).on("touchmove.simpleDrag",
            function(p) {
                j(p, n, this);
                p.preventDefault()
            })
    }
    function b(p, o, n) {
        o.isClicking = true;
        o.startY = l(p);
        if (o.overflowHeight != 0) {
            o.transformY = h(n)
        }
    }
    function e(q, p, o) {
        p.isClicking = false;
        p.moveY = m(p);
        var n = {};
        f(o).css("transform", "translateY(" + p.moveY + ")").css("-webkit-transform", "translateY(" + p.moveY + "px)");
        f(o).css("transition", "transform 0.5s cubic-bezier(0.45, 0.05, 0.55, 0.95) 0s").css("-webkit-transition", "transform 0.5s cubic-bezier(0.45, 0.05, 0.55, 0.95) 0s");
        setTimeout(function() {
                f(o).css("transition", "").css("-webkit-transition", "")
            },
            550)
    }
    function j(q, p, o) {
        var n = {};
        if (p.isClicking) {
            p.moveY = l(q) - p.startY;
            if (p.overflowHeight != 0) {
                p.moveY += p.transformY
            }
            if (p.moveY > p.moveOverflowRange) {
                p.moveY = p.moveOverflowRange
            } else {
                if (p.moveY < (p.overflowHeight * -1 - p.moveOverflowRange)) {
                    p.moveY = (p.overflowHeight * -1 - p.moveOverflowRange)
                }
            }
            f(o).css("transform", "translateY(" + p.moveY + ")").css("-webkit-transform", "translateY(" + p.moveY + "px)")
        }
    }
    function a(q, p) {
        var o = parseInt(f(p).parent().height()),
            n = parseInt(f(p).height());
        q.startY = 0;
        q.moveY = 0;
        q.isClicking = false;
        q.overflowHeight = n - o;
        q.transformY = h(p);
        q.moveOverflowRange = f(f(p).children()[0]).height();
        if (n < o) {
            q.overflowHeight = 0
        }
    }
    function m(n) {
        if ( !! !n.moveY || n.moveY > 0) {
            return 0
        }
        if (n.moveY < 0) {
            if ((n.moveY * -1) >= n.overflowHeight) {
                return n.overflowHeight * -1
            }
        }
        return n.moveY
    }
    function l(o) {
        var n = o.clientY;
        if (o.touches) {
            n = o.touches[0].clientY
        }
        return n
    }
    function h(n) {
        if (n.length == 0) {
            return 0
        }
        var o = f(n).css("transform");
        if (!o) {
            o = f(n).css("-webkit-transform")
        }
        if (o == "none") {
            o = 0
        } else {
            o = o.replace("translateY(", "").replace(")", "");
            o = parseInt(o, 10)
        }
        if (!o) {
            o = 0
        }
        return o
    }
})(jm, Mobi.SimpleDrag); (function(a, b) {
    if (typeof define === "function" && define.amd) {
        define(["$"], b)
    } else {
        if (typeof exports === "object") {
            module.exports = b()
        } else {
            a.Dialog = b(window.Zepto || window.jQuery || jm)
        }
    }
})(this,
    function(b) {
        b.fn.Dialog = function(c) {
            var d = [];
            b(this).each(function() {
                var f = new a();
                var e = b.extend({
                        trigger: b(this)
                    },
                    c);
                f.init(e);
                d.push(f)
            });
            return d
        };
        b.Dialog = function(c) {
            if (c.type === "confirm") {
                var j = new a();
                var h = '<div class="fkarea-ui-confirm-title">' + c.content + "</div>";
                var e = "";
                if (!c.buttons) {
                    c.buttons = [{
                        no: "取消"
                    },
                        {
                            yes: "完成"
                        }]
                }
                var n = "";
                for (var f = 0,
                         d = c.buttons.length; f < d; f++) {
                    var k = c.buttons[f];
                    if (k.no) {
                        n += '<td><button class="fkarea-ui-confirm-no" data-type="no">' + k.no + "</button></td>"
                    }
                    if (k.yes) {
                        n += '<td><button class="fkarea-ui-confirm-submit " data-type="yes">' + k.yes + "</button></td>"
                    }
                }
                e = '<table class="fkarea-ui-dialog-action"><tr>' + n + "</tr></table>";
                h = e + h;
                var m = b.extend({
                        target: h,
                        animate: true,
                        show: true,
                        fixed: true,
                        mask: true,
                        className: "fkarea-ui-alert",
                        afterHide: function(l) {
                            this.dispose()
                        },
                        beforeShow: function(l) {
                            j.touch(b(".fkarea-ui-confirm-submit", l),
                                function() {
                                    c.callback && c.callback.call(j, "yes", l);
                                    b("body").css({
                                        overflow: "auto"
                                    })
                                });
                            j.touch(b(".fkarea-ui-confirm-no", l),
                                function() {
                                    c.callback && c.callback.call(j, "no", l);
                                    b("body").css({
                                        overflow: "auto"
                                    })
                                })
                        }
                    },
                    c);
                j.init(m)
            }
        };
        b.confirm = function(f, e, j, d) {
            var c = {};
            var h = {
                zIndex: 1001,
                type: "confirm"
            };
            if (typeof f == "object") {
                c = b.extend(h, f)
            } else {
                c = b.extend(h, {
                    content: f,
                    buttons: e,
                    callback: j
                })
            }
            b.Dialog(b.extend(c, d))
        };
        var a = function() {
            var c = Math.random().toString().replace(".", "");
            this.id = "dialog_" + c;
            this.settings = {};
            this.settings.titleTpl = b('<div class="fkarea-ui-dialog-title"></div>');
            this.timer = null;
            this.showed = false;
            this.mask = b()
        };
        a.prototype = {
            init: function(c) {
                var e = this;
                this.settings = b.extend({
                        fixed: false
                    },
                    this.settings, c);
                if (this.settings.mask) {
                    this.mask = b('<div class="fkarea-ui-dialog-mask"/>');
                    b("body").append(this.mask)
                }
                b("body").append('<div class="fkarea-ui-dialog" id="' + this.id + '"></div>');
                this.dialogContainer = b("#" + this.id);
                var d = this.settings.zIndex || 10;
                this.dialogContainer.css({
                    zIndex: d
                });
                if (this.settings.className) {
                    this.dialogContainer.addClass(this.settings.className)
                }
                this.mask.css({
                    zIndex: d - 1
                });
                if (this.settings.title) {
                    this.dialogContainer.append(this.settings.titleTpl);
                    this.settings.titleTpl.html(this.settings.title)
                }
                this.bindEvent();
                if (this.settings.show) {
                    this.show()
                }
            },
            touch: function(f, d) {
                var c;
                b(f).on("click", e);
                function e(h) {
                    return d.call(this, h)
                }
                b(f).on("touchmove",
                    function(h) {
                        c = true;
                        h.preventDefault();
                        h.stopPropagation()
                    }).on("touchend",
                    function(h) {
                        h.preventDefault();
                        if (!c) {
                            var j = d.call(this, h, "touch");
                            if (!j) {
                                h.preventDefault();
                                h.stopPropagation()
                            }
                        }
                        c = false
                    })
            },
            bindEvent: function() {
                var c = this;
                if (this.settings.trigger) {
                    b(this.settings.trigger).click(function() {
                        c.show()
                    });
                    c.touch(b(this.settings.trigger),
                        function() {
                            c.show()
                        })
                }
                b(this.dialogContainer).on("click", ".js-dialog-close",
                    function() {
                        c.hide();
                        return false
                    });
                b(this.dialogContainer).on("hide",
                    function() {
                        c.hide()
                    })
            },
            dispose: function() {
                this.dialogContainer.remove();
                this.mask.remove();
                this.timer && clearInterval(this.timer)
            },
            hide: function() {
                var c = this;
                if (c.settings.beforeHide) {
                    c.settings.beforeHide.call(c, c.dialogContainer)
                }
                this.showed = false;
                this.mask.hide();
                this.timer && clearInterval(this.timer);
                if (this.settings.animate) {
                    this.dialogContainer.removeClass("fkarea-zoomIn").addClass("fkarea-zoomOut");
                    setTimeout(function() {
                            c.dialogContainer.hide();
                            if (typeof c.settings.target === "object") {
                                b("body").append(c.dialogContainer.hide())
                            }
                            if (c.settings.afterHide) {
                                c.settings.afterHide.call(c, c.dialogContainer)
                            }
                        },
                        500)
                } else {
                    this.dialogContainer.hide();
                    if (typeof this.settings.target === "object") {
                        b("body").append(this.dialogContainer)
                    }
                    if (this.settings.afterHide) {
                        this.settings.afterHide.call(this, this.dialogContainer)
                    }
                }
            },
            show: function() {
                if (typeof this.settings.target === "string") {
                    if (/^(\.|\#\w+)/gi.test(this.settings.target)) {
                        this.dailogContent = b(this.settings.target)
                    } else {
                        this.dailogContent = b("<div>" + this.settings.target + "</div>")
                    }
                } else {
                    this.dailogContent = this.settings.target
                }
                this.mask.show();
                this.mask.bind("touchmove",
                    function(d) {
                        d.preventDefault()
                    });
                b("body").css({
                    overflow: "hidden"
                });
                this.dailogContent.show();
                this.dailogContent.bind("touchmove",
                    function(d) {
                        d.preventDefault()
                    });
                this.height = this.settings.height || "auto";
                this.width = this.settings.width || "auto";
                this.dialogContainer.append(this.dailogContent).show().css({
                    height: this.height,
                    width: this.width
                });
                if (this.settings.beforeShow) {
                    this.settings.beforeShow.call(this, this.dialogContainer)
                }
                this.showed = true;
                this.setPosition();
                var c = this;
                this.timer && clearInterval(this.timer);
                if (this.settings.fixed) {
                    this.timer = setInterval(function() {
                            c.setPosition()
                        },
                        1000)
                }
                if (this.settings.animate) {
                    this.dialogContainer.addClass("fkarea-zoomIn").removeClass("fkarea-zoomOut").addClass("fkarea-animated")
                }
            },
            setPosition: function() {
                if (this.showed) {
                    var j = this;
                    this.dialogContainer.show();
                    this.height = this.settings.height;
                    this.width = this.settings.width;
                    if (isNaN(this.height)) {
                        this.height = (this.dialogContainer.outerHeight && this.dialogContainer.outerHeight()) || this.dialogContainer.height()
                    }
                    if (isNaN(this.width)) {
                        this.width = (this.dialogContainer.outerWidth && this.dialogContainer.outerWidth()) || this.dialogContainer.width()
                    }
                    var h = this.settings.clientHeight || document.documentElement.clientHeight || document.body.clientHeight;
                    var l = this.settings.clientWidth || document.documentElement.clientWidth || document.body.clientWidth;
                    var e = this.width / 2;
                    var c = this.height / 2;
                    var d = l / 2 - e;
                    var k = h / 2 - c;
                    d = Math.floor(Math.max(0, d));
                    k = Math.floor(Math.max(0, k));
                    var f = "absolute";
                    var m = "768px";
                    if (jm && jm("#g_web") && jm("#g_web").length > 0) {
                        m = jm("#g_web").css("max-width")
                    }
                    if (j.settings.fixed) {
                        f = "fixed"
                    }
                    j.dialogContainer.css({
                        position: f,
                        top: k,
                        width: "100%",
                        left: 0,
                        right: 0,
                        maxWidth: m,
                        margin: "0px auto"
                    })
                }
            }
        };
        return a
    }); (function(a, b) {
    if (typeof define === "function" && define.amd) {
        define(["$", "dialog"], b)
    } else {
        if (typeof define === "function" && define.cmd) {
            define(function(e, d, f) {
                var h = e("$");
                var c = e("dialog");
                return b(h, c)
            })
        } else {
            if (typeof exports === "object") {
                module.exports = b()
            } else {
                a.MobileSelectArea = b(window.Zepto || window.jQuery || jm)
            }
        }
    }
})(this,
    function(c, a) {
        var b = function() {
            var d = Math.random().toString().replace(".", "");
            this.id = "scroller_" + d;
            this.scroller;
            this.data;
            this.index = 0;
            this.value = [0, 0, 0];
            this.oldvalue;
            this.oldtext = [];
            this.text = ["", "", ""];
            this.level = 3;
            this.mtop = 30;
            this.separator = ""
        };
        b.prototype = {
            init: function(d) {
                this.settings = c.extend({
                        eventName: "click"
                    },
                    d);
                this.lcid = parseInt(this.settings.lcid);
                this.trigger = c(this.settings.trigger);
                this.settings.init == undefined ? this.init = 1 : this.init = 0;
                level = parseInt(this.settings.level);
                this.level = level > 0 ? level: 3;
                this.trigger.attr("readonly", "readonly");
                this.value = (this.settings.value && this.settings.value.split(",")) || [0, 0, 0];
                this.text = this.settings.text || this.trigger.val().split(" ") || ["", "", ""];
                this.oldvalue = this.value.concat([]);
                this.oldtext = this.text.concat([]);
                this.clientHeight = document.documentElement.clientHeight || document.body.clientHeight;
                this.clientWidth = document.documentElement.clientWidth || document.body.clientWidth;
                this.bindEvent()
            },
            getData: function() {
                var d = this;
                if (typeof this.settings.data == "object") {
                    this.data = this.settings.data
                }
            },
            bindEvent: function() {
                var d = this;
                this.trigger[d.settings.eventName](function(m) {
                    var l = "";
                    for (var k = 0; k < d.level; k++) {
                        l += "<div></div>"
                    }
                    if (d.lcid != 2052 && d.lcid != 1028) {
                        d.buttons = [{
                            no: "cancel"
                        },
                            {
                                yes: "fulfil"
                            }]
                    } else {
                        d.buttons = null
                    }
                    c.confirm('<div class="fkarea-ui-scroller-mask"><div id="' + d.id + '" class="ui-scroller">' + l + "<p></p></div></div>", d.buttons,
                        function(e, p) {
                            if (e == "yes") {
                                d.submit()
                            }
                            if (e == "no") {
                                d.cancel()
                            }
                            this.dispose()
                        },
                        {
                            width: 320,
                            height: 215
                        });
                    d.scroller = c("#" + d.id);
                    d.getData();
                    d.format();
                    var o = 0,
                        h = 0;
                    d.scroller.children().off("mousedown.area-scroller").on("mousedown.area-scroller", n);
                    function n(e) {
                        e = e || window.event;
                        o = e.pageY;
                        c(window).off("mousemove.area-scroller").on("mousemove.area-scroller", f);
                        c(window).off("mouseup.area-scroller").on("mouseup.area-scroller", j);
                        e.preventDefault()
                    }
                    function f(p) {
                        p = p || window.event;
                        h = p.pageY;
                        var r = h - o;
                        var e = c(p.target).parent();
                        if (e[0].nodeName != "DL") {
                            return
                        }
                        var q = parseInt(e.css("top") || 0) + r;
                        if (q < -c(e).height() + 60) {
                            q = -c(e).height() + 60
                        }
                        e.css("top", q + "px");
                        o = h;
                        p.preventDefault()
                    }
                    function j(e) {
                        e = e || window.event;
                        h = e.pageY;
                        c(window).off("mousemove.area-scroller");
                        c(window).off("mouseup.area-scroller");
                        var w = h - o;
                        var s = c(e.target).parent();
                        if (s[0].nodeName != "DL") {
                            return
                        }
                        var q = c(s.parent()).index();
                        var u = parseInt(s.css("top") || 0) + w - 30;
                        if (u > d.mtop) {
                            u = d.mtop
                        }
                        if (u < -c(s).height() + 60) {
                            u = -c(s).height() + 60
                        }
                        var v = u / d.mtop;
                        var r = Math.round(v);
                        var t = Math.abs(r) + 1;
                        if (r == 1) {
                            t = 0
                        }
                        d.value[q] = c(s.children().get(t)).attr("ref");
                        d.value[q] == 0 ? d.text[q] = "": d.text[q] = c(s.children().get(t)).html();
                        for (var p = d.level - 1; p > q; p--) {
                            d.value[p] = 0;
                            d.text[p] = ""
                        }
                        if (!c(s.children().get(t)).hasClass("focus")) {
                            d.format()
                        }
                        c(s.children().get(t)).addClass("focus").siblings().removeClass("focus");
                        s.css("top", r * d.mtop + "px");
                        e.preventDefault()
                    }
                    d.scroller.children().bind("touchstart",
                        function(p) {
                            o = (p.changedTouches || p.originalEvent.changedTouches)[0].pageY
                        });
                    d.scroller.children().bind("touchmove",
                        function(s) {
                            h = (s.changedTouches || s.originalEvent.changedTouches)[0].pageY;
                            var r = h - o;
                            var p = c(s.target).parent();
                            if (p[0].nodeName != "DL") {
                                return
                            }
                            var q = parseInt(p.css("top") || 0) + r;
                            if (q < -c(p).height() + 60) {
                                q = -c(p).height() + 60
                            }
                            p.css("top", q + "px");
                            o = h;
                            return false
                        });
                    d.scroller.children().bind("touchend",
                        function(u) {
                            h = (u.changedTouches || u.originalEvent.changedTouches)[0].pageY;
                            var x = h - o;
                            var s = c(u.target).parent();
                            if (s[0].nodeName != "DL") {
                                return
                            }
                            var q = c(s.parent()).index();
                            var v = parseInt(s.css("top") || 0) + x - 30;
                            if (v > d.mtop) {
                                v = d.mtop
                            }
                            if (v < -c(s).height() + 60) {
                                v = -c(s).height() + 60
                            }
                            var w = v / d.mtop;
                            var r = Math.round(w);
                            var t = Math.abs(r) + 1;
                            if (r == 1) {
                                t = 0
                            }
                            d.value[q] = c(s.children().get(t)).attr("ref");
                            d.value[q] == 0 ? d.text[q] = "": d.text[q] = c(s.children().get(t)).html();
                            for (var p = d.level - 1; p > q; p--) {
                                d.value[p] = 0;
                                d.text[p] = ""
                            }
                            if (!c(s.children().get(t)).hasClass("focus")) {
                                d.format()
                            }
                            c(s.children().get(t)).addClass("focus").siblings().removeClass("focus");
                            s.css("top", r * d.mtop + "px");
                            return false
                        });
                    return false
                })
            },
            format: function() {
                var e = this;
                var d = e.scroller.children();
                this.f(this.data)
            },
            f: function(l) {
                var o = this;
                var s = l;
                if (!s) {
                    s = []
                }
                var p = '<dl><dd ref="0">——</dd>';
                var t = 0,
                    f, q = o.mtop;
                if (o.index !== 0 && o.value[o.index - 1] == "0" && this.init == 0) {
                    p = '<dl><dd ref="0" class="focus">——</dd>';
                    o.value[o.index] = 0;
                    o.text[o.index] = "";
                    t = 0
                } else {
                    if (o.value[o.index] == "0") {
                        p = '<dl><dd ref="0" class="focus">——</dd>';
                        t = 0
                    }
                    if (s.length > 0 && this.init == 1) {
                        p = "<dl>";
                        var m = s[0].pid || 0;
                        var d = s[0].id || 0;
                        t = s[0].id;
                        if (o.lcid == 2052 || o.lcid == 1028) {
                            f = site_cityUtil.getCities(s[0].id)
                        } else {
                            f = site_cityUtil.getCitiesEn(s[0].id)
                        }
                        if (!o.value[this.index]) {
                            o.value[this.index] = d;
                            o.text[this.index] = s[0].name
                        }
                        p += '<dd pid="' + m + '" class="' + r + '" ref="' + d + '">' + s[0].name + "</dd>"
                    }
                    for (var k = o.init,
                             n = s.length; k < n; k++) {
                        var m = s[k].pid || 0;
                        var d = s[k].id || 0;
                        var r = "";
                        if (o.value[o.index] == d) {
                            r = "focus";
                            t = d;
                            if (o.lcid == 2052 || o.lcid == 1028) {
                                f = site_cityUtil.getCities(s[k].id)
                            } else {
                                f = site_cityUtil.getCitiesEn(s[k].id)
                            }
                            q = o.mtop * ( - (k - o.init))
                        }
                        p += '<dd pid="' + m + '" class="' + r + '" ref="' + d + '">' + s[k].name + "</dd>"
                    }
                }
                p += "</dl>";
                var h = p;
                var e = o.scroller.children();
                c(e[o.index]).html(h);
                c(e[o.index]).children().css("top", q + 30 + "px");
                o.index++;
                if (o.index > o.level - 1) {
                    o.index = 0;
                    return
                }
                o.f(f)
            },
            submit: function() {
                this.oldvalue = this.value.concat([]);
                this.oldtext = this.text.concat([]);
                if (this.trigger[0].nodeType == 1) {
                    this.trigger.val(this.text.join(this.separator));
                    this.trigger.attr("data-value", this.value.join(","))
                }
                this.settings.callback && this.settings.callback.call(this, this.scroller, this.text, this.value)
            },
            cancel: function() {
                this.value = this.oldvalue.concat([]);
                this.text = this.oldtext.concat([])
            }
        };
        return b
    });
Mobi.initProductGroupManage = function(b, c) {
    if (Fai.top._templateFrameId < 2000 || Fai.top._templateFrameId >= 3000) {
        return
    }
    var a = Mobi.getPreviewDocument().getElementById("module" + b);
    $(a).mouseover(function() {
        Mobi.addModuleLayer("module" + b, c)
    }).mouseleave(function() {
        Mobi.removeModuleLayer("module" + b)
    })
};
Mobi.ajaxClick = function(h, f, c) {
    showLoadingAgain = function(l) {
        closeLoading(l);
        var e = ['<div class="ajaxLoadingAgain width" style="margin-top:50px;margin-bottom:50px;text-align:center;">', '<div style="color: #1b7ad1; text-decoration: none; text-align:center; width:100%;cursor:pointer;" onclick="reloadingClick(' + l + ');">加载失败，请点击重新加载</div>', "</div>"];
        jm("#module" + l + " .middleCenter").empty().append(e.join(""))
    };
    showLoading = function(l) {
        var e = ["<div class='moduleLoading' style='height : 150px;'>", "<table style='width:100%;height:100%;'><tr><td align='center' valign='middle'>", "<img src='" + Fai.top._resRoot + "/image/loading/loading_2.gif?v=201509211806' >", "</td></tr></table>", "</div>"];
        jm("#module" + l + " .middleCenter").empty().append(e.join(""))
    };
    closeLoading = function(e) {
        jm("#module" + e + " .moduleLoading").remove()
    };
    reloadingClick = function(e) {
        loadingAjaxDom(e)
    };
    var b = jm(h).attr("href");
    if (c) {
        b = h.children[h.selectedIndex].getAttribute("value")
    }
    var a = 3;
    var k = 0;
    try {
        a = Fai.top._colInfo.id;
        k = Fai.top._colInfo.extId
    } catch(j) {
        a = 3;
        k = 0
    }
    var d = false;
    loadingAjaxDom = function(e) {
        setTimeout(function() {
                if (!d) {
                    showLoading(e)
                }
            },
            1000);
        // jm.ajax({
        //     type: "post",
        //     url: "ajax/ajaxLoadModuleDom_h.jsp",
        //     data: "cmd=getAjaxPageModuleInfo&_colId=" + a + "&_extId=" + k + "&moduleId=" + e + "&href=" + jm.encodeUrl(b),
        //     error: function(l) {
        //         d = true;
        //         closeLoading(e);
        //         showLoadingAgain(e);
        //         Mobi.ing(LS.systemError)
        //     },
        //     success: function(l) {
        //         d = true;
        //         closeLoading(e);
        //         var l = jm.parseJSON(l);
        //         if (l.success) {
        //             var m = jm(l.domStr).find(".middleCenter" + e).html();
        //             var n = jm("#module" + e).find(".middleCenter" + e);
        //             n.html(m);
        //             jm.fkEval.call(window, l.scripts);
        //             Mobi.scrollToModule(e)
        //         } else {
        //             showLoadingAgain(e);
        //             Mobi.ing(l.msg)
        //         }
        //     }
        // })
    };
    loadingAjaxDom(f)
};
Mobi.getOemViewUrl = function(a) {
    return "http://www.webportal.cc/sys/view.jsp?id=" + a
};
Mobi.showTopTips = function(c, a, h) {
    var b = jm.parseJSON(h);
    var f = "";
    var j = false;
    if (c == undefined || c == 0) {
        f = '<li style="color:red;margin-left:20px;">免费域名不支持调用第三方代码，请使用已购买的域名进行访问&nbsp;&nbsp;&nbsp;</li>'
    } else {
        if (c == 1) {
            if (Fai.top._manageMode && Fai.top.httpInCodeCount > 0) {
                if (Fai.top.$(".httpInCodeTips").length > 0) {
                    Fai.top.$(".httpIncode").text("点击定位链接位置（" + Fai.top.httpInCodeCount + "条）");
                    return
                } else {
                    j = true;
                    f = "<div class='httpInCodeTips' style='color:#ff8e1e;font-size:13px;text-align:0;margin-left:20px;'>网站内插入的代码存在非HTTPS链接，该链接无法正常加载，请先修改或者删除该链接。<a class='httpIncode' style='text-decoration: underline;color:#ff1d1d;' href='javascript:;' onclick='Mobi.getPreviewWindow().Mobi.jumptoHttpInCodeModule()'>点击定位链接位置（" + Fai.top.httpInCodeCount + "条）</a><a class='tipsDescription' onclick='Mobi.getPreviewWindow().Mobi.jumptoHttpInCodeExplain()' style='cursor:pointer; color:red; margin-left:30px; margin-right:30px; text-decoration:underline;'>详细说明&gt;&gt;</a></div>"
                }
            } else {
                f = "<li style='color:#ff8e1e;font-size:13px;text-align:0;margin-left:20px;'>网站内插入的代码存在非HTTPS链接，该链接无法正常加载显示，请替换成HTTPS链接或使用非HTTPS方式访问&nbsp;&nbsp;&nbsp</li>"
            }
        } else {
            if (c == 2) {
                f = '<li style="color:red;margin-left:20px;">免费域名不支持插件代码&nbsp;&nbsp;&nbsp</li>'
            } else {
                if (c == 3) {
                    f = '<li style="color:red;margin-left:20px;">基于安全原因，2018年4月11号起新注册的用户免费域名访问不支持插件代码和第三方代码，请使用绑定的域名进行访问。&nbsp;&nbsp;&nbsp</li>'
                }
            }
        }
    }
    if (a && a != "") {
        f = a
    }
    if (j) {
        var e = ['<div id="fk-tips" class="fk-tips" style="position: fixed; width: 100%; height: 40px; background: #fff5dc; font-size: 13px; color: #ff8e1e; line-height: 40px; text-align: center;">', f, "</div>", ];
        Fai.top.$(".fk-toolTopBar").css("top", "40px");
        Fai.top.$(".mobiStyleDesign").css("top", "100px");
        Fai.top.$("body").prepend(e.join(""));
        return
    }
    if (jm("#webTips").length > 0) {
        jm("#mobiTipsMarquee").append(f)
    } else {
        var d = ['<div id="webTips" class="webTips jz-webTips">', '   <div id="mobitips" class="mobitips">', '       <div class="mobiScrollbar">', '           <div class="j-marqueeContainer J_marqueeContainer">', '               <ul class="marquee J_marquee" id="mobiTipsMarquee">', f, "               </ul>", "           </div>", "       </div>", "   </div>", "</div>", ];
        jm("body").prepend(d.join(""))
    }
    jm(".detailHeaderColor.detailHeaderColor").css("top", "1.5rem");
    jm(".productDetailHeader").css("top", "1.5rem");
    Mobi.topTipMarquee()
};
Mobi.jumptoHttpInCodeExplain = function() {
    var a = "";
    if (Fai.top._oem) {
        a = "http://adm.webportal.top/sys/view.jsp?id=844"
    } else {
        a = "http://jz.fkw.com/blog/11673"
    }
    Fai.top.window.open(a)
};
Mobi.changeHttp = function() {
    var a = Fai.top.location.href;
    if (a.indexOf("https://") == 0) {
        a = "http://" + a.substring(8)
    }
    Fai.top.location.href = a
};
Mobi.fixWXPublicAttentionTip = function(b, e, a) {
    var d = jm("#wxPublicAttentionService");
    if (a) {
        d.show()
    }
    var c, h = d.find(".close"),
        f = d.find(".clickContent"),
        j = ['<div id="wxTopTip" class="wxTopTip">', "</div>", '   <div id="wxPage" class="wxPage">', '       <div class="pic" id="wxPagePic">', '           <img src="' + Fai.top._resRoot + '/image/wxPage.png?v=201712151528" >', "       </div>", '       <div class="pic1">', '           <img class="img" src="' + e + '"/>', "       </div>", '       <div class="text">', "           长按识别图中二维码快来关注我吧", "       </div>", "   </div>", ];
    h.bind("click",
        function() {
            d.hide();
            jm.cookie("_hideWXPublicAttentionTip", 1, {
                expires: 1,
                path: "/"
            })
        });
    f.bind("click",
        function() {
            jm("body").append(j.join(""));
            if (e == "") {
                jm("#wxPage").find(".img").hide()
            }
            jm("#wxTopTip").bind("click",
                function() {
                    jm(this).remove();
                    jm("#wxPage").remove()
                });
            jm("#wxPagePic").bind("mouseup",
                function(k) {
                    k.stopPropagation();
                    k.preventDefault()
                })
        });
    if (b) {
        if (top.Fai.top._other.pa.st != 1) {
            d.hide()
        } else {
            d.show()
        }
    }
    if (Fai.top._templateFrameId >= 2000) {
        if (jm("#serviceBtnOuter").length > 0 && jm("#serviceBtnOuter").css("display") != "none") {
            c = jm("#serviceBtnOuter").height()
        } else {
            if (jm("#fixedAreaBox").length > 0 && jm("#fixedAreaBox").css("display") != "none") {
                c = jm("#fixedAreaBox").height()
            }
        }
    } else {
        if (Fai.top._templateFrameId >= 1000 && Fai.top._templateFrameId < 2000) {
            if (jm("#webCustomerServiceBox").length > 0 && jm("#webCustomerServiceBox").css("display") != "none") {
                c = jm("#customerServiceDiv").height()
            }
        } else {
            if (jm("#webCustomerServiceBox").length > 0 && jm("#webCustomerServiceBox").css("display") != "none") {
                c = jm("#customerServiceDiv").height()
            }
        }
    }
    d.css("bottom", c + "px")
};
Mobi.allFixWXPA = function(e, d, a) {
    var c = jm("#wxPublicAttentionService"),
        b = 0;
    if (e == 1) {
        if (Fai.top._openOnlineService) {
            b = jm("#customerServiceDiv").height()
        }
        c.css("bottom", b + "px")
    } else {
        if (e == 2) {
            if (a) {
                b = parseInt(jm("#module" + d).find(".newsBottom").height())
            }
            c.css("bottom", b + "px")
        } else {
            if (e == 3) {
                if (a) {
                    b = parseInt(jm(".productMallShop").height())
                }
                c.css("bottom", b + "px")
            }
        }
    }
};
Mobi.fixNewsJumpLink = function(c, a) {
    var b = jm("#module" + c);
    b.find(".newsLine").on("click.link",
        function(d) {
            if (jm(d.target).hasClass("J_linkH")) {
                return
            }
            window.location.href = "/" + a + "/" + jm(this).find(".J_linkH").attr("href")
        })
};
Mobi.statisticsHttpInCode = function(c, b) {
    if (!Fai.top.httpInCode) {
        Fai.top.httpInCode = {}
    }
    Fai.top.httpInCode[c] = b;
    Fai.top.httpInCodeModuleList = [];
    Fai.top.httpInCodeCount = 0;
    for (var a in Fai.top.httpInCode) {
        if (Fai.top.httpInCode[a] == 0) {
            continue
        }
        Fai.top.httpInCodeModuleList.push(a);
        Fai.top.httpInCodeCount += Fai.top.httpInCode[a]
    }
    if (Fai.top.httpInCodeCount == 0) {
        if ($(".httpIncode").length > 0) {
            $(document).ready(function() {
                window.location.reload()
            })
        }
    } else {
        Fai.top.$(".httpIncode").text("点击定位链接位置（" + Fai.top.httpInCodeCount + "条）")
    }
};
Mobi.fixParamAreaHeight = function(c) {
    var a = jm("#module" + c);
    var b = 0;
    var d = a.find(".paramCollectionWrap");
    d.each(function(f, h) {
        var e = parseInt(jm(h).height());
        e > b && (b = e)
    });
    if (b > 0) {
        d.each(function(e, f) {
            jm(f).height(b + "px")
        })
    }
};
Mobi.jumptoHttpInCodeModule = function() {
    if (!Fai.top.curHttpInCode) {
        Fai.top.curHttpInCode = 0
    }
    if (Fai.top.curHttpInCode == Fai.top.httpInCodeModuleList.length - 1) {
        Fai.top.curHttpInCode = 0
    } else {++Fai.top.curHttpInCode
    }
    var a = Fai.top.httpInCodeModuleList[Fai.top.curHttpInCode];
    $("#mobiImagePage").remove();
    $("#g_web").show();
    if (a == 0) {
        setTimeout(function() {
                Fai.top.$(".f_item_set").click();
                setTimeout(function() {
                        Fai.top.$(".tabs-label:eq(1)").click()
                    },
                    100)
            },
            0)
    } else {
        if (a == -1) {
            $("html, body, #g_main, #web").animate({
                    scrollTop: document.getElementById("footer").offsetTop + $("#webHeaderBox").height()
                },
                {
                    duration: 500,
                    easing: "swing"
                })
        } else {
            $("html, body, #g_main, #web").animate({
                    scrollTop: document.getElementById("module" + a).offsetTop + $("#webHeaderBox").height() + document.getElementById("g_web").offsetTop
                },
                {
                    duration: 500,
                    easing: "swing"
                })
        }
    }
};
Mobi.showNavItemContainer = function() {
    Mobi.hideNavItemContainer();
    Mobi.removeNavIconPositionFix();
    var w = Mobi.getPreviewObject("navbarList"),
        b = Mobi.getPreviewObject("navbar"),
        e = w,
        t = parseInt(jm(b).width()),
        m = 0,
        l = b.querySelectorAll(".navItem"),
        v = b.querySelectorAll(".itemSep"),
        h = jm(b),
        E = h.find(".navItem"),
        z = jm(w),
        F = h.offset();
    for (var A = 0; A < l.length; A++) {
        m += l[A].offsetWidth
    }
    for (var x = 0; x < v.length; x++) {
        m += v[x].offsetWidth
    }
    m = m + l.length;
    if (m > t) {
        if (navigator.appVersion.match(/MSIE [\d.]+/)) {
            if (parseInt(navigator.appVersion.match(/MSIE ([\d.]+)/)[1]) === 10) {
                m = m + l.length * 2
            }
        }
        jm(e).css("width", m + "px").removeClass("navbarList-horizontalLayout");
        var C = jm.getCookie("startX") ? parseInt(jm.getCookie("startX")) : 0;
        if (jm.os.supportsTouch) {
            var c = new iScroll(b, {
                x: C,
                scrollX: true,
                scrollY: false,
                mouseWheel: true,
                remarkXCoordinate: true,
                remarkNavLeftRight: B,
                onBeforeScrollMove: q
            });
            B(C, c);
            function q() {
                Mobi.hideOfficalNavSubMenu()
            }
            function B(j, p) {
                var G = p.wrapper.querySelector(".navLeft") ? p.wrapper.querySelector(".navLeft") : p.wrapper.querySelector(".navTouchLeft"),
                    H = p.wrapper.querySelector(".navRight") ? p.wrapper.querySelector(".navRight") : p.wrapper.querySelector(".navTouchRight");
                G.className = "navTouchLeft";
                H.className = "navTouchRight";
                if (j < 0) {
                    G.style.display = "block"
                } else {
                    G.style.display = "none"
                }
                if (p.maxScrollX === p.x) {
                    H.style.display = "none"
                } else {
                    H.style.display = "block"
                }
            }
        } else {
            var r = jm(b).find(".navLeft"),
                D = jm(b).find(".navRight"),
                a = jm(b).find(".navbarList"),
                u = t - m;
            timer = null;
            if (C < 0) {
                r.css("display", "block");
                jm(e).css("left", u + "px")
            }
            D.css("display", "block");
            var x = jm.getCookie("startX_p") ? parseInt(jm.getCookie("startX_p")) : 0;
            var y = 0;
            var d = 0;
            var f;
            if (jm(v[0]).css("display")) {
                f = 0
            } else {
                f = jm(b).find(".itemSep").width() / 2
            }
            var o = b.offsetLeft;
            var s = [];
            jm(b).find(".navItem").each(function(j) {
                s[j] = this.offsetLeft - o;
                y++
            });
            D.unbind("click");
            r.unbind("click");
            D.on("click",
                function() {
                    k(this, "click");
                    if (jm(".nav_offical_sub_menu_wrap").length > 0) {
                        Mobi.hideOfficalNavSubMenu()
                    }
                });
            r.on("click",
                function() {
                    n(this, "click");
                    if (jm(".nav_offical_sub_menu_wrap").length > 0) {
                        Mobi.hideOfficalNavSubMenu()
                    }
                });
            jm(b).bind("swipeLeft",
                function(j) {}).bind("swipeRight",
                function(j) {});
            function n(G, p) {
                jm(G).unbind(p);
                if (x >= s.length) {
                    x = s.length - 1
                }
                d = s[x] - s[x - 1];
                if (x == 1) {
                    d -= f
                }
                x--;
                if (x < 0) {
                    x = 0
                }
                var j = (e.offsetLeft + d);
                if (j > 0) {
                    j = 0
                }
                jm(e).css("left", j + "px");
                jm.setCookie("startX", j);
                jm.setCookie("startX_p", x);
                setTimeout(function() {
                        if ((Math.abs(e.offsetLeft) + t) < m) {
                            D.css("display", "block")
                        }
                        if (e.offsetLeft >= -1) {
                            r.css("display", "none")
                        }
                        jm(G).bind(p,
                            function() {
                                n(this, p)
                            })
                    },
                    600)
            }
            function k(G, p) {
                jm(G).unbind(p);
                if (x >= s.length) {
                    x = s.length - 1
                }
                d = s[x + 1] - s[x];
                if (x == 0) {
                    d -= f
                }
                x++;
                if (x == y) {
                    x = y - 1
                }
                var j = (e.offsetLeft - d);
                if (Math.abs(j) + t > m) {
                    j = 0 - (m - t)
                }
                jm(e).css("left", j + "px");
                jm.setCookie("startX", j);
                jm.setCookie("startX_p", x);
                setTimeout(function() {
                        if (e.offsetLeft < 0) {
                            r.css("display", "block")
                        }
                        if ((Math.abs(e.offsetLeft) + t) >= m) {
                            D.css("display", "none")
                        }
                        jm(G).bind(p,
                            function() {
                                k(this, p)
                            })
                    },
                    1000)
            }
        }
        h.on("click.nav", ".navItem",
            function() {
                var j = jm(this),
                    H = j.offset(),
                    G = jm.os.supportsTouch ? c.x: parseInt(z.css("left").replace("px", "")),
                    p = parseInt(j.width());
                if (F.right < H.right) {
                    if (j.closest(".nav_1_level").length < 1) {
                        jm.setCookie("startX", G - p)
                    } else {
                        if (h.hasClass("jz_subMenu_bubble")) {}
                    }
                } else {
                    if (F.left > H.left) {
                        if (j.closest(".nav_1_level").length < 1) {
                            jm.setCookie("startX", G + p)
                        } else {
                            if (h.hasClass("jz_subMenu_bubble")) {}
                        }
                    }
                }
            })
    }
    jm(e).removeClass("navbarList-horizontalLayout")
};
Mobi.hideNavItemContainer = function() {
    jm(Mobi.getPreviewObject("navbarList")).removeAttr("style");
    jm(Mobi.getPreviewObject("navbar")).find(".navLeft").hide();
    jm(Mobi.getPreviewObject("navbar")).find(".navRight").hide()
};
Mobi.removeAllSwipeMenuClass = function() {
    a("moveAnimation");
    a("moveRight");
    jm("#navbar").removeClass("open");
    jm("#navButton").removeClass("navButtonOpen");
    jm("#navExistOffPanel").removeClass("navButtonOpen");
    function a(b) {
        jm("#webHeaderBox").removeClass(b);
        jm("#webBannerBox").removeClass(b);
        jm("#webContainerBox").removeClass(b);
        jm("#customerServiceDiv").removeClass(b);
        jm("#webFooter").removeClass(b);
        jm("#bgm_icon").removeClass(b)
    }
};
Mobi.navSwipeMenu = function(a) {
    var c = "navButton",
        b = false;
    d("moveAnimation");
    function d(h) {
        jm("#webBannerBox").addClass(h);
        jm("#webContainerBox").addClass(h);
        jm("#customerServiceDiv").addClass(h);
        jm("#webFooter").addClass(h);
        jm("#bgm_icon").addClass(h)
    }
    function f(h) {
        jm("#webHeaderBox").removeClass(h);
        jm("#webBannerBox").removeClass(h);
        jm("#webContainerBox").removeClass(h);
        jm("#customerServiceDiv").removeClass(h);
        jm("#webFooter").removeClass(h);
        jm("#bgm_icon").removeClass(h)
    }
    function e(j) {
        var h = Mobi.getPreviewObject("navbar").className;
        if (h.indexOf("open") !== -1) {
            jm("#navbar").removeClass("open");
            jm("#navExistOffPanel").removeClass("navPanelOpen");
            jm("#navButton").removeClass("navButtonOpen");
            f("moveRight");
            if (a === 2) {
                jm("#webTop").css("height", "")
            }
        } else {
            jm("#navbar").addClass("open");
            jm("#navExistOffPanel").addClass("navPanelOpen");
            jm("#navButton").addClass("navButtonOpen");
            d("moveRight");
            if (!b) {
                Mobi.fixNavIconPosition();
                b = true
            }
            if (a === 2) {
                jm("#webTop").css("height", "100%")
            }
        }
    }
    if (a != 5 && a != 2 && a !== 8) {
        Mobi.autoSetNavBarHeight(a)
    }
    Mobi.bindTouchAndClickEvent(jm("#" + c),
        function() {
            e();
            return false
        },
        "show");
    Mobi.bindTouchAndClickEvent(jm("#navExistOffPanel"),
        function() {
            e();
            return false
        })
};
Mobi.fixNavIconPosition = function() {
    var k = Fai.top._templateLayoutId,
        q = 0,
        u = 1,
        h = 2,
        o = 3,
        r = 4,
        m = 5,
        j = 6,
        l = 7,
        e = 8;
    var s = jm("#navbar"),
        a = jm("#navbarList"),
        t = a.find(".J_imgIcon"),
        n = a.find(".J_fontIcon"),
        d = a.find(".icon-navItemIcon"),
        v,
        p,
        f,
        b,
        c;
    Mobi.removeNavIconPositionFix();
    if (! (k == h || k == r || k == l || k == m)) {
        return
    }
    if (n.length < 1 || t.length < 1) {
        return
    }
    b = jm(n[0]);
    v = parseFloat(n[0].offsetWidth);
    b.addClass("fk-fixNavIconStyle");
    p = parseFloat(n[0].offsetWidth);
    f = parseFloat(n[0].offsetHeight);
    b.removeClass("fk-fixNavIconStyle");
    if (v > p) {
        return
    }
    d.each(function(w, x) {
        c = jm(x).parent().attr("id");
        Mobi.setCtrlStyleCssList("mobiStyleNav", c, [{
            cls: ".icon-navItemIcon",
            key: "width",
            value: p + "px"
        },
            {
                cls: ".icon-navItemIcon",
                key: "height",
                value: f + "px"
            }])
    })
};
Mobi.removeNavIconPositionFix = function() {
    var b = jm("#navbarList"),
        a = b.find(".icon-navItemIcon");
    if (Fai.top._manageMode) {
        a.each(function(c, d) {
            styleId = jm(d).parent().attr("id");
            Mobi.removeCtrlStyleCssList("mobiStyleNav", styleId, [{
                cls: ".icon-navItemIcon",
                key: "width"
            },
                {
                    cls: ".icon-navItemIcon",
                    key: "height"
                }])
        })
    }
};
Mobi.initNavSubMenu = function(l, a, b) {
    var h = [],
        f = [],
        c,
        j = (Fai.top._manageMode && Fai.top._columnStyleJson.s) || a,
        n = (Fai.top._manageMode && Fai.top._other.templateInfo.templatePresetIndex) || b;
    for (var k in l) {
        nav = l[k];
        c = nav.children || nav.cil,
            f.push(nav.id);
        if (Fai.top._manageMode) {
            if (nav.children && nav.children.length > 0) {
                for (var e = 0; e < nav.children.length; e++) {
                    h.push(nav.children[e].id)
                }
            }
        } else {
            h = h.concat(nav.cil)
        }
    }
    for (var e = 0; e < h.length; e++) {
        index = jm.inArray(h[e], f);
        if (index >= 0) {
            f.splice(index, 1)
        }
    }
    var d = jm("#fixedAreaBox"),
        m = d.offset();
    for (var e = 0; e < f.length; e++) { (function(p) {
        var s = l["nav" + f[p]],
            q = [],
            t,
            o;
        if (s.children) {
            for (var p = 0; p < s.children.length; p++) {
                q.push(s.children[p].id)
            }
        } else {
            q = s.cil
        }
        var r = jm("#mallNavItem_" + s.id);
        if (r.length < 1) {
            return
        }
        if (q.length < 1) {
            r.find(".mallNavText").removeClass("icon-subMenuIcon");
            r.off("click.subMenu")
        } else {
            if (Fai.top._manageMode) {
                r.attr("href", "javascript:;");
                if (j == 7 || j == 3) {
                    r.find(".mallNavText").addClass("icon-subMenuIcon")
                }
            }
            r.off("click.subMenu").on("click.subMenu",
                function() {
                    j = (Fai.top._manageMode && Fai.top._columnStyleJson.s) || a,
                        n = (Fai.top._manageMode && Fai.top._other.templateInfo.templatePresetIndex) || b;
                    jm(".nav_sub_menu_wrap").remove();
                    if (d.data("subMenuOpen") == s.id) {
                        d.data("subMenuOpen", 0);
                        return
                    }
                    o = "<div class='nav_sub_menu_wrap nav_style" + j + " nav_style" + j + "_color" + n + "'>";
                    o += "<div id='sub_menu_" + s.id + "'  class='nav_sub_menu_wrap2'>";
                    o += "<div class='nav_sub_menu_content'>";
                    for (var z = 0; z < q.length; z++) {
                        t = l["nav" + q[z]];
                        if (t) {
                            o += "<a class='nav_sub_menu_item' href='" + t.jumpCtrl.href + "'>" + Mobi.encodeHtml(t.name) + "</a>"
                        }
                    }
                    o += "</div>";
                    o += "</div>";
                    o += "<div id='sub_menu_triangle" + s.id + "' class='nav_sub_menu_triangle'></div>";
                    o += "</div>";
                    jm(o).appendTo(jm("#fixedAreaBox"));
                    var E = jm(this),
                        A = jm("#sub_menu_" + s.id),
                        B = jm("#sub_menu_triangle" + s.id),
                        u = parseFloat(B.width()),
                        D = parseFloat(B.height()),
                        J = parseFloat(E.offset().left) - m.left,
                        C = parseFloat(E.width()),
                        y = parseFloat(A[0].offsetWidth),
                        G = d.height(),
                        x = G.indexOf("rem") > -1 ? parseFloat(G.replace("rem", 0) * _htmlFontSize) : parseFloat(G),
                        w = J + (C - y) / 2,
                        v = A[0].offsetWidth,
                        I = w + v,
                        H = jm("body")[0].offsetWidth;
                    w = w < 0 ? 0 : w;
                    w = I > H ? w - (I - H) : w;
                    if (j == 6 && jm(event.target).closest(".bigCircle").length > 0) {
                        var F = d.find(".bigCircle .mallNavBtnText");
                        x = parseFloat(F.css("border-right-width").replace("px", "")) * 2 + parseFloat(F.height())
                    }
                    A.css({
                        left: w + "px",
                        bottom: x + "px"
                    });
                    B.css({
                        left: J + (C - u) / 2 + "px",
                        bottom: (2 + x + D / 2) + "px"
                    });
                    d.data("subMenuOpen", s.id)
                })
        }
    })(e)
    }
    jm("body").off("click.subMenu").on("click.subMenu",
        function(o) {
            if (jm(o.target).closest("#fixedAreaBox").length < 1 && d.data("subMenuOpen") > 0) {
                Mobi.hideNavSubMenu()
            }
        })
};
Mobi.hideNavSubMenu = function() {
    var a = jm("#fixedAreaBox");
    jm(".nav_sub_menu_wrap").remove();
    a.data("subMenuOpen", 0)
};
Mobi.initOfficalNavSubMenu = function(j, k, s) {
    var d = [],
        p = [],
        u = "ontouchstart" in window,
        b = u ? "touchstart": "click",
        q = Fai.top._manageMode ? "children": "cil",
        e = jm("#navbar"),
        o = jm("#navbarList"),
        l = jm("#navButton"),
        r = document.body.offsetHeight,
        n = Mobi.checkSubMenuType(),
        h = Fai.top._templateLayoutId,
        m = jm.getCookie("navId"),
        f;
    Mobi.initOfficalSubMenu();
    for (var w in j) {
        nav = j[w];
        f = nav.children || nav.cil,
            p.push(nav.id);
        if (Fai.top._manageMode) {
            if (nav.children && nav.children.length > 0) {
                for (var t = 0; t < nav.children.length; t++) {
                    d.push(nav.children[t].id)
                }
            }
        } else {
            d = d.concat(nav.cil)
        }
    }
    for (var t = 0; t < d.length; t++) {
        index = jm.inArray(d[t], p);
        if (index >= 0) {
            p.splice(index, 1)
        }
    }
    for (var t = 0; t < p.length; t++) { (function(y) {
        var B = p[y];
        var A = j["nav" + p[y]];
        if (!A) {
            return
        }
        var z = [],
            x = jm("#navItem_" + p[y]);
        v(x, B);
        if (!s) {
            x.removeClass("nav_1_level");
            x.off(b + ".subMenu")
        }
        if (Fai.top._manageMode && !s) {
            if (A.children && A.children.length > 0) {
                for (var y = 0; y < A.children.length; y++) {
                    z.push(A.children[y].id)
                }
            }
        } else {
            z = z.concat(A.cil)
        }
        if (!z || z.length < 1) {
            return
        }
        x.addClass("nav_1_level");
        x.on(b + ".subMenu",
            function(K) {
                K.preventDefault();
                if (e.data("subMenuOpen") == A.id) {
                    Mobi.hideOfficalNavSubMenu();
                    return
                }
                var E = jm(this),
                    L = Fai.top._templateLayoutId,
                    P = Mobi.checkSubMenuType(),
                    J = P != "panel" && P != "panel2" ? "navItem": "",
                    O = false,
                    D,
                    I;
                I = "<div class='nav_offical_sub_menu_wrap nav_sub_layout_" + P + " subMenu_" + Fai.top._templateFrameId + "'>";
                if (P == "bubble" || P == "bubble_horizon") {
                    I += "<div class='icon- nav_sub_menu_triangle2'></div>"
                }
                I += "<div class='nav_offical_sub_menu_wrap2'>";
                if (P == "panel" || P == "panel2") {
                    I += "<div class='parent_menu sub_menu_nav_item_wrap'><a href='javascript:;'><span class='icon-parentMenu'></span><span class='navItemName'>" + A.name + "</span></a></div>"
                }
                for (var G = 0; G < z.length; G++) {
                    var C = z[G],
                        F = j["nav" + C];
                    if (!F) {
                        continue
                    }
                    if (!O) {
                        if ( !! m) {
                            if (m == C) {
                                D = C;
                                O = true
                            }
                        } else {
                            if (F.jumpCtrl && F.jumpCtrl.info && ((F.jumpCtrl.info.i == Fai.top._pageId) || (F.jumpCtrl.info.i == -5 && Fai.top._pageId == 6))) {
                                D = C
                            }
                        }
                    }
                    if (P != "bubble" || P != "dragDown") {
                        I += "<div id='itemSep_" + C + "' class='itemSep'></div>"
                    }
                    I += "<div id='navItem_" + C + "' class='sub_menu_nav_item_wrap navItem_" + C + " icon-navItem " + J + "'>";
                    I += "<a href='" + F.jumpCtrl.href + "' _colid='" + C + "' id='navbar_" + C + "'>";
                    if (P == "panel" || P == "panel2") {
                        I += "<span class='icon_subMenu'></span>"
                    } else {
                        if ((P == "fold" || P == "fold2") && k == 2) {
                            I += "<span class='navItemIcon icon-navItemIcon'></span>"
                        }
                    }
                    I += "<span class='navItemName '>" + Mobi.encodeHtml(F.name) + "</span>";
                    I += "</a>";
                    I += "</div>"
                }
                I += "</div>";
                I += "</div>";
                Mobi.hideOfficalNavSubMenu(true);
                E.addClass("subMenuOpen");
                o.addClass("jz_navbar_sub_menu_open");
                e.addClass("jz_navbar_sub_menu_open_1");
                if (P == "fold" || P == "fold2") {
                    var N = e.find(".itemSelected a").css("background-color");
                    Mobi.setCtrlStyleCssList("mobiStyleNav", "", [{
                        cls: ".subMenuOpen",
                        key: "background-color",
                        value: N
                    }])
                }
                if (P == "fold" || P == "fold2") {
                    jm(I).insertAfter(E)
                } else {
                    if (P == "panel") {
                        o.append(I)
                    } else {
                        if (P == "panel2") {
                            e.append(jm(I))
                        } else {
                            if (P == "bubble" || P == "bubble_horizon" || P == "dragDown") {
                                jm("#g_web").append(jm(I))
                            }
                        }
                    }
                }
                if (P == "bubble" || P == "dragDown") {
                    setTimeout(function() {
                            c(jm(".nav_offical_sub_menu_wrap"), x, P)
                        },
                        200)
                } else {
                    if (P == "bubble_horizon") {
                        a(jm(".nav_offical_sub_menu_wrap"), x)
                    }
                }
                e.data("subMenuOpen", A.id);
                if (P == "panel" || P == "panel2") {
                    jm(".parent_menu").on("click.nav",
                        function() {
                            Mobi.hideOfficalNavSubMenu()
                        })
                }
                var H = jm("#navItem_" + D);
                H.addClass("fk_subMenuSelected");
                H.find(".navItemName").addClass("g_mainColor");
                for (var G = 0; G < z.length; G++) {
                    var C = z[G],
                        M = jm("#navItem_" + C);
                    v(M, C)
                }
            })
    })(t)
    }
    if (e.find(".nav_1_level").length > 0) {
        e.addClass("jz_subMenu_bar")
    }
    jm("body").off(b + ".subMenu2").on(b + ".subMenu2",
        function(x) {
            if (jm(x.target).closest("#navbar").length < 1 && e.data("subMenuOpen") > 0) {
                setTimeout(function() {
                        Mobi.hideOfficalNavSubMenu()
                    },
                    200)
            }
        });
    if (n == "bubble_horizon") {
        e.off("scroll.subMenu").on("scroll.subMenu",
            function() {
                if (e.find(".subMenuOpen").length > 0) {
                    Mobi.hideOfficalNavSubMenu()
                }
            })
    }
    l.on(b + ".subMenu",
        function() {
            Mobi.hideOfficalNavSubMenu()
        });
    jm("#navExistOffPanel").off(b + ".subMenu").on(b + ".subMenu",
        function() {
            Mobi.hideOfficalNavSubMenu()
        });
    if (h == 8 || h == 6 || h == 1 || h == 0) {
        Mobi.showNavItemContainer()
    }
    function c(D, F, M) {
        if (D.length < 1 || F.length < 1) {
            return
        }
        var J = jm("#g_web").offset(),
            N = F.offset(),
            E = J.width,
            A = D[0].offsetWidth,
            H = M == "dragDown" ? 0 : 0,
            B = N.left + (N.width - A) / 2 - H,
            L = B + A,
            G = L - J.left,
            y = L - J.left,
            K = jm("body")[0].offsetWidth,
            I = B - J.left < 0,
            z = y > J.width,
            x,
            C;
        if (I || z) {
            x = I ? (B - J.left) : (y - E)
        }
        B = I ? (J.left + (0.5 * _htmlFontSize)) : B;
        B = z ? B - (y - E) : B;
        D.css({
            top: N.bottom + "px",
            left: B + "px"
        });
        if (x) {
            C = (A / 2) + x;
            jm(".nav_sub_menu_triangle2").css("left", C + "px")
        }
    }
    function a(F, H) {
        if (F.length < 1 || H.length < 1) {
            return
        }
        var A = document.documentElement.scrollTop || document.body.scrollTop,
            z = A + r,
            y = A;
        var K = jm("#navbar").offset(),
            L = H.offset(),
            D = F.offset(),
            B = F[0].offsetWidth,
            J = L.top - (D.height - L.height) / 2,
            C = K.left - B + 1,
            I = J <= y,
            G = (J + D.height) >= z,
            x,
            E;
        if (I) {
            J = _htmlFontSize + A;
            x = -(J + _htmlFontSize)
        } else {
            if (G) {
                x = (J + D.height) - z + _htmlFontSize * 0.5;
                J -= x
            }
        }
        F.css({
            top: J - A + "px",
            left: C + "px"
        });
        if (x) {
            E = L.top - A;
            jm(".nav_sub_menu_triangle2").css("top", E + "px")
        }
    }
    function v(x, A) {
        var y = "ontouchstart" in window,
            z = y ? "touchstart": "click";
        x.find("#navbar_" + A).off(z + ".navHref").on(z + ".navHref",
            function() {
                var B = jm(this).attr("href");
                if (B && jm.trim(B) == "javascript:;") {
                    return
                }
                event.stopPropagation();
                jm.setCookie("navId", A);
                window.location.href = B;
                return false
            })
    }
};
Mobi.checkSubMenuType = function() {
    var d = "fold",
        a = Fai.top._templateLayoutId,
        c = [1022, 1006],
        e = [1016, 1008],
        b = [1005, 1019],
        f = [1010, 1020, 326];
    switch (a) {
        case 2:
            d = "fold";
            break;
        case 0:
        case 3:
        case 6:
            d = "bubble";
            break;
        case 4:
            d = "panel";
            break;
        case 1:
            d = "panel2";
            break;
        case 7:
            d = "fold2";
            break;
        case 8:
            d = "dragDown";
            break
    }
    if (c.indexOf(Fai.top._templateFrameId) > -1) {
        d = "panel"
    } else {
        if (e.indexOf(Fai.top._templateFrameId) > -1) {
            d = "bubble_horizon"
        } else {
            if (b.indexOf(Fai.top._templateFrameId) > -1) {
                d = "dragDown"
            } else {
                if (f.indexOf(Fai.top._templateFrameId) > -1) {
                    d = "fold2"
                }
            }
        }
    }
    return d
};
Mobi.initOfficalSubMenu = function(b) {
    var a = Mobi.checkSubMenuType(),
        c = jm("#navbar");
    Mobi.hideOfficalNavSubMenu(true);
    c.removeClass("jz_subMenu_fold jz_subMenu_fold2 jz_subMenu_bubble jz_subMenu_bubble_horizon jz_subMenu_panel jz_subMenu_panel2 jz_subMenu_dragDown jz_subMenu_" + b).addClass("jz_subMenu_" + a + " jz_subMenu_" + Fai.top._templateFrameId)
};
Mobi.hideOfficalNavSubMenu = function(b) {
    var d = jm("#navbar"),
        c = Mobi.checkSubMenuType(),
        a = Fai.top._templateLayoutId;
    if (c == "fold" || c == "fold2") {
        Mobi.removeCtrlStyleCssList("mobiStyleNav", "", [{
            cls: ".subMenuOpen",
            keu: "background-color"
        }])
    }
    d.removeClass("jz_navbar_sub_menu_open_1");
    d.find(".subMenuOpen").removeClass("subMenuOpen");
    d.find(".jz_navbar_sub_menu_open").removeClass("jz_navbar_sub_menu_open");
    d.data("subMenuOpen", 0);
    if (a == 4 && !b) {
        jm(".nav_offical_sub_menu_wrap").css({
            left: "100%",
            width: "0",
            height: "0"
        })
    } else {
        if (c == "panel2" && !b) {
            jm(".nav_offical_sub_menu_wrap").css({
                top: "100%"
            })
        } else {
            jm(".nav_offical_sub_menu_wrap").remove()
        }
    }
};
Mobi.getStyle = function(a, b) {
    var c = "";
    if (document.defaultView && document.defaultView.getComputedStyle) {
        c = document.defaultView.getComputedStyle(a, "").getPropertyValue(b)
    } else {
        if (a.currentStyle) {
            b = b.replace(/\-(\w)/g,
                function(d, e) {
                    return e.toUpperCase()
                });
            c = a.currentStyle[b]
        }
    }
    return c
};
Mobi.getFrameHeight = function(d) {
    var c = parseInt(Mobi.getStyle(d, "padding-top").replace("px", "")) + parseInt(Mobi.getStyle(d, "padding-bottom").replace("px", ""));
    var b = parseInt(Mobi.getStyle(d, "margin-top").replace("px", "")) + parseInt(Mobi.getStyle(d, "margin-bottom").replace("px", ""));
    var a = parseInt(Mobi.getStyle(d, "border-top-width").replace("px", "")) + parseInt(Mobi.getStyle(d, "border-bottom-width").replace("px", ""));
    return a + b + c
};
Mobi.setModuleHeight2 = function(a, p, e) {
    var b = Mobi.getPreviewObject("module" + a),
        n = 1;
    if (!b) {
        return
    }
    var l = e || _htmlFontSize;
    var c = _htmlFontSize;
    var d = c / l;
    p *= d;
    p = parseInt(p);
    b.style.height = p / _htmlFontSize + "rem";
    var h = b.querySelector(".formBannerTitle" + a);
    var k = b.querySelector(".formMiddle");
    var m = 0;
    if (getComputedStyle(h).display != "none") {
        if (jm(b).hasClass("formStyle2")) {
            m = 2 * _htmlFontSize
        } else {
            m = h.offsetHeight
        }
    }
    var j = p - m - Mobi.getFrameHeight(k);
    k.style.height = j / _htmlFontSize + "rem";
    var o = k.querySelector(".middleCenter");
    j = j - Mobi.getFrameHeight(o);
    var f = k.querySelector(".formMiddleContent");
    j = j - Mobi.getFrameHeight(f);
    f.style.height = j / _htmlFontSize + "rem";
    f.style.overflow = "hidden";
    if (jm(b).hasClass("formStyle51")) {
        k.querySelector(".J_packContentList").style.height = j / _htmlFontSize + "rem"
    }
};
Mobi.setModuleBannerHeight2 = function(d, a) {
    if (d === 0) {
        return
    }
    var c = Mobi.getPreviewObject("module" + d);
    var b = c.querySelector(".formBannerTitle");
    b && (b.style.height = a / _htmlFontSize + "rem")
};
Mobi.scrollToModule = function(d) {
    var b = jm("#module" + d),
        c = Mobi.getPreviewObject("webHeaderBox"),
        a = 0;
    if (typeof b == "undefined" || b.length < 1) {
        return
    }
    if (jm(c).css("position") == "fixed") {
        a = parseInt(jm(c).height())
    }
    scrollElem = document.documentElement.scrollTop ? document.documentElement: document.body;
    scrollElem.scrollTop = b.offset().top - a
};
Mobi.msgBoardShowMsg = function(a) {
    jm(".notice").show();
    jm(".notice").html(a)
};
Mobi.msgBoardAddMsg = function(p, n, b) {
    var a = jm("#reqName").val();
    var j = jm("#reqPhone").val();
    var k = jm("#reqEmail").val();
    var h = jm("#reqContent").val();
    var o = jm("#msgBoardCaptcha").val();
    var c = jm(".notice").show();
    var l = jm(".J_msgBoardCaptcha");
    var f = 0;
    jm("input.msg_isMust").each(function() {
        var r = jm(this).attr("id");
        var s = jm(this).attr("placeholder");
        var q = jm(this).val();
        if (q == "" || q == null) {
            c.html(jm.format(LS.msgBoardInputIsEmpty, jm.encodeHtml(s)));
            Mobi.getPreviewObject(r).focus();
            f = 1;
            return false
        }
        if (r == "reqPhone" && !jm.isPhone(q)) {
            c.html(jm.format(LS.msgBoardInputCorrect, jm.encodeHtml(s)));
            Mobi.getPreviewObject(r).focus();
            f = 1;
            return false
        }
        if (r == "reqEmail" && !jm.isEmail(q)) {
            c.html(jm.format(LS.msgBoardInputCorrect, jm.encodeHtml(s)));
            Mobi.getPreviewObject(r).focus();
            f = 1;
            return false
        }
    });
    if (f == 1) {
        return false
    }
    var e = 0;
    jm("input.msg_ipt").each(function() {
        var r = jm(this).attr("id");
        var t = jm(this).attr("placeholder");
        var q = jm(this).val();
        var s = jm(this).attr("maxlength");
        if (q.length > s) {
            c.html(jm.format(LS.msgBoardInputMaxLength, jm.encodeHtml(t), s));
            e = 1;
            return false
        }
        if (r == "reqPhone" && q.length && !jm.isPhone(q)) {
            c.html(jm.format(LS.msgBoardInputCorrect, jm.encodeHtml(t)));
            Mobi.getPreviewObject(r).focus();
            e = 1;
            return false
        }
        if (r == "reqEmail" && q.length && !jm.isEmail(q)) {
            c.html(jm.format(LS.msgBoardInputCorrect, jm.encodeHtml(t)));
            Mobi.getPreviewObject(r).focus();
            e = 1;
            return false
        }
    });
    if (e == 1) {
        return false
    }
    if (h == null || h == "") {
        Mobi.msgBoardShowMsg(LS.msgBoardInputContent);
        Mobi.getPreviewObject("reqContent").focus();
        return
    }
    var d = 10000;
    if (h.length > d) {
        Mobi.msgBoardShowMsg(jm.format(LS.msgBoardInputContent2, d));
        Mobi.getPreviewObject("reqContent").focus();
        return
    }
    if (!l.hasClass("msgBoardCaptchaHide")) {
        if (o == null || o == "") {
            Mobi.msgBoardShowMsg(LS.msgBoardInputValidateCode);
            Mobi.getPreviewObject("msgBoardCaptcha").focus();
            return
        }
    }
    Mobi.msgBoardShowMsg(LS.msgBoardDoing);
    var m = {};
    jm("input.msg_ipt").each(function() {
        var r = jm(this).attr("id");
        var q = jm(this).val();
        m[r] = q.trim()
    });
    m.reqContent = h;
    m.memberId = (n === undefined) ? 0 : n;
    // jm.ajax({
    //     type: "post",
    //     url: "ajax/msgBoard_h.jsp",
    //     data: "cmd=add&msgBdData=" + jm.encodeUrl(jm.toJSON(m)) + "&validateCode=" + jm.encodeUrl(o) + "&moduleId=" + jm.encodeUrl(b),
    //     error: function() {
    //         Mobi.msgBoardShowMsg(LS.systemError)
    //     },
    //     success: function(q) {
    //         q = jm.parseJSON(q);
    //         if (q.success) {
    //             if (p) {
    //                 Mobi.ing(LS.msgBoardSendOkAutoOpen, 1)
    //             } else {
    //                 Mobi.ing(LS.msgBoardSendOk, 1)
    //             }
    //             setTimeout(function() {
    //                     Fai.top.location.reload()
    //                 },
    //                 1500)
    //         } else {
    //             if (q.errno == 1) {
    //                 Mobi.msgBoardShowMsg(LS.captchaError)
    //             } else {
    //                 if (q.errno == 2) {
    //                     Mobi.msgBoardShowMsg(LS.argsError)
    //                 } else {
    //                     if (q.errno == -4) {
    //                         Mobi.msgBoardShowMsg(LS.msgBoardAddCountLimit)
    //                     } else {
    //                         Mobi.msgBoardShowMsg(LS.systemError)
    //                     }
    //                 }
    //             }
    //             if (q.needCode) {
    //                 Mobi.msgBoardShowMsg(q.msg);
    //                 l.removeClass("msgBoardCaptchaHide")
    //             }
    //             if (q.hasFW) {
    //                 Mobi.ing(q.msg);
    //                 jm(".notice").hide()
    //             }
    //         }
    //         Mobi.changeValidateCode(jm("#msgBoardCaptchaImg"))
    //     }
    // })
};
Mobi.noticeLeftRightMarquee = function(e, A) {
    var z = {
        direction: "up",
        speed: "normal",
        loop: "infinite",
        moveout: false,
        isScrolling: false
    };
    jm.extend(z, e);
    if (z.speed == "normal") {
        jm.extend(z, {
            speed: 70
        })
    } else {
        if (z.speed == "slow") {
            jm.extend(z, {
                speed: 40
            })
        } else {
            jm.extend(z, {
                speed: 100
            })
        }
    }
    jm("#noticeMarquee" + z.id).data("options", e);
    var n = z.id,
        w = Mobi.getPreviewObject("noticeMarquee" + n),
        h = w.offsetHeight,
        f = w.offsetWidth,
        q = 0,
        a = w.querySelectorAll(".noticeMarqueeRow>span");
    for (var s = 0; s < a.length; s++) {
        q += a[s].offsetWidth
    }
    var c = Mobi.getPreviewObject("noticeContainer" + n),
        d = c.offsetWidth,
        m = (q > d) ? q: d;
    var E = z.direction,
        D = 0,
        l = "left",
        t = z.speed,
        C = (z.loop != "infinite" || z.loop <= 0) ? 1 : z.loop,
        o = false,
        F = z.isScrolling,
        y = z.noticeType,
        B = 20,
        v = Mobi.createElementByHtml("<div id='noticeMarqueeCopy" + n + "' class='noticeMarquee' style='overflow:hidden;width:" + m + "px;' ></div>");
    var k = "<div id='noticeMarqueeNewParent" + n + "' style='position:relative;overflow:hidden;width:" + (m + d) + "px;'></div>";
    var j = Mobi.createElementByHtml("<div style='-webkit-text-size-adjust:none;position: relative;width: 100%;height:1.5rem;line-height:1.5rem;overflow: hidden;" + (y == 4 ? "": "left: 23px;") + "'></div>");
    var p = Mobi.createElementByHtml(k);
    w.style.width = m + "px";
    function r() {
        c.appendChild(j);
        j.appendChild(p);
        p.appendChild(w);
        p.appendChild(v);
        if (!F) {
            v.style.height = 20 + "px";
            v.style.width = d + "px"
        } else {
            v.appendChild(w.querySelector(".noticeMarqueeDiv").cloneNode(true))
        }
        if (E == "left") {
            D = h
        } else {
            D = 0 - m;
            if (F && !o || !F && !o) {
                D = 0
            }
            if (F && o) {
                D = -m
            }
        }
        if (o) {
            w.style.left = 0 + "px"
        } else {
            w.style.left = D + "px"
        }
        if (E == "left" || E == "right") {
            w.style.top = 0 + "px"
        }
        b(E)
    }
    function b(G) {
        if (G == "left" || G == "right") {
            p.style.position = "relative";
            v.style.top = 0 + "px";
            if (G == "left") {
                if (F && !o) {
                    p.style.width = m * 2 + "px";
                    w.style.left = 0 + "px";
                    v.style.left = m + "px"
                }
                if (F && o) {}
                if (!F && !o) {
                    w.style.left = f + "px";
                    v.style.left = m + d + "px"
                }
                if (!F && o) {}
            } else {
                w.style.width = m + "px";
                if (F && !o) {
                    p.style.width = m * 2 + "px";
                    w.style.paddingLeft = m + "px";
                    p.style.left = -(m * 2 - d + 23) + "px"
                }
                if (F && o) {
                    p.style.width = m * 2 + "px";
                    w.style.paddingLeft = m + "px";
                    p.style.left = -(m * 2 - d + 23) + "px"
                }
                if (!F && !o) {
                    v.style.left = m + "px";
                    p.style.left = -m + "px"
                }
                if (!F && o) {
                    p.style.left = -(m + 23) + "px";
                    w.style.left = d + "px";
                    v.style.left = 0 + "px"
                }
            }
        }
    }
    function x(H, J, K, I) {
        var G;
        if (J == "left") {
            G = K ? "mobi_notice_right_to_left_50": "mobi_notice_right_to_left"
        } else {
            if (J == "right") {
                G = K ? "mobi_notice_left_to_right_50": "mobi_notice_left_to_right"
            }
        }
        return "-webkit-animation: " + G + " " + H / I + "s linear 1s infinite;-moz-animation:    " + G + " " + H / I + "s linear 1s infinite;-o-animation:      " + G + " " + H / I + "s linear 1s infinite;animation:         " + G + " " + H / I + "s linear 1s infinite;"
    }
    function u() {
        if (E == "left") {
            var G = p.scrollLeft;
            G++;
            if (F && !o) {
                p.setAttribute("style", p.getAttribute("style") + x(m + d, E, F, t))
            }
            if (F && o) {}
            if (!F && !o) {
                p.setAttribute("style", p.getAttribute("style") + x(m + d, E, F, t))
            }
            if (!F && o) {
                p.className += " mobi_notice_right_to_left";
                setTimeout(function() {
                        p.style.left = d + "px"
                    },
                    15000)
            }
        } else {
            if (E == "right") {
                var G = p.scrollLeft;
                G--;
                if (F && !o) {
                    p.setAttribute("style", p.getAttribute("style") + x(m + d, E, F, t))
                }
                if (F && o) {
                    p.className += " mobi_notice_left_to_right_50_" + t
                }
                if (!F && !o) {
                    p.setAttribute("style", p.getAttribute("style") + x(m + d, E, F, t))
                }
                if (!F && o) {
                    p.className += " mobi_notice_left_to_right_" + t;
                    setTimeout(function() {
                            p.style.left = -(d + m + 23) + "px"
                        },
                        15000)
                }
            }
        }
    }
    if (e != null) {
        r();
        u()
    }
};
Mobi.saveNoticeMarqueeProps = function(a) {
    if (a != null) {
        jm("#noticeMarquee" + a.id).data("options", a)
    }
    jm("#module" + a.id).on("Fai_onModuleSizeChange",
        function() {
            Mobi.noticeMarquee(jm("#noticeMarquee" + a.id).data("options"), a.id)
        });
    jm("#module" + a.id).on("Fai_onModulePositionChange",
        function() {
            Mobi.noticeMarquee(jm("#noticeMarquee" + a.id).data("options"), a.id)
        })
};
Mobi.noticeMarqueeUpDown1 = function(c) {
    var b = {
        direction: "top",
        speed: "normal",
        stopTime: 1000
    };
    jm.extend(b, c);
    if ("fast" === b.speed) {
        jm.extend(b, {
            speed: 500
        })
    } else {
        if ("slow" === b.speed) {
            jm.extend(b, {
                speed: 1100
            })
        } else {
            jm.extend(b, {
                speed: 850
            })
        }
    }
    var h = jm("#noticeScrollbar" + b.id + " li");
    if (h.length == 1) {
        var f = jm(h.get(0));
        var a = "<li class='scrollbarLi'>" + f.html() + "</li>";
        jm(a).insertAfter(f)
    }
    jm("#noticeScrollbar" + b.id).marquee({
        yScroll: b.direction,
        showSpeed: b.speed,
        pauseSpeed: b.stopTime,
        hoverChange: false
    });
    var e = jm("#module" + b.id + " .formMiddleContent");
    e.css("overflow", "hidden");
    e.css("width", "98%");
    var d = jm("#module" + b.id + " .formMiddleCenter");
    d.css("overflow", "hidden")
};
Mobi.revertIcon = function(d) {
    var c = jm("#module" + d);
    var b = false;
    var a = c.find(".noticeContainer").height();
    if (c.find(".noticeFontIcon").length != 0) {
        b = true
    }
    if (b) {
        c.find(".noticeFontIcon").css("font-size", 21 + "px").css("line-height", a + "px")
    } else {
        c.find(".noticeImg").css("width", 21 + "px").css("height", 21 + "px").css("margin-top", (a - 21) / 2 / 20.5 + "rem")
    }
};
Mobi.noticeMarqueeUpDown = function(c) {
    var w = {
        direction: "top",
        speed: "normal",
        stopTime: 1000
    };
    jm.extend(w, c);
    if ("fast" === w.speed) {
        jm.extend(w, {
            speed: 500
        })
    } else {
        if ("slow" === w.speed) {
            jm.extend(w, {
                speed: 1100
            })
        } else {
            jm.extend(w, {
                speed: 850
            })
        }
    }
    var e = Mobi.getPreviewObject("noticeScrollbar" + w.id);
    if (e.length < 1) {
        return
    }
    var s = e.style,
        h = jm(e),
        v = e.querySelectorAll("li"),
        a = v.length,
        u = "";
    if (a == 1) {
        var m = "";
        if (a == 1) {
            m = "<li class='scrollbarLi'>" + v[0].innerHTML + "</li><li class='scrollbarLi'>" + v[0].innerHTML + "</li>"
        } else {
            for (var q in v) {
                m += "<li class='scrollbarLi'>" + v[q].innerHTML + "</li>"
            }
        }
        h.append(jm(m))
    } else {
        if (w.direction == "top") {
            u = "<li class='scrollbarLi'>" + v[a - 1].innerHTML + "</li>";
            e.insertBefore(jm(u)[0], e.getElementsByClassName("scrollbarLi")[0])
        } else {
            u = "<li class='scrollbarLi'>" + v[0].innerHTML + "</li>";
            h.append(u)
        }
    }
    v = e.querySelectorAll("li");
    s[jm.feat.cssPrefix + "TransitionProperty"] = "top";
    s[jm.feat.cssPrefix + "TransitionTimingFunction"] = "ease";
    e.parentNode.style.height = v[0].offsetHeight + "px";
    var o = [];
    for (var t = 0; t < v.length; t++) {
        o[t] = v[t].offsetTop
    }
    if (w.direction == "top") {
        o.reverse()
    }
    e.style.top = -o[0] + "px";
    Mobi.noticeMarqueetimeIds = Mobi.noticeMarqueetimeIds || {};
    var p = Mobi.noticeMarqueetimeIds["scroll" + w.id];
    if (p >= 0) {
        clearTimeout(p)
    }
    var r = o.length - 1,
        d = o.length,
        b = w.speed + "ms",
        f = 0,
        l = jm.feat.cssPrefix + "TransitionDuration";
    if (v.length > 1) {
        n()
    }
    function n() {
        if (r < d) {
            if (r) {
                s[l] = b;
                f = w.stopTime + w.speed
            } else {
                s[l] = "0ms";
                f = 25
            }
            s.top = -o[r] + "px";
            r++
        } else {
            r = 0;
            f = 0
        }
        Mobi.getPreviewWindow().Mobi.noticeMarqueetimeIds["scroll" + w.id] = setTimeout(n, f)
    }
};
Mobi.noticeUpDownSizeChange = function(d) {
    var b = jm("#noticeMarquee" + d),
        a = b.height(),
        c = b.children().children();
    jm.each(c,
        function(e, f) {
            jm(f).css("top", -(a + 2) + "px")
        });
    jm("#noticeScrollbar" + d).removeData("_innerHeight")
};
Mobi.siteFormAdd = function(a, s, q, h, e) {
    var k = [];
    var r = q;
    var c = true;
    var n = 100;
    var f = 1000;
    var p = h;
    var o = jm("#M" + a + "F" + s + "siteFormValidateCode");
    var l = o.val();
    var m = [];
    var d = jm("#M" + a + "F" + s + "siteFormAddButton");
    if (r.length > 0) {
        jm.each(r,
            function(I, G) {
                if (G.hide) {
                    return true
                }
                var D = G.id;
                var O = G.name;
                var E = G.must;
                var x = G.type;
                var K = {};
                K.id = D;
                K.type = x;
                if (x == 0) {
                    var M = jm("#M" + a + "F" + s + "siteFormInput" + D).val();
                    if (E && M == "") {
                        Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(O)));
                        c = false;
                        return false
                    }
                    if (M.length > n) {
                        Mobi.ing(jm.format(LS.siteFormSubmitInputMaxLength, jm.encodeHtml(O), n));
                        c = false;
                        return false
                    }
                    K.val = M
                } else {
                    if (x == 1) {
                        var t = jm("#M" + a + "F" + s + "siteFormTextArea" + D).val();
                        if (E && t == "") {
                            Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(O)));
                            c = false;
                            return false
                        }
                        if (t.length > f) {
                            Mobi.ing(jm.format(LS.siteFormSubmitInputMaxLength, jm.encodeHtml(O), f));
                            c = false;
                            return false
                        }
                        K.val = t
                    } else {
                        if (x == 2) {
                            var z = document.querySelectorAll("input[name='M" + a + "F" + s + "siteFormRadioR" + D + "']:checked");
                            if (E && z.length == 0) {
                                Mobi.ing(jm.format(LS.siteFormSubmitCheckIsEmpty, jm.encodeHtml(O)));
                                c = false;
                                return false
                            }
                            if (z.length > 0) {
                                K.val = z[0].value
                            } else {
                                K.val = ""
                            }
                        } else {
                            if (x == 3) {
                                var A = document.querySelectorAll("input[name='M" + a + "F" + s + "siteFormCheckboxR" + D + "']:checked");
                                if (E && A.length == 0) {
                                    Mobi.ing(jm.format(LS.siteFormSubmitCheckIsEmpty, jm.encodeHtml(O)));
                                    c = false;
                                    return false
                                }
                                var H = [];
                                for (var I = 0; I < A.length; I++) {
                                    H.push(A[I].value)
                                }
                                K.val = H.join("\n")
                            } else {
                                if (x == 4) {
                                    var C = document.getElementById("M" + a + "F" + s + "siteFormSelect" + D),
                                        F = C.options[C.selectedIndex].value;
                                    if (E && (F.length == 0 || F == "none")) {
                                        Mobi.ing(jm.format(LS.siteFormSubmitCheckIsEmpty, jm.encodeHtml(O)));
                                        c = false;
                                        return false
                                    }
                                    K.val = F
                                } else {
                                    if (x == 5) {
                                        return true
                                    } else {
                                        if (x == 6) {
                                            var M = jm("#Mobi" + a + "Calendar" + D + "Pluginsinput").val(),
                                                y = G.dateSetting ? G.dateSetting.type: 0,
                                                B = y == 1 ? jm("#Mobi" + a + "Calendar" + D + "Plugins_endinput").val() : "";
                                            if (E && (M == "" || (y == 1 && B == ""))) {
                                                Mobi.ing(jm.format(LS.siteFormSubmitCheckIsEmpty, jm.encodeHtml(O)));
                                                c = false;
                                                return false
                                            }
                                            M = y == 1 ? (M + " 至 " + B) : M;
                                            K.val = M
                                        } else {
                                            if (x == 7) {
                                                var u = jm("#module" + a).find("#siteForm" + a + "fileName" + D);
                                                var L = {};
                                                if (E && u.attr("_tmpFileId") == "") {
                                                    Mobi.ing("请选择文件上传");
                                                    c = false;
                                                    return false
                                                }
                                                if (u.attr("_tmpFileId") == "") {
                                                    K.val = ""
                                                } else {
                                                    K.val = u.attr("_fileId");
                                                    L.tmpFileName = u.attr("_tmpFileName");
                                                    L.fileId = K.val;
                                                    L.tmpFileId = u.attr("_tmpFileId");
                                                    m.push(L)
                                                }
                                            } else {
                                                if (x == 8) {
                                                    var N = jm("#M" + a + "F" + s + "siteFormPhoneInput" + D).val();
                                                    if (E) {
                                                        if (N == "") {
                                                            Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(O)));
                                                            c = false;
                                                            return false
                                                        } else {
                                                            if (!jm.isNationMobile(N)) {
                                                                Mobi.ing(LS.mobileNumRegular);
                                                                c = false;
                                                                return false
                                                            }
                                                        }
                                                    } else {
                                                        if (N != "") {
                                                            if (!jm.isNationMobile(N)) {
                                                                Mobi.ing(LS.mobileNumRegular);
                                                                c = false;
                                                                return false
                                                            }
                                                        }
                                                    }
                                                    K.val = N
                                                } else {
                                                    if (x == 9) {
                                                        var J = jm("#M" + a + "F" + s + "siteFormMailInput" + D).val();
                                                        if (E) {
                                                            if (J == "") {
                                                                Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(O)));
                                                                c = false;
                                                                return false
                                                            } else {
                                                                if (!jm.isEmail(J)) {
                                                                    Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, jm.encodeHtml(O)));
                                                                    c = false;
                                                                    return false
                                                                }
                                                            }
                                                        } else {
                                                            if (J != "") {
                                                                if (!jm.isEmail(J)) {
                                                                    Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, jm.encodeHtml(O)));
                                                                    c = false;
                                                                    return false
                                                                }
                                                            }
                                                        }
                                                        K.val = J
                                                    } else {
                                                        if (x == 10) {
                                                            var w = jm("#M" + a + "F" + s + "siteFormIndentityInput" + D).val();
                                                            if (E) {
                                                                if (w == "") {
                                                                    Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(O)));
                                                                    c = false;
                                                                    return false
                                                                } else {
                                                                    if (!jm.isCardNo(w)) {
                                                                        Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, jm.encodeHtml(O)));
                                                                        c = false;
                                                                        return false
                                                                    }
                                                                }
                                                            } else {
                                                                if (w != "") {
                                                                    if (!jm.isCardNo(w)) {
                                                                        Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, jm.encodeHtml(O)));
                                                                        c = false;
                                                                        return false
                                                                    }
                                                                }
                                                            }
                                                            K.val = w
                                                        } else {
                                                            if (x == 11) {
                                                                var v = jm("#M" + a + "F" + s + "siteFormAddressInput" + D).val();
                                                                if (E && v == "") {
                                                                    Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(O)));
                                                                    c = false;
                                                                    return false
                                                                }
                                                                K.val = v
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                k.push(K)
            })
    }
    if (!c) {
        return false
    }
    if (p && l == "") {
        Mobi.ing(jm.format(o.attr("msg")));
        c = false;
        return false
    }
    if (d.find("input")[0].value == "提交中...") {
        return
    }
    d.css("opacity", "0.5");
    d.find("input")[0].value = "提交中...";
    d.attr("disabled", true);
    var j = "&submitContentList=" + jm.encodeUrl(jm.toJSON(k));
    Mobi.ing(LS.siteFormSubmitIng, -1);
    var b = Fai.top._colInfo.id;
    jm.ajax({
        type: "post",
        url: "ajax/mobiForm_h.jsp",
        data: "cmd=addSubmit&formId=" + s + "&submitContentList=" + jm.encodeUrl(jm.toJSON(k)) + "&vCodeId=" + a + s + "&validateCode=" + l + "&tmpFileList=" + jm.encodeUrl(jm.toJSON(m)) + "&id=" + a + "&colId=" + b,
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(t) {
            t = jm.parseJSON(t);
            console.log(t);
            if (t.success) {
                Mobi.ing(LS.siteFormSubmitOk, 1);
                Mobi.resertForm(t.formHtml.id, t.formHtml.div);
                setTimeout(function() {
                        if (!e) {
                            e = "index.jsp"
                        }
                        location.href = e
                    },
                    2500)
            } else {
                if (t.hasFW) {
                    Mobi.ing(t.msg);
                    return
                }
                if (t.rt == -4) {
                    Mobi.ing(LS.siteFormSubmitCountLimit)
                } else {
                    if (t.rt == -20) {
                        Mobi.ing(t.msg)
                    } else {
                        if (t.rt == -28) {
                            Mobi.ing(LS.hasSubmitThisSiteForm)
                        } else {
                            if (t.rt == -401) {
                                Mobi.ing(LS.siteFormSubmitValidateCodeErr);
                                jm("#M" + a + "F" + s + "siteFormValidateCode").val("");
                                Mobi.siteFormValidation(s, a)
                            } else {
                                Mobi.ing(LS.systemError)
                            }
                        }
                    }
                }
                if (t.needCode) {
                    Mobi.ing(t.msg);
                    jm("#module" + a + " .J_formValidation").removeClass("siteFormValidationHide")
                }
                d.css("opacity", "1");
                d.find("input")[0].value = "提交";
                d.attr("disabled", false)
            }
        }
    })
};
Mobi.siteFormNotLogin = function(d, c) {
    var b = jm.encodeUrl(Fai.top.location.href);
    var a = LS.siteFormSubmitNotLogin + LS.login + LS.period;
    Mobi.ing(a)
};
Mobi.siteFormValidation = function(b, a) {
    jm("#M" + a + "F" + b + "validateCodeImg").attr("src", "validateCode.jsp?" + parseInt(Math.random() * 1000) + "&vCodeId=" + a + b)
};
Mobi.siteFormFileUpload = function(c, f, o, k, d, a, b, j) {
    var n = jm(".uploadify-button").height();
    var l = jm(".uploadify-button").width();
    var m = jm(".uploadify-button").css("font-size");
    var p = {
        file_post_name: "Filedata",
        upload_url: "/ajax/upsiteimg_h.jsp",
        button_placeholder_id: "siteForm" + d + "fileUpload" + o,
        file_size_limit: f + "MB",
        button_image_type: 5,
        button_height: n,
        button_width: l,
        button_text: "<span class='fk_m_btText'>" + j + "</span>",
        button_text_style: ".fk_m_btText{text-align:center;font-family: 微软雅黑; color: #666666;font-size:" + m + "}",
        button_text_top_padding: 10,
        file_queue_limit: 1,
        requeue_on_error: false,
        post_params: {
            ctrl: "Filedata",
            app: 21,
            type: 0,
            isSiteForm: true
        },
        file_types: a.join(""),
        file_dialog_complete_handler: function(q) {
            this._allSuccess = false;
            this.startUpload()
        },
        file_queue_error_handler: function(r, q, s) {
            switch (q) {
                case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:
                    Mobi.ing(LS.siteFormSubmitCheckFileSizeErr, true);
                    break;
                case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:
                    Mobi.ing("不允许的文件类型", true);
                    break;
                case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:
                    Mobi.ing("一次只能上传一个文件", true);
                    break;
                default:
                    Mobi.ing("请重新选择文件上传。", true);
                    break
            }
        },
        upload_success_handler: function(r, q) {
            var s = jQuery.parseJSON(q);
            this._allSuccess = s.success;
            this._sysResult = s.msg;
            if (s.success) {
                setTimeout(function() {
                        Mobi.ing("文件上传成功", true)
                    },
                    2000);
                Mobi.onFileUploadEvent("upload", s, d, o)
            } else {
                Mobi.ing("文件" + r.name + "，" + s.msg)
            }
        },
        upload_error_handler: function(r, q, s) {
            if (q == -280) {
                Mobi.ing("文件取消成功", false)
            } else {
                if (q == -270) {
                    Mobi.ing("已经存在名称为" + r.name + "的文件。", true)
                } else {
                    Mobi.ing("服务繁忙，文件" + r.name + "上传失败，请稍候重试。")
                }
            }
        },
        upload_complete_handler: function(q) {
            if (q.filestatus == SWFUpload.FILE_STATUS.COMPLETE) {
                setTimeout(function() {
                        swfObj.startUpload()
                    },
                    swfObj.upload_delay)
            } else {
                if (q.filestatus == SWFUpload.FILE_STATUS.ERROR) {
                    Mobi.ing("服务繁忙，文件" + q.name + "上传失败，请稍候重试。")
                }
            }
        },
        upload_start_handler: function(q) {
            Mobi.ing("读取文件准备上传", false)
        },
        view_progress: function(q, t, s, r) {
            var r = Math.ceil((t / s) * 100);
            if (r == 100) {
                Mobi.ing("正在上传" + r + "%", true)
            } else {
                Mobi.ing("正在上传" + r + "%", false)
            }
        }
    };
    var e = document.createElement("script");
    e.type = "text/javascript";
    e.src = c;
    e.onload = function() {
        var q = document.createElement("script");
        q.src = b;
        q.type = "text/javascript";
        h.appendChild(q);
        q.onload = function() {
            swfObj = SWFUploadCreator.create(p);
            jm(".swfupload").css("vertical-align", "middle")
        }
    };
    var h = document.documentElement || document.body;
    h.appendChild(e)
};
Mobi.siteFormFileUploadHtml = function(p, d, a, l, o, n, h, b, c, q, m) {
    var k = {
        siteFree: n,
        updateUrlViewRes: "updateUrlViewRes",
        auto: true,
        fileTypeExts: a.join(""),
        multi: false,
        fileSizeLimit: h * 1024 * 1024,
        breakPoints: true,
        fileSplitSize: 20 * 1024 * 1024,
        saveInfoLocal: false,
        showUploadedPercent: true,
        showUploadedSize: true,
        removeTimeout: 9999999,
        post_params: {
            app: 21,
            type: 0,
            fileUploadLimit: h
        },
        isBurst: false,
        isDefinedButton: true,
        buttonText: m,
        getFileSizeUrl: "//" + q + "/ajax/advanceUpload.jsp?cmd=_getUploadSize",
        uploader: "//" + q + "/ajax/advanceUpload.jsp?cmd=_mobiupload",
        onUploadSuccess: function(s, u) {
            var t = jQuery.parseJSON(u);
            if (t.success) {
                var r = {
                    status: "end",
                    id: s.id,
                    title: "上传成功。"
                };
                j(r);
                Mobi.onFileUploadEvent("upload", t, d, p);
                setTimeout(function() {
                        Mobi.ing("文件上传成功", true)
                    },
                    2500)
            } else {
                var r = {
                    status: "end",
                    id: s.id,
                    title: t.msg
                };
                j(r);
                Mobi.ing("文件:" + s.name + "，" + t.msg)
            }
        },
        onUploadError: function(r, s) {
            $("#progressBody_ " + r.id).remove();
            $("#progressWrap_" + r.id).remove();
            Mobi.ing("网络繁忙，文件:" + r.name + "上传失败，请稍后重试")
        },
        onSelect: function() {
            if (l) {
                Mobi.ing("已超过资源库容量限制，请升级网站版本。");
                return false
            } else {
                return true
            }
        },
        view_progress: function(r) {
            var r = Math.ceil(r);
            if (r == 100) {
                Mobi.ing("正在上传" + r + "%", true)
            } else {
                Mobi.ing("正在上传" + r + "%", false, true)
            }
        }
    };
    function j(r) {
        if (r.status == "start") {
            var s = ['<div id="progressBody_' + r.id + '" class="bodyDisable"></div>', '<div id="progressWrap_' + r.id + '" class="bodyProgressWrap">', '<div class="progressCenter"></div>', '<div class="progressIngBody">', '<div id="progressTitle' + r.id + '" class="progressIngTitle">' + r.title + "</div>", '<div class="progressIngMission">', '<div class="mission"><div id="progress' + r.id + '" class="progress" style="width:1%;"></div></div>', '<div id="progressNum' + r.id + '" class="progressNum">0%</div>', "</div>", '<div class="progressInfo"><span id="progressTips' + r.id + '" class="progressFileSize"></span><a class="progressCancel" href="javascript:uploadCancel(\'' + r.id + "');\">取消</a></div>", "</div>", "</div>"];
            $("body").append(s.join(""))
        } else {
            if (r.status == "ing") {
                $("#progressTitle" + r.id).text(r.title);
                $("#progress" + r.id).css("width", Math.round(r.percent) + "%");
                $("#progressNum" + r.id).html(Math.round(r.percent) + "%")
            } else {
                if (r.status == "end") {
                    $("#progressTitle" + r.id).text(r.title);
                    $("#progressBody_" + r.id).remove();
                    $("#progressWrap_" + r.id).remove()
                } else {
                    if (r.status == "error") {
                        $("#progress" + r.id).addClass("progressError")
                    }
                }
            }
        }
    }
    var e = document.createElement("script");
    e.type = "text/javascript";
    e.src = b;
    e.onload = function() {
        var r = document.createElement("script");
        r.src = c;
        r.type = "text/javascript";
        f.appendChild(r);
        r.onload = function() {
            upload = jm("#uploadButton" + d + p).uploadify(k)
        }
    };
    var f = document.documentElement || document.body;
    f.appendChild(e)
};
Mobi.onFileUploadEvent = function(p, m, q, j) {
    if (p == "upload") {
        var e = m.id;
        var o = m.name;
        var c = m.type;
        var l = m.size;
        var k = m.path;
        var d = m.createTime;
        var a = m.groupId;
        var f = "";
        var b = 100;
        var n = 100;
        var h = m.fileId;
        $("#module" + q).find("#siteForm" + q + "fileName" + j).html(o);
        $("#module" + q).find("#siteForm" + q + "fileName" + j).attr("_tmpFileId", e).attr("_tmpFileName", o).attr("title", o).attr("_fileId", h)
    }
};
Mobi.fixMobiFormDropdownItem = function(c, b, a) {
    jm(jm("#M" + c + "F" + b + "siteFormSelect" + a + "").find("option")[0]).hide()
};
Mobi.fixIphoneStyle = function(c, b) {
    var a = navigator.userAgent;
    if (a.indexOf("iPhone") > -1) {
        jm("#module" + b + "").find(".F" + c + "siteFormItemShowVal").find("select").css({
            width: "85%",
            height: "2rem"
        })
    }
};
Mobi.siteFormSelectArea = function(c, e, d, b, h) {
    var f;
    if (b == 2052 || b == 1028) {
        f = site_cityUtil.getProvince()
    } else {
        f = site_cityUtil.getProvinceEn()
    }
    var a = new MobileSelectArea();
    a.init({
        level: h,
        lcid: b,
        trigger: "#M" + d + "F" + e + "siteFormAddressInput" + c + "",
        value: jm("#M" + d + "F" + e + "siteFormAddressInput" + c + "").data("value"),
        data: f,
        eventName: "click",
        init: 0
    })
};
Mobi.siteFormPhoneValidate = function(d, a) {
    var e;
    e = d ? jm("#module" + d).find("#" + a) : jm("#" + a);
    var b;
    var c;
    if (e.length === 0) {
        return
    }
    e.keydown(function(f) {
        c = f.which;
        if ((c > 47) && (c < 58) || (c > 95) && (c < 106) || c === 37 || c === 39 || c === 8) {
            return true
        } else {
            return false
        }
    });
    e.keypress(function(f) {
        c = f.which;
        if ((c > 47) && (c < 58) || (c > 95) && (c < 106)) {
            return true
        } else {
            return false
        }
    });
    e.on("input",
        function(h) {
            var j = jm(this);
            var f = h.target.value;
            if (c !== 8) {
                if (f && f.length > 11) {
                    h.target.value = f.slice(0, 11)
                }
                if (!f) {
                    h.target.value = (b == undefined ? "": b)
                }
            }
            f = null;
            b = h.target.value;
            c = 0
        });
    e.keyup(function(f) {
        var h = jm(this);
        h.off("mousewheel.disabledScroll").on("mousewheel.disabledScroll",
            function(j) {
                j.preventDefault()
            });
        h.get(0).addEventListener("DOMMouseScroll",
            function(j) {
                j.preventDefault()
            },
            false);
        if (f.keyCode == 38 || f.keyCode == 40) {
            f.preventDefault()
        }
    })
};
Mobi.initmobiFormTimeBtn = function(f) {
    var e = jm("#webFooterBox"),
        b = "#Mobi" + f.moduleId + "Calendar" + f.siteFormItemId + "Plugins",
        a = jm(b),
        v = f.dateSetting,
        u = JSON.parse(JSON.stringify(v.od.unSelectDay)).sort(),
        t = (v.type == 0 && v.accuracy == 1),
        p = v.type == 1,
        d = new Date(),
        w = new Date(d.getFullYear(), d.getMonth(), d.getDate()),
        n = [{
            elem: a,
            isStart: true
        }],
        l,
        j,
        c,
        o,
        m,
        q,
        k;
    if (p) {
        o = "#Mobi" + f.moduleId + "Calendar" + f.siteFormItemId + "Plugins_end";
        n.push({
            elem: jm(o),
            isStart: false
        })
    } else {
        for (var r = 0; r < 24; r++) {
            if (jm.inArray(r, v.ot.unSelectTime) == -1) {
                q = r;
                break
            }
        }
    }
    for (r = 0; r < n.length; r++) { (function(C) {
        var x = n[C],
            A = x.isStart,
            z = x.elem,
            y = p ? (A ? "fk-datePickStart": "fk-datePickEnd") : "",
            B = v.banPassDate == 1 ? w: new Date(1900, 0, 1),
            D = "";
        if (p) {
            D = A ? "<div class='fk-calendarNav'>请选择开始日期</div>": "<div class='fk-calendarNav'>请选择结束日期</div>"
        }
        z.Calendar({
            inputExtClass: y,
            minDate: B,
            yearChangeable: f.yearChangeable,
            monthChangeable: f.monthChangeable,
            slideAble: true,
            placeholder: f.placeholder,
            showHour: t,
            minHour: q || 0,
            drawNavHeaderHtml: D,
            onBeforeInitCalendar: function(F) {
                var E = F._options;
                if (F._container.hasClass("fk-startDateInput")) {
                    F._option("minDate", B);
                    F._option("maxDate", null)
                }
                F._input[0].blur();
                e.addClass("fk-datepickerContainer")
            },
            onBeforeCancel: function(F) {
                var E;
                if (p && A) {
                    E = F.getTargetOption(F._container[0].id + "_end");
                    E._hideDate(E._container, E)
                }
            },
            beforeShowTime: function(E, F) {
                if (v.ot.unSelectTime.length > 0 && jm.inArray(E, v.ot.unSelectTime) > -1) {
                    return false
                }
                return true
            },
            beforeShowDay: function(E, F) {
                return h(E)
            },
            onAfterRefresh: function(G) {
                var F = G._options,
                    E;
                if (p) {
                    G._container.find(".ui-state-active").addClass("ui-state-active-hide");
                    if (!A) {
                        G._container.find("td").not(".ui-calendar-unSelectable").eq(0).find(".ui-state-default").addClass("ui-calendar-startDate")
                    }
                }
            },
            onSelectDate: function(J, K) {
                if (!p) {
                    return
                }
                var H = J.replace(/-/g, "/"),
                    M = new Date(H),
                    R = new Date(M.getFullYear(), M.getMonth(), M.getDate()).getTime(),
                    L = {
                        minDate: B,
                        maxDate: null
                    },
                    F = K._container.hasClass("fk-startDateInput"),
                    I,
                    G,
                    E,
                    O,
                    Q,
                    N,
                    P;
                if (F) {
                    L.minDate = M;
                    if (v.banAll == 1 || v.banHoliday == 1 || u.length > 0) {
                        for (r = 1; r < 365; r++) {
                            P = new Date(R + (r * 86400000));
                            if (!h(P)) {
                                L.maxDate = P;
                                break
                            }
                        }
                    }
                }
                if (F) {
                    E = K.getTargetOption(K._container[0].id + "_end");
                    Q = E._input.val();
                    N = typeof Q == "string" ? Q.replace(/-/g, "/") : "";
                    O = new Date(N).getTime();
                    if ( !! O && (( !! L.minDate && O < L.minDate.getTime()) || ( !! L.maxDate && O > L.maxDate.getTime()))) {
                        E._input.val("")
                    }
                } else {
                    E = K.getTargetOption(K._container[0].id.replace("_end", ""))
                }
                if ( !! E) {
                    E._option("minDate", new Date(L.minDate));
                    E._option("maxDate", L.maxDate != null ? new Date(L.maxDate) : null);
                    E.switchMonthTo(K._options._selectedMonth, K._options._selectedYear);
                    E.refresh()
                }
            },
            onAfterSelectDate: function(E, F) {
                if (A) {}
            },
            onAfterHidePicker: function(E) {
                if ((p && !A) || !p) {
                    e.removeClass("fk-datepickerContainer")
                }
            }
        })
    })(r)
    }
    if (p) {
        j = jm(o + "input");
        l = jm(b + "input");
        jm("#Mobi" + f.moduleId + "CalendarInput" + f.siteFormItemId).insertBefore(j);
        s(l, o, b);
        s(j, o, b)
    }
    function s(C, x, z) {
        var y, A, B;
        A = jm("<div class='fk-dateInputMaskWrap'></div>");
        y = jm("<div class='fk-dateInputMask'></div>");
        A.insertAfter(C);
        A.append(C);
        A.append(y);
        y.on("click",
            function() {
                jm(x + "input").trigger("click");
                jm(z + "input").trigger("click")
            })
    }
    function h(z) {
        var y = true,
            x = z.getDay(),
            A = z.getTime();
        if (v.banAll == 1) {
            y = false
        }
        if (x == 0 || x == 6) {
            if (v.banHoliday == 1) {
                y = false
            } else {
                y = true
            }
        }
        if (v.od.t == 1 && jm.inArray(A, v.od.unSelectDay) > -1) {
            y = false
        }
        if (v.od.t == 1 && jm.inArray(A, v.od.openDay) > -1) {
            y = true
        }
        return y
    }
};
Mobi.resertForm = function(d, c, a) {
    var b = jm(Mobi.getPreviewObject("module" + d));
    b.children("div.formBannerMore").remove();
    b.children("div.formBannerTitle, div.formMiddle").remove().end().prepend(c)
};
Mobi.voidFun = function() {};
Mobi.codeInsertButtom = function(d) {
    var b = /document.write/g;
    d = d.replace(b, "Mobi.voidFun");
    var a = document.createElement("script");
    a.type = "text/javascript";
    try {
        a.appendChild(document.createTextNode(d))
    } catch(c) {
        a.text = d
    }
    document.body.appendChild(a)
};
Mobi.storageReturnUrl = function(a) {
    if (!a.match(/login.jsp$/)) {
        localStorage.setItem("returnUrl", jm.encodeUrl(a))
    }
};
Mobi.loadReturnUrl = function(a) {
    var c = localStorage.getItem("returnUrl");
    c = jm.decodeHtml(c);
    localStorage.removeItem("returnUrl");
    var b = false;
    if (a.indexOf("?") != -1) {
        b = true
    }
    if (c) {
        if (b) {
            document.location.href = a + "&returnUrl=" + c
        } else {
            document.location.href = a + "?returnUrl=" + c
        }
    } else {
        if (b) {
            document.location.href = a + "&noReturn=true"
        } else {
            document.location.href = a + "?noReturn=true"
        }
    }
};
Mobi.mobileFastLoginToggle = function() {
    jm(".forAcctLogin").hide();
    jm(".forFastLogin").show();
    jm(".forFastLogin").css("display", "inline-block")
};
Mobi.acctLoginToggle = function() {
    jm(".forAcctLogin").show();
    jm(".forFastLogin").hide();
    jm(".forAcctLogin").css("display", "inline-block")
};
Mobi.loginAcquireCode = function() {
    var a = jm("#acquirerInput").val();
    if (Mobi.isNull(a) || !a) {
        return false
    }
    if (!jm.isMobile(a)) {
        Mobi.ing(LS.mobileNumRegular);
        return false
    }
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=sendMobileLoginCode",
        data: "memName=" + jm.encodeUrl(a) + "&new=true",
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(b) {
            var b = jm.parseJSON(b);
            if (b.success) {
                Mobi.loginAcquireCodeCountdown(60);
                jm("#memCodeSign").val(b.mobileCodeSign)
            } else {
                if (b.argErr) {
                    Mobi.ing(LS.memberDialogSendMobileClose)
                } else {
                    if (b.apiKeyNotFound) {
                        Mobi.ing(LS.memberDialogYunPianErr)
                    } else {
                        if (b.tplNotFound) {
                            Mobi.ing(LS.memberDialogMobileTplErr)
                        } else {
                            if (b.notFound) {
                                Mobi.ing(LS.memberDialogNotFound)
                            } else {
                                if (b.limitOne) {
                                    Mobi.ing(LS.getMobileOneMin)
                                } else {
                                    if (b.limitTwo) {
                                        Mobi.ing(LS.getMobileHalfHour)
                                    } else {
                                        if (b.noMoney) {
                                            Mobi.ing(LS.memberDialogMobileMoneyErr)
                                        } else {
                                            if (b.mobileErr) {
                                                Mobi.ing(LS.memberDialogSendMobileCodeErr)
                                            } else {
                                                if (b.sendLimit) {
                                                    Mobi.ing(LS.memberDialogSendMobileCodeLimit)
                                                } else {
                                                    if (b.mobileSysErr) {
                                                        Mobi.ing(LS.memberDialogSendMobileSysErr)
                                                    } else {
                                                        if (b.tplNationErr) {
                                                            Mobi.ing(LS.mobileNationTplErr)
                                                        } else {
                                                            if (b.systemErr) {
                                                                Mobi.ing(LS.systemError)
                                                            } else {
                                                                Mobi.ing(LS.argsError)
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    })
};
Mobi.loginAcquireCodeCountdown = function(b) {
    jm("#acquireCode").attr("onclick", "");
    var a = setInterval(function() {
            jm("#acquireCode").attr("onclick", "");
            jm("#acquireCode").text(jm.format(LS.reacquireMemCode, b));
            if (b < 0) {
                clearInterval(a);
                jm("#acquireCode").text(LS.memberDialogAcquireCode);
                jm("#acquireCode").attr("onclick", "Mobi.loginAcquireCode();return false;")
            }
            b--
        },
        1000)
};
Mobi.fastLogin = function(url, mid, fid) {
    var acquirer = jm("#acquirerInput").val();
    var code = jm("#memCodeInput").val();
    var memCodeSign = jm("#memCodeSign").val();
    var needCaptcha = (jm(".loginCaptchaCtrl").css("display") != "none");
    var captcha = jm("#loginCaptcha").val();
    if (mid != null && fid != null) {
        jm.cookie("_moduleid", mid);
        jm.cookie("_fileid", fid)
    }
    if (acquirer == null || acquirer == "") {
        Mobi.showMemberLoginMsg(4, false);
        return
    }
    if (code == null || code == "") {
        Mobi.showMemberLoginMsg(5, false);
        return
    }
    if (needCaptcha && (captcha == null || captcha == "")) {
        Mobi.showMemberLoginMsg(3, false);
        return
    }
    var loginBtn = jm(".loginSubmit");
    loginBtn.attr("disabled", true);
    jm(".g_botton").removeClass("sendIcon");
    var autoLoginBtn = jm("#autoLogin");
    var autoLogin = false;
    if (autoLoginBtn && autoLoginBtn.prop("checked")) {
        autoLogin = true
    }
    var data = "memCode=" + jm.encodeUrl(code) + "&memCodeSign=" + jm.encodeUrl(memCodeSign) + "&acquirer=" + jm.encodeUrl(acquirer) + "&mode=" + jm.encodeUrl("mobile");
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=checkMobileCodeGeneral",
        data: data,
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(result) {
            var result = jm.parseJSON(result);
            if (result.success) {
                var memId = result.memId;
                jm.ajax({
                    type: "post",
                    url: "ajax/login_h.jsp",
                    data: "cmd=loginMemberByMobile&memId=" + jm.encodeUrl(memId) + "&captcha=" + jm.encodeUrl(captcha) + "&autoLogin=" + jm.encodeUrl(autoLogin),
                    error: function() {
                        loginBtn.removeAttr("disabled");
                        Mobi.showMemberLoginMsg( - 1)
                    },
                    success: function(result) {
                        loginBtn.removeAttr("disabled");
                        var result = jm.parseJSON(result);
                        if (result.success) {
                            jm("#_TOKEN").attr("value") || jm("#g_web").append("<span id='_TOKEN' value='" + result._TOKEN + "'></span>");
                            Mobi.mallBuyLoginCheck();
                            if (url.indexOf("javascript") == -1) {
                                Fai.top.location.href = url;
                                return
                            } else {
                                var methods = url.split(";");
                                for (var i = 0; i < methods.length - 1; i++) {
                                    var patt1 = new RegExp("[^script:]");
                                    if (patt1.test(url)) {
                                        var cells = methods[i].split(":"),
                                            start = cells[1].indexOf("(") + 1,
                                            end = cells[1].lastIndexOf(")"),
                                            plist = Array.prototype.slice.call(cells[1].substring(start, end).split(","));
                                        namespace = cells[1].substring(0, start - 1);
                                        eval(cells[1]);
                                        if (url.indexOf("PhotoDetailSwipeForJumpCtrl") != -1) {
                                            window.klass.returnIndex = function() {
                                                Fai.top.location.href = "/index.jsp"
                                            }
                                        }
                                    }
                                }
                            }
                        } else {
                            jm(".g_botton").addClass("sendIcon");
                            jm(".loginIcon ").hide();
                            if (result.active) {
                                Mobi.ing(LS.memberLoginMailActivation)
                            } else {
                                if (result.rt == -2000) {
                                    Fai.top.location.href = "login.jsp?errno=-307"
                                } else {
                                    Mobi.showMemberLoginMsg(result.rt, result.captcha)
                                }
                            }
                        }
                    }
                })
            } else {
                if (result.notFound) {
                    Mobi.ing(LS.memberDialogNotFound, true)
                } else {
                    if (result.rt == -2000) {
                        Fai.top.location.href = "login.jsp?errno=-307"
                    } else {
                        if (result.rt == 1) {
                            Mobi.ing(LS.memberSignupRegisterCaptchaNotMatch)
                        }
                    }
                }
            }
        }
    })
};
Mobi.memberLogin1 = function(a) {
    Fai.top.location.href = "login.jsp?returnUrl=" + jm.encodeUrl(jm.getUrlRoot(Fai.top.location.href)) + "&errno=" + a
};
Mobi.memberLogin = function(url, mid, fid) {
    Mobi.logDog(200061, 0);
    var acct = jm("#user").val();
    var pwd = jm("#password").val();
    var needCaptcha = (jm(".loginCaptchaCtrl").css("display") != "none");
    var captcha = jm("#loginCaptcha").val();
    if (mid != null && fid != null) {
        jm.cookie("_moduleid", mid);
        jm.cookie("_fileid", fid)
    }
    if (acct == null || acct == "") {
        Mobi.showMemberLoginMsg(1, false);
        return
    }
    if (pwd == null || pwd == "") {
        Mobi.showMemberLoginMsg(2, false);
        return
    }
    if (needCaptcha && (captcha == null || captcha == "")) {
        Mobi.showMemberLoginMsg(3, false);
        return
    }
    pwd = jm.md5(pwd);
    var loginBtn = jm(".loginSubmit");
    loginBtn.attr("disabled", true);
    jm(".g_botton").removeClass("sendIcon");
    var autoLoginBtn = jm("#autoLogin");
    var autoLogin = false;
    if (autoLoginBtn && autoLoginBtn.prop("checked")) {
        autoLogin = true
    }
    jm.ajax({
        type: "post",
        url: "ajax/login_h.jsp",
        data: "cmd=loginMember&acct=" + jm.encodeUrl(acct) + "&pwd=" + jm.encodeUrl(pwd) + "&captcha=" + jm.encodeUrl(captcha) + "&autoLogin=" + autoLogin,
        error: function() {
            loginBtn.removeAttr("disabled");
            Mobi.showMemberLoginMsg( - 1)
        },
        success: function(result) {
            loginBtn.removeAttr("disabled");
            if (result.msg) {
                delete result.msg
            }
            var result = jm.parseJSON(result);
            if (result.success) {
                jm("#_TOKEN").attr("value") || jm("#g_web").append("<span id='_TOKEN' value='" + result._TOKEN + "'></span>");
                Mobi.mallBuyLoginCheck();
                if (url.indexOf("javascript") == -1) {
                    Fai.top.location.href = url;
                    return
                } else {
                    var methods = url.split(";");
                    for (var i = 0; i < methods.length - 1; i++) {
                        var patt1 = new RegExp("[^script:]");
                        if (patt1.test(url)) {
                            var cells = methods[i].split(":"),
                                start = cells[1].indexOf("(") + 1,
                                end = cells[1].lastIndexOf(")"),
                                plist = Array.prototype.slice.call(cells[1].substring(start, end).split(","));
                            namespace = cells[1].substring(0, start - 1);
                            eval(cells[1]);
                            if (url.indexOf("PhotoDetailSwipeForJumpCtrl") != -1) {
                                window.klass.returnIndex = function() {
                                    Fai.top.location.href = "/index.jsp"
                                }
                            }
                        }
                    }
                }
            } else {
                jm(".g_botton").addClass("sendIcon");
                jm(".loginIcon ").hide();
                if (result.active) {
                    Mobi.ing(LS.memberLoginMailActivation)
                } else {
                    if (result.rt == -2000) {
                        Fai.top.location.href = "login.jsp?errno=-307"
                    } else {
                        Mobi.showMemberLoginMsg(result.rt, result.captcha)
                    }
                }
            }
        }
    })
};
Mobi.showMemberLoginMsg = function(c, b) {
    var d = "";
    if (c == 1) {
        d = LS.memberInputAcct;
        Mobi.getPreviewObject("user").focus()
    } else {
        if (c == 2) {
            d = LS.memberInputPwd;
            Mobi.getPreviewObject("password").focus()
        } else {
            if (c == 3) {
                d = LS.memberInputCaptcha
            } else {
                if (c == 4) {
                    d = LS.memberDialogPlzEnterMobile
                } else {
                    if (c == 5) {
                        d = LS.memberDialogEnterCode
                    } else {
                        if (c == 11) {
                            d = LS.memberLoginFirst
                        } else {
                            if (c == 12) {
                                d = LS.memberLoginSignup
                            } else {
                                if (c == 13) {
                                    d = LS.memberLoginToView
                                } else {
                                    if (c == 14) {
                                        d = LS.memberLoginNoPermission
                                    } else {
                                        if (c == -3) {
                                            d = LS.memberPwdError
                                        } else {
                                            if (c == -301) {
                                                d = LS.memberCaptchError
                                            } else {
                                                if (c == -302) {
                                                    d = LS.memberPwdError
                                                } else {
                                                    if (c == -303) {
                                                        d = LS.memberNoAuth
                                                    } else {
                                                        if (c == -305) {
                                                            d = LS.memberPwdError
                                                        } else {
                                                            if (c == -307) {
                                                                d = LS.loginUseAcct
                                                            } else {
                                                                if (c == -308) {
                                                                    d = LS.memberDialogGetCodeFirst
                                                                } else {
                                                                    d = LS.memberLoginError
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    var a = jm(".loginErrorLine");
    a.show();
    Mobi.ing(d);
    if (b) {
        jm(".loginCaptchaCtrl").show();
        jm("#loginCaptchaImg").attr("src", "validateCode.jsp?" + Math.random() * 1000)
    }
    setTimeout(function() {
            a.hide()
        },
        3000)
};
Mobi.changeValidateCode = function(b, a) {
    jm(b).attr("src", "validateCode.jsp?" + Math.random() * 1000 + "&validateCodeRegType=" + a)
};
Mobi.onLogout = function(a) {
    if (a == null) {
        a = "index.jsp"
    }
    jm.ajax({
        type: "post",
        url: "ajax/login_h.jsp?cmd=logoutMember",
        error: function() {},
        success: function(b) {
            var b = jm.parseJSON(b);
            if (b.success) {
                location.href = a;
                return
            }
        }
    })
};
Mobi.initWBLogin = function(h, e, c, b, d, f, a) {
    jm("#" + f).click(function() {
        jm.cookie("_wbLoginKey", a, {
            expires: 1
        });
        window.location.href = "https://api.weibo.com/oauth2/authorize?client_id=" + h + "&redirect_uri=" + e + "/wbLogin.jsp&display=mobile&response_type=code"
    })
};
Mobi.wbWinListener = function(l, d, e, k, f, b, a) {
    if (typeof(l) == "string") {
        l = jm.parseJSON(l)
    }
    var c = Mobi.checkHasMobileOption(l);
    var m = false;
    if (l) {
        for (var j = 0; j < l.length; j++) {
            if (l[j]["otherLoginMust"]) {
                m = true;
                break
            }
        }
    }
    var h = "loginType=2&openId=" + encodeURIComponent(k);
    if (!m) {
        h += "&avator=" + encodeURIComponent(b) + "&name=" + f
    }
    jm.ajax({
        type: "post",
        url: "ajax/login_h.jsp?cmd=otherLoginMember&hasMobile=" + c + "&otherLoginMust=" + m,
        data: h,
        error: function() {
            Mobi.ing(LS.memberLoginError, true)
        },
        success: function(n) {
            var n = jm.parseJSON(n);
            if (n.success) {
                Mobi.mallBuyLoginCheck();
                if (a == "/login.jsp") {
                    Fai.top.location.href = "/index.jsp"
                } else {
                    Fai.top.location.href = a
                }
                return
            } else {
                if (n.active) {
                    Mobi.memberActive(n.mail, n.memName)
                } else {
                    if (n.rt == -3) {
                        Mobi.memberOtherLoginFill(l, f, k, b, 2, n.mobileCtNameList, n.signNeenMobile, a)
                    } else {
                        if (n.rt == -303) {
                            Mobi.ing(LS.memberNoAuth, true)
                        } else {
                            Mobi.ing(LS.argsError, true)
                        }
                    }
                }
            }
        }
    })
};
Mobi.initQQLogin = function(h, e, c, b, d, f, a) {
    jm("#" + f).off("click").on("click",
        function() {
            jm.cookie("_qqLoginKey", a, {
                expires: 1
            });
            window.location.href = "https://graph.qq.com/oauth2.0/authorize?client_id=" + h + "&redirect_uri=" + e + "/qqLogin.jsp&display=mobile&response_type=token&scope=all"
        })
};
Mobi.qqWinListener = function(optionList, noRemark, remarkMaxLen, q_uid, q_name, q_avator, url) {
    if (typeof(optionList) == "string") {
        optionList = jm.parseJSON(optionList)
    }
    var hasMobile = Mobi.checkHasMobileOption(optionList);
    var otherLoginMust = false;
    if (optionList) {
        for (var i = 0; i < optionList.length; i++) {
            if (optionList[i]["otherLoginMust"]) {
                otherLoginMust = true;
                break
            }
        }
    }
    var data = "loginType=1&openId=" + encodeURIComponent(q_uid);
    if (!otherLoginMust) {
        data += "&avator=" + encodeURIComponent(q_avator) + "&name=" + q_name
    }
    jm.ajax({
        type: "post",
        url: "ajax/login_h.jsp?cmd=otherLoginMember&hasMobile=" + hasMobile + "&otherLoginMust=" + otherLoginMust,
        data: data,
        error: function() {
            Mobi.ing(LS.memberLoginError, true)
        },
        success: function(result) {
            var result = jm.parseJSON(result);
            if (result.success) {
                Mobi.mallBuyLoginCheck();
                if (url.indexOf("javascript") == -1) {
                    if (url == "/login.jsp") {
                        Fai.top.location.href = "/index.jsp"
                    } else {
                        Fai.top.location.href = url
                    }
                    return
                } else {
                    var methods = url.split(";");
                    for (var i = 0; i < methods.length - 1; i++) {
                        var patt1 = new RegExp("[^script:]");
                        if (patt1.test(url)) {
                            var cells = methods[i].split(":"),
                                start = cells[1].indexOf("(") + 1,
                                end = cells[1].lastIndexOf(")"),
                                plist = Array.prototype.slice.call(cells[1].substring(start, end).split(","));
                            namespace = cells[1].substring(0, start - 1);
                            eval(cells[1]);
                            if (url.indexOf("PhotoDetailSwipeForJumpCtrl") != -1) {
                                window.klass.returnIndex = function() {
                                    Fai.top.location.href = "/index.jsp"
                                }
                            }
                        }
                    }
                }
            } else {
                if (result.active) {
                    Mobi.memberActive(result.mail, result.memName)
                } else {
                    if (result.rt == -3) {
                        Mobi.memberOtherLoginFill(optionList, q_name, q_uid, q_avator, 1, result.mobileCtNameList, result.signNeenMobile, url)
                    } else {
                        if (result.rt == -303) {
                            Mobi.ing(LS.memberNoAuth, true)
                        } else {
                            Mobi.ing(LS.argsError, true)
                        }
                    }
                }
            }
        }
    })
};
Mobi.wxLogin = function(c, e, d, k, n, h, m, j, l, a, b, f) {
    jm("#" + c).click(function() {
        Mobi.logDog(200061, 1);
        if (a) {
            Mobi.ing("系统维护中", true);
            return
        }
        if (n == "wxb98d3675b04fbc2f") {
            Mobi.logDog(200314, e)
        }
        if (j) {
            Mobi.ing("管理态无法登录", true);
            return
        }
        if (l) {
            Mobi.ing("样板网站无法登录", true);
            return
        }
        jm.cookie("_wxLoginKey", m, {
            expires: 1
        });
        window.location.href = "/" + d + "/mobiWxLoginConfirm.jsp?_key=" + m
    })
};
Mobi.wxOpenIdLogin = function(optionList, noRemark, remarkMaxLen, openId, nickName, headImg, url, faiOpenIdGreen, faiOpenId) {
    if (typeof(optionList) == "string") {
        optionList = jm.parseJSON(optionList)
    }
    var hasMobile = Mobi.checkHasMobileOption(optionList);
    var otherLoginMust = false;
    if (optionList) {
        for (var i = 0; i < optionList.length; i++) {
            if (optionList[i]["otherLoginMust"]) {
                otherLoginMust = true;
                break
            }
        }
    }
    var unionId = "";
    if (typeof(Mobi.w_unionId) != "undefined" && Mobi.w_unionId) {
        unionId = Mobi.w_unionId
    }
    var data = faiOpenIdGreen == "true" ? ("loginType=" + 5 + "&hasMobile=" + hasMobile + "&otherLoginMust=" + otherLoginMust + "&faiOpenIdGreen=" + faiOpenIdGreen + "&faiOpenId=" + encodeURIComponent(faiOpenId)) : "loginType=" + 4 + "&hasMobile=" + hasMobile + "&otherLoginMust=" + otherLoginMust + "&openId=" + encodeURIComponent(openId) + "&faiOpenId=" + encodeURIComponent(faiOpenId) + "&faiOpenIdGreen=" + faiOpenIdGreen + "&unionId=" + encodeURIComponent(unionId);
    if (!otherLoginMust) {
        data += "&avator=" + encodeURIComponent(headImg) + "&name=" + nickName
    }
    jm.ajax({
        type: "post",
        url: "ajax/login_h.jsp?cmd=otherLoginMember",
        data: data,
        error: function() {
            Mobi.ing(LS.memberLoginError, true)
        },
        success: function(result) {
            var result = jm.parseJSON(result);
            if (result.success) {
                Mobi.mallBuyLoginCheck();
                if (url.indexOf("javascript") == -1) {
                    if (url == "/login.jsp") {
                        Fai.top.location.href = "/index.jsp"
                    } else {
                        Fai.top.location.href = url
                    }
                    return
                } else {
                    var methods = url.split(";");
                    for (var i = 0; i < methods.length - 1; i++) {
                        var patt1 = new RegExp("[^script:]");
                        if (patt1.test(url)) {
                            var cells = methods[i].split(":"),
                                start = cells[1].indexOf("(") + 1,
                                end = cells[1].lastIndexOf(")"),
                                plist = Array.prototype.slice.call(cells[1].substring(start, end).split(","));
                            namespace = cells[1].substring(0, start - 1);
                            eval(cells[1]);
                            if (url.indexOf("PhotoDetailSwipeForJumpCtrl") != -1) {
                                window.klass.returnIndex = function() {
                                    Fai.top.location.href = "/index.jsp"
                                }
                            }
                        }
                    }
                }
            } else {
                if (result.active) {
                    Mobi.memberActive(result.mail, result.memName)
                } else {
                    if (result.rt == -3) {
                        if ((typeof(faiOpenId) != "undefined") && faiOpenId) {
                            Mobi.memberOtherLoginFill(optionList, nickName, faiOpenId, headImg, 5, result.mobileCtNameList, result.signNeenMobile, url)
                        } else {
                            Mobi.memberOtherLoginFill(optionList, nickName, openId, headImg, 4, result.mobileCtNameList, result.signNeenMobile, url)
                        }
                    } else {
                        if (result.rt == -303) {
                            Fai.top.location.href = "/login.jsp?errno=-303"
                        } else {
                            Mobi.ing(LS.argsError, true)
                        }
                    }
                }
            }
        }
    })
};
Mobi.memberOtherBindOrLogin = function(h, c, d, f, k, j, e, a, b, m) {
    var l = [];
    l.push("<div style='height:7.38rem;'>");
    l.push("<div class='avator loginAvatorCircle' style='background-image:url(" + j + ");'></div>");
    l.push("<div class='userName' style='margin-top:0.5rem; text-align: center;'>" + k + "</div>");
    l.push("</div>");
    l.push("<div class='remarkCon'>");
    l.push("<div class='remarkLine'></div>");
    l.push("</div>");
    l.push("<div class='signupSubmitCtrl g_globalLine' style='margin-top:0.6rem;'>");
    l.push("<input type='button'  class='g_button sendIcon signupSubmit submitIcon' onclick='Mobi.bindOtherAcctFirst(\"" + e + '","' + f + '","' + b + '","' + m + "\");' value='" + LS.memberOtherLgnBindAcct + "'/>");
    l.push("</div>");
    l.push("<div class='signupSubmitCtrl g_globalLine' style='margin-top:0.78rem;'>");
    if (e == "other_qq") {
        l.push("<input type='button'  class='g_button sendIcon signupSubmit submitIcon g_mainColor' style='background:rgb(240,240,245);border:1px solid;' onclick='Mobi.qqWinListener(" + h + ", " + c + "," + d + ',"' + f + '","' + k + '","' + j + '","' + a + "\");' value='" + LS.memberOtherLgnNow + "'/>")
    } else {
        if (e == "other_wb") {
            l.push("<input type='button'  class='g_button sendIcon signupSubmit submitIcon g_mainColor' style='background:rgb(240,240,245);border:1px solid;' onclick='Mobi.wbWinListener(" + h + ", " + c + "," + d + ',"' + f + '","' + k + '","' + j + '","' + a + "\");' value='" + LS.memberOtherLgnNow + "'/>")
        } else {
            if (e == "other_wx") {
                l.push("<input type='button'  class='g_button sendIcon signupSubmit submitIcon g_mainColor' style='background:rgb(240,240,245);border:1px solid;' onclick='Mobi.wxOpenIdLogin(" + h + ", " + c + "," + d + ',"' + f + '","' + k + '","' + j + '","' + a + '","' + b + '","' + m + "\");' value='" + LS.memberOtherLgnNow + "'/>")
            }
        }
    }
    l.push("</div>");
    jm("#bindOrLogin").parents(".g_web, .middleCenter").css("background", "#f0f0f5");
    if (!jm("#bindOrLogin .loginContent").children().length) {
        jm("#bindOrLogin .loginContent").append(l.join(""))
    }
    jm("#mLogin").hide();
    jm("#bindOrLogin").show();
    jm("#bindOrLogin #bindOrLoginBack").click(function() {
        jm("#bindOrLogin").hide();
        jm("#mLogin").show()
    })
};
Mobi.bindOtherAcctFirst = function(d, a, b, e) {
    if (d == "other_qq") {
        d = 1
    } else {
        if (d == "other_wb") {
            d = 2
        } else {
            if (d == "other_wx") {
                d = 4
            }
        }
    }
    var c = "<div class='g_globalLine'>";
    c += "	<input type='text' maxlength='50'  id='bindUser' class='itemEdit g_input mustItem' placeholder='" + LS.memberSignupRegisterAcctEmpty + "'/><span class='icon-userIcon g_mainColor'></span>";
    c += "</div>";
    c += "<div class='g_globalLine'>";
    c += "	<input type='password'maxlength='20' id='bindPassword' class='itemEdit g_input  mustItem' placeholder='" + LS.memberDialogPleaseEnterPwd + "'/><span class='icon-pswIcon g_mainColor'></span>";
    c += "</div>";
    c += "<div class='g_globalLine'>";
    c += "<input type='button'  class=' g_button sendIcon' onclick='Mobi.bindOtherAcctFirstSubmit(" + d + ',"' + a + '","' + b + '","' + e + "\")' value='" + LS.memberOtherLgnBindNow + "'/>";
    c += "</div>";
    if (!jm("#bindNow .loginContent").children().length) {
        jm("#bindNow .loginContent").append(c)
    }
    jm("#bindOrLogin").hide();
    jm("#bindNow").show();
    jm("#bindNow #bindNowBack").click(function() {
        jm("#bindNow").hide();
        jm("#bindOrLogin").show()
    })
};
Mobi.memberOtherLoginFill = function(j, a, c, l, f, e, h, b) {
    var m = [];
    m.push("<div style='height:5rem;'>");
    if (f == 1 || f == 4) {
        m.push("<div class='avator loginTypeAvator' style='background-image:url(" + l + ");'></div>")
    } else {
        m.push("<div class='avator otherLoginTypeAvator' style='background-image:url(" + l + ");'></div>")
    }
    m.push("<div class='userName' style='margin-top:0.5rem; text-align: center;'>" + a + "</div>");
    m.push("</div>");
    m.push("<div class='remarkCon'>");
    m.push("<div class='remarkLine'></div>");
    m.push("<div class='remarkInfo'>" + LS.memberOtherLgnLastStep + "</div>");
    m.push("</div>");
    var d = "";
    if (Mobi.checkHasMobileOption(j)) {
        d = "tagWidth8"
    }
    var k = "";
    jm.each(j,
        function(p, t) {
            var r = "";
            if (t.otherLoginMust) {
                if ("email" == t.fieldKey) {
                    k = "icon-emailIcon g_mainColor"
                } else {
                    if ("phone" == t.fieldKey) {
                        k = "icon-phoneIcon g_mainColor"
                    } else {
                        if ("name" == t.fieldKey) {
                            k = "icon-nameIcon g_mainColor"
                        } else {
                            k = "icon-customIcon g_mainColor";
                            r = "customIcon"
                        }
                    }
                }
                var s = "";
                if (t.placeholder == t.name) {
                    s = LS.memberOtherLgnPleaseInput + t.name
                } else {
                    s = t.placeholder
                }
                if ("mobile" == t.fieldKey) {
                    m.push("<div class='g_globalLine " + d + "'>");
                    m.push("<select id='mobileCt' name='mobileCt' class='itemEdit g_select'>");
                    for (var o = 0; o < e.length; o++) {
                        m.push("<option value='" + e[o]["ctName"] + "'>" + e[o]["ctShowName"] + e[o]["ctCode"] + "</option>")
                    }
                    m.push("</select>");
                    m.push("<span class='" + r + "'>" + LS.mobileAreaCode + "</span>");
                    m.push("</div>")
                }
                if (t.dropDownType) {
                    m.push("<div class='g_globalLine " + d + "'>");
                    if (t.must) {
                        m.push("<select id='" + t.fieldKey + "' name='" + t.name + "' class='itemEdit userAddItem isCheckUAI g_select' placeholder='" + s + LS.memberOtherLgnMust + "'>");
                        m.push("<option value=''>" + t.name + LS.memberOtherLgnMust + "</option>")
                    } else {
                        m.push("<select id='" + t.fieldKey + "' name='" + t.name + "' class='itemEdit userAddItem g_select' placeholder='" + s + "'>");
                        m.push("<option value=''>" + t.name + "</option>")
                    }
                    var q = t.dropDownContent.split("&");
                    for (var p = 0; p < q.length; p++) {
                        m.push("<option value='" + q[p] + "'>" + q[p] + "</option>")
                    }
                    m.push("</select><span class='" + k + "'></span>");
                    if (r != "") {
                        m.push("<span class='" + r + "'>" + t.name + "</span>")
                    }
                    m.push("</div>")
                } else {
                    m.push("<div class='g_globalLine " + d + "'>");
                    if (t.must) {
                        m.push("<input type='text' maxlength='50' id='" + t.fieldKey + "' name='" + t.name + "' class='mustItem isCheckUAI itemEdit userAddItem  g_input' maxlength='50' placeholder='" + s + LS.memberOtherLgnMust + "'><span class='" + k + "'></span>")
                    } else {
                        m.push("<input type='text' maxlength='50' id='" + t.fieldKey + "' name='" + t.name + "' class='mustItem itemEdit userAddItem  g_input' maxlength='50' placeholder='" + s + "'><span class='" + k + "'></span>")
                    }
                    if (r != "") {
                        m.push("<span class='" + r + "'>" + t.name + "</span>")
                    }
                    m.push("</div>")
                }
            }
        });
    if (h) {
        m.push("<div class='g_globalLine'>");
        m.push("<input id='memberSignupCaptcha' type='text' class='captchaText g_input' maxlength='4' placeholder='" + LS.EnterVerificationCode + "'/><img id='signupCaptchaImg'  class='captchaImg' src='validateCode.jsp?" + (Math.random() * 1000) + "' onclick='Mobi.changeValidateCode(jm(\"#signupCaptchaImg\"))' /><div style='clear:both'></div>");
        m.push("</div>");
        m.push("<div class='g_globalLine'>");
        m.push("<input id='messageAuthCode' type='text' class='captchaText g_input' maxlength='6' placeholder='" + LS.inputMobileCode + "' /><div id='messageAuthCodeClick' onclick='Mobi.getSignMobileCode()' class='fk-sign-getMobileCode' title='" + LS.getMobileCode + "'>" + LS.getMobileCode + "</div><div style='clear:both'></div>");
        m.push("</div>")
    }
    m.push("<div class='signupSubmitCtrl g_globalLine " + d + "' style='margin-top:1rem;'>");
    m.push("<input type='button'  class='g_button sendIcon signupSubmit submitIcon' onclick='Mobi.memberOtherLoginSubmit(\"" + a + '", ' + f + ', "' + c + '", "' + b + '", "' + l + "\")' value='" + LS.login + "'/>");
    m.push("</div>");
    jm("#fillAcctInfo").parents(".g_web, .middleCenter").css("background", "#f0f0f5");
    if (!jm("#fillAcctInfo .loginContent").children().length) {
        jm("#fillAcctInfo .loginContent").append(m.join(""))
    }
    jm("#mLogin").hide();
    jm("#bindOrLogin").hide();
    jm("#fillAcctInfo").show();
    jm("#fillAcctInfo #fillInfoBack").click(function() {
        jm("#fillAcctInfo").hide();
        jm("#mLogin").show()
    })
};
Mobi.memberOtherLoginAdd = function(b, c, l, k, d, e, j, f, h, a) {
    var m = [];
    m.push("<div style='height:5rem;'>");
    if (j == 1 || j == 4) {
        m.push("<div class='avator' style='height:2.5rem;width:2.5rem;margin-top:1rem;margin-left:6.2rem;border-radius:50%;background:url(" + l + ");background-size:2.5rem;'></div>")
    } else {
        m.push("<div class='avator' style='height:1.2rem;width:1.2rem;margin-top:1rem;margin-left:6.6rem;border-radius:50%;background:url(" + l + ");background-size:1.2rem;'></div>")
    }
    m.push("<div class='userName' style='margin-top:0.5rem;'>" + b + "</div>");
    m.push("</div>");
    m.push("<div class='desc' style='height:3rem;font-size:0.6rem;color:#666;'>");
    if (j == 1) {
        m.push("<div class='firstLine' style='width:4.5rem;'>" + LS.memberOtherLgnQQUser + ":</div>")
    } else {
        if (j == 2) {
            m.push("<div class='firstLine' style='width:5.8rem;'>" + LS.memberOtherLgnWBUser + ":</div>")
        } else {
            m.push("<div class='firstLine' style='width:5rem;'>" + LS.memberOtherLgnWXUser + ":</div>")
        }
    }
    m.push("<div class='secondLine' style='width:13rem;margin-top:0.5rem;'>" + LS.memberOtherLgnBindAcctMsg + "</div>");
    m.push("</div>");
    m.push("<div class='choose' style='font-size:0.6rem;color:#999;height:7rem;'>");
    m.push("<div class='haveMember' style='width:3rem;'>" + LS.memberOtherLgnHaveAcct + "</div>");
    m.push("<div class='bindNow g_button sendIcon' style='margin-bottom:1rem;' onclick='Mobi.bindNow(" + j + ', "' + c + '", "' + a + "\");'>" + LS.memberOtherLgnBindNow + "</div>");
    m.push("<div class='noMember' style='width:3rem;'>" + LS.memberOtherLgnNotAcct + "</div>");
    m.push("<div class='signUp g_button sendIcon' id='signUp' >" + LS.memberOtherLgnSignUp + "</div>");
    m.push("</div>");
    if (!jm("#bindAcct .loginContent").children().length) {
        jm("#bindAcct .loginContent").append(m.join(""))
    }
    jm("#mLogin").hide();
    jm("#bindAcct").show();
    jm("#bindAcct #bindBack").click(function() {
        jm("#bindAcct").hide();
        jm("#mLogin").show()
    });
    jm("#signUp").click(function() {
        Mobi.signUp(k, d, e, j, c, l, f, h, a)
    })
};
Mobi.bindOtherAcct = function(f, e, a, d, c, b) {
    jm("#changeOtherLoginAcct").click(function() {
        Mobi.logDog(200199, 4);
        var k = jm.cookie("isOtherLogin");
        var j = true;
        var h = "<div class='g_globalLine'>";
        h += "	<input type='text' maxlength='50'  id='bindUser' class='itemEdit g_input mustItem' placeholder='" + LS.memberSignupRegisterAcctEmpty + "'/><span class='icon-userIcon g_mainColor'></span>";
        h += "</div>";
        h += "<div class='g_globalLine'>";
        h += "	<input type='password'maxlength='20' id='bindPassword' class='itemEdit g_input  mustItem' placeholder='" + LS.memberDialogPleaseEnterPwd + "'/><span class='icon-pswIcon g_mainColor'></span>";
        h += "</div>";
        h += "<div class='g_globalLine'>";
        h += "<input type='button'  class=' g_button sendIcon' onclick='Mobi.bindOtherAcctSubmit(" + f + ", true, " + k + ")' value='" + LS.memberOtherLgnBindNow + "'/>";
        h += "</div>";
        h += "<div id='signUp' class='g_globalLine' style='text-align:right; margin-top:0.4rem;'>" + LS.memberSignUpNewAcct + "</div>";
        if (!jm("#bindOtherAcct .loginContent").children().length) {
            jm("#bindOtherAcct .loginContent").append(h)
        }
        jm("#profile").hide();
        jm("#bindOtherAcct").show();
        jm("#bindOtherAcct #bindAcctBack").click(function() {
            jm("#bindOtherAcct").hide();
            jm("#profile").show()
        });
        jm("#signUp").click(function() {
            Mobi.logDog(200199, 6);
            Mobi.signUp(f, e, a, d, k, c, b)
        })
    })
};
Mobi.signUp = function(f, k, a, c, h, e, j) {
    var d = false;
    var m = [],
        b = "";
    k = jm.parseJSON(k);
    e = jm.parseJSON(e);
    if (Mobi.checkHasMobileOption(k)) {
        b = "tagWidth8"
    }
    var l = "";
    m.push("<div class='g_globalLine " + b + "'>");
    m.push("<input type='text' maxlength='50' id='memberSignupAcct' class='mustItem itemEdit userAddItem g_input' placeholder='" + LS.memberSignupRegisterAcctEmpty + LS.memberOtherLgnMust + "'><span class='icon-userIcon g_mainColor'></span>");
    m.push("</div>");
    m.push("<div class='g_globalLine " + b + "'>");
    m.push("<input type='password'  maxlength='20' id='memberSignupPwd' class='mustItem itemEdit icon-pswIcon userAddItem g_input' placeholder='" + LS.memberDialogPleaseEnterPwd + LS.memberOtherLgnMust + "'><span class='icon-pswIcon g_mainColor'></span>");
    m.push("</div>");
    m.push("<div class='g_globalLine " + b + "'>");
    m.push("<input type='password'  maxlength='20' id='memberSignupRepwd' class='mustItem itemEdit icon-pswIcon userAddItem g_input' placeholder='" + LS.memberDialogPleaseEnterPwd2 + LS.memberOtherLgnMust + "'><span class='icon-pswIcon g_mainColor'></span>");
    m.push("</div>");
    jm.each(k,
        function(p, s) {
            var q = "";
            if ("email" == s.fieldKey) {
                l = "icon-emailIcon g_mainColor"
            } else {
                if ("phone" == s.fieldKey) {
                    l = "icon-phoneIcon g_mainColor"
                } else {
                    if ("name" == s.fieldKey) {
                        l = "icon-nameIcon g_mainColor"
                    } else {
                        l = "icon-customIcon g_mainColor";
                        q = "customIcon"
                    }
                }
            }
            var r = "";
            if (s.placeholder == s.name) {
                r = LS.memberOtherLgnPleaseInput + s.name
            } else {
                r = s.placeholder
            }
            if ("mobile" == s.fieldKey) {
                m.push("<div class='g_globalLine " + b + "'>");
                m.push("<select id='mobileCt' name='mobileCt' class='itemEdit g_select'>");
                for (var o = 0; o < e.length; o++) {
                    m.push("<option value='" + e[o]["ctName"] + "'>" + e[o]["ctShowName"] + e[o]["ctCode"] + "</option>")
                }
                m.push("</select>");
                m.push("<span class='" + q + "'>" + LS.mobileAreaCode + "</span>");
                m.push("</div>")
            }
            m.push("<div class='g_globalLine " + b + "'>");
            if (s.must) {
                m.push("<input type='text' maxlength='50' id='" + s.fieldKey + "' name='" + s.name + "' class='mustItem isCheckUAI itemEdit userAddItem  g_input' maxlength='50' placeholder='" + r + LS.memberOtherLgnMust + "'><span class='" + l + "'></span>")
            } else {
                m.push("<input type='text' maxlength='50' id='" + s.fieldKey + "' name='" + s.name + "' class='itemEdit userAddItem  g_input' maxlength='50' placeholder='" + r + "'><span class='" + l + "'></span>")
            }
            if (q != "") {
                m.push("<span class='" + q + "'>" + s.name + "</span>")
            }
            m.push("</div>")
        });
    if (a) {
        m.push("<div class='g_globalLine " + b + "'>");
        m.push("<input type='text' class='itemEdit g_input userAddItem' id='memberSignupRemark' maxlength='200' placeholder='" + LS.memberOtherLgnRemark + "'><span class='icon-msgIcon g_mainColor'></span>");
        m.push("</div>")
    }
    if (j) {
        m.push("<div class='g_globalLine'>");
        m.push("<input id='memberSignupCaptcha' type='text' class='captchaText g_input' maxlength='4' placeholder='" + LS.EnterVerificationCode + "'/><img id='signupCaptchaImg'  class='captchaImg' src='validateCode.jsp?" + (Math.random() * 1000) + "' onclick='Mobi.changeValidateCode(jm(\"#signupCaptchaImg\"))' /><div style='clear:both'></div>");
        m.push("</div>");
        m.push("<div class='g_globalLine'>");
        m.push("<input id='messageAuthCode' type='text' class='captchaText g_input' maxlength='6' placeholder='" + LS.inputMobileCode + "' /><div id='messageAuthCodeClick' onclick='Mobi.getSignMobileCode()' class='fk-sign-getMobileCode' title='" + LS.getMobileCode + "'>" + LS.getMobileCode + "</div><div style='clear:both'></div>");
        m.push("</div>")
    }
    if (h == 1) {
        m.push("<div style='margin-top:0.5rem;font-size:0.6rem;color:#999;width:12rem;'>" + LS.signByQQCanLogin + "</div>")
    } else {
        if (h == 2) {
            m.push("<div style='margin-top:0.5rem;font-size:0.6rem;color:#999;width:13.5rem;'>" + LS.signByWbCanLogin + "</div>")
        } else {
            m.push("<div style='margin-top:0.5rem;font-size:0.6rem;color:#999;width:13.5rem;'>" + LS.signByWXCanLogin + "</div>")
        }
    }
    m.push("<div class='signupSubmitCtrl g_globalLine " + b + "'>");
    m.push("<input type='button'  class='g_button sendIcon signupSubmit submitIcon' onclick='Mobi.bindOtherAcctSubmit(" + f + ", false, " + h + ");' value='" + LS.memberOtherLgnSignUp + "'/>");
    m.push("</div>");
    if (!jm("#mSignUp .loginContent").children().length) {
        jm("#mSignUp .loginContent").append(m.join(""))
    }
    jm("#mSignUp").show();
    jm("#bindOtherAcct").hide();
    jm("#mSignUp #signUpBack").click(function() {
        jm("#mSignUp").hide();
        jm("#bindOtherAcct").show()
    })
};
Mobi.checkHasMobileOption = function(b) {
    var c = false;
    if (b) {
        for (var a = 0; a < b.length; a++) {
            if (b[a]["fieldKey"] == "mobile" && b[a]["otherLoginMust"]) {
                c = true;
                break
            }
        }
    }
    return c
};
Mobi.bindOtherAcctFirstSubmit = function(d, a, b, e) {
    var c = "cmd=bindOtherAcctFirst";
    info = {},
        data = "";
    acct = jm("#bindUser").val(),
        pwd = jm("#bindPassword").val();
    if (acct == null || acct == "") {
        Mobi.ing(LS.memberSignupRegisterAcctEmpty);
        Mobi.getPreviewObject("bindUser").focus();
        return
    }
    if (pwd == null || pwd == "") {
        Mobi.ing(LS.memberSignupRegisterPwdEmpty);
        Mobi.getPreviewObject("bindPassword").focus();
        return
    }
    pwd = jm.md5(pwd);
    info.acct = acct;
    info.pwd = pwd;
    if (e == "true") {
        data += "&loginType=5&uid=" + jm.encodeUrl(a) + "&faiOpenId=" + jm.encodeUrl(e);
        if (typeof(Mobi.w_unionId) != "undefined" && Mobi.w_unionId && Mobi.w_unionId != "") {
            data += "&unionId=" + jm.encodeUrl(Mobi.w_unionId)
        }
    } else {
        data += "&loginType=4&uid=" + jm.encodeUrl(a);
        if (typeof(e) != "undefined" && e) {
            data += "&faiOpenId=" + jm.encodeUrl(e)
        }
        if (typeof(Mobi.w_unionId) != "undefined" && Mobi.w_unionId && Mobi.w_unionId != "") {
            data += "&unionId=" + jm.encodeUrl(Mobi.w_unionId)
        }
    }
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?" + c,
        data: "info=" + jm.encodeUrl(jm.toJSON(info)) + data,
        error: function() {
            Mobi.ing(LS.memberSignupRegisterError)
        },
        success: function(f) {
            var h = jm.parseJSON(f);
            if (h.success) {
                if (h.fromBind) {
                    Mobi.memberActive(h.mail, h.memName)
                } else {
                    if (h.active) {
                        Mobi.memberActive(info.email, info.acct)
                    } else {
                        document.location.reload()
                    }
                }
            } else {
                if (h.rt == -401) {
                    Mobi.ing(LS.memberSignupRegisterCaptchaNotMatch)
                } else {
                    if (h.rt == -601) {
                        Mobi.ing(LS.reGetMobileCode)
                    } else {
                        if (h.rt == -8) {
                            Mobi.ing(LS.mobileHasSigned)
                        } else {
                            if (h.rt == -6) {
                                Mobi.ing(LS.memberSignupRegisterExisted)
                            } else {
                                if (h.rt == -4) {
                                    Mobi.ing(LS.memberSignupRegisterLimit)
                                } else {
                                    if (h.rt == -3) {
                                        if (h.msg == "密码不正确") {
                                            Mobi.ing(LS.memberPwdError)
                                        } else {
                                            Mobi.ing(LS.memberDialogNotFound)
                                        }
                                    } else {
                                        if (h.rt == Mobi.otherLoginErrno.acctAlreadyBind) {
                                            Mobi.ing(LS.memberOtherLgnAcctAlreadyBind)
                                        } else {
                                            Mobi.ing(LS.memberSignupRegisterError)
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    })
};
Mobi.bindOtherAcctSubmit = function(l, a, h) {
    var r = "";
    var u = {};
    if (a) {
        Mobi.logDog(200199, 5);
        r = "cmd=bindOtherAcct";
        var m = jm("#bindUser").val();
        var e = jm("#bindPassword").val();
        if (m == null || m == "") {
            Mobi.ing(LS.memberSignupRegisterAcctEmpty);
            Mobi.getPreviewObject("bindUser").focus();
            return
        }
        if (e == null || e == "") {
            Mobi.ing(LS.memberSignupRegisterPwdEmpty);
            Mobi.getPreviewObject("bindPassword").focus();
            return
        }
        e = jm.md5(e);
        u.acct = m;
        u.pwd = e
    } else {
        r = "cmd=signUpAndBind";
        var m = jm("#memberSignupAcct").val();
        if (m == null || m == "") {
            Mobi.ing(LS.memberSignupRegisterAcctEmpty);
            Mobi.getPreviewObject("memberSignupAcct").focus();
            return
        }
        var e = jm("#memberSignupPwd").val();
        if (e == null || e == "") {
            Mobi.ing(LS.memberSignupRegisterPwdEmpty);
            Mobi.getPreviewObject("memberSignupPwd").focus();
            return
        }
        if (e.length < 4) {
            Mobi.ing(LS.memberSignupRegisterPwdMinLength);
            Mobi.getPreviewObject("memberSignupPwd").focus();
            return
        }
        var p = jm("#memberSignupRepwd").val();
        if (e != p) {
            Mobi.ing(LS.memberSignupRegisterPwdNotMatch);
            Mobi.getPreviewObject("memberSignupRepwd").focus();
            return
        }
        var q = "";
        if (jm("#memberSignupRemark").length > 0) {
            q = jm("#memberSignupRemark").val();
            var v = jm("#memberSignupRemark").attr("maxlength");
            if (q.length > v) {
                Mobi.ing(jm.format(LS.memberSignupRegisterRemarkMaxLength, v));
                Mobi.getPreviewObject("memberSignupRemark").focus();
                return
            }
        }
        u.acct = m;
        u.pwd = jm.md5(e);
        u.remark = q;
        var b = "";
        var s = "";
        var f = "";
        var t = 0;
        var n = "";
        var d = 0;
        var k = "";
        jm("#mSignUp .userAddItem").each(function() {
            userAddItemID = jm(this).attr("id");
            f = jm(this).val();
            b = jm(this).attr("name");
            n = jm(this).attr("maxlength");
            u[userAddItemID] = f;
            if (typeof(n) != "undefined" && n != null && f.length > n) {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemMaxLength, b, n));
                Mobi.getPreviewObject(userAddItemID).focus();
                t = 1;
                return false
            }
            if (userAddItemID == "email" && f.length > 0) {
                if (!jm.isEmail(f)) {
                    Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, b));
                    Mobi.getPreviewObject(userAddItemID).focus();
                    d = 1;
                    return false
                }
            }
            if (userAddItemID == "mobile" && f.length > 0) {
                if (!jm.isNationMobile(f)) {
                    Mobi.ing(LS.mobileNumRegular);
                    Mobi.getPreviewObject(userAddItemID).focus();
                    d = 1;
                    return false
                } else {
                    u.mobileCt = jm("#mobileCt").val()
                }
            }
        });
        if (d == 1) {
            return
        }
        if (t == 1) {
            return
        }
        if (typeof(jm("#messageAuthCode").attr("maxlength")) != "undefined" && jm("#messageAuthCode").attr("maxlength") != null) {
            var c = jm("#memberSignupCaptcha").val();
            if (typeof(c) == "undefined" || c == null || c == "") {
                Mobi.ing(LS.memberInputCaptcha);
                return false
            }
            var o = jm("#messageAuthCode").val();
            if (typeof(o) == "undefined" || o == null || o == "") {
                Mobi.ing(LS.inputMobileCode);
                return false
            }
            u.messageAuthCode = o
        }
        var j = 0;
        jm(".isCheckUAI").each(function() {
            userAddItemID = jm(this).attr("id");
            f = jm(this).val();
            b = jm(this).attr("name");
            if (f == null || f == "") {
                if (jm(this).is("input")) {
                    Mobi.ing(jm.format(LS.memberSignupUserAddItemIsEmpty, b))
                } else {
                    Mobi.ing(jm.format(LS.memberSignupUserAddItemIsEmpty2, b))
                }
                Mobi.getPreviewObject(userAddItemID).focus();
                j = 1;
                return false
            }
            if (userAddItemID == "email" && f.length > 0) {
                if (!jm.isEmail(f)) {
                    Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, b));
                    Mobi.getPreviewObject(userAddItemID).focus();
                    j = 1;
                    return false
                }
            }
        });
        if (j == 1) {
            return
        }
    }
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?" + r,
        data: "info=" + jm.encodeUrl(jm.toJSON(u)) + "&mid=" + l + "&loginType=" + h,
        error: function() {
            Mobi.ing(LS.memberSignupRegisterError)
        },
        success: function(w) {
            var x = jm.parseJSON(w);
            if (x.success) {
                if (x.fromBind) {
                    Mobi.memberActive(x.mail, x.memName)
                } else {
                    if (x.active) {
                        Mobi.memberActive(u.email, u.acct)
                    } else {
                        document.location.reload()
                    }
                }
            } else {
                if (x.msg == "该帐号已绑定到其他帐号") {
                    Mobi.ing(LS.hasBindOtherAcct)
                } else {
                    if (x.rt == -401) {
                        Mobi.ing(LS.memberSignupRegisterCaptchaNotMatch)
                    } else {
                        if (x.rt == -601) {
                            Mobi.ing(LS.reGetMobileCode)
                        } else {
                            if (x.rt == -8) {
                                Mobi.ing(LS.mobileHasSigned)
                            } else {
                                if (x.rt == -6) {
                                    Mobi.ing(LS.memberSignupRegisterExisted)
                                } else {
                                    if (x.rt == -4) {
                                        Mobi.ing(LS.memberSignupRegisterLimit)
                                    } else {
                                        if (x.rt == -3) {
                                            Mobi.ing(LS.memberDialogNotFound)
                                        } else {
                                            if (x.rt == Mobi.otherLoginErrno.acctAlreadyBind) {
                                                Mobi.ing(LS.memberOtherLgnAcctAlreadyBind)
                                            } else {
                                                Mobi.ing(LS.memberSignupRegisterError)
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    })
};
Mobi.memberOtherLoginSubmit = function(name, loginType, openId, url, avator) {
    var cmd = "cmd=otherAdd";
    var info = {};
    info.headImgUrl = avator;
    info.acct = name;
    var userAddItemName = "";
    var userAddItemId = "";
    var userAddItemValue = "";
    var isUserAddItemNameTooLong = 0;
    var userAddItemMaxLength = "";
    var isUserAddItemPass = 0;
    var userAddItemType = "";
    jm("#fillAcctInfo .userAddItem").each(function() {
        userAddItemID = jm(this).attr("id");
        userAddItemValue = jm(this).val();
        userAddItemName = jm(this).attr("name");
        userAddItemMaxLength = jm(this).attr("maxlength");
        info[userAddItemID] = userAddItemValue;
        if (typeof(userAddItemMaxLength) != "undefined" && userAddItemMaxLength != null && userAddItemValue.length > userAddItemMaxLength) {
            Mobi.ing(jm.format(LS.memberSignupUserAddItemMaxLength, userAddItemName, userAddItemMaxLength));
            Mobi.getPreviewObject(userAddItemID).focus();
            isUserAddItemNameTooLong = 1;
            return false
        }
        if (userAddItemID == "email" && userAddItemValue.length > 0) {
            if (!jm.isEmail(userAddItemValue)) {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, userAddItemName));
                Mobi.getPreviewObject(userAddItemID).focus();
                isUserAddItemPass = 1;
                return false
            }
        }
        if (userAddItemID == "mobile" && userAddItemValue.length > 0) {
            if (!jm.isNationMobile(userAddItemValue)) {
                Mobi.ing(LS.mobileNumRegular);
                Mobi.getPreviewObject(userAddItemID).focus();
                isUserAddItemPass = 1;
                return false
            } else {
                info.mobileCt = jm("#mobileCt").val()
            }
        }
    });
    if (isUserAddItemPass == 1) {
        return
    }
    if (isUserAddItemNameTooLong == 1) {
        return
    }
    if (typeof(jm("#messageAuthCode").attr("maxlength")) != "undefined" && jm("#messageAuthCode").attr("maxlength") != null) {
        var memberSignupCaptcha = jm("#memberSignupCaptcha").val();
        if (typeof(memberSignupCaptcha) == "undefined" || memberSignupCaptcha == null || memberSignupCaptcha == "") {
            Mobi.ing(LS.memberInputCaptcha);
            return false
        }
        var messageAuthCode = jm("#messageAuthCode").val();
        if (typeof(messageAuthCode) == "undefined" || messageAuthCode == null || messageAuthCode == "") {
            Mobi.ing(LS.inputMobileCode);
            return false
        }
        info.messageAuthCode = messageAuthCode
    }
    var isCheckUAIStatus = 0;
    jm(".isCheckUAI").each(function() {
        userAddItemID = jm(this).attr("id");
        userAddItemValue = jm(this).val();
        userAddItemName = jm(this).attr("name");
        if (userAddItemValue == null || userAddItemValue == "") {
            if (jm(this).is("input")) {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemIsEmpty, userAddItemName))
            } else {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemIsEmpty2, userAddItemName))
            }
            Mobi.getPreviewObject(userAddItemID).focus();
            isCheckUAIStatus = 1;
            return false
        }
        if (userAddItemID == "email" && userAddItemValue.length > 0) {
            if (!jm.isEmail(userAddItemValue)) {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, userAddItemName));
                Mobi.getPreviewObject(userAddItemID).focus();
                isCheckUAIStatus = 1;
                return false
            }
        }
    });
    if (isCheckUAIStatus == 1) {
        return
    }
    var unionId = "";
    if (typeof(Mobi.w_unionId) != "undefined" && Mobi.w_unionId) {
        unionId = Mobi.w_unionId
    }
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?" + cmd,
        data: "info=" + jm.encodeUrl(jm.toJSON(info)) + "&loginType=" + loginType + "&openId=" + encodeURIComponent(openId) + "&unionId=" + encodeURIComponent(unionId),
        error: function() {
            Mobi.ing(LS.memberSignupRegisterError)
        },
        success: function(result) {
            var data = jm.parseJSON(result);
            if (data.success) {
                Mobi.mallBuyLoginCheck();
                if (data.rt == 0) {
                    Fai.top.location.href = "/login.jsp?errno=-303"
                } else {
                    if (data.fromBind) {
                        Mobi.memberActive(data.mail, data.memName)
                    } else {
                        if (data.active) {
                            Mobi.memberActive(info.email, data.acct)
                        } else {
                            if (url.indexOf("javascript") == -1) {
                                Fai.top.location.href = url;
                                return
                            } else {
                                var methods = url.split(";");
                                for (var i = 0; i < methods.length - 1; i++) {
                                    var patt1 = new RegExp("[^script:]");
                                    if (patt1.test(url)) {
                                        var cells = methods[i].split(":"),
                                            start = cells[1].indexOf("(") + 1,
                                            end = cells[1].lastIndexOf(")"),
                                            plist = Array.prototype.slice.call(cells[1].substring(start, end).split(","));
                                        namespace = cells[1].substring(0, start - 1);
                                        eval(cells[1]);
                                        if (url.indexOf("PhotoDetailSwipeForJumpCtrl") != -1) {
                                            window.klass.returnIndex = function() {
                                                Fai.top.location.href = "/index.jsp"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            } else {
                Mobi.changeValidateCode(jm("#signupCaptchaImg"));
                jm("#memberSignupCaptcha").val("");
                if (data.rt == -401) {
                    Mobi.ing(LS.memberSignupRegisterCaptchaNotMatch)
                } else {
                    if (data.rt == -601) {
                        Mobi.ing(LS.reGetMobileCode)
                    } else {
                        if (data.rt == -8) {
                            Mobi.ing(LS.mobileHasSigned)
                        } else {
                            if (data.rt == -6) {
                                Mobi.ing(LS.memberSignupRegisterExisted)
                            } else {
                                if (data.rt == -4) {
                                    Mobi.ing(LS.memberSignupRegisterLimit)
                                } else {
                                    if (data.rt == -3) {
                                        Mobi.ing(LS.memberDialogNotFound)
                                    } else {
                                        if (data.rt == Mobi.otherLoginErrno.acctAlreadyBind) {
                                            Mobi.ing(LS.memberOtherLgnAcctAlreadyBind)
                                        } else {
                                            Mobi.ing(LS.memberSignupRegisterError)
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    })
};
Mobi.otherLoginErrno = {
    acctAlreadyBind: 1
};
Mobi.memberSignupSubmit = function(b, l, u) {
    if (!l && !u) {
        var k = jm("#memberSignupAcct").val().trim();
        if (k == null || k == "") {
            Mobi.ing(LS.memberSignupRegisterAcctEmpty);
            Mobi.getPreviewObject("memberSignupAcct").focus();
            return
        }
    }
    var d = jm("#memberSignupPwd").val();
    if (d == null || d.trim() == "") {
        Mobi.ing(LS.memberSignupRegisterPwdEmpty);
        Mobi.getPreviewObject("memberSignupPwd").focus();
        return
    }
    if (d.length < 4) {
        Mobi.ing(LS.memberSignupRegisterPwdMinLength);
        Mobi.getPreviewObject("memberSignupPwd").focus();
        return
    }
    var o = jm("#memberSignupRepwd").val();
    if (d != o) {
        Mobi.ing(LS.memberSignupRegisterPwdNotMatch);
        Mobi.getPreviewObject("memberSignupRepwd").focus();
        return
    }
    var p = "";
    if (jm("#memberSignupRemark").length > 0) {
        p = jm("#memberSignupRemark").val().trim();
        var v = jm("#memberSignupRemark").attr("maxlength");
        if (p.length > v) {
            Mobi.ing(jm.format(LS.memberSignupRegisterRemarkMaxLength, v));
            Mobi.getPreviewObject("memberSignupRemark").focus();
            return
        }
    }
    var t = {};
    t.acct = k;
    t.pwd = jm.md5(d);
    t.remark = p;
    t.signUpbyMobile = l;
    t.signUpbyMail = u;
    if (typeof(jm("#messageAuthCode").attr("maxlength")) != "undefined" && jm("#messageAuthCode").attr("maxlength") != null) {
        var n = jm("#messageAuthCode").val();
        if (typeof(n) == "undefined" || n == null || n == "") {
            Mobi.ing(LS.inputMobileCode);
            Mobi.getPreviewObject("messageAuthCode").focus();
            return
        } else {
            t.messageAuthCode = n
        }
    }
    var a = "";
    var q = "";
    var e = "";
    var s = 0;
    var m = "";
    var j = "";
    var c = 0;
    jm(".userAddItem").each(function() {
        userAddItemID = jm(this).attr("id");
        e = jm(this).val().trim();
        a = jm(this).attr("name");
        m = jm(this).attr("maxlength");
        t[userAddItemID] = e;
        if (typeof(m) != "undefined" && m != null && e.length > m && j == "input") {
            Mobi.ing(jm.format(LS.memberSignupUserAddItemMaxLength, a, m));
            Mobi.getPreviewObject(userAddItemID).focus();
            s = 1;
            return false
        }
        if (userAddItemID == "email" && e.length > 0) {
            if (!jm.isEmail(e)) {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, a));
                Mobi.getPreviewObject(userAddItemID).focus();
                c = 1;
                return false
            }
        }
        if (userAddItemID == "mobile" && e.length > 0) {
            if (!jm.isNationMobile(e)) {
                Mobi.ing(LS.mobileNumRegular);
                Mobi.getPreviewObject(userAddItemID).focus();
                c = 1;
                return false
            }
        }
        if (userAddItemID == "mobile" && e.length <= 0) {
            t.mobileCt = ""
        }
    });
    if (c == 1) {
        return
    }
    if (s == 1) {
        return
    }
    var h = 0;
    jm(".isCheckUAI").each(function() {
        userAddItemID = jm(this).attr("id");
        e = jm(this).val().trim();
        a = jm(this).attr("name");
        if (e == null || e.trim() == "") {
            if (jm(this).is("input")) {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemIsEmpty, a))
            } else {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemIsEmpty2, a))
            }
            Mobi.getPreviewObject(userAddItemID).focus();
            h = 1;
            return false
        }
        if (userAddItemID == "email" && e.length > 0) {
            if (!jm.isEmail(e)) {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, a));
                Mobi.getPreviewObject(userAddItemID).focus();
                h = 1;
                return false
            }
        }
    });
    if (h == 1) {
        return
    }
    if (jm(".J_memberSignupCaptcha").css("display") != "none") {
        var f = jm("#memberSignupCaptcha").val();
        if (f == null || f == "" || typeof(f) == "undefined") {
            Mobi.ing(LS.memberSignupRegisterCaptchaEmpty);
            Mobi.getPreviewObject("memberSignupCaptcha").focus();
            return
        }
    } else {
        if (f == null || f == "" || typeof(f) == "undefined") {
            f = ""
        }
    }
    var r = jm("#memberAgreePro");
    if (r.length > 0) {
        if (!r.prop("checked")) {
            Mobi.ing(LS.memberAgreeProtocol);
            return
        }
    }
    Mobi.ing(LS.memberSignupRegisterIng, false, true);
    jm(".g_button").removeClass("sendIcon");
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=add",
        data: "info=" + jm.encodeUrl(jm.toJSON(t)) + "&validateCode=" + f,
        error: function() {
            Mobi.ing(LS.memberSignupRegisterError)
        },
        success: function(w) {
            var x = jm.parseJSON(w);
            if (x.success) {
                if (x.active) {
                    Mobi.memberActive(t.email, x.acct, b,
                        function() {})
                } else {
                    if (x.rt == 0) {
                        Fai.top.location.href = "login.jsp?errno=-303"
                    }
                    setTimeout(function() {
                            if (b) {
                                Mobi.autoLogin(x.acct, d, b)
                            } else {
                                Fai.top.location.href = "login.jsp?errno=12"
                            }
                        },
                        3000)
                }
            } else {
                jm(".g_button").addClass("sendIcon");
                jm(".loginIcon ").hide();
                jm("#signupCaptchaImg").attr("src", "validateCode.jsp?" + Math.random() * 1000);
                jm("#memberSignupCaptcha").val("");
                if (x.rt == -401) {
                    Mobi.ing(LS.memberSignupRegisterCaptchaNotMatch);
                    if (x.needCode) {
                        jm(".J_memberSignupCaptcha").removeClass("memberSignupCaptchaHide")
                    }
                } else {
                    if (x.rt == -601) {
                        Mobi.ing(LS.reGetMobileCode)
                    } else {
                        if (x.rt == -8) {
                            Mobi.ing(LS.mobileHasSigned)
                        } else {
                            if (x.rt == -6) {
                                Mobi.ing(LS.memberSignupRegisterExisted)
                            } else {
                                if (x.rt == -4) {
                                    Mobi.ing(LS.memberSignupRegisterLimit)
                                } else {
                                    if (x.rt == -28) {
                                        Mobi.ing(LS.memberRegisterLimit)
                                    } else {
                                        if (x.rt == -20) {
                                            Mobi.ing(x.msg)
                                        } else {
                                            if (x.rt == -1001) {
                                                jm("#mobiIngTigs").remove();
                                                Mobi.showPluralPopup("email", x.headImg, x.name, x.acct, d, t, b)
                                            } else {
                                                if (x.rt == -1002) {
                                                    jm("#mobiIngTigs").remove();
                                                    Mobi.showPluralPopup("mobile", x.headImg, x.name, x.acct, d, t, b)
                                                } else {
                                                    Mobi.ing(LS.memberSignupRegisterError)
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (x.hasFW) {
                    Mobi.ing(x.msg)
                }
            }
        }
    })
};
Mobi.showPluralPopup = function(h, f, a, m, l, d, b) {
    var o = h == "email" ? LS.emailAcct: LS.mobileNum,
        n = h == "email" ? d.email: d.mobile,
        e = h == "email" ? "ajax/member_h.jsp?cmd=proceedAfterMail": "ajax/member_h.jsp?cmd=proceedAfterMobile";
    var k = Mobi.isNull(a) || a == "" || a == "null" ? m: a;
    var j = [];
    j.push("<div style='position: relative; top: -1.094rem; left: -.125rem; display: inline-block; width: 3.875rem; height: 3.875rem;'>");
    j.push("	<img src=" + f + " style='height: 3.875rem; width: 3.875rem; border-radius: 100%; border: .125rem #f2f2f2 solid;' />");
    j.push("</div>");
    j.push("<div style='font-size: .75rem; color: #333; position: relative; top: -.375rem;'>");
    j.push("	<span style='display: block; text-align: center;'>" + k + "</span>");
    j.push("	<span style='display: block; text-align: center; position: relative; top: .4rem'>" + jm.format(LS.alreadyHasAnAcct, o) + "</span>");
    j.push("</div>");
    var p = {
        textClass: "proceed",
        cancelClass: "loginInstantly",
        content: j.join(""),
        callback: function() {
            c()
        },
        cancelCallback: function() {
            Fai.top.location.href = "login.jsp"
        }
    };
    Mobi.prompt(p);
    function c() {
        var r = [];
        r.push("<div style='width: 2.5rem; height: 2.5rem; border-radius:50%; border: .125rem solid gray; position: relative; top: -.625rem; left: 4.0625rem; border-color: #F8BB86;'>");
        r.push("<div style='animation: pulseWarningIns 0.75s infinite alternate; -webkit-animation: pulseWarningIns 0.75s infinite alternate;'>");
        r.push("<span style='position: absolute; width: 0.15625rem; height: 1.46875rem; left: 50%; top: .3125rem; webkit-border-radius: .0625rem; border-radius: .0625rem; margin-left: -.0625rem; background-color: #F8BB86;'></span>");
        r.push("<span style='position: absolute; width: .21875rem; height: .21875rem; -webkit-border-radius: 50%; border-radius: 50%; margin-left: .09375rem; left: 42%; bottom: .3125rem; background-color: #F8BB86;'></span>");
        r.push("</div>");
        r.push("</div>");
        r.push("<div style='color: #333; font-size: .75rem; text-align:center;'>" + jm.format(LS.warningBeforeProceedRegistry, n) + "</div>");
        var q = {
            textClass: "confirm",
            content: r.join(""),
            callback: function() {
                jm.ajax({
                    type: "post",
                    url: e,
                    data: "info=" + jm.encodeUrl(jm.toJSON(d)),
                    error: function() {
                        Mobi.ing(LS.memberSignupRegisterError)
                    },
                    success: function(s) {
                        var t = jm.parseJSON(s);
                        if (t.success) {
                            if (t.active) {
                                Mobi.memberActive(d.email, t.acct, b,
                                    function() {})
                            } else {
                                if (t.rt == 0) {
                                    Fai.top.location.href = "login.jsp?errno=-303"
                                }
                                setTimeout(function() {
                                        if (b) {
                                            Mobi.autoLogin(m, l, b)
                                        } else {
                                            Fai.top.location.href = "login.jsp?errno=12"
                                        }
                                    },
                                    3000)
                            }
                        } else {
                            jm(".g_button").addClass("sendIcon");
                            jm(".loginIcon ").hide();
                            jm("#signupCaptchaImg").attr("src", "validateCode.jsp?" + Math.random() * 1000);
                            jm("#memberSignupCaptcha").val("");
                            if (t.rt == -401) {
                                Mobi.ing(LS.memberSignupRegisterCaptchaNotMatch);
                                if (t.needCode) {
                                    jm(".J_memberSignupCaptcha").removeClass("memberSignupCaptchaHide")
                                }
                            } else {
                                if (t.rt == -601) {
                                    Mobi.ing(LS.reGetMobileCode)
                                } else {
                                    if (t.rt == -8) {
                                        Mobi.ing(LS.mobileHasSigned)
                                    } else {
                                        if (t.rt == -6) {
                                            Mobi.ing(LS.memberSignupRegisterExisted)
                                        } else {
                                            if (t.rt == -4) {
                                                Mobi.ing(LS.memberSignupRegisterLimit)
                                            } else {
                                                if (t.rt == -28) {
                                                    Mobi.ing(LS.memberRegisterLimit)
                                                } else {
                                                    if (t.rt == -20) {
                                                        Mobi.ing(t.msg)
                                                    } else {
                                                        if (t.rt == -1001) {
                                                            Mobi.showPluralPopup("email", t.headImg, t.name, t.acct, l, d, b)
                                                        } else {
                                                            if (t.rt == -1002) {
                                                                Mobi.showPluralPopup("mobile", t.headImg, t.name, t.acct, l, d, b)
                                                            } else {
                                                                if (t.rt == -1500) {} else {
                                                                    Mobi.ing(LS.memberSignupRegisterError)
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            if (t.hasFW) {
                                Mobi.ing(t.msg)
                            }
                        }
                    }
                })
            }
        };
        Mobi.prompt(q)
    }
};
Mobi.getSignMobileCode = function(b) {
    var a = jm("#mobile").val();
    var c = jm("#mobileCt").val();
    var d = jm("#memberSignupCaptcha").val();
    if (!jm.isNationMobile(a)) {
        Mobi.ing(LS.mobileNumRegular);
        return
    }
    if (b) {
        if (d == null || d == "") {
            Mobi.ing(LS.memberSignupRegisterCaptchaEmpty);
            return
        }
    }
    info = {};
    info.mobile = a;
    info.mobileCt = c;
    info.captcha = d;
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=getMobileCode",
        data: "mobile=" + a + "&mobileCt=" + c + "&validateCode=" + d,
        error: function() {
            Mobi.ing(LS.getMobileCodeErrAf)
        },
        success: function(e) {
            var f = jm.parseJSON(e);
            if (f.success) {
                Mobi.ing(LS.sendMobileCodeSuc);
                Mobi.getSignMobileCodeCountDown()
            } else {
                if (f.needCode) {
                    jm(".J_memberSignupCaptcha").removeClass("memberSignupCaptchaHide")
                }
                Mobi.changeValidateCode(jm("#signupCaptchaImg"));
                jm("#memberSignupCaptcha").val("");
                if (f.rt == -401) {
                    Mobi.ing(LS.memberSignupRegisterCaptchaNotMatch)
                } else {
                    if (f.rt == -2) {
                        Mobi.ing(LS.argsError)
                    } else {
                        if (f.rt == 2) {
                            Mobi.ing(LS.memberDialogSendMobileCodeErr)
                        } else {
                            if (f.rt == -4 || f.rt == 8) {
                                Mobi.ing(LS.getMobileOneMin)
                            } else {
                                if (f.rt == -8) {
                                    Mobi.ing(LS.getMobileHalfHour)
                                } else {
                                    if (f.rt == 3) {
                                        Mobi.ing(LS.memberDialogMobileMoneyErr)
                                    } else {
                                        if (f.rt == 9) {
                                            Mobi.ing(LS.memberDialogSendMobileCodeLimit)
                                        } else {
                                            if (f.rt == 101) {
                                                Mobi.ing(LS.mobileSetErr)
                                            } else {
                                                if (f.rt == -6) {
                                                    Mobi.ing(LS.mobileHasSigned)
                                                } else {
                                                    if (f.rt == 23) {
                                                        Mobi.ing(LS.mobileNationTplErr)
                                                    } else {
                                                        if (f.rt == -1002) {} else {
                                                            Mobi.ing(LS.getMobileRefresh)
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    })
};
Mobi.getSignMobileCodeCountDown = function() {
    var d = jm("#messageAuthCodeClick");
    var c = d.attr("cTime");
    var e = 60;
    var b = "5.2rem";
    if (!c || c == null) {
        c = 0
    } else {
        b = "5.6rem";
        c = parseInt(c);
        e = 1800
    }
    c++;
    d.attr("cTime", c);
    d.attr("s_onclick", d.attr("onclick"));
    d.removeAttr("onclick");
    d.css("width", b);
    var a = setInterval(function() {
            e--;
            d.html(LS.reGetMsg + "(" + e + ")");
            if (e <= 0) {
                d.html(d.attr("title"));
                d.css("width", "4.2rem");
                d.attr("onclick", d.attr("s_onclick"));
                clearInterval(a)
            }
        },
        1000)
};
Mobi.mallBuyLoginCheck = function() {
    var a = localStorage.getItem("mallBuyCallBack");
    if ( !! a) {
        localStorage.removeItem("mallBuyCallBack");
        a = jm.parseJSON(a);
        a.login = true;
        localStorage.setItem("mallBuyCallBack", jm.toJSON(a))
    }
};
Mobi.autoLogin = function(c, b, a) {
    jm.ajax({
        type: "post",
        url: "ajax/login_h.jsp",
        data: "cmd=loginMember&acct=" + jm.encodeUrl(c) + "&pwd=" + jm.encodeUrl(jm.md5(b)),
        error: function() {
            Mobi.showMemberLoginMsg( - 1)
        },
        success: function(d) {
            var d = jm.parseJSON(d);
            if (d.success) {
                Mobi.mallBuyLoginCheck();
                Fai.top.location.href = a;
                return
            } else {
                Fai.top.location.href = "login.jsp?returnUrl=" + jm.encodeUrl(a)
            }
        }
    })
};
Mobi.memberActive = function(a, c, b) {
    jm.ajax({
        type: "post",
        url: "ajax/mail_h.jsp?cmd=sendMemberActiveMail",
        data: "memName=" + jm.encodeUrl(c) + "&memEmail=" + a,
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(d) {
            jm("#profileArea").hide();
            jm("#fillAcctInfo").hide();
            jm("#mSignUp").show();
            jm("#mSignUp .loginContent").hide();
            jm(".loginErrorLine").hide();
            var e = Mobi.getEmailCarriersAddress(a);
            jm("#checkEmail").html(jm.format(LS.memberSignupMailActivation, a));
            if (e != -1) {
                jm("#emailAddr").attr("href", e.addr);
                jm("#emailAddr").html(jm.format(LS.memberSignupMailActivationLink, e.name));
                jm("#emailAddr").show()
            }
            jm("#mobiIngTigs").remove()
        }
    })
};
Mobi.getEmailCarriersAddress = function(a) {
    var c = {};
    var b = a.split("@")[1];
    if (b === "qq.com" || b === "vip.qq.com" || b === "foxmail.com") {
        c.name = "QQ";
        c.addr = "https://w.mail.qq.com";
        return c
    } else {
        if (b === "163.com") {
            c.name = "163";
            c.addr = "http://smart.mail.163.com";
            return c
        } else {
            if (b === "126.com") {
                c.name = "126";
                c.addr = "http://smart.mail.126.com";
                return c
            } else {
                if (b === "sina.com" || b === "vip.sina.com") {
                    c.name = "sina";
                    c.addr = "http://mail.sina.com.cn";
                    return c
                } else {
                    return - 1
                }
            }
        }
    }
};
Mobi.showErrorMsg = function(a) {
    jm(".loginErrorLine").show();
    Mobi.ing(a)
};
Mobi.readBulletin = function() {
    var a = jm("#bulletinTitle"),
        b = jm("#bulletinTitle").attr("sessionMid");
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp",
        data: "cmd=setBulletinReadTime&id=" + b,
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(c) {
            var c = jm.parseJSON(c);
            if (c.success) {
                jm("#profile").hide();
                jm("#mBulletinConten").show();
                jm(a).removeClass("newsReminds");
                jm("#mBulletinConten img").each(function() {
                    var e = jm("#mBulletinConten p").width();
                    if (jm(this).attr("width") >= e) {
                        var d = jm(this).attr("height") / (jm(this).attr("width") / e);
                        jm(this).css({
                            height: d + "px",
                            width: e + "px"
                        })
                    }
                })
            } else {
                Mobi.ing(LS.systemError)
            }
        }
    })
};
Mobi.memberAddrInfoOpera = function(b, c, w, t) {
    var k = c,
        A = "",
        m = "",
        f = k.length,
        y = "",
        s = false;
    var a = {};
    site_cityUtil.initProvinces(w);
    jm("#editAddrInfo .g_close").click(function() {
        jm("#editAddrInfo").hide();
        jm("#addrInfoList").show()
    });
    jm("#addrInfoList .orderAddAddrInfo").click(function() {
        s = true;
        f = jm("#addrInfo .addrInfo").length;
        if (f < 6) {
            jm("#addrInfoList").hide();
            jm("#editAddrInfo").show();
            jm("#editAddrInfo").find(".propItemValue").each(function() {
                var J = jm(this).attr("proptype");
                if (J == 9) {
                    var I = jm(this).attr("id");
                    if (I != undefined && I != "") {
                        var H = I.replace("input", "") + "_endinput";
                        jm("#" + I).val("");
                        jm("#" + H).val("")
                    }
                }
                jm(this).val("")
            });
            A = "addAddr";
            y = "ajax/member_h.jsp?cmd=set&id=" + b
        } else {
            Mobi.ing(LS.mallAddrInfoAmountLimit, true)
        }
    });
    jm("#addrInfoList").delegate(".edit, .info_name", "click",
        function() {
            s = false;
            jm("#addrInfoList").hide();
            jm("#editAddrInfo").show();
            if (jm(this).attr("class") == "edit") {
                m = jm(this).attr("_index")
            } else {
                m = jm(this).parent().attr("_item")
            }
            A = "editAddr";
            y = "ajax/member_h.jsp?cmd=set&id=" + b;
            var H = k[m];
            jm("#editAddrInfo").find(".propItemValue").each(function() {
                var S = jm(this).attr("_field");
                var T = jm(this).attr("proptype");
                var U = jm(this).attr("id") || "";
                if (T == 9) {
                    var Q = H[S];
                    if (Q == undefined) {
                        Q = {}
                    }
                    var R = Q;
                    if (R.s == undefined) {
                        jm(this).val("")
                    } else {
                        jm(this).val(R.s)
                    }
                    var P = U.replace("input", "") + "_endinput";
                    if (R.e != undefined) {
                        jm("#" + P).val(R.e)
                    } else {
                        jm("#" + P).val("")
                    }
                } else {
                    jm(this).val(H[S])
                }
            });
            var O = H.addr_info;
            if (O != null) {
                var K = O.isCus;
                if (!K) {
                    var N = "";
                    var L = "";
                    var J = "";
                    var I = "";
                    if (w == 2052 || w == 1028) {
                        N = site_cityUtil.getInfo(O.streetCode).name;
                        L = site_cityUtil.getInfo(O.countyCode).name;
                        J = site_cityUtil.getInfo(O.cityCode).name;
                        I = site_cityUtil.getInfo(O.provinceCode).name
                    } else {
                        N = site_cityUtil.getInfoEn(O.streetCode).name;
                        L = site_cityUtil.getInfoEn(O.countyCode).name;
                        J = site_cityUtil.getInfoEn(O.cityCode).name;
                        I = site_cityUtil.getInfoEn(O.provinceCode).name
                    }
                    if (O.provinceCode == 990000) {
                        jm("#areaBoxInput").attr("isOs", 1);
                        jm("#allArea").val("os");
                        jm("#allArea").change()
                    } else {
                        jm("#areaBoxInput").attr("isCn", 1);
                        jm("#allArea").val("cn");
                        jm("#allArea").change()
                    }
                    jm("#areaBoxInput").attr("area1", O.provinceCode);
                    jm("#areaBoxInput").attr("area2", O.cityCode);
                    jm("#areaBoxInput").attr("area3", O.countyCode);
                    jm("#areaBoxInput").attr("area4", O.streetCode);
                    jm("#areaBox1 .group_item[pid='" + O.provinceCode + "']").click();
                    jm("#areaBox1 .group_item[cid='" + O.cityCode + "']").click();
                    jm("#areaBox1 .group_item[cid='" + O.countyCode + "']").click();
                    jm("#areaBox1 .group_item[cid='" + O.streetCode + "']").click()
                } else {
                    jm("#allArea").val(O.provinceCode);
                    jm("#allArea").change();
                    jm("#areaBox2 .group_item[cid='" + O.cityCode + "']").click();
                    jm("#areaBox2 .group_item[cid='" + O.countyCode + "']").click()
                }
                jm("#addrInfo_street").val(O.streetAddr)
            }
            var M = H.isDefault
        });
    jm("#addrInfoList").delegate(".selectedDiv label", "click",
        function() {
            A = "setDefault";
            var J = 0;
            if (k.length == 1) {
                return
            }
            m = jm(this).parents(".selectedArea").parent().attr("_item");
            var H = {};
            H.isDefault = 1;
            a.opera = A;
            a._item = m;
            a.addrInfo = H;
            c[m]["isDefault"] = H.isDefault;
            var I = this;
            jm.ajax({
                type: "post",
                url: "ajax/member_h.jsp?cmd=set&id=" + b,
                data: "info=" + jm.encodeUrl(jm.toJSON(a)),
                error: function() {
                    Mobi.ing(LS.memberProfileError)
                },
                success: function(K) {
                    var L = jm.parseJSON(K);
                    if (L.success) {
                        jm(".addrInfo").each(function() {
                            jm(this).find(".text").text(LS.mallSetDefault);
                            jm(this).find(".cutOut").css("display", "block");
                            k[jm(this).attr("_item")]["isDefault"] = 0
                        });
                        jm(I).find(".text").text(LS.mallDefault);
                        jm(I).parents(".addrInfo").find(".cutOut").css("display", "none");
                        k[m].isDefault = 1
                    } else {
                        Mobi.ing(L.msg)
                    }
                }
            })
        });
    jm("#g_body").append(jm("<div id='temBox' class='g_color'></div>"));
    var h = jm("#temBox");
    var e = h.css("color");
    jm("head").append("<style>.checkbox-comp:checked +.text:before{background-color:" + e + ";}</style>");
    jm("#g_body").children("#temBox").remove();
    var z = false;
    jm("#editAddrInfo").delegate(".orderSaveAddrInfo", "click",
        function() {
            if (z) {
                return
            }
            z = true;
            var T = true;
            var N = 0;
            if (k.length == 0) {
                N = 1
            } else {
                if (k[m]) {
                    N = k[m].isDefault
                }
            }
            var S = jm(this);
            var U = {};
            var I = {};
            var J = {};
            var X = "";
            var M = "";
            var L = "";
            var H = false;
            S.parent().find(".propItemValue").each(function() {
                X = jm(this).attr("_field");
                M = jm(this).val();
                L = jm(this).attr("_prop");
                propType = jm(this).attr("proptype");
                var ac = jm(this).attr("_required");
                id = jm(this).attr("id");
                H = (ac == "1" || ac == "true") ? true: false;
                if (H && (M == null || M == "")) {
                    Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, L));
                    this.focus();
                    T = false
                }
                if (propType == 8 || propType == 10) {
                    if (M.length > 0) {
                        if (!jm.isNationMobile(M)) {
                            msg = LS.mobileNumRegular;
                            Mobi.ing(msg);
                            this.focus();
                            T = false
                        }
                    }
                }
                if (propType == 3 || propType == 12) {
                    if (M.length > 0) {
                        if (!jm.isEmail(M)) {
                            msg = LS.mallStlSubmitInput2 + jm(this).attr("_prop");
                            Mobi.ing(msg);
                            this.focus();
                            T = false
                        }
                    }
                }
                var aa = {};
                if (propType == 9) {
                    if (M.length > 0) {
                        aa.s = M;
                        var Y = id.replace("input", "") + "_endinput";
                        var ab = S.parent().find("#" + Y);
                        if (ab.length > 0) {
                            var Z = ab.val();
                            if (Z == "") {
                                msg = LS.mallStlSubmitInput2 + jm(this).attr("_prop");
                                Mobi.ing(msg);
                                T = false
                            } else {
                                aa.e = Z
                            }
                        }
                    }
                    M = aa
                }
                I[X] = M
            });
            var R = !(jm("#allArea").val() == "os" || jm("#allArea").val() == "cn");
            var O = jm("#areaBoxInput").attr("area4");
            var K = jm("#areaBoxInput").attr("area3");
            var Q = jm("#areaBoxInput").attr("area2");
            var P = jm("#areaBoxInput").attr("area1");
            var W = jm("#addrInfo_street");
            H = S.parent().find("#addrInfo_street").attr("_required") == "1" ? true: false;
            if (H) {
                if (jm("#allArea").val() == null || jm("#allArea").val() == "") {
                    Mobi.ing("请选择地区", 1);
                    z = false;
                    return
                }
                if ((P == null || P == "") && !R) {
                    Mobi.ing("请选择省份", 1);
                    z = false;
                    return
                }
                if ((Q == null || Q == "") && !R) {
                    Mobi.ing("请选择城市", 1);
                    z = false;
                    return
                }
            }
            U.provinceCode = P;
            U.cityCode = Q;
            U.countyCode = K;
            U.streetCode = O;
            U.streetAddr = W.val();
            U.isCus = R;
            I.addr_info = U;
            var V = "";
            if (jm("#allArea").length == 1) {
                if (Fai.top._lcid == 2052 || Fai.top.lcid == 1028) {
                    V = jm("#areaBoxInput").val().replace(/-/g, "") + jm("#addrInfo_street").val();
                    if (U.provinceCode == 990000) {
                        V = V.replace(jm("div[pid='990000']").text() + jm("div[pid='990000']").text(), jm("div[pid='990000']").text())
                    }
                } else {
                    V = jm("#areaBoxInput").val().replace(/-/g, " ") + " " + jm("#addrInfo_street").val();
                    if (U.provinceCode == 990000) {
                        V = V.replace(jm("div[pid='990000']").text() + " " + jm("div[pid='990000']").text(), jm("div[pid='990000']").text())
                    }
                }
            }
            I.addr = V;
            I.isDefault = N;
            a.opera = A;
            a._item = m;
            a.addrInfo = I;
            if (T) {
                jm.ajax({
                    type: "post",
                    url: y,
                    data: "info=" + jm.encodeUrl(jm.toJSON(a)),
                    error: function() {
                        Mobi.ing(LS.memberProfileError)
                    },
                    complete: function() {
                        z = false
                    },
                    success: function(Z) {
                        var ac = jm.parseJSON(Z);
                        if (ac.success) {
                            var aa = I.name || "";
                            var Y = I.mobile || "";
                            var ae = I.addr || "";
                            if (aa == "" || Y == "" || ae == "") {
                                jm("#editAddrInfo").find(".propItemValue").each(function() {
                                    var ah = jm(this).attr("_field");
                                    if (ah != null && ah != "addrDetail") {
                                        var ai = jm(this).attr("proptype");
                                        var aj = jm(this).attr("id") || "";
                                        var af = I[ah];
                                        if (ai != 2 && ai != 4 && ai != 7 && ai != 8) {
                                            if (ai == 9) {
                                                if (af == "" || af == undefined) {
                                                    af = {}
                                                }
                                                var ag = af;
                                                if (ag.s != undefined) {
                                                    af = ag.s;
                                                    if (ag.e != undefined) {
                                                        af += LS.to + ag.e
                                                    }
                                                } else {
                                                    af = ""
                                                }
                                            }
                                            if (aa == undefined || aa == "") {
                                                aa = af
                                            } else {
                                                if (Y == undefined || Y == "") {
                                                    Y = af
                                                } else {
                                                    if (ae == undefined || ae == "") {
                                                        ae = af
                                                    }
                                                }
                                            }
                                        }
                                    }
                                })
                            }
                            if (A == "editAddr") {
                                if (N) {
                                    jm("#addrInfoList").find(".addrInfo").each(function() {
                                        if (jm(this).find(".cutOut").attr("display") != "block") {
                                            k[jm(this).attr("_item")]["isDefault"] = 0
                                        }
                                        if (jm(this).attr("_item") == m) {
                                            jm(this).find(".name").text(aa);
                                            jm(this).find(".phone").text(Y);
                                            jm(this).find("#addr").text(ae);
                                            addrInfo = jm(this)
                                        }
                                    })
                                } else {
                                    jm("#addrInfoList").find(".addrInfo").each(function() {
                                        if (jm(this).attr("_item") == m) {
                                            jm(this).find(".name").text(aa);
                                            jm(this).find(".phone").text(Y);
                                            jm(this).find("#addr").text(ae)
                                        }
                                    })
                                }
                                k.splice(m, 1, I);
                                jm("#editAddrInfo").hide();
                                jm("#addrInfoList").show()
                            } else {
                                if (A == "addAddr") {
                                    if (N) {
                                        jm("#addrInfoList").find(".addrInfo").each(function() {
                                            if (jm(this).find(".cutOut").attr("display") != "block") {
                                                k[jm(this).attr("_item")]["isDefault"] = 0
                                            }
                                        })
                                    }
                                    var ad = k.length;
                                    var ab = [];
                                    ab.push("<div class='addrInfo' _item=" + ad + ">");
                                    ab.push("<div class='" + (N ? "": "middle") + " info_name' style='width:100%;'>");
                                    ab.push("<div class='nameAndPhone'><span class='name'>" + aa + "</span><span class='phone'>" + Y + "</span></div><div class='address'><span id='addr'>" + ae + "</span></div>");
                                    ab.push("</div>");
                                    ab.push("<div class='selectedArea'>");
                                    ab.push("<div class='left'>");
                                    ab.push("<div class='selectedDiv'><label for='input" + ad + "'><input type='radio' class='checkbox-comp' id='input" + ad + "' name='defaultLogo'><span class='text'>设为默认</span></label></div>");
                                    ab.push("</div>");
                                    ab.push("<div class='right'>");
                                    ab.push("<div class='edit' _index=" + ad + "><span>编辑</span></div><div class='cutOut'><span>删除</span></div>");
                                    ab.push("</div>");
                                    ab.push("</div>");
                                    ab.push("</div>");
                                    jm("#addrInfo").append(ab.join(""));
                                    k.push(I);
                                    jm("#editAddrInfo").hide();
                                    jm("#addrInfoList").show()
                                }
                            }
                        } else {
                            z = false;
                            Mobi.ing(ac.msg)
                        }
                    }
                })
            }
        });
    jm("#addrInfo").delegate(".cutOut", "click",
        function() {
            var J = jm(this);
            m = J.parents(".selectedArea").parent().attr("_item");
            a.opera = "delAddr";
            a._item = m;
            var H = function(L, K) {
                jm.ajax({
                    type: "post",
                    url: "ajax/member_h.jsp?cmd=set&id=" + L,
                    data: "info=" + jm.encodeUrl(jm.toJSON(a)),
                    error: function() {
                        Mobi.ing(LS.systemError)
                    },
                    success: function(M) {
                        var O = jm.parseJSON(M);
                        if (O.success) {
                            jm("#mobiPrompt").remove();
                            jm("#mobiPrompt_Bg").remove();
                            var N = 0;
                            jm("#addrInfoList").find(".addrInfo").each(function() {
                                if (jm(this).attr("_item") == K) {
                                    jm(this).remove()
                                } else {
                                    jm(this).attr("_item", N);
                                    N++
                                }
                            });
                            f--;
                            k.splice(K, 1)
                        } else {
                            Mobi.ing(O.msg)
                        }
                    }
                })
            };
            var I = {
                textClass: "confirm",
                content: "确定要删除该收货人信息吗？",
                callback: function() {
                    H(b, m)
                }
            };
            Mobi.prompt(I)
        });
    var v = LS.mallPleaseChoose,
        E = [],
        n,
        F,
        r,
        C,
        G,
        q,
        D;
    var o = Mobi.initWebPage({
        triggerId: "areaBoxInput",
        panelId: "areaBox",
        pageBg: true,
        returnSeltFun: true,
        direction: "bottom",
        closeWebPage: "#areaBoxClose"
    });
    jm("#areaBox").unbind("click").bind("click",
        function(I) {
            var H = I.target.className;
            if (!H) {
                return
            }
            if (jm.inArray("areaBox", H.split(" ")) >= 0) {
                jm("#areaBoxClose").click();
                jm("#areaBox1").hide();
                jm("#areaBox2").hide()
            }
        });
    var p = "";
    jm.each(site_cityUtil.getAreaGroupsPinYin(),
        function(H, I) {
            p += "<div class='pv_group' style='" + (I[0] == "OS" ? "display:none;": "") + "'>";
            p += "<div class='group_head'>" + I[0] + "</div>";
            p += "<div class='group_content'>";
            jm.each(I[1],
                function(K, J) {
                    if (w == 2052 || w == 1028) {
                        p += "<div class='group_item' pid='" + J + "' pname='" + site_cityUtil.getInfo(J).name + "'>" + site_cityUtil.simpleProvinceNameStr(site_cityUtil.getInfo(J).name) + "</div>"
                    } else {
                        p += "<div class='group_item' pid='" + J + "' pname='" + site_cityUtil.getInfoEn(J).name + "'>" + site_cityUtil.simpleProvinceNameStrEn(site_cityUtil.getInfoEn(J).name) + "</div>"
                    }
                });
            p += "</div>";
            p += "</div>"
        });
    jm("#areaBox1 .pv_content").html("").append(p);
    jm("#allArea").change(function() {
        if (jm("#allArea").val() == null || jm("#allArea").val() == "" || jm("#allArea").val() == "os") {
            jm("#areaBoxInput").parent(".edit_line").hide();
            jm("#areaBox1").hide();
            jm("#areaBox2").hide()
        } else {
            jm("#areaBoxInput").parent(".edit_line").show()
        }
        jm("#areaBoxInput").attr("isCn", 0);
        jm("#areaBoxInput").attr("isCus", 0);
        jm("#areaBoxInput").attr("isOs", 0);
        jm("#areaBoxInput").attr("area1", "");
        jm("#areaBoxInput").attr("area2", "");
        jm("#areaBoxInput").attr("area3", "");
        jm("#areaBoxInput").attr("area4", "");
        if (jm("#allArea").val() == "cn") {
            jm("#areaBoxInput").attr("isCn", 1);
            jm("#areaBox1 .pv").click();
            jm("#areaBox1 .city_content").remove();
            jm("#areaBox1 .county_content").remove();
            jm("#areaBox1 .street_content").remove();
            jm("#areaBoxInput").val("")
        } else {
            if (jm("#allArea").val() == "os") {
                jm("#areaBoxInput").attr("isOs", 1);
                jm("#areaBoxInput").attr("area1", 990000);
                jm("#areaBoxInput").attr("area2", 990100);
                jm("#areaBoxInput").val(jm("#areaBox1").find(".group_item[pid='990000']").text())
            } else {
                jm("#areaBoxInput").attr("isCus", 1);
                jm("#areaBoxInput").attr("area1", jm("#allArea").val());
                jm("#areaBox2 .sec_content").html("");
                jm("#areaBox2 .thd_content").html("");
                jm("#areaBoxInput").val("")
            }
        }
        if (jm("#allArea").val() == "cn" || jm("#allArea").val() == "os") {
            jm(".J_ssq").show();
            jm(".J_administrativeRegion").hide()
        } else {
            var H = d(jm("#allArea").val());
            jm("#sec_box .sec_content").append(H);
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + jm("#allArea option[value='" + jm("#allArea").val() + "']").text());
            jm(".J_ssq").hide();
            jm(".J_administrativeRegion").show();
            if (H === null || H === undefined || H === "") {
                jm("#areaBoxInput").parents(".edit_line").hide()
            }
        }
    });
    jm("#areaBoxInput").unbind("click").bind("click",
        function() {
            if (jm("#allArea").val() == "cn") {
                o();
                jm("#areaBox1").toggle();
                jm("#areaBox2").hide();
                jm("#areaBox1 .J_areaHead .pv").click()
            } else {
                if (jm("#allArea").val() == null || jm("#allArea").val() == "os") {} else {
                    o();
                    jm("#areaBox2").toggle();
                    jm("#areaBox1").hide();
                    jm("#areaBox2 .J_areaHead2 .sec").click()
                }
            }
            document.getElementById("areaBoxInput").blur()
        });
    jm("#areaBox1 .J_areaHead .pv").click(function() {
        jm("#province_box").show();
        jm("#city_box").hide();
        jm("#county_box").hide();
        jm("#street_box").hide()
    });
    jm("#areaBox1 .J_areaHead .city").click(function() {
        jm("#province_box").hide();
        jm("#city_box").show();
        jm("#county_box").hide();
        jm("#street_box").hide()
    });
    jm("#areaBox1 .J_areaHead .county").click(function() {
        jm("#province_box").hide();
        jm("#city_box").hide();
        jm("#county_box").show();
        jm("#street_box").hide()
    });
    jm("#areaBox1 .J_areaHead .street").click(function() {
        jm("#province_box").hide();
        jm("#city_box").hide();
        jm("#county_box").hide();
        jm("#street_box").show()
    });
    jm("#areaBox2 .J_areaHead2 .sec").click(function() {
        jm("#sec_box").show();
        jm("#thd_box").hide()
    });
    jm("#areaBox2 .J_areaHead2 .thd").click(function() {
        jm("#sec_box").hide();
        jm("#thd_box").show()
    });
    jm("#province_box .group_item").bind("click",
        function() {
            jm("#areaBox1 .city_content").remove();
            jm("#areaBox1 .county_content").remove();
            var H = jm(this).attr("pname");
            var I = jm(this).attr("pid");
            jm("#areaBox1 .J_areaHead .city").click();
            jm("#areaBoxInput").val("");
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + H);
            jm("#areaBoxInput").removeAttr("lastArea");
            jm("#areaBoxInput").removeAttr("lastAreaType");
            jm("#areaBoxInput").attr("area1", I);
            jm("#areaBoxInput").attr("area2", "");
            jm("#areaBoxInput").attr("area3", "");
            jm("#areaBoxInput").attr("area4", "");
            var K = "";
            if (w == 2052 || w == 1028) {
                K = u(site_cityUtil.getCities(I))
            } else {
                K = u(site_cityUtil.getCitiesEn(I))
            }
            var J = jm(K).html();
            if (J === null || J === undefined || J === "") {
                jm("#areaBox1").hide();
                jm("#areaBoxClose").click()
            }
            jm("#city_box").append(K)
        });
    jm("#city_box").delegate(".group_item", "click",
        function() {
            jm("#areaBox1 .county_content").remove();
            var H = jm(this).attr("cname");
            var J = jm(this).attr("cid");
            jm("#areaBox1 .J_areaHead .county").click();
            var M = jm("#areaBoxInput").attr("lastArea");
            var I = jm("#areaBoxInput").attr("lastAreaType");
            if (I != null && I != "") {
                jm("#areaBoxInput").val(jm("#areaBoxInput").val().substring(0, jm("#areaBoxInput").val().indexOf("-")))
            }
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + "-" + H);
            jm("#areaBoxInput").attr("lastArea", "-" + H);
            jm("#areaBoxInput").attr("lastAreaType", "city");
            jm("#areaBoxInput").attr("area2", J);
            jm("#areaBoxInput").attr("area3", "");
            jm("#areaBoxInput").attr("area4", "");
            var L = "";
            if (w == 2052 || w == 1028) {
                L = l(site_cityUtil.getCounty(J))
            } else {
                L = l(site_cityUtil.getCountyEn(J))
            }
            var K = jm(L).html();
            if (K === null || K === undefined || K === "") {
                jm("#areaBox1").hide();
                jm("#areaBoxClose").click()
            }
            jm("#county_box").append(L)
        });
    jm("#county_box").delegate(".group_item", "click",
        function() {
            jm("#areaBox1 .street_content").remove();
            var I = jm(this).attr("cname");
            var K = jm(this).attr("cid");
            var M = jm("#areaBoxInput").attr("lastArea");
            var J = jm("#areaBoxInput").attr("lastAreaType");
            jm("#areaBox1 .J_areaHead .street").click();
            if (J != null && (J == "street" || J == "county")) {
                jm("#areaBoxInput").val(jm("#areaBoxInput").val().substring(0, jm("#areaBoxInput").val().indexOf("-", jm("#areaBoxInput").val().indexOf("-") + 1)))
            }
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + "-" + I);
            jm("#areaBoxInput").attr("lastArea", "-" + I);
            jm("#areaBoxInput").attr("lastAreaType", "county");
            jm("#areaBoxInput").attr("area3", K);
            jm("#areaBoxInput").attr("area4", "");
            var H = "";
            if (w == 2052 || w == 1028) {
                H = x(site_cityUtil.getStreet(K))
            } else {
                H = x(site_cityUtil.getStreetEn(K))
            }
            var L = jm(H).html();
            if (L === null || L === undefined || L === "") {
                jm("#areaBox1").hide();
                jm("#areaBoxClose").click()
            }
            jm("#street_box").append(H)
        });
    jm("#street_box").delegate(".group_item", "click",
        function() {
            var H = jm(this).attr("cname");
            var J = jm(this).attr("cid");
            var K = jm("#areaBoxInput").attr("lastArea");
            var I = jm("#areaBoxInput").attr("lastAreaType");
            if (I != null && I == "street") {
                jm("#areaBoxInput").val(jm("#areaBoxInput").val().replace(K, ""))
            }
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + "-" + H);
            jm("#areaBoxInput").attr("lastArea", "-" + H);
            jm("#areaBoxInput").attr("lastAreaType", "street");
            jm("#areaBoxInput").attr("area4", J);
            jm("#areaBox1").hide();
            jm("#areaBoxClose").click()
        });
    jm("#sec_box").delegate(".group_item", "click",
        function() {
            jm("#areaBox2 .thd_content").html("");
            var H = jm(this).attr("cname");
            var J = jm(this).attr("cid");
            jm("#areaBox2 .J_areaHead2 .thd").click();
            var L = jm("#areaBoxInput").attr("lastArea");
            var I = jm("#areaBoxInput").attr("lastAreaType");
            if (I != null && I != "" && jm("#areaBoxInput").val().indexOf("-") != -1) {
                jm("#areaBoxInput").val(jm("#areaBoxInput").val().substring(0, jm("#areaBoxInput").val().indexOf("-")))
            }
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + "-" + H);
            jm("#areaBoxInput").attr("lastArea", "-" + H);
            jm("#areaBoxInput").attr("lastAreaType", "sec");
            jm("#areaBoxInput").attr("area2", J);
            jm("#areaBoxInput").attr("area3", "");
            var K = d(J);
            if (K === null || K === undefined || K === "") {
                jm("#areaBox2").hide();
                jm("#areaBoxClose").click()
            }
            jm("#thd_box .thd_content").append(K)
        });
    jm("#thd_box").delegate(".group_item", "click",
        function() {
            var H = jm(this).attr("cname");
            var J = jm(this).attr("cid");
            var K = jm("#areaBoxInput").attr("lastArea");
            var I = jm("#areaBoxInput").attr("lastAreaType");
            if (I != null && I == "thd") {
                jm("#areaBoxInput").val(jm("#areaBoxInput").val().replace(K, ""))
            }
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + "-" + H);
            jm("#areaBoxInput").attr("lastArea", "-" + H);
            jm("#areaBoxInput").attr("lastAreaType", "thd");
            jm("#areaBoxInput").attr("area3", J);
            jm("#areaBox2").hide();
            jm("#areaBoxClose").click()
        });
    function u(I) {
        var H = "";
        H += "<div class='city_content'>";
        jm.each(I,
            function(J, K) {
                if (w == 2052 || w == 1028) {
                    H += "<div class='group_item' cid='" + K.id + "' cname='" + site_cityUtil.getInfo(K.id).name + "'>" + site_cityUtil.simpleCityNameStr(site_cityUtil.getInfo(K.id).name) + "</div>"
                } else {
                    H += "<div class='group_item' cid='" + K.id + "' cname='" + site_cityUtil.getInfoEn(K.id).name + "'>" + site_cityUtil.simpleCityNameStrEn(site_cityUtil.getInfoEn(K.id).name) + "</div>"
                }
            });
        H += "</div>";
        return H
    }
    function l(I) {
        var H = "";
        H += "<div class='county_content'>";
        jm.each(I,
            function(J, K) {
                if (w == 2052 || w == 1028) {
                    H += "<div class='group_item' cid='" + K.id + "' cname='" + site_cityUtil.getInfo(K.id).name + "'>" + site_cityUtil.getInfo(K.id).name + "</div>"
                } else {
                    H += "<div class='group_item' cid='" + K.id + "' cname='" + site_cityUtil.getInfoEn(K.id).name + "'>" + site_cityUtil.getInfoEn(K.id).name + "</div>"
                }
            });
        H += "</div>";
        return H
    }
    function x(I) {
        var H = "";
        H += "<div class='street_content'>";
        jm.each(I,
            function(J, K) {
                if (w == 2052 || w == 1028) {
                    H += "<div class='group_item' cid='" + K.id + "' cname='" + site_cityUtil.getInfo(K.id).name + "'>" + site_cityUtil.getInfo(K.id).name + "</div>"
                } else {
                    H += "<div class='group_item' cid='" + K.id + "' cname='" + site_cityUtil.getInfoEn(K.id).name + "'>" + site_cityUtil.getInfoEn(K.id).name + "</div>"
                }
            });
        H += "</div>";
        return H
    }
    function j(I) {
        var H = "";
        var J = false;
        jm.each(t,
            function(K, L) {
                if (J) {
                    return
                }
                if (L.id == I) {
                    H = L.name;
                    J = true
                }
            });
        return H
    }
    function B(I) {
        var H = [];
        jm.each(t,
            function(J, K) {
                if (K.parentId == I) {
                    H.push(K)
                }
            });
        return H
    }
    function d(H) {
        if (isNaN(H)) {
            return ""
        }
        var J = parseInt(H);
        var I = "";
        jm.each(B(J),
            function(K, L) {
                I += "<div class='group_item' cid='" + L.id + "' cname='" + L.name + "'>" + L.name + "</div>"
            });
        return I
    }
};
Mobi.modifyListener = function(c, b) {
    if (Fai.top._manageMode) {
        return
    }
    jm(".modifyArea li").click(function() {
        if (jm(this).attr("orderlist") === "0") {
            return
        }
        if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
            jm(".form .loginHeader").show();
            jm(".form .loginHeader .icon-gClose").off("click.gc").on("click.gc",
                function() {
                    jm(".form .loginHeader").hide()
                })
        }
        if (jm(this).attr("orderlist") === "1") {
            Mobi.readBulletin();
            return
        }
        var e = jm(this).find(".itemName").html();
        if (jm(this).attr("id") === "password") {
            jm("#profile").hide();
            jm("#modifyPsw").show()
        } else {
            if (jm(this).attr("id") === "consigneeInfo") {
                jm("#addrInfoList").find(".title").html(e);
                jm("#profile").hide();
                jm("#addrInfoList").show()
            } else {
                if (jm(this).attr("id") === "personalInfo") {
                    jm("#modifyPersInfo").find(".title").html(e);
                    jm("#profile").hide();
                    jm("#modifyPersInfo").show()
                } else {
                    if (jm(this).attr("id") === "cutPrice") {
                        jm("#modifyCutPrice").find(".title").html(e);
                        jm("#profile").hide();
                        jm("#modifyCutPrice").show()
                    } else {
                        if (jm(this).attr("id") === "promoter") {
                            jm("#modifyPromoter").find(".title").html(e);
                            jm("#profile").hide();
                            jm("#modifyPromoter").show()
                        } else {
                            if (jm(this).attr("id") === "integral") {
                                jm("#modifyIntegral").find(".title").html(e);
                                jm("#profile").hide();
                                jm("#modifyIntegral").show()
                            } else {
                                if (jm(this).attr("id") === "collection") {
                                    jm("#modifyCollection").find(".title").html(e);
                                    jm("#profile").hide();
                                    jm("#modifyCollection").show()
                                } else {
                                    if (jm(this).attr("id") === "coupon") {
                                        jm("#modifyCoupon").find(".title").html(e);
                                        jm("#profile").hide();
                                        jm("#modifyCoupon").show()
                                    } else {
                                        if (jm(this).attr("id") === "changeOtherLoginAcct") {
                                            return
                                        } else {
                                            var d = jm(this).find(".itemText").html();
                                            jm("#profile").hide();
                                            jm("#modifyProfile").show();
                                            jm("#modifyProfile").find(".title").html(e);
                                            jm("#profileValue").val(jm.decodeHtml(d));
                                            jm("#profileValue").attr("name", jm(this).attr("id"));
                                            jm("#profileValue").attr("ismust", jm(this).attr("ismust"))
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    });
    var a = new Mobi.memberHeadPic(c, b);
    a.init()
};
Mobi.persInfoChangeMobileCt = function() {
    var b = jm("#modifyPersInfo #mobileCt").val();
    var a = jm("#modifyPersInfo #mobileCt").find("option[value='" + b + "']").html();
    jm("#modifyPersInfo .mobileCtVal").html(a.substring(a.indexOf("+")))
};
Mobi.profileLogout = function(a) {
    var b = Mobi.getPreviewWindow().location.href;
    var d = Mobi.getUrlParam(b, "returnUrl");
    if (!d) {
        d = a
    }
    var c = {
        textClass: "confirm",
        content: LS.onLogout,
        callback: function() {
            Mobi.onLogout("login.jsp?returnUrl=" + jm.encodeUrl(d))
        }
    };
    Mobi.prompt(c)
};
Mobi.loadPdCollectionList = function(b, a) {
    this.pIdList = a;
    this.mid = b;
    this.panel = jm("#modifyCollection")
}; (function(r, m, c) {
    var h = m.prototype,
        s, d, j, l = [],
        t = 10,
        a,
        b = [];
    h.init = function() {
        d = this.pIdList,
            j = this.panel;
        s = this.mid;
        if (d.length == 0) {
            f();
            return
        }
        p();
        var w = d.slice(0, t);
        a = w.length;
        o(w);
        e()
    };
    function f() {
        if (d.length == 0) {
            j.find(".profileContent").html("<div class='noCollIcon'></div><div class='noCollTip'>" + LS.notCollect + "</div>")
        }
    }
    function p() {
        r.post("ajax/product_h.jsp", {
                mid: s,
                cmd: "updateCollections",
                ids: r.toJSON(d)
            },
            function(w) {
                if (w.success) {
                    d = w.list
                }
            },
            "json")
    }
    function o(w) {
        r.ajax({
            url: "ajax/product_h.jsp",
            data: {
                cmd: "batchGetPd",
                ids: r.toJSON(w)
            },
            async: false,
            type: "POST",
            dataType: "json",
            success: function(x) {
                if (x.success) {
                    n(w, x.list)
                }
            }
        })
    }
    function u(x) {
        var w = false,
            y;
        r.each(b,
            function(z, A) {
                if (x == A.lid) {
                    w = true;
                    y = A
                }
            });
        if (!w) {
            y = k(x)
        }
        return y
    }
    function k(w) {
        var x = {
            lid: w
        };
        r.ajax({
            url: "ajax/productProp_h.jsp?cmd=list&lid=" + w,
            async: false,
            type: "POST",
            dataType: "json",
            success: function(y) {
                if (y.success) {
                    var z = false;
                    r.each(y.list,
                        function(A, B) {
                            if (B.fieldKey == "mallPrice") {
                                z = true
                            }
                        });
                    x.showPrice = z;
                    b.push(x)
                }
            }
        });
        return x
    }
    function v() {
        var x = {},
            w = false;
        x.productCollections = d.reverse() + "";
        r.ajax({
            url: "ajax/member_h.jsp",
            data: {
                cmd: "set",
                id: s,
                info: r.toJSON(x)
            },
            async: false,
            type: "POST",
            dataType: "json",
            success: function(y) {
                if (y.success) {
                    w = true
                } else {
                    w = false
                }
            }
        });
        return w
    }
    function n(w, x) {
        var y = [];
        r.each(x,
            function(z, B) {
                var A = u(B.lid);
                y.push("<li>");
                y.push('  <div class="pdImg">');
                y.push('      <a href="javascript:;" _href="pd.jsp?pid=' + B.id + '&returnUrl=profile.jsp">');
                y.push('          <img src="' + B.picPath + '" />');
                y.push("      </a>");
                y.push("  </div>  ");
                y.push('  <div class="pdName">' + B.name + "</div>");
                if (B.mallPrice != -1 && A.showPrice) {
                    y.push('  <div class="pdPrice"><div class="mallPrice">￥ ' + B.mallPrice + "</div></div>")
                }
                y.push('  <div class="cancelCollection" data-id="' + B.id + '">' + LS.cancelCollect + "</div>");
                y.push("</li>")
            });
        j.find(".collectionList").append(y.join(""))
    }
    function q() {
        j.find(".collectionList li img[_src]").each(function() {
            var x = r(this).attr("_src");
            var w = new Image();
            w.src = x;
            r(this).attr("_src", "");
            r(this).attr("src", x)
        })
    }
    function e() {
        Mobi.onTouchAndClickEvent(".cancelCollection",
            function(z) {
                var x = $(this);
                var y = {
                    textClass: "confirm",
                    content: LS.sureCancelCollect,
                    callback: function() {
                        var B = x.attr("data-id");
                        var C = d.indexOf(Number(B));
                        if (C > -1) {
                            d.splice(C, 1)
                        }
                        if (v()) {
                            a--;
                            x.parents("li").remove()
                        }
                        if (j.find(".collectionList li").length < 6 && d.length > a) {
                            var A = d.slice(a, a + t);
                            a = a + A.length;
                            if (A.length > 0) {
                                o(A)
                            }
                        }
                        f();
                        r("#mobiPrompt").remove();
                        r("#mobiPrompt_Bg").remove()
                    }
                };
                Mobi.prompt(y)
            });
        Mobi.onTouchAndClickEvent(".pdName,.pdPrice,.pdImg",
            function(y) {
                var x = r(this).parent().find("a").attr("_href");
                location.href = x;
                r.setCookie("_fromCollect", true)
            });
        r(window).on("scroll",
            function() {
                if (d.length > a) {
                    var y = Math.max(document.body.scrollHeight, document.documentElement.scrollHeight);
                    if (r(window)[0].scrollY + r(window).height() + 100 >= y) {
                        var x = d.slice(a, a + t);
                        a = a + x.length;
                        if (x.length > 0) {
                            o(x)
                        }
                    }
                }
            });
        if (r.getCookie("_openCollect")) {
            var w = r("#collection").find(".itemName").html();
            r("#modifyCollection").find(".title").html(w);
            r("#profile").hide();
            r("#modifyCollection").show();
            r.setCookie("_openCollect", "", -1)
        }
    }
})(jm, Mobi.loadPdCollectionList);
Mobi.loadCutPriceList = function(b) {
    if (b <= 0) {
        location.href = "login.jsp?errno=11"
    }
    jm.ajax({
        url: "ajax/cutPrice_h.jsp?cmd=getCutPriceByMid",
        data: "mid=" + b,
        success: function(h) {
            h = jm.parseJSON(h);
            var j = jm.parseJSON(h.all),
                f = jm.parseJSON(h.ongoing),
                k = jm.parseJSON(h.ended);
            d(j, f, k)
        }
    });
    var a = jm(".cutPriceListPanel");
    function d(h, f, k) {
        var j = "<div class='cpPanelHeader'>";
        j += "    <div class='cpPanelText'>";
        j += "        <div class='cpPanelChoose' id='cpAllHeader'>全部</div>";
        j += "        <div class='cpPanelChoose' id='cpOngoingHeader'>进行中</div>";
        j += "        <div class='cpPanelChoose' id='cpEndedHeader'>已结束</div>";
        j += "    </div>";
        j += "    <div class='cpUnderline g_bgColor'></div>";
        j += "</div>";
        a.append(j);
        c(h, f, k);
        jm("#cpAllHeader").click(function() {
            jm(".cpUnderline").css("left", "1.55rem");
            jm(".cpList").hide();
            jm("#cpAll").show()
        });
        jm("#cpOngoingHeader").click(function() {
            jm(".cpUnderline").css("left", "6.8rem");
            jm(".cpList").hide();
            jm("#cpOngoing").show()
        });
        jm("#cpEndedHeader").click(function() {
            jm(".cpUnderline").css("left", "12.2rem");
            jm(".cpList").hide();
            jm("#cpEnded").show()
        })
    }
    function c(h, f, k) {
        var j = "<div class='cpListContent'>";
        j += "    <div class='cpList' id='cpAll' style='display: block;'><div class='cpEmpty'><div class='cpEmptyIcon'></div><div class='cpEmptyText'>你还没有砍价记录哦~</div></div></div>";
        j += "    <div class='cpList' id='cpOngoing' style='display: none;'><div class='cpEmpty'><div class='cpEmptyIcon'></div><div class='cpEmptyText'>你还没有砍价记录哦~</div></div></div>";
        j += "    <div class='cpList' id='cpEnded' style='display: none;'><div class='cpEmpty'><div class='cpEmptyIcon'></div><div class='cpEmptyText'>你还没有砍价记录哦~</div></div></div>";
        j += "</div>";
        a.append(j);
        if (h.length != 0) {
            jm("#cpAll").empty();
            var j = "";
            jm(h).each(function() {
                var l = e(this);
                j += l
            });
            jm("#cpAll").append(j)
        }
        if (f.length != 0) {
            jm("#cpOngoing").empty();
            var j = "";
            jm(f).each(function() {
                var l = e(this);
                j += l
            });
            jm("#cpOngoing").append(j)
        }
        if (k.length != 0) {
            jm("#cpEnded").empty();
            var j = "";
            jm(k).each(function() {
                var l = e(this);
                j += l
            });
            jm("#cpEnded").append(j)
        }
    }
    function e(m) {
        var l = "<div class='cpRecord' onclick='Mobi.jumpToCutPriceDetail(" + m.cutPriceId + ", " + m.id + ", " + m.pdChoice.pid + ")'>";
        if (m.status == 1) {
            l += "   <div class='cpStatusIcon cpSucc'></div>"
        } else {
            if (m.status == 2) {
                l += "   <div class='cpStatusIcon cpFail'></div>"
            }
        }
        l += "    <div class='cpPdImg' style='background-image: url(" + m.productInfo.picPath + "); background-size: cover; background-repeat: no-repeat;'></div>";
        l += "    <div class='cpDetail'>";
        l += "        <div class='cpPdName'>" + jm.encodeHtml(m.productInfo.name) + "</div>";
        var n = m.cutPriceInfo.pdList;
        var f = 0;
        jm(n).each(function() {
            if (this.i == m.pdChoice.pid) {
                f = this.p
            }
        });
        var k = (f - m.currentPrice) / (f - m.cutPriceInfo.minPrice);
        var j = 356 * k;
        var h = j / 40;
        l += "        <div class='cpPro'>";
        if (m.status == 2) {
            l += "        <div class='cpRecProBar' style='background-color: #f2f2f2; opacity: 1;'></div>";
            l += "        <div class='cpActualRecProBar' style='width: " + h + "rem; background-color: #ddd; opacity: 1;'></div>"
        } else {
            l += "        <div class='cpRecProBar g_bgColor'></div>";
            l += "        <div class='cpActualRecProBar g_bgColor' style='width: " + h + "rem;'></div>"
        }
        l += "        </div>";
        l += "        <div class='cpCurPrice'>已砍至" + Fai.top.choiceCurrencyVal + m.currentPrice.toFixed(2) + "</div>";
        l += "        <div class='cpPrice'>";
        l += "            <div class='cpMinPriceTxt'>底价：</div>";
        l += "            <div class='cpMinPriceVal g_mainColor'>" + Fai.top.choiceCurrencyVal + m.cutPriceInfo.minPrice.toFixed(2) + "</div>";
        l += "        </div>";
        l += "    </div>";
        l += "</div>";
        return l
    }
};
Mobi.jumpToCutPriceDetail = function(b, d, a) {
    var c = "cpDetail.jsp?cpId=" + b + "&cpDetailId=" + d + "&pdId=" + a + "&isInit=true";
    location.href = c
};
Mobi.bindPromoterWhenEnter = function(a) {
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=bindPromoteMember",
        data: "promoteMemberId=" + a,
        async: false,
        success: function(b) {
            b = jm.parseJSON(b)
        }
    })
};
Mobi.loadPromoterForInvite = function(c, a) {
    var b = jm(".webContainerBox");
    b = jm(".webContainerBox");
    b.css("top", "0");
    b.empty();
    jm("#g_web").css("background", "#f7f7f7");
    jm("#webBannerBox").remove();
    jm("#webFooterBox").remove();
    jm("#fixedAreaBox").remove();
    jm("#mallThemeHeader").remove();
    var d = "";
    d += "<div class='promPoster'></div>";
    d += "<div class='promWelcomeTxt'>";
    d += "    <span class='promHeader'>推广规则</span>";
    d += "    <span class='promDivider g_bgColor'></span>";
    d += "    <span class='promgibberish'>" + c + "</span>";
    d += "</div>";
    d += "<div class='promBtnWrapper'><div class='promInterBtn g_bgColor' onclick='Mobi.enterPromoterCenter(-1);'>进入" + a + "中心</div></div>";
    b.append(d)
};
Mobi.loadPromoter = function(c, b, a, d) {
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=getInfo",
        async: false,
        success: function(e) {
            e = jm.parseJSON(e);
            if (typeof e.info.createTime !== "undefined" && e.info.createTime !== null && e.info.createTime !== "") {
                Mobi.enterPromoterCenter(c)
            } else {
                var f = jm(".promoterPanel");
                if (d) {
                    f = jm(".webContainerBox");
                    f.empty();
                    jm(".webFooterBox").empty();
                    jm("#fixedAreaBox").empty()
                }
                var h = "";
                h += "<div class='promPoster'></div>";
                h += "<div class='promWelcomeTxt'>";
                h += "    <span class='promHeader'>推广规则</span>";
                h += "    <span class='promDivider g_bgColor'></span>";
                h += "    <span class='promgibberish'>" + b + "</span>";
                h += "</div>";
                h += "<div class='promBtnWrapper'><div class='promInterBtn g_bgColor' onclick='Mobi.enterPromoterCenter(" + c + ");'>进入" + a + "中心</div></div>";
                f.append(h)
            }
        }
    })
};
Mobi.addNewPromoter = function(a) {
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=addNewPromoter",
        data: "parentPromoId=" + a,
        async: false,
        success: function(b) {
            b = jm.parseJSON(b);
            if (!b.success) {
                Mobi.ing(b.msg);
                return
            }
        }
    })
};
Mobi.enterPromoterCenter = function(c) {
    Mobi.logDog(200578, 0);
    if (c <= 0) {
        location.href = "login.jsp?errno=11";
        return
    }
    Mobi.addNewPromoter(0);
    var a = jm(".promoterPanel");
    a.empty();
    var f = jm(".webHeaderBg").css("background-color");
    jm(".middleCenter").css("padding-bottom", "0");
    var b = false,
        h = 0,
        e = 0;
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=getInfo",
        async: false,
        success: function(j) {
            j = jm.parseJSON(j);
            b = j.info.openInvitation;
            h = j.info.income;
            e = j.info.balance;
            if (typeof h === "undefined" || h === null) {
                h = 0
            }
            if (typeof e === "undefined" || e === null) {
                e = 0
            }
        }
    });
    h = h.toFixed(2);
    e = e.toFixed(2);
    var d = "";
    d += "<div class='promoPageBg'>";
    d += "    <div class='promoPageHeader'>";
    d += "        <div class='accumulateIncomeIndicator'>累计收入（元）</div>";
    d += "        <div class='accumulateIncome'>" + h + "</div>";
    d += "        <div class='promoSeparateLine'></div>";
    d += "        <div class='withdrawPanel'>";
    d += "            <div class='withdrawIndicator'>待提现（元）：<span class='withdrawNum'>" + e + "</span></div>";
    d += "            <div class='withdrawBtn g_mainColor' style='border: 1px solid " + f + "' onclick='Mobi.promoWithdraw();'>提现</div>";
    d += "        </div>";
    d += "    </div>";
    d += "    <div class='promoPageFeaturesEntry'>";
    d += "        <div class='promoPageFeature' id='promoOrders' onclick='Mobi.loadPromoOrders(" + b + ")'><span class='promImg'></span><span class='promTxt'>推广订单</span></div>";
    if (b) {
        d += "        <div class='promoPageFeature' id='myInvitations' onclick='Mobi.loadPromoInvites()'><span class='promImg'></span><span class='promTxt'>我的邀请</span></div>"
    }
    d += "        <div class='promoPageFeature' id='balanceDetail' onclick='Mobi.loadPromoBalance()'><span class='promImg'></span><span class='promTxt'>收支明细</span></div>";
    d += "        <div class='promoPageFeature' id='withdrawNotification' onclick='Mobi.loadPromoNotify()'><span class='promImg'></span><span class='promTxt'>提现通知</span></div>";
    d += "    </div>";
    d += "    <div class='promoPagePosters'>";
    if (b) {
        d += "        <div class='promoPoster' id='promo' onclick='Mobi.createPromoPoster();'></div>";
        d += "        <div class='promoPoster' id='invite' onclick='Mobi.createInvitePoster();'></div>"
    } else {
        d += "        <div class='promoPosterOnly' id='promoOnly' onclick='Mobi.createPromoPoster();'></div>"
    }
    d += "    </div>";
    d += "</div>";
    a.append(d)
};
Mobi.loadPromoOrders = function(b) {
    Mobi.logDog(200578, 4);
    var d = null,
        e = null,
        a = jm(".promoterPanel"),
        c = "";
    a.find(".promoPageBg").hide();
    if (jm(".promoOrdersPageWrapper").length !== 0) {
        jm(".promoOrdersPageWrapper").show();
        Mobi.modifyPageHeader("推广订单", ".promoOrdersPageWrapper", ".promoPageBg");
        return
    }
    c += "<div class=promoOrdersPageWrapper>";
    if (b) {
        c += "<div class='promoOrdersSwitch'>";
        c += "    <div class='switches'>";
        c += "        <div class='myOrders highlight'>自助推广</div>";
        c += "        <div class='othersOrders'>好友推广</div>";
        c += "    </div>";
        c += "    <div class='switchUnderline g_bgColor'></div>";
        c += "</div>";
        jm.ajax({
            url: "ajax/promoter_h.jsp?cmd=getOrderList",
            data: "isInvite=false",
            async: false,
            success: function(f) {
                f = jm.parseJSON(f);
                d = f.rtData.orderList;
                c += Mobi.createPromoOrderList(d, true)
            }
        });
        jm.ajax({
            url: "ajax/promoter_h.jsp?cmd=getOrderList",
            data: "isInvite=true",
            async: false,
            success: function(f) {
                f = jm.parseJSON(f);
                e = f.rtData.orderList;
                c += Mobi.createPromoOrderList(e, false)
            }
        })
    } else {
        jm.ajax({
            url: "ajax/promoter_h.jsp?cmd=getOrderList",
            data: "isInvite=false",
            async: false,
            success: function(f) {
                f = jm.parseJSON(f);
                d = f.rtData.orderList;
                c += Mobi.createPromoOrderList(d, true)
            }
        })
    }
    c += "</div>";
    a.append(c);
    jm(".promoOrderListWrapper.isMine").show();
    if (b) {
        jm(".switches .myOrders").off().on("click",
            function() {
                jm(this).addClass("highlight");
                jm(this).siblings().removeClass("highlight");
                jm(".promoOrdersSwitch .switchUnderline").css("left", "3.95rem");
                jm(".promoOrderListWrapper").hide();
                jm(".promoOrderListWrapper.isMine").show()
            });
        jm(".switches .othersOrders").off().on("click",
            function() {
                jm(this).addClass("highlight");
                jm(this).siblings().removeClass("highlight");
                jm(".promoOrdersSwitch .switchUnderline").css("left", "11.15rem");
                jm(".promoOrderListWrapper").hide();
                jm(".promoOrderListWrapper.isOthers").show()
            })
    }
    Mobi.modifyPageHeader("推广订单", ".promoOrdersPageWrapper", ".promoPageBg");
    Mobi.expandPromoOrderList(d);
    Mobi.expandPromoOrderList(e)
};
Mobi.modifyPageHeader = function(e, c, h, j) {
    if (typeof j === "undefined" || j === null) {
        j = 1
    }
    var d = jm("#modifyPromoter .loginHeader .g_close"),
        b = jm("<span class='g_close icon-gClose newPromoJumpBack" + j + "'></span>"),
        f = jm("#modifyPromoter .loginHeader .pageTitle"),
        a = f.text();
    if (j > 1) {
        d = jm(".newPromoJumpBack" + (j - 1))
    }
    f.text(e);
    jm(b).insertAfter(d);
    jm(d).hide();
    jm(b).click(function() {
        f.text(a);
        jm(c).hide();
        jm(h).show();
        jm(b).remove();
        jm(d).show()
    })
};
Mobi.createPromoOrderList = function(b, c) {
    var a = "";
    if (b != null && b.length > 0) {
        if (c) {
            a += "<div class='promoOrderListWrapper isMine'>"
        } else {
            a += "<div class='promoOrderListWrapper isOthers'>"
        }
        jm.each(b,
            function(d, e) {
                a += "<div class='aPromoOrder' id='" + e.orderCode + "'>";
                a += "    <div class='promoOrderHeader'>";
                a += "        <span class='orderCode'>订单编号：" + e.orderCode + "</span>";
                if (e.status == 20) {
                    a += "    <span class='orderStatus finished'>" + e.orderStatus + "</span>"
                } else {
                    a += "    <span class='orderStatus'>" + e.orderStatus + "</span>"
                }
                a += "    </div>";
                a += "    <div class='promoOrderBody'>";
                if (e.itemList.length > 3) {
                    jm.each(e.itemList,
                        function(h, f) {
                            if (h > 2) {
                                a += "<div class='aItem toHidden'>"
                            } else {
                                if (h == 2) {
                                    a += "<div class='aItem anchor'>"
                                } else {
                                    a += "<div class='aItem'>"
                                }
                            }
                            a += "        <div class='itemWrapper'>";
                            a += "            <div class='itemImg'><img src='" + f.img + "' /></div>";
                            a += "            <div class='itemInfo'>";
                            a += "                <div class='itemNameAndOptions'>";
                            a += "                    <div class='itemName'>" + jm.encodeHtml(f.tmpProductName) + "</div>";
                            a += "                    <div class='itemOptions'>" + f.chooseOption + "</div>";
                            a += "                </div>";
                            a += "                <div class='itemPriceAndAmount'>";
                            a += "                    <div class='itemPrice'>" + f.price.toFixed(2) + "</div>";
                            a += "                    <div class='itemAmount'>x" + f.amount + "</div>";
                            a += "                </div>";
                            a += "            </div>";
                            a += "        </div>";
                            a += "    </div>";
                            a += "    <div class='itemSeparateLine'></div>"
                        })
                } else {
                    jm.each(e.itemList,
                        function(h, f) {
                            a += "<div class='aItem'>";
                            a += "    <div class='itemWrapper'>";
                            a += "        <div class='itemImg'><img src='" + f.img + "' /></div>";
                            a += "        <div class='itemInfo'>";
                            a += "            <div class='itemName'>" + jm.encodeHtml(f.tmpProductName) + "</div>";
                            a += "            <div class='itemPriceAndAmount'>";
                            a += "                <div class='itemPrice'>" + f.price.toFixed(2) + "</div>";
                            a += "                <div class='itemAmount'>x" + f.amount + "</div>";
                            a += "            </div>";
                            a += "        </div>";
                            a += "    </div>";
                            a += "</div>";
                            a += "<div class='itemSeparateLine'></div>"
                        })
                }
                a += "    </div>";
                a += "    <div class='promoOrderFooter'>";
                a += "        <div class='promoOrderTotalPrice'>";
                if (e.status == 20) {
                    a += "    <div class='totalPriceNum finished'>" + e.price.toFixed(2);
                    if (typeof e.shipPrice != "undefined" && e.shipPrice > 0) {
                        a += "    <span class='promoShipPrice'>（含运费" + Fai.top.choiceCurrencyVal + e.shipPrice + "）</span>"
                    }
                    a += "    </div>"
                } else {
                    a += "    <div class='totalPriceNum'>" + e.price.toFixed(2);
                    if (typeof e.shipPrice != "undefined" && e.shipPrice > 0) {
                        a += "    <span class='promoShipPrice'>（含运费" + Fai.top.choiceCurrencyVal + e.shipPrice + "）</span>"
                    }
                    a += "    </div>"
                }
                a += "            <div class='totalPriceTxt'>实付金额</div>";
                a += "        </div>";
                a += "        <div class='promoOrderCommission'>";
                if (e.status == 20) {
                    a += "            <div class='commissionNum finished'>" + e.commission.toFixed(2) + "</div>"
                } else {
                    a += "            <div class='commissionNum'>" + e.commission.toFixed(2) + "</div>"
                }
                a += "            <div class='commissionTxt'>成交预估收入</div>";
                a += "        </div>";
                a += "    </div>";
                a += "</div>"
            });
        a += "</div>"
    } else {
        if (c) {
            a += "<div class='promoOrderListWrapper isMine'>"
        } else {
            a += "<div class='promoOrderListWrapper isOthers'>"
        }
        a += "<div class='promoEmpty promoOrderListEmpty'>";
        a += "    <div class='promoEmptyIcon'></div>";
        a += "    <div class='promoEmptyTxt'>暂无推广订单</div>";
        a += "</div>";
        a += "</div>"
    }
    return a
};
Mobi.expandPromoOrderList = function(a) {
    jm.each(a,
        function(c, d) {
            if (d.itemList.length > 3) {
                jm("#" + d.orderCode).find(".toHidden").hide();
                jm("#" + d.orderCode).find(".toHidden ~ .itemSeparateLine").hide();
                var b = "<div class='expandWrapper'><div class='expandPanel' onclick='Mobi.expandPromoItems(" + d.orderCode + ")'>还有" + (d.itemList.length - 3) + "件<span class='expandArrow faisco-icons-S000112'></span></div></div>";
                jm("#" + d.orderCode).find(".anchor").append(b)
            }
        })
};
Mobi.expandPromoItems = function(a) {
    jm("#" + a).find(".toHidden").show();
    jm("#" + a).find(".toHidden ~ .itemSeparateLine").show();
    jm("#" + a).find(".expandWrapper").remove()
};
Mobi.promoWithdraw = function() {
    Mobi.logDog(200578, 3);
    var f = jm(".promoterPanel"),
        d = null;
    html = "";
    f.find(".promoPageBg").hide();
    if (jm(".withdraw").length !== 0) {
        jm(".withdraw").remove()
    }
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=getPromoteWithdraw",
        async: false,
        success: function(m) {
            m = jm.parseJSON(m);
            d = m.rtData
        }
    });
    if (d === null) {
        return
    }
    var b = d.settleData.lma,
        h = d.modeParamList,
        e = d.balance.toFixed(2),
        j = d.settleData.t,
        c = 0;
    if (j === 0) {
        c = 2
    } else {
        if (h.length === 1) {
            var k = h[0].mode;
            if (k === 0) {
                c = 0
            } else {
                c = 1
            }
        } else {
            c = 0
        }
    }
    html += "<div class='withdraw' id='withdraw'>";
    html += "    <div class='withdrawForm'>";
    if (j === 0) {
        html += "   <div class='manualPanel'>";
        html += "   	<div class='withdrawFormCtrl'>";
        html += "       	<div class='ctrlBadge'>提现账户</div>";
        html += "       	<div class='ctrlVal'><input placeholder='请输入提现账户' class='acctField'></div>";
        html += "   	</div>";
        html += "   	<div class='withdrawFormCtrl'>";
        html += "       	<div class='ctrlBadge'>提现金额</div>";
        html += "       	<div class='ctrlVal'><input placeholder='可提现金额" + e + "元' class='amountField'></div>";
        html += "   	</div>";
        html += "   </div>"
    } else {
        html += "    <div class='withdrawFormCtrl' id='acctChange' style='width: 90%;'>";
        html += "       <div class='ctrlBadge'>提现至</div>";
        if (c === 0) {
            html += "       <div class='ctrlVal drawToOnlineAcct'>支付宝<span class='drawToAcctSwitch faisco-icons-S000106'></span></div>"
        } else {
            html += "       <div class='ctrlVal drawToOnlineAcct'>微信零钱<span class='drawToAcctSwitch faisco-icons-S000106'></span></div>"
        }
        html += "    </div>";
        html += "    <div class='alipayPanel'>";
        html += "   	<div class='withdrawFormCtrl'>";
        html += "       	<div class='ctrlBadge'>提现账户</div>";
        html += "       	<div class='ctrlVal'><input placeholder='请输入提现账户' class='acctField'></div>";
        html += "   	</div>";
        html += "   	<div class='withdrawFormCtrl'>";
        html += "       	<div class='ctrlBadge'>真实姓名</div>";
        html += "       	<div class='ctrlVal'><input class='nameField'></div>";
        html += "   	</div>";
        html += "   	<div class='withdrawFormCtrl'>";
        html += "       	<div class='ctrlBadge'>提现金额</div>";
        html += "       	<div class='ctrlVal'><input placeholder='可提现金额" + e + "元' class='amountField'></div>";
        html += "   	</div>";
        html += "    </div>";
        html += "    <div class='wechatPanel'>";
        html += "   	<div class='withdrawFormCtrl'>";
        html += "       	<div class='ctrlBadge'>提现账户</div>";
        html += "       	<div class='ctrlVal'>微信</div>";
        html += "   	</div>";
        html += "       <input id='wechatWdOpenId' style='display: none;'>";
        html += "   	<div class='withdrawFormCtrl'>";
        html += "       	<div class='ctrlBadge'>提现金额</div>";
        html += "       	<div class='ctrlVal'><input placeholder='可提现金额" + e + "元' class='amountField'></div>";
        html += "   	</div>";
        html += "    </div>"
    }
    html += "        <div class='withdrawFormFooter'>注：推广订单交易成功后享有现金奖励，可发起提现申请</div>";
    html += "    </div>";
    html += "    <div class='withdrawBtn g_bgColor' id='promoWithdrawBtn'>确认提现</div>";
    html += "</div>";
    f.append(html);
    jm("#promoWithdrawBtn").css("opacity", "0.5");
    jm("#promoWithdrawBtn").off("click");
    if (j === 1) {
        if (h.length === 1) {
            var k = h[0].mode;
            if (k === 0) {
                jm(".withdraw .alipayPanel").show();
                jm(".withdraw .drawToAcctSwitch").remove();
                jm(".withdraw #acctChangeAliPay").removeAttr("id")
            } else {
                jm(".withdraw .wechatPanel").show();
                jm(".withdraw .drawToAcctSwitch").remove();
                jm(".withdraw #acctChangeWechat").removeAttr("id")
            }
            Mobi.bindWithdrawFormCtl(c)
        } else {
            Mobi.changePromoWithdrawMode(c);
            var l = {
                triggerId: "acctChange",
                panelId: "pgListDiv",
                pageHtml: Mobi.printPromoWithdrawMode(h, c),
                callback: function() {
                    a("pgListDiv", "acctChange")
                },
                closeWebPage: "#pgListDiv .g_close",
                direction: "bottom",
                pageBg: true
            };
            Mobi.initWebPage(l)
        }
    } else {
        Mobi.bindWithdrawFormCtl(c)
    }
    function a(n, q) {
        if (n == "editCusInfo" || n == "editAddrInfo") {
            if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) {
                jm("#" + n).find("input,select,textarea").bind("blur",
                    function() {
                        document.querySelector("body").scrollTop = 0
                    });
                jm("#" + n).find("input,select,textarea").bind("focus",
                    function() {
                        jm("#" + n).attr("ontouchmove", "return false;")
                    }).bind("blur",
                    function() {
                        jm("#" + n).parent().css("position", "fixed");
                        jm("#" + n).css("position", "");
                        jm("#" + n).removeAttr("ontouchmove")
                    });
                jm("#areaBox").bind("touchmove",
                    function(s) {
                        s.preventDefault()
                    });
                jm("#areaBox .J_areaHead").bind("touchmove",
                    function(s) {
                        s.preventDefault()
                    });
                jm("#areaBox1").bind("touchmove",
                    function(s) {
                        s.stopPropagation()
                    });
                jm("#areaBox2").bind("touchmove",
                    function(s) {
                        s.stopPropagation()
                    })
            }
        }
        var o = Fai.top.document.querySelector("#" + n);
        var m = Fai.top.document.querySelector("#webPagePanel" + q);
        window.ontouchmove = function(u) {
            if (o.scrollHeight == o.offsetHeight && jm(m).css("display") != "none") {
                var t = u.target;
                var s = (jm(t).parents(".areaBox").length > 0 || jm(t).parents(".areaBox2").length > 0);
                if (!s) {
                    u.preventDefault()
                }
            }
        };
        var p = 1;
        requestAnimationFrame(function r() {
            o = Fai.top.document.querySelector("#" + n);
            var t = 0,
                s = o.scrollHeight - o.clientHeight;
            if ((s - t) == p) {
                p = 0.5
            }
            var u = o.scrollTop;
            if (u === t) {
                o.scrollTop += p
            } else {
                if (u === s) {
                    o.scrollTop -= p
                }
            }
            requestAnimationFrame(r)
        })
    }
    Mobi.modifyPageHeader("提现", ".withdraw", ".promoPageBg")
};
Mobi.getPromoWechatOpenId = function() {
    var a = navigator.userAgent.toLowerCase();
    var b = a.indexOf("micromessenger") != -1;
    if (b) {
        jm.ajax({
            url: "ajax/promoter_h.jsp?cmd=getWechatConfig",
            async: false,
            success: function(c) {
                c = jm.parseJSON(c)
            }
        })
    } else {
        Mobi.ing("需在微信端打开网站才可提现")
    }
};
Mobi.wechatWithdrawSubmit = function(b) {
    var a = navigator.userAgent.toLowerCase(),
        f = a.indexOf("micromessenger") != -1,
        d = null,
        e = null;
    if (f) {
        jm.ajax({
            url: "ajax/promoter_h.jsp?cmd=getWechatConfig",
            async: false,
            success: function(h) {
                h = jm.parseJSON(h);
                d = h.rtData.appId;
                e = h.rtData.appSecret
            }
        });
        var c = location.href;
        if (c.indexOf("?") != -1) {
            c += "&jumpToPromoWxWithdraw=true&withdrawAmount=" + b
        } else {
            c += "?jumpToPromoWxWithdraw=true&withdrawAmount=" + b
        }
        c = encodeURIComponent(c);
        window.location.href = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + d + "&redirect_uri=" + c + "&response_type=code&scope=snsapi_base&state=1#wechat_redirect"
    } else {
        Mobi.ing("需在微信端打开网站才可提现")
    }
};
Mobi.actualWechatWithdraw = function(a, c, b) {
    if (a) {
        jm("#profile").find("#promoter").click();
        jm(".withdrawBtn.g_mainColor").click();
        if (typeof c != undefined && c !== null && c !== "" && b > 0) {
            jm.ajax({
                url: "ajax/promoter_h.jsp?cmd=submitWithdraw",
                data: "amount=" + b + "&wxOpenId=" + c + "&settleType=1&selectedMode=1",
                success: function(d) {
                    d = jm.parseJSON(d);
                    if (d.success) {
                        Mobi.logDog(200579, 1);
                        Mobi.showWithdrawSuccPage(true)
                    } else {
                        Mobi.showWithdrawSuccPage(false)
                    }
                }
            })
        } else {
            Mobi.showWithdrawSuccPage(false)
        }
    } else {
        jm("#profile").find("#promoter").click();
        jm(".withdrawBtn.g_mainColor").click();
        Mobi.showWithdrawSuccPage(false)
    }
};
Mobi.changePromoWithdrawMode = function(a) {
    if (a === 0) {
        jm(".withdraw .wechatPanel").hide();
        jm(".withdraw .alipayPanel").show();
        jm(".withdraw .drawToOnlineAcct").html("支付宝<span class='drawToAcctSwitch faisco-icons-S000106'></span>")
    } else {
        jm(".withdraw .alipayPanel").hide();
        jm(".withdraw .wechatPanel").show();
        jm(".withdraw .drawToOnlineAcct").html("微信零钱<span class='drawToAcctSwitch faisco-icons-S000106'></span>")
    }
    jm("#pgListDiv .J_selectPay").removeAttr("style").attr("style", "font-size:1rem;height:2.5rem;line-height:2.5rem;").removeAttr("class").attr("class", "faisco-icons-shape11");
    jm("#pgListDiv .payMode").each(function(b, c) {
        if (jm(this).attr("_paymode") == a) {
            jm(this).parent().find(".faisco-icons-shape11").removeAttr("style").attr("style", "margin-left:0.1rem;height:2.5rem;line-height:2.5rem;").removeAttr("class").attr("class", "faisco-icons-right g_color J_selectPay")
        }
    });
    jm("#pgListDiv .g_close").click();
    Mobi.bindWithdrawFormCtl(a)
};
Mobi.bindWithdrawFormCtl = function(a) {
    var c = null;
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=getPromoteWithdraw",
        async: false,
        success: function(l) {
            l = jm.parseJSON(l);
            c = l.rtData
        }
    });
    if (c != null) {
        if (a === 0) {
            var f = [],
                b = jm("#withdraw .alipayPanel .acctField"),
                k = jm("#withdraw .alipayPanel .nameField"),
                d = jm("#withdraw .alipayPanel .amountField"),
                e = false,
                h = "请完成提现表格";
            f.push(b);
            f.push(k);
            f.push(d);
            jm.each(f,
                function(l, m) {
                    jm(this).off().on("input",
                        function() {
                            var q = b.val(),
                                p = k.val(),
                                o = d.val();
                            if (typeof q !== "undefined" && q !== "" && typeof p !== "undefined" && p !== "" && typeof o !== "undefined" && o !== "") {
                                if (!jm.isMobile(q) && !jm.isEmail(q)) {
                                    h = "支付宝账号不合法，请重新输入"
                                } else {
                                    var n = c.settleData.lma;
                                    if (o < n) {
                                        h = "单笔提现金额须不少于" + n + "元"
                                    } else {
                                        if (o > c.balance) {
                                            h = "提现金额不得大于余额"
                                        } else {
                                            e = true;
                                            jm("#promoWithdrawBtn").css("opacity", 1)
                                        }
                                    }
                                }
                            }
                        })
                });
            d.on("keydown",
                function(o) {
                    var m = o.code;
                    if (m.startsWith("Digit") || m.startsWith("Key") || m.startsWith("Numpad")) {
                        var l = /^\s*-?[1-9]\d*(\.\d{1,2})?\s*$/;
                        var n = this.value + o.key;
                        return Mobi.matchDecimalPoint(n, 2)
                    }
                });
            jm("#promoWithdrawBtn").off().on("click",
                function() {
                    if (!e) {
                        Mobi.ing(h);
                        return
                    } else {
                        jm.ajax({
                            url: "ajax/promoter_h.jsp?cmd=submitWithdraw",
                            data: "acct=" + b.val() + "&name=" + k.val() + "&amount=" + d.val() + "&settleType=1&selectedMode=0",
                            success: function(l) {
                                l = jm.parseJSON(l);
                                if (l.success) {
                                    Mobi.logDog(200579, 2);
                                    Mobi.showWithdrawSuccPage(true)
                                } else {
                                    Mobi.ing(l.msg)
                                }
                            }
                        })
                    }
                })
        } else {
            if (a === 1) {
                var f = [],
                    d = jm("#withdraw .wechatPanel .amountField"),
                    j = jm("#withdraw .wechatPanel #wechatWdOpenId"),
                    e = false,
                    h = "请完成提现表格";
                f.push(d);
                jm.each(f,
                    function(l, m) {
                        jm(this).off().on("input",
                            function() {
                                var o = d.val();
                                if (typeof o !== "undefined" && o !== "") {
                                    var n = c.settleData.lma;
                                    if (o < n) {
                                        h = "单笔提现金额须不少于" + n + "元"
                                    } else {
                                        if (o > c.balance) {
                                            h = "提现金额不得大于余额"
                                        } else {
                                            e = true;
                                            jm("#promoWithdrawBtn").css("opacity", 1)
                                        }
                                    }
                                }
                            })
                    });
                d.on("keydown",
                    function(o) {
                        var m = o.code;
                        if (m.startsWith("Digit") || m.startsWith("Key") || m.startsWith("Numpad")) {
                            var l = /^\s*-?[1-9]\d*(\.\d{1,2})?\s*$/;
                            var n = this.value + o.key;
                            return Mobi.matchDecimalPoint(n, 2)
                        }
                    });
                jm("#promoWithdrawBtn").off().on("click",
                    function() {
                        if (!e) {
                            Mobi.ing(h);
                            return
                        } else {
                            Mobi.wechatWithdrawSubmit(d.val())
                        }
                    })
            } else {
                if (a === 2) {
                    var f = [],
                        b = jm("#withdraw .manualPanel .acctField"),
                        d = jm("#withdraw .manualPanel .amountField"),
                        e = false,
                        h = "请完成提现表格";
                    f.push(b);
                    f.push(d);
                    jm.each(f,
                        function(l, m) {
                            jm(this).off().on("input",
                                function() {
                                    var p = b.val(),
                                        o = d.val();
                                    if (typeof p !== "undefined" && p !== "" && typeof o !== "undefined" && o !== "") {
                                        var n = c.settleData.lma;
                                        if (o < n) {
                                            h = "单笔提现金额须不少于" + n + "元"
                                        } else {
                                            if (o > c.balance) {
                                                h = "提现金额不得大于余额"
                                            } else {
                                                e = true;
                                                jm("#promoWithdrawBtn").css("opacity", 1)
                                            }
                                        }
                                    }
                                })
                        });
                    d.on("keydown",
                        function(o) {
                            var m = o.code;
                            if (m.startsWith("Digit") || m.startsWith("Key") || m.startsWith("Numpad")) {
                                var l = /^\s*-?[1-9]\d*(\.\d{1,2})?\s*$/;
                                var n = this.value + o.key;
                                return Mobi.matchDecimalPoint(n, 2)
                            }
                        });
                    jm("#promoWithdrawBtn").off().on("click",
                        function() {
                            if (!e) {
                                Mobi.ing(h);
                                return
                            } else {
                                jm.ajax({
                                    url: "ajax/promoter_h.jsp?cmd=submitWithdraw",
                                    data: "acct=" + b.val() + "&amount=" + d.val() + "&settleType=0",
                                    success: function(l) {
                                        l = jm.parseJSON(l);
                                        if (l.success) {
                                            Mobi.logDog(200579, 0);
                                            Mobi.showWithdrawSuccPage(true)
                                        } else {
                                            Mobi.ing(l.msg)
                                        }
                                    }
                                })
                            }
                        })
                }
            }
        }
    }
};
Mobi.matchDecimalPoint = function(d, c) {
    var b = d.substring(d.length - 1);
    if (b == ".") {
        d = d + "0"
    }
    var a = new RegExp("^\\s*-?(\\d+(\\.\\d{1," + c + "})?|\\.\\d{1," + c + "})\\s*$", "g");
    if (c == -1) {
        a = new RegExp("^\\s*-?(\\d+(\\.\\d{1,25})?|\\.\\d{1,25})\\s*$", "g")
    }
    return a.test(d)
};
Mobi.showWithdrawSuccPage = function(a) {
    var b = jm(".promoterPanel"),
        d = "",
        c = "提现申请已提交，等待商家审核";
    if (!a) {
        c = "提现申请提交失败，请稍后重试"
    }
    b.find(".withdraw").hide();
    if (jm(".withdrawSubmitSucc").length !== 0) {
        jm(".withdrawSubmitSucc").show();
        return
    }
    d += "<div class='withdrawSubmitSucc'>";
    d += "    <div class='withdrawSubMain'>";
    d += "        <div class='withdrawSubIcon'></div>";
    d += "        <div class='withdrawSubTxt'>" + c + "</div>";
    d += "    </div>";
    d += "    <div class='withdrawSubComplete g_bgColor'>完成</div>";
    d += "</div>";
    b.append(d);
    jm(".newPromoJumpBack1").off().on("click",
        function() {
            document.location.href = "profile.jsp"
        });
    jm(".withdrawSubmitSucc .withdrawSubComplete").off().on("click",
        function() {
            document.location.href = "profile.jsp"
        })
};
Mobi.loadPromoInvites = function() {
    Mobi.logDog(200578, 5);
    var a = jm(".promoterPanel"),
        b = null,
        c = "";
    a.find(".promoPageBg").hide();
    if (jm(".invitationWrapper").length !== 0) {
        jm(".invitationWrapper").show();
        Mobi.modifyPageHeader("我的邀请", ".invitationWrapper", ".promoPageBg");
        return
    }
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=getPromoteInvite",
        async: false,
        success: function(d) {
            d = jm.parseJSON(d);
            b = d.promoterList
        }
    });
    c += "<div class='invitationWrapper'>";
    if (b != null && b.length > 0) {
        jm.each(b,
            function(d, e) {
                c += "<div class='aInvitee'>";
                c += "    <div class='leftPart'>";
                c += "        <span class='inviteeAvator'><img src='" + e.headPicUrl + "' /></span>";
                c += "        <span class='inviteeName'>" + e.memberName + "</span>";
                c += "    </div>";
                c += "    <div class='rightPart'>";
                c += "        <span class='inviteeJoinedDate'>加入时间：" + e.createTimeStr.split(" ")[0] + "</span>";
                c += "    </div>";
                c += "</div>"
            })
    } else {
        c += "<div class='promoEmpty promoInviteEmpty'>";
        c += "    <div class='promoEmptyIcon'></div>";
        c += "    <div class='promoEmptyTxt'>暂无邀请小伙伴</div>";
        c += "</div>"
    }
    c += "</div>";
    a.append(c);
    Mobi.modifyPageHeader("我的邀请", ".invitationWrapper", ".promoPageBg")
};
Mobi.loadPromoBalance = function() {
    Mobi.logDog(200578, 6);
    var a = jm(".promoterPanel"),
        c = null,
        b = "";
    a.find(".promoPageBg").hide();
    if (jm(".balanceDetailWrapper").length !== 0) {
        jm(".balanceDetailWrapper").show();
        Mobi.modifyPageHeader("收支明细", ".balanceDetailWrapper", ".promoPageBg");
        return
    }
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=getPromoteFlow",
        async: false,
        success: function(d) {
            d = jm.parseJSON(d);
            c = d.flowList
        }
    });
    b += "<div class='balanceDetailWrapper'>";
    if (c != null && c.length > 0) {
        jm.each(c,
            function(d, e) {
                b += "<div class='aFlow'>";
                b += "    <div class='leftPart'>";
                b += "        <div class='flowTitle'>" + e.showName + "</div>";
                b += "        <div class='flowDate'>" + e.settleTimeStr.split(" ")[0] + "</div>";
                b += "    </div>";
                b += "    <div class='rightPart'>";
                if (e.type === 2) {
                    b += "    <div class='flowAmount minus'>" + e.sign + e.amount.toFixed(2) + "</div>"
                } else {
                    b += "    <div class='flowAmount plus'>" + e.sign + e.amount.toFixed(2) + "</div>"
                }
                b += "    </div>";
                b += "</div>"
            })
    } else {
        b += "<div class='promoEmpty promoBalanceEmpty'>";
        b += "    <div class='promoEmptyIcon'></div>";
        b += "    <div class='promoEmptyTxt'>暂无收支明细</div>";
        b += "</div>"
    }
    b += "</div>";
    a.append(b);
    Mobi.modifyPageHeader("收支明细", ".balanceDetailWrapper", ".promoPageBg")
};
Mobi.createPromoPoster = function() {
    Mobi.logDog(200578, 1);
    var c = jm(".promoterPanel"),
        b = null,
        h = "";
    c.find(".promoPageBg").hide();
    if (jm(".promoPosterWrapper").length !== 0) {
        jm(".promoPosterWrapper").show();
        Mobi.modifyPageHeader("推广二维码", ".promoPosterWrapper", ".promoPageBg");
        return
    }
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=getPromoQRCode",
        async: false,
        success: function(m) {
            m = jm.parseJSON(m);
            b = m.rtData
        }
    });
    var f = jm(".webHeaderBg").css("background-color"),
        d = f.replace(")", ", 0.2)").replace("rgb", "rgba");
    var l = jm("html").css("font-size");
    l = Number(l.substring(0, l.indexOf("p")));
    var e = l * 13;
    var j = l * 16.5;
    h += "<div class='promoPosterWrapper'>";
    h += "    <div class='posterHeader'>";
    h += "        <div class='iconPart'>";
    h += "            <div class='iconIndicator g_mainColor' style='border-color: " + d + "'>1</div>";
    h += "            <div class='iconSeparate'></div>";
    h += "            <div class='iconIndicator g_mainColor' style='border-color: " + d + "'>2</div>";
    h += "            <div class='iconSeparate'></div>";
    h += "            <div class='iconIndicator g_mainColor' style='border-color: " + d + "'>3</div>";
    h += "        </div>";
    h += "        <div class='txtPart'>";
    h += "            <div class='aPosterTxt'>分享商城给好友</div>";
    h += "            <div class='aPosterTxt'>好友下单</div>";
    h += "            <div class='aPosterTxt'>获得推广奖励</div>";
    h += "        </div>";
    h += "    </div>";
    h += "    <div class='posterBody'>";
    h += "        <canvas class='actualPoster promoPoster' id='promoPoster' width='" + e + "px' height='" + j + "px'>";
    h += "        </canvas>";
    h += "        <div class='posterBodyBtn'>长按保存图片</div>";
    h += "    </div>";
    h += "</div>";
    c.append(h);
    var a = document.getElementById("promoPoster");
    var k = a.getContext("2d");
    Mobi.drawPromoteAndInviteCanvas(k, b, false);
    Mobi.modifyPageHeader("推广二维码", ".promoPosterWrapper", ".promoPageBg")
};
Mobi.createInvitePoster = function() {
    Mobi.logDog(200578, 2);
    var b = jm(".promoterPanel"),
        a = null,
        f = "";
    b.find(".promoPageBg").hide();
    if (jm(".invitePosterWrapper").length !== 0) {
        jm(".invitePosterWrapper").show();
        Mobi.modifyPageHeader("邀请二维码", ".invitePosterWrapper", ".promoPageBg");
        return
    }
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=getInviteQRCode",
        async: false,
        success: function(l) {
            l = jm.parseJSON(l);
            a = l.rtData
        }
    });
    var e = jm(".webHeaderBg").css("background-color"),
        c = e.replace(")", ", 0.2)").replace("rgb", "rgba");
    var k = jm("html").css("font-size");
    k = Number(k.substring(0, k.indexOf("p")));
    var d = k * 13;
    var h = k * 16.5;
    f += "<div class='invitePosterWrapper'>";
    f += "    <div class='posterHeader'>";
    f += "        <div class='iconPart'>";
    f += "            <div class='iconIndicator g_mainColor' style='border-color: " + c + "'>1</div>";
    f += "            <div class='iconSeparate'></div>";
    f += "            <div class='iconIndicator g_mainColor' style='border-color: " + c + "'>2</div>";
    f += "            <div class='iconSeparate'></div>";
    f += "            <div class='iconIndicator g_mainColor' style='border-color: " + c + "'>3</div>";
    f += "        </div>";
    f += "        <div class='txtPart'>";
    f += "            <div class='aPosterTxt'>分享邀请码给好友</div>";
    f += "            <div class='aPosterTxt'>好友成为推广员并带来订单</div>";
    f += "            <div class='aPosterTxt'>获得邀请奖励</div>";
    f += "        </div>";
    f += "    </div>";
    f += "    <div class='posterBody'>";
    f += "        <canvas class='actualPoster invitePoster' id='invitePoster' width='" + d + "px' height='" + h + "px'>";
    f += "        </canvas>";
    f += "        <div class='posterBodyBtn'>长按保存图片</div>";
    f += "    </div>";
    f += "</div>";
    b.append(f);
    var j = document.getElementById("invitePoster").getContext("2d");
    Mobi.drawPromoteAndInviteCanvas(j, a, true);
    Mobi.modifyPageHeader("邀请二维码", ".invitePosterWrapper", ".promoPageBg")
};
Mobi.drawPromoteAndInviteCanvas = function(l, b, f) {
    var m = jm("html").css("font-size");
    m = Number(m.substring(0, m.indexOf("p")));
    var c = m * 13;
    var e = m * 16.5;
    var k = "";
    if (typeof Fai != "undefined" && typeof Fai.top._resRoot != "undefined") {
        k = Fai.top._resRoot
    }
    var d = jm("#_TOKEN").attr("value");
    var h = k + "/image/promoter/invite.png";
    var j = k + "/image/promoter/promo.png";
    var a = new Image();
    if (f) {
        a.src = "http://" + document.location.host + "/ajax/mobiImgTransfer_h.jsp?_TOKEN=" + d + "&imgUrl=" + jm.encodeUrl(h)
    } else {
        a.src = "http://" + document.location.host + "/ajax/mobiImgTransfer_h.jsp?_TOKEN=" + d + "&imgUrl=" + jm.encodeUrl(j)
    }
    a.onload = function() {
        l.drawImage(a, 0, 0, c, e);
        var n = new Image();
        var o = b.headPicUrl;
        n.src = "http://" + document.location.host + "/ajax/mobiImgTransfer_h.jsp?_TOKEN=" + d + "&imgUrl=" + jm.encodeUrl(o);
        n.onload = function() {
            var q = c / 2;
            var w = m * 1.725;
            var v = m * 1.175;
            l.beginPath();
            l.moveTo(q, w);
            l.fillStyle = "#fff";
            l.arc(q, w, v, 0, Math.PI * 2, true);
            l.closePath();
            l.fill();
            var u = m * 1.075;
            l.save();
            l.beginPath();
            l.arc(q, w, u, 0, Math.PI * 2, true);
            l.clip();
            l.drawImage(n, q - u, w - u, u * 2, u * 2);
            l.closePath();
            l.restore();
            var r = q;
            var p = m * 3.85;
            var t = m * 0.65;
            l.font = t + "px Helvetica";
            l.textAlign = "center";
            l.fillText(b.memberName, r, p);
            var s = new Image();
            s.src = "http://" + document.location.host + "/ajax/mobiImgTransfer_h.jsp?_TOKEN=" + d + "&imgUrl=" + jm.encodeUrl(b.qrCodeUrl);
            s.onload = function() {
                var z = m * 7;
                var C = (c - z) / 2;
                var B = C;
                var A = p + (z / 1.7);
                l.save();
                l.drawImage(s, B, A, z, z);
                l.restore();
                if (f) {
                    var x = document.getElementById("invitePoster").toDataURL("image/png");
                    var y = new Image();
                    y.src = x;
                    y.setAttribute("class", "actualPoster invitePoster");
                    jm(".invitePosterWrapper .posterBody").empty();
                    jm(".invitePosterWrapper .posterBody").append(y);
                    jm(".invitePosterWrapper .posterBody").append("<div class='posterBodyBtn g_bgColor'>长按保存图片</div>")
                } else {
                    var x = document.getElementById("promoPoster").toDataURL("image/png");
                    var y = new Image();
                    y.src = x;
                    y.setAttribute("class", "actualPoster promoPoster");
                    jm(".promoPosterWrapper .posterBody").empty();
                    jm(".promoPosterWrapper .posterBody").append(y);
                    jm(".promoPosterWrapper .posterBody").append("<div class='posterBodyBtn g_bgColor'>长按保存图片</div>")
                }
            }
        }
    }
};
Mobi.loadPromoNotify = function() {
    Mobi.logDog(200578, 7);
    var a = jm(".promoterPanel"),
        c = null,
        b = "";
    a.find(".promoPageBg").hide();
    if (jm(".promoNotifyWrapper").length !== 0) {
        jm(".promoNotifyWrapper").show();
        Mobi.modifyPageHeader("提现通知", ".promoNotifyWrapper", ".promoPageBg");
        return
    }
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=getPromoteFlow",
        data: "isWithdraw=true",
        async: false,
        success: function(d) {
            d = jm.parseJSON(d);
            c = d.flowList
        }
    });
    b += "<div class='promoNotifyWrapper'>";
    if (c != null && c.length > 0) {
        jm.each(c,
            function(d, e) {
                b += "<div class='aWithdraw' onclick='Mobi.loadWithdrawDetail(" + JSON.stringify(e) + ")'>";
                b += "    <div class='leftPart'>";
                b += "        <div class='withdrawTitle'>" + e.showName + "</div>";
                if (e.iur) {
                    b += "        <div class='unreadSymbol'></div>"
                }
                b += "        <div class='withdrawDate'>" + e.settleTimeStr + "</div>";
                b += "    </div>";
                b += "    <div class='rightPart'>";
                if (e.status === 101 || e.status === 103) {
                    b += "    <div class='withdrawAmount succ'>" + Fai.top.choiceCurrencyVal + e.amount.toFixed(2) + "</div>"
                } else {
                    if (e.status === 102 || e.status === 104) {
                        b += "    <div class='withdrawAmount fail'>" + Fai.top.choiceCurrencyVal + e.amount.toFixed(2) + "</div>"
                    }
                }
                b += "    </div>";
                b += "</div>"
            })
    } else {
        b += "<div class='promoEmpty promoWithdrawEmpty'>";
        b += "    <div class='promoEmptyIcon'></div>";
        b += "    <div class='promoEmptyTxt'>暂无提现信息</div>";
        b += "</div>"
    }
    b += "</div>";
    a.append(b);
    Mobi.modifyPageHeader("提现通知", ".promoNotifyWrapper", ".promoPageBg")
};
Mobi.promoShareIconClick = function() {
    Mobi.logDog(20578, 8);
    var b = jm("#productDetailShare");
    var a = jm("#mallThemeProductDetailShare");
    b.click();
    a.click()
};
Mobi.loadWithdrawDetail = function(f) {
    jm.ajax({
        url: "ajax/promoter_h.jsp?cmd=setPromoteWithdrawAlreadyRead",
        data: "id=" + f.id,
        success: function(j) {
            j = jm.parseJSON(j)
        }
    });
    var b = jm(".promoterPanel"),
        h = null,
        d = "";
    b.find(".promoNotifyWrapper").hide();
    if (jm("#withdrawDetail" + f.id).length !== 0) {
        jm("#withdrawDetail" + f.id).show();
        Mobi.modifyPageHeader("通知详情", "#withdrawDetail" + f.id, ".promoNotifyWrapper", 2);
        return
    }
    var c = "";
    if (f.status === 101 || f.status === 103) {
        c = "商家已经通过你的提现申请，请查看你的提现账户是否到账。"
    } else {
        if (f.status === 102) {
            c = "商家拒绝了你的提现申请，拒绝原因：" + jm.encodeHtml(f.other.rm) + "。"
        } else {
            if (f.status === 104) {
                c = "打款失败，请联系商家"
            }
        }
    }
    var a = f.other.ac;
    var e = f.other.wt;
    if (e == 10 || e == 11 || e == 14) {
        a += "（微信零钱）"
    } else {
        if (e == 12 || e == 13) {
            a += "（支付宝）"
        }
    }
    d += "<div class='withdrawDetail' id='withdrawDetail" + f.id + "'>";
    d += "    <div class='withdrawBg g_bgColor'>";
    d += "        <div class='withdrawTitleWrapper'>";
    if (f.status === 101 || f.status === 103) {
        d += "        <div class='withdrawIcon succ'></div>";
        d += "        <div class='withdrawTxt'>提现申请成功</div>"
    } else {
        if (f.status === 102 || f.status === 104) {
            d += "        <div class='withdrawIcon fail'></div>";
            d += "        <div class='withdrawTxt'>提现申请失败</div>"
        }
    }
    d += "        </div>";
    d += "    </div>";
    d += "    <div class='withdrawInfo'>";
    d += "        <div class='withdrawInfoTitle'>" + c + "</div>";
    d += "        <div class='withdrawInfoBody'>";
    d += "            <div class='applyDate'>申请时间：" + f.settleTimeStr + "</div>";
    d += "            <div class='applyAmount'>申请金额：";
    if (f.status === 101 || f.status === 103) {
        d += "            <span class='succ'>" + Fai.top.choiceCurrencyVal + f.amount.toFixed(2) + "</span>"
    } else {
        if (f.status === 102 || f.status === 104) {
            d += "            <span class='fail'>" + Fai.top.choiceCurrencyVal + f.amount.toFixed(2) + "</span>"
        }
    }
    d += "            </div>";
    d += "            <div class='withdrawAcct'>提现账户：";
    d += "                <span>" + jm.encodeHtml(a) + "</span>";
    d += "            </div>";
    d += "        </div>";
    d += "    </div>";
    d += "</div>";
    b.append(d);
    Mobi.modifyPageHeader("通知详情", "#withdrawDetail" + f.id, ".promoNotifyWrapper", 2)
};
Mobi.loadCouponList = (function(j) {
    function k(t, s) {
        this.mid = t;
        this.flag = s
    }
    var l = k.prototype,
        q, d = 0,
        o = [1, 1, 1],
        n = 10,
        p = [[], [], []],
        e = ["red", "orange", "yellow", "green", "blue", "pink", "purple", "gray"];
    l.init = function() {
        q = this;
        c();
        r()
    };
    function c() {
        var s = q;
        j.ajax({
            url: "ajax/mallCoupon_h.jsp?cmd=getCouponByMid",
            data: "mid=" + s.mid,
            dataType: "json",
            success: function(t) {
                if (t.success) {
                    if (t.receiveList) {
                        p[0] = t.receiveList
                    }
                    if (t.usedList) {
                        p[1] = t.usedList
                    }
                    if (t.expireList) {
                        p[2] = t.expireList
                    }
                    a()
                }
            },
            error: function() {}
        })
    }
    function a() {
        var v = q;
        var t = j(".couponListPanel");
        var s = [];
        s.push('<div class="tabList">');
        s.push('<div class="coupon-tab"><span><span class="">' + LS.notUse + '(</span><span class="coupon-amount">' + p[0].length + "</span><span>)</span></span><em></em></div>");
        s.push('<div class="coupon-tab"><span><span>' + LS.used + '(</span><span class="coupon-amount">' + p[1].length + "</span><span>)</span></span><em></em></div>");
        s.push('<div class="coupon-tab"><span><span>' + LS.expired + '(</span><span class="coupon-amount">' + p[2].length + "</span><span>)</span></span><em></em></div>");
        s.push("</div>");
        s.push("<div id='showCouponList'>");
        s.push(m());
        s.push("</div>");
        t.append(s.join(""));
        if (v.flag) {
            f(d)
        } else {
            h(d)
        }
        var u = jm("body").height()
    }
    function h(t) {
        var w = "fk-coupon-tab-active",
            s = jm(".coupon-tab");
        s.attr("style", "");
        s.find("em").attr("style", "");
        s.removeClass(w);
        var u = jm(".coupon-tab").eq(t),
            v = jm(".g_button").css("background-color");
        u.css({
            background: v,
            color: "#fff",
            borderColor: v
        });
        u.find("em").css({
            borderColor: v + " transparent transparent transparent"
        });
        u.addClass(w)
    }
    function f(s) {
        var t = jm(".coupon-tab").eq(s);
        t.addClass("coupon-tab-selected").siblings(".coupon-tab").removeClass("coupon-tab-selected")
    }
    function b() {
        if (jm(".webHeaderBg").height() <= jm("body")[0].scrollTop && (Fai.top._templateFrameId < 2000 || Fai.top._templateFrameId >= 3000)) {
            jm(".tabList").css({
                position: "fixed",
                width: jm(".couponListPanel").width() + "px"
            });
            jm("#showCouponList").css("margin-top", "1.7rem")
        } else {
            jm(".tabList").css({
                position: "",
                width: ""
            });
            jm("#showCouponList").css("margin-top", "")
        }
    }
    function r() {
        var s = q;
        Mobi.onTouchAndClickEvent(".coupon-tab",
            function() {
                if (jm(this).index() != d) {
                    d = jm(this).index();
                    if (s.flag) {
                        f(d)
                    } else {
                        h(d)
                    }
                    j(".show-coupon-list").remove();
                    j(".coupon-empty").remove();
                    j("#showCouponList").append(m())
                }
            });
        document.addEventListener("touchstart",
            function(t) {
                b()
            },
            false);
        document.addEventListener("touchmove",
            function(t) {
                b()
            },
            false);
        document.addEventListener("touchend",
            function(t) {
                b()
            },
            false);
        document.addEventListener("scroll",
            function() {
                b()
            },
            false);
        Mobi.onTouchAndClickEvent(".icon-delIcon",
            function() {
                var v = j(this).parents(".coupon-warp");
                var w = v.attr("data_id");
                var u = LS.delCouponWillUnavail;
                if (d != 0) {
                    u = LS.confirmDelCoupon
                }
                var t = {
                    textClass: "confirm",
                    content: u,
                    callback: function() {
                        p[d].splice((o[d] - 1) * n, 1);
                        j.ajax({
                            url: "ajax/member_h.jsp?cmd=delCoupon",
                            data: "mid=" + s.mid + "&cdid=" + w,
                            dataType: "json",
                            success: function(x) {
                                if (x.success) {
                                    v.remove();
                                    j(".coupon-tab").eq(d).find(".coupon-amount").text(p[d].length)
                                }
                            },
                            error: function() {}
                        });
                        jm("#mobiPrompt").remove();
                        jm("#mobiPrompt_Bg").remove()
                    }
                };
                Mobi.prompt(t)
            });
        Mobi.onTouchAndClickEvent(".toUseCoupon",
            function() {
                var t = jm(this).parents(".couponItem").attr("couponid");
                Fai.top.location.href = "pr.jsp?couponId=" + t
            })
    }
    function m() {
        var w = q,
            t = [],
            s = o[d];
        t = p[d];
        var u = [];
        if (t.length == 0) {
            u.push("<div class='coupon-empty'>");
            u.push("<div class='icon-coupons1'></div>");
            var v = "";
            if (d == 0) {
                v = jm.format(LS.notHasCoupon, LS.notUse)
            } else {
                if (d == 1) {
                    v = jm.format(LS.notHasCoupon, LS.used)
                } else {
                    if (d == 2) {
                        v = jm.format(LS.notHasCoupon, LS.expired)
                    }
                }
            }
            u.push("<div class='showMsg'>" + v + "</div>");
            u.push("</div>")
        } else {
            u.push("<div class='show-coupon-list'>");
            j.each(t,
                function(z, y) {
                    var x = "g_bgColor";
                    var B = "";
                    if (d != 0) {
                        x = "";
                        B = "coupon-words-invalid"
                    }
                    var A = "";
                    if (z == 0) {
                        A = "padding-top:0.75rem;"
                    }
                    u.push("<div class ='couponItem' couponId='" + y.couponId + "' data_id='" + y.cdId + "' style='" + A + "'>");
                    u.push("<div class='couponItem-left " + x + "'>");
                    u.push("<div class='couponItemLeftBackground'></div>");
                    u.push("<div class='couponItemLeftData'>" + Fai.top.choiceCurrencyVal + "</span><span style='font-size: 1.625rem;'>" + y.savePrice + "</span></div>");
                    u.push("<div class='couponItemLeftCondit'>" + jm.format(LS.fullMinCanUse, y.orderMinPrice) + "</div>");
                    u.push("</div>");
                    u.push("<div class='couponItem-right'>");
                    if (Fai.top._lcid == 2052 || Fai.top._lcid == 1028) {
                        if (d == 1) {
                            u.push("<div class='couponState couponStateUsed'></div>")
                        } else {
                            if (d == 2) {
                                u.push("<div class='couponState couponStateExpired'></div>")
                            }
                        }
                    } else {
                        if (d == 1) {
                            u.push("<div class='couponState couponStateUsedEn'></div>")
                        } else {
                            if (d == 2) {
                                u.push("<div class='couponState couponStateExpiredEn'></div>")
                            }
                        }
                    }
                    u.push("<div class='couponItemRightName " + B + "'>" + jm.encodeHtml(y.couponName) + "</div>");
                    u.push("<div class='couponItemRightValidity'>" + y.validity + "</div>");
                    if (d == 0) {
                        u.push("<div class='toUseCoupon g_mainColor'>" + LS.toUseCoupon + "</div>")
                    }
                    u.push("</div>");
                    u.push("</div>")
                });
            u.push("</div>")
        }
        return u.join("")
    }
    return k
})(jm);
Mobi.memberHeadPic = function(b, a) {
    this.sessionMid = b;
    this.headPicJson = a
}; (function(o, k, f) {
    var j = k.prototype;
    var t = o(".picArea .coverImg"),
        q = o(".picArea"),
        n = o("#headPic"),
        c,
        s,
        d,
        l,
        e,
        h,
        b,
        p;
    j.init = function() {
        this.initBind()
    };
    j.initBind = function() {
        var E = this;
        t = o(".picArea .coverImg"),
            q = o(".picArea"),
            n = o("#headPic");
        n.on({
            load: function() {
                h = o(this)[0].offsetTop;
                b = o(this)[0].offsetLeft;
                p = Math.min(o(this)[0].height, o(this)[0].width);
                l = h + o(this)[0].height / 2 - p / 2;
                e = b + o(this)[0].width / 2 - p / 2;
                n.css({
                    top: h + "px",
                    left: b + "px"
                });
                r()
            }
        });
        o("#memberHeadPic").click(function() {
            var F = setInterval(function() {
                    if (o("#headPic")[0].complete) {
                        o("#profile").hide();
                        o(".middleCenter").css("padding-bottom", "0");
                        var G = o("#editMemberHeadPic");
                        G.css("height", o(window).height() + "px");
                        o("#editMemberHeadPic").show();
                        if (Mobi.deviceTypeIsMobi()) {
                            o("#coverBox").remove()
                        }
                        q.css("height", o(window).height() - Math.floor(o(".loginHeader").height()) - Math.floor(o(".editHeadPicFooter").height()) + "px");
                        c = Number(q.height());
                        s = Number(q.width());
                        h = (c - n.height()) / 2;
                        b = (s - n.width()) / 2;
                        if (o.toJSON(E.headPicJson) == "{}" || E.headPicJson.thumbId == "") {
                            l = h;
                            e = b;
                            p = Number(n.width())
                        } else {
                            var H = E.headPicJson.imgW / n.width();
                            l = h + E.headPicJson.top / H;
                            e = b + E.headPicJson.left / H;
                            p = E.headPicJson.width / H
                        }
                        n.css({
                            top: h + "px",
                            left: b + "px"
                        });
                        d = Math.min(n.width(), n.height());
                        m();
                        r();
                        clearInterval(F)
                    }
                },
                50)
        });
        o(".editHeadPicFooter .saveBtn").click(function() {
            var F = o(this).attr("mid");
            var G = o(this).attr("newimg");
            var I = o(this).attr("oldimgid");
            var H = {};
            if (!G && !I) {
                o("#editMemberHeadPic").hide();
                o("#profile").show();
                return
            }
            E.headPicJson.width = Math.round(p);
            E.headPicJson.top = Math.round(l - h);
            E.headPicJson.left = Math.round(e - b);
            E.headPicJson.imgH = Math.round(n[0].height);
            E.headPicJson.imgW = Math.round(n[0].width);
            if (G != null) {
                $.ajax({
                    type: "post",
                    url: "ajax/member_h.jsp?cmd=cimg",
                    data: "oldImgId=" + I + "&mid=" + F + "&newImg=" + o.encodeUrl(G),
                    async: false,
                    error: function() {
                        Mobi.ing(LS.memberProfileError)
                    },
                    success: function(J) {
                        J = JSON.parse(J);
                        if (J.success) {
                            E.headPicJson.thumbId = J.fileId
                        }
                    }
                })
            } else {
                E.headPicJson.thumbId = I
            }
            H.headPic = E.headPicJson;
            $.ajax({
                type: "post",
                async: false,
                url: "ajax/member_h.jsp?cmd=set",
                data: "id=" + F + "&info=" + o.encodeUrl(o.toJSON(H)),
                error: function() {
                    Mobi.ing(LS.memberProfileError)
                },
                success: function(J) {
                    var K = o.parseJSON(J);
                    if (K.success) {
                        E.headPicJson.path = n.attr("src");
                        Mobi.initMemberHeadPic(E.headPicJson);
                        o("#editMemberHeadPic").hide();
                        o("#profile").show();
                        Mobi.ing(LS.saveMemHeadImgSuc, 1)
                    } else {
                        Mobi.ing(LS.memberProfileError)
                    }
                }
            })
        });
        var u, A, y, B, y, z, v, x, w;
        o(".picArea").on({
            touchstart: function(F) {
                var H = F.touches.length;
                u = t[0].offsetTop;
                A = t[0].offsetLeft;
                p = t[0].width;
                if (H == 1) {
                    F.preventDefault();
                    var G = F.touches[0];
                    z = {
                        x: G.pageX,
                        y: G.pageY
                    }
                } else {
                    B = a(F).dist;
                    y = p
                }
            },
            touchmove: function(G) {
                var J = G.touches.length;
                d = Math.min(n.width(), n.height());
                if (J == 1) {
                    G.preventDefault();
                    var I = G.touches[0];
                    v = {
                        x: I.pageX,
                        y: I.pageY
                    };
                    x = v.x - z.x;
                    w = v.y - z.y;
                    l = u + w;
                    e = A + x;
                    r()
                } else {
                    var H = a(G).dist,
                        F = H / B;
                    p = Math.round(y * F);
                    l = u + (y - p) / 2;
                    e = A + (y - p) / 2;
                    r()
                }
            }
        });
        var C = false;
        o("body").on("mouseup",
            function() {
                C = false
            });
        o(".picArea").on({
                mousedown: function(G) {
                    u = t[0].offsetTop;
                    A = t[0].offsetLeft;
                    y = t[0].width;
                    z = {
                        x: G.pageX,
                        y: G.pageY
                    };
                    C = true;
                    var F = G.target.id;
                    if (F == "coverBox" || F == "coverImg") {
                        D(0)
                    } else {
                        if (F == "dragBotCenter" || F == "dragRightCenter" || F == "dragRightBot") {
                            D(1)
                        } else {
                            if (F == "dragLeftCenter" || F == "dragLeftBot") {
                                D(2)
                            } else {
                                if (F == "dragTopCenter" || F == "dragRightTop") {
                                    D(3)
                                } else {
                                    if (F == "dragLeftTop") {
                                        D(4)
                                    }
                                }
                            }
                        }
                    }
                },
                mouseup: function() {
                    C = false
                }
            },
            "#coverBox,#coverImg");
        function D(F) {
            document.onmousemove = function(G) {
                if (!C) {
                    return
                }
                v = {
                    x: G.pageX,
                    y: G.pageY
                };
                x = v.x - z.x;
                w = v.y - z.y;
                switch (F) {
                    case 0:
                        p = y;
                        l = u + w;
                        e = A + x;
                        break;
                    case 1:
                        p = y + Math.max(x, w);
                        l = u;
                        e = A;
                        break;
                    case 2:
                        p = y - x;
                        l = u;
                        e = A + x;
                        break;
                    case 3:
                        p = y + x;
                        l = u - x;
                        e = A;
                        break;
                    case 4:
                        p = y - x;
                        l = u + x;
                        e = A + x;
                        break
                }
                r()
            }
        }
    };
    function m() {
        o(".coverImg").css({
            width: p + "px",
            height: p + "px",
            top: h + "px",
            left: b + "px"
        });
        o(".picArea .coverRing").css({
            width: p - 2 + "px",
            height: p - 2 + "px",
            top: h + "px",
            left: b + "px"
        });
        o(".picArea .coverBox").css({
            width: p + "px",
            height: p + "px",
            top: h - 1 + "px",
            left: b - 1 + "px"
        });
        o(".picArea .cover1").css({
            width: "100%",
            height: l + "px",
            top: 0,
            left: 0
        });
        o(".picArea .cover2").css({
            width: b + "px",
            height: p + "px",
            top: h + "px",
            left: 0
        });
        o(".picArea .cover4").css({
            width: s - p - b + "px",
            height: p + "px",
            top: h + "px",
            left: p + b + "px"
        });
        o(".picArea .cover5").css({
            width: "100%",
            height: c - p - h + "px",
            top: p + h + "px",
            left: 0
        })
    }
    function r() {
        if (p < 100) {
            p = 100
        } else {
            if (p > Math.min(n[0].height, n[0].width)) {
                p = Math.min(n[0].height, n[0].width)
            }
        }
        if (l < h) {
            l = h
        } else {
            if (l > h + n[0].height - p) {
                l = h + n[0].height - p
            }
        }
        if (e < b) {
            e = b
        } else {
            if (e > b + n[0].width - p) {
                e = b + n[0].width - p
            }
        }
        if (l >= h && l <= h + n[0].height - p && e >= b && e <= b + n[0].width - p) {
            t.css({
                width: p + "px",
                height: p + "px",
                top: l + "px",
                left: e + "px"
            });
            o(".picArea .coverRing").css({
                width: p - 2 + "px",
                height: p - 2 + "px",
                top: l + "px",
                left: e + "px"
            });
            o(".picArea .coverBox").css({
                width: p + "px",
                height: p + "px",
                top: l - 1 + "px",
                left: e - 1 + "px"
            });
            o(".picArea .cover1").css({
                width: "100%",
                height: l + "px",
                top: 0,
                left: 0
            });
            o(".picArea .cover2").css({
                width: e + "px",
                height: p + "px",
                top: l + "px",
                left: 0
            });
            o(".picArea .cover4").css({
                width: s - p - e + "px",
                height: p + "px",
                top: l + "px",
                left: p + e + "px"
            });
            o(".picArea .cover5").css({
                width: "100%",
                height: c - p - l + "px",
                top: p + l + "px",
                left: 0
            })
        }
    }
    function a(B) {
        var y = 0,
            A = 0,
            w = 0,
            z = 0,
            v = 0,
            x = 0,
            u = {};
        y = B.touches[0].pageX;
        w = B.touches[1].pageX;
        A = B.touches[0].pageY - document.body.scrollTop;
        z = B.touches[1].pageY - document.body.scrollTop;
        if (!y || !w) {
            return
        }
        if (y <= w) {
            v = (w - y) / 2 + y
        } else {
            v = (y - w) / 2 + w
        }
        if (A <= z) {
            x = (z - A) / 2 + A
        } else {
            x = (A - z) / 2 + z
        }
        u = {
            dist: Math.round(Math.sqrt(Math.pow(y - w, 2) + Math.pow(A - z, 2))),
            x: Math.round(v),
            y: Math.round(x)
        };
        return u
    }
})(jm, Mobi.memberHeadPic);
Mobi.deviceTypeIsMobi = function() {
    var c = navigator.userAgent.toLowerCase();
    var h = c.match(/ipad/i) == "ipad";
    var j = c.match(/iphone os/i) == "iphone os";
    var f = c.match(/midp/i) == "midp";
    var d = c.match(/rv:1.2.3.4/i) == "rv:1.2.3.4";
    var e = c.match(/ucweb/i) == "ucweb";
    var a = c.match(/android/i) == "android";
    var b = c.match(/windows ce/i) == "windows ce";
    var k = c.match(/windows mobile/i) == "windows mobile";
    if (h || j || f || d || e || a || b || k) {
        return true
    } else {
        return false
    }
};
Mobi.reloadMemberImg = function(b, f) {
    var d = jm("#headPic"),
        e = jm(".picArea"),
        a = Number(e.height()),
        h = Number(e.width());
    if (b == "new") {
        var c = new Image();
        c.src = f.smallPath;
        c.onload = function() {
            d.attr("src", f.smallPath);
            imgTop = (a - d.height()) / 2;
            imgLeft = (h - d.width()) / 2;
            d.css({
                top: imgTop + "px",
                left: imgLeft + "px"
            });
            jm(".editHeadPicFooter .saveBtn").attr("newimg", jm.toJSON(f))
        }
    }
};
Mobi.initMemberUploadImg = function(c, d, k, l, h, j, n, b) {
    var m = document.createElement("script");
    m.type = "text/javascript";
    m.src = l;
    m.onload = function() {
        var o = document.createElement("script");
        if (b == "true") {
            o.src = n
        } else {
            o.src = h
        }
        o.type = "text/javascript";
        f.appendChild(o);
        o.onload = function() {
            if (b == "true") {
                Mobi.mobiMemberUploadImgSWF("file_upload", c, d, 1, j)
            } else {
                Mobi.mobiMemberUploadImgHtml("file_upload", c, d, j)
            }
        }
    };
    var f = document.documentElement || document.body;
    f.appendChild(m);
    var a = jm("#headPic").attr("_src");
    var e = new Image();
    e.src = a;
    jm("#headPic").attr("src", a)
};
Mobi.mobiMemberUploadImgSWF = function(e, c, h, b, a) {
    var f = h.split(",");
    var d = {
        file_post_name: "Filedata",
        upload_url: "ajax/memberHeadImgUp_h.jsp",
        button_placeholder_id: e,
        file_size_limit: c + "MB",
        button_image_type: 3,
        file_queue_limit: 1,
        button_cursor: SWFUpload.CURSOR.HAND,
        requeue_on_error: false,
        post_params: {
            ctrl: "Filedata",
            app: 21,
            type: 0,
            fileUploadLimit: c
        },
        file_types: f.join(";"),
        file_dialog_complete_handler: function(j) {
            this._allSuccess = false;
            this.startUpload()
        },
        file_queue_error_handler: function(k, j, l) {
            switch (j) {
                case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:
                    Mobi.ing(LS.mobiFormSubmitCheckFileSizeErr, true);
                    break;
                case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:
                    Mobi.ing(LS.mobiFormSubmitFileUploadNotAllow, true);
                    break;
                case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadOneTimeNum, "1"), true);
                    break;
                default:
                    Mobi.ing(LS.mobiFormSubmitFileUploadReSelect, true);
                    break
            }
        },
        upload_success_handler: function(k, j) {
            var l = jm.parseJSON(j);
            this._allSuccess = l.success;
            this._sysResult = l.msg;
            if (l.success) {
                setTimeout(function() {
                        Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSucess, jm.encodeHtml(k.name)), true)
                    },
                    1800);
                Mobi.reloadMemberImg("new", l)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadFile + k.name + "   " + l.msg)
            }
        },
        upload_error_handler: function(k, j, l) {
            if (j == -280) {
                Mobi.ing(LS.mobiFormSubmitFileUploadFileCancle, false)
            } else {
                if (j == -270) {
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadFileExist, jm.encodeHtml(k.name)), true)
                } else {
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSvrBusy, jm.encodeHtml(k.name)))
                }
            }
        },
        upload_complete_handler: function(j) {
            if (j.filestatus == SWFUpload.FILE_STATUS.COMPLETE) {
                setTimeout(function() {
                        swfObj.startUpload()
                    },
                    swfObj.upload_delay)
            } else {
                if (j.filestatus == SWFUpload.FILE_STATUS.ERROR) {
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSvrBusy, jm.encodeHtml(j.name)))
                }
            }
        },
        upload_start_handler: function(j) {
            Mobi.ing(LS.mobiFormSubmitFileUploadPrepare, false)
        },
        view_progress: function(j, m, l, k) {
            var k = Math.ceil((m / l) * 100);
            if (isNaN(k)) {
                return
            }
            if (k == 100) {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + k + "%", true)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + k + "%", false)
            }
        }
    };
    swfObj = SWFUploadCreator.create(d)
};
Mobi.mobiMemberUploadImgHtml = function(h, d, e, f) {
    var a = e.split(",");
    var c = jm("#_TOKEN").attr("value");
    var j = {
        siteFree: false,
        updateUrlViewRes: "",
        auto: true,
        fileTypeExts: a.join(";"),
        multi: false,
        fileSizeLimit: d * 1024 * 1024,
        breakPoints: true,
        saveInfoLocal: false,
        showUploadedPercent: true,
        removeTimeout: 9999999,
        isDefinedButton: true,
        getFileSizeUrlFlag: true,
        post_params: {
            app: 21,
            type: 0,
            fileUploadLimit: d,
            isSiteForm: true
        },
        isOrnotButton: true,
        buttonText: "",
        uploader: "../ajax/memberHeadImgUp_h.jsp?cmd=mobiUpload&_TOKEN=" + c,
        onUploadStart: function(l) {
            jm("#progressBody_ " + l.id).remove();
            jm("#progressWrap_" + l.id).remove()
        },
        onUploadSuccess: function(l, n) {
            var m = jm.parseJSON(n);
            if (m.success) {
                setTimeout(function() {
                        Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSucess, jm.encodeHtml(l.name)), true)
                    },
                    1800);
                Mobi.reloadMemberImg("new", m)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadFile + l.name + "   " + m.msg)
            }
        },
        onUploadError: function(l, m) {
            jm("#progressWrap_" + l.id).remove();
            Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSvrBusy, jm.encodeHtml(l.name)))
        },
        view_progress: function(l) {
            var l = Math.ceil(l);
            if (isNaN(l)) {
                return
            }
            if (l == 100) {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + l + "%", true)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + l + "%", false)
            }
        }
    };
    upload = jm("#" + h).uploadify(j);
    jm("#" + h).parent(".modifyBtn").on("click",
        function() {
            $(this).find(".selectbtn").trigger("click")
        });
    var k = "file_upload_pt_1";
    var b = "select_btn_pt_1";
    jm("#file_upload_1-button").attr("id", k);
    jm("#select_btn_1").attr("id", b);
    if (Fai.top._manageMode) {
        jm("#file_upload_pt_1").attr("disabled", "true")
    }
};
Mobi.initMemberHeadPic = function(b) {
    var a = jm("#memberHeadPic"),
        c = jm(".icon-pnameIcon");
    if (typeof b.path != undefined) {
        a.attr("src", b.path)
    }
    if (b.width != 0) {
        var f = b.width / c.width(),
            e = -(b.top / f) + "px",
            d = -b.left / f + "px";
        a.css({
            width: b.imgW / f + "px",
            height: b.imgH / f + "px",
            marginTop: e,
            marginLeft: d
        })
    }
};
Mobi.memberProfileSubmit = function(k, a, h) {
    var c = {};
    if (a) {
        if (h) {
            var d = jm("#oldPsw").val();
            if (d == null || d == "") {
                Mobi.ing(LS.memberProfileOldPwdEmpty);
                Mobi.getPreviewObject("oldPsw").focus();
                return
            }
            c.oldPwd = jm.md5(d)
        }
        var j = jm("#newPsw").val();
        if (j == null || j == "") {
            Mobi.ing(LS.memberProfilePwdEmpty);
            Mobi.getPreviewObject("newPsw").focus();
            return
        }
        if (j.length < 4) {
            Mobi.ing(LS.memberProfilePwdMinLength);
            Mobi.getPreviewObject("newPsw").focus();
            return
        }
        var e = jm("#confirmPsw").val();
        if (j != e) {
            Mobi.ing(LS.memberProfilePwdNotMatch);
            Mobi.getPreviewObject("confirmPsw").focus();
            return
        }
        c.pwd = jm.md5(j)
    } else {
        var l = jm("#profileValue").attr("maxlength");
        var f = jm("#profileValue").attr("name");
        var b = jm("#profileValue").val();
        c[f] = b;
        if (b.length > l) {
            Mobi.ing(jm.format(LS.memberProfileUserEditItemMaxLength, f, l));
            Mobi.getPreviewObject("profileValue").focus();
            return false
        }
        if (jm("#profileValue").attr("ismust") === "true") {
            if (b == null || b == "") {
                if (jm(this).is("input")) {
                    Mobi.ing(jm.format(LS.memberSignupUserAddItemIsEmpty, jm("#modifyProfile").find(".title").html()))
                } else {
                    Mobi.ing(jm.format(LS.memberSignupUserAddItemIsEmpty2, jm("#modifyProfile").find(".title").html()))
                }
                Mobi.getPreviewObject("profileValue").focus();
                return false
            }
            if (f === "email" && b.length > 0) {
                if (!jm.isEmail(b)) {
                    Mobi.ing(jm.format(LS.memberProfileItemCorrect, f));
                    Mobi.getPreviewObject("profileValue").focus();
                    return false
                }
            }
        }
    }
    Mobi.ing(LS.memberProfileSubmitting, -1);
    jm(".g_button").removeClass("sendIcon");
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=set",
        data: "id=" + k + "&info=" + jm.encodeUrl(jm.toJSON(c)),
        error: function() {
            Mobi.ing(LS.memberProfileError)
        },
        success: function(m) {
            var n = jm.parseJSON(m);
            if (n.success) {
                Mobi.ing(LS.memberProfileOK, 1);
                document.location.reload()
            } else {
                jm(".g_button").addClass("sendIcon");
                jm(".loginIcon ").hide();
                if (n.rt = -3) {
                    Mobi.ing(LS.memberProfileOldPwdIncorrectError)
                } else {
                    Mobi.ing(LS.memberProfileError)
                }
            }
        }
    })
};
Mobi.getMProtocol = function(a, b) {
    jm("#mProPage .loginHeader").show();
    jm("#webHeaderBox").hide();
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=getProContent",
        error: function() {
            Mobi.ing(LS.memberProfileError)
        },
        success: function(c) {
            var d = jm.parseJSON(c);
            if (d.success) {
                jm("#mProPage").find(".title").html(d.proName);
                jm("#mProPage").find(".set-line").html(d.msg);
                window.scrollTo(0, 0);
                jm("#signupPage").hide();
                jm("#mProPage").show()
            } else {
                alert("服务器连接错误!")
            }
        }
    })
};
Mobi.checkMustItem = function(a) {
    jm(a).find(".mustItem").on("keyup focusout",
        function() {
            var b = true;
            jm(a).find(".mustItem").each(function() {
                if (jm(this).val().trim() === "") {
                    b = false;
                    return
                }
            });
            if (b === true) {
                jm(".sendIcon").removeAttr("disabled")
            }
        })
};
Mobi.setPersonalInfo = function(c) {
    var f = {};
    var e = "";
    var a = "";
    var b = "";
    var h = 0;
    var d = false;
    jm(".infoItem").each(function() {
        e = jm(this).attr("name");
        a = jm(this).val();
        b = jm(this).attr("proptip");
        d = (jm(this).attr("class").indexOf("mustItem") < 0) ? false: true;
        if (!h && d && (a == null || a == "")) {
            Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, b));
            this.focus();
            h = 1
        }
        if (!h && e == "email" && a.length > 0) {
            if (!jm.isEmail(a)) {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, b));
                this.focus();
                h = 1
            }
        }
        if (!h && e == "mobile" && a.length > 0) {
            if (jm(this).attr("disabled") != "disabled") {
                if (!jm.isNationMobile(a)) {
                    Mobi.ing(LS.mobileNumRegular);
                    this.focus();
                    h = 1
                }
            } else {
                a = ""
            }
        }
        f[e] = a;
        if (e == "mobile" && a.length <= 0) {
            f.mobileCt = ""
        }
    });
    if (jm("#modifyPersInfo .acct").attr("disabled") != "") {
        if (jm("#modifyPersInfo .acct").val() == "") {
            h = 1
        } else {
            f.acct = jm("#modifyPersInfo .acct").val()
        }
    }
    if (h === 0) {
        jm.ajax({
            type: "post",
            url: "ajax/member_h.jsp?cmd=set",
            data: "id=" + c + "&info=" + jm.encodeUrl(jm.toJSON(f)),
            error: function() {
                Mobi.ing(LS.memberProfileError)
            },
            success: function(j) {
                var k = jm.parseJSON(j);
                if (k.success) {
                    Mobi.ing(LS.memberProfileOK, 1);
                    document.location.reload()
                } else {
                    if (k.rt == -3) {
                        Mobi.ing(LS.memberProfileOldPwdIncorrectError)
                    } else {
                        if (k.rt == -6) {
                            Mobi.ing(LS.memberAcctExist)
                        } else {
                            if (k.rt == -8) {
                                Mobi.ing(LS.emailPlural)
                            } else {
                                if (k.rt == -9) {
                                    Mobi.ing(LS.mobilePlural)
                                } else {
                                    if (k.mobileErr) {
                                        Mobi.ing(LS.mobileNumRegular)
                                    } else {
                                        Mobi.ing(LS.memberProfileError)
                                    }
                                }
                            }
                        }
                    }
                }
            }
        })
    }
};
Mobi.manageLogin = function() {
    var b = jm(".qqLgnPanel");
    var d = jm(".sinaLgnPanel");
    var a = jm(".wxLgnPanel");
    if (window.parent == window) {
        if (Fai.top._templateFrameId == 2001 || Fai.top._templateFrameId == 2003 || Fai.top._templateFrameId == 2004) {
            if (a.css("display") == "none") {
                if (b.length == 0 && d.length > 0 && a.length == 0) {
                    d.css("margin-left", "4.7rem")
                } else {
                    if (b.length > 0 && d.length == 0 && a.length == 0) {
                        b.css("margin-left", "4.7rem")
                    } else {
                        if (b.length == 0 && d.length == 0 && a.length > 0) {
                            a.css("margin-left", "4.7rem")
                        } else {
                            if (b.length == 0 && d.length > 0 && a.length > 0) {
                                d.css("margin-left", "4.7rem")
                            } else {
                                if (b.length > 0 && d.length == 0 && a.length > 0) {
                                    b.css("margin-left", "4.7rem")
                                }
                            }
                        }
                    }
                }
            } else {
                if (b.length > 0 && d.length > 0 && a.length > 0) {
                    b.css("margin-left", "0.5rem")
                } else {
                    if (b.length > 0 && d.length == 0 && a.length > 0) {
                        b.css("margin-left", "2.4rem")
                    } else {
                        if (b.length == 0 && d.length > 0 && a.length > 0) {
                            d.css("margin-left", "2.4rem")
                        } else {
                            if (b.length == 0 && d.length == 0 && a.length > 0) {
                                a.css("margin-left", "4.7rem")
                            }
                        }
                    }
                }
            }
        }
        return
    }
    jm(".wxLgnPanel").show();
    var c = false;
    if (Fai.top._templateFrameId == 2001 || Fai.top._templateFrameId == 2003 || Fai.top._templateFrameId == 2004) {
        c = true
    }
    if (b.length > 0 && d.length > 0 && a.length > 0) {
        if (c) {
            b.css("margin-left", "0.5rem")
        } else {
            b.css("margin-left", "1.8rem")
        }
    } else {
        if (b.length > 0 && d.length == 0 && a.length > 0) {
            if (c) {
                b.css("margin-left", "2.4rem")
            } else {
                b.css("margin-left", "3.6rem")
            }
        } else {
            if (b.length == 0 && d.length > 0 && a.length > 0) {
                if (c) {
                    d.css("margin-left", "2.4rem")
                } else {
                    d.css("margin-left", "3.6rem")
                }
            } else {
                if (b.length == 0 && d.length > 0 && a.length == 0) {
                    if (c) {
                        d.css("margin-left", "4.7rem")
                    } else {
                        d.css("margin-left", "6rem")
                    }
                } else {
                    if (b.length > 0 && d.length == 0 && a.length == 0) {
                        if (c) {
                            b.css("margin-left", "4.7rem")
                        } else {
                            b.css("margin-left", "6rem")
                        }
                    } else {
                        if (b.length == 0 && d.length == 0 && a.length > 0) {
                            if (c) {
                                a.css("margin-left", "4.7rem")
                            } else {
                                a.css("margin-left", "6rem")
                            }
                        } else {
                            if (b.length == 0 && d.length > 0 && a.length == 0) {
                                if (c) {
                                    d.css("margin-left", "4.7rem")
                                } else {
                                    d.css("margin-left", "6rem")
                                }
                            } else {
                                if (b.length > 0 && d.length == 0 && a.length == 0) {
                                    if (c) {
                                        b.css("margin-left", "4.7rem")
                                    } else {
                                        b.css("margin-left", "6rem")
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    if (jm(".loginContent").find(".notice").length > 0) {
        return
    }
    if (b.length > 0) {
        b.find("#qqLgn").unbind().click(function() {
            Mobi.ing("第三方登录需要在手机上使用。请用手机扫一扫，再尝试该功能。", true)
        })
    }
    if (d.length > 0) {
        d.find("#sinaLgn").unbind().click(function() {
            Mobi.ing("第三方登录需要在手机上使用。请用手机扫一扫，再尝试该功能。", true)
        })
    }
    if (a.length > 0) {
        a.find("#wxLgn").unbind().click(function() {
            Mobi.ing("第三方登录需要在手机上使用。请用手机扫一扫，再尝试该功能。", true)
        })
    }
};
Mobi.hidePlaceholder = function() {
    var e = document.querySelectorAll(".mustItem");
    var d = document.querySelectorAll(".g_input");
    var a = document.querySelectorAll(".g_textArea");
    var c = "";
    for (var b = 0; b < d.length; b++) {
        d[b].onfocus = function() {
            c = this.placeholder;
            this.placeholder = "";
            jm(this).removeClass("fk-inputFontColor")
        };
        d[b].onblur = function() {
            this.placeholder = c;
            jm(this).addClass("fk-inputFontColor")
        }
    }
    for (var b = 0; b < a.length; b++) {
        a[b].onfocus = function() {
            c = this.placeholder;
            this.placeholder = ""
        };
        a[b].onblur = function() {
            this.placeholder = c
        }
    }
};
Mobi.checkLabel = function(a) {
    var b = jm(a).find("span").attr("class");
    if (b === "icon-checkIcon g_mainColor") {
        b = "icon-uncheckIcon g_mainColor";
        jm(a).parent().find("input").attr("checked", "")
    } else {
        if (b === "icon-uncheckIcon g_mainColor") {
            b = "icon-checkIcon g_mainColor";
            jm(a).parent().find("input").removeAttr("checked")
        }
    }
    jm(a).find("span").attr("class", b)
};
Mobi.isEmail = function(a) {
    var b = /^[a-zA-Z0-9][a-zA-Z0-9_=\&\-\.\+]*[a-zA-Z0-9]*@[a-zA-Z0-9][a-zA-Z0-9_\-\.]+[a-zA-Z0-9]$/;
    return b.test(a)
};
Mobi.isNull = function(a) {
    return (typeof a == "undefined") || (a == null) || (!a)
};
Mobi.acquireCode = function(a, b) {
    var c = jm("#acquirerInput").val();
    if (Mobi.isNull(c) || !c) {
        return false
    }
    if (b && Mobi.isEmail(c)) {
        jm.ajax({
            type: "post",
            url: "ajax/mail_h.jsp?cmd=sendMemberPwdEmail",
            data: "memName=" + jm.encodeUrl(c) + "&new=true",
            error: function() {
                Mobi.ing(LS.systemError)
            },
            success: function(d) {
                var d = jm.parseJSON(d);
                if (d.success) {
                    jm("#memCodeSign").val(d.emailCodeSign);
                    Mobi.acquireCodeCountdown(60, a, b)
                } else {
                    if (d.notFound) {
                        Mobi.ing(LS.memberDialogNotFound, true)
                    } else {
                        Mobi.ing(LS.argsError, true)
                    }
                }
            }
        })
    } else {
        if (a && jm.isMobile(c)) {
            jm.ajax({
                type: "post",
                url: "ajax/member_h.jsp?cmd=sendMemberPwdMobileCode",
                data: "memName=" + jm.encodeUrl(c) + "&new=true",
                error: function() {
                    Mobi.ing(LS.systemError)
                },
                success: function(d) {
                    var d = jm.parseJSON(d);
                    if (d.success) {
                        jm("#memCodeSign").val(d.mobileCodeSign);
                        Mobi.acquireCodeCountdown(60, a, b)
                    } else {
                        if (d.argErr) {
                            Mobi.ing(LS.memberDialogSendMobileClose)
                        } else {
                            if (d.apiKeyNotFound) {
                                Mobi.ing(LS.memberDialogYunPianErr)
                            } else {
                                if (d.tplNotFound) {
                                    Mobi.ing(LS.memberDialogMobileTplErr)
                                } else {
                                    if (d.notFound) {
                                        Mobi.ing(LS.memberDialogNotFound)
                                    } else {
                                        if (d.limitOne) {
                                            Mobi.ing(LS.getMobileOneMin)
                                        } else {
                                            if (d.limitTwo) {
                                                Mobi.ing(LS.getMobileHalfHour)
                                            } else {
                                                if (d.noMoney) {
                                                    Mobi.ing(LS.memberDialogMobileMoneyErr)
                                                } else {
                                                    if (d.mobileErr) {
                                                        Mobi.ing(LS.memberDialogSendMobileCodeErr)
                                                    } else {
                                                        if (d.sendLimit) {
                                                            Mobi.ing(LS.memberDialogSendMobileCodeLimit)
                                                        } else {
                                                            if (d.mobileSysErr) {
                                                                Mobi.ing(LS.memberDialogSendMobileSysErr)
                                                            } else {
                                                                if (d.tplNationErr) {
                                                                    Mobi.ing(LS.mobileNationTplErr)
                                                                } else {
                                                                    if (d.systemErr) {
                                                                        Mobi.ing(LS.systemError)
                                                                    } else {
                                                                        Mobi.ing(LS.argsError)
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            })
        } else {
            if (jm.isMobile(c)) {
                Mobi.ing(LS.memberDialogPlzEnterMail)
            } else {
                if (Mobi.isEmail(c)) {
                    Mobi.ing(LS.memberDialogPlzEnterMobile)
                } else {
                    Mobi.ing(LS.memberDialogPlzEnterBoth)
                }
            }
        }
    }
};
Mobi.acquireCodeCountdown = function(c, b, d) {
    jm(".acquireCode").attr("onclick", "");
    var a = setInterval(function() {
            jm(".acquireCode").attr("onclick", "");
            jm(".acquireCode").text(c + "秒后重发");
            if (c < 0) {
                clearInterval(a);
                jm(".acquireCode").text(LS.memberDialogAcquireCode);
                jm(".acquireCode").attr("onclick", "Mobi.acquireCode(" + b + ", " + d + ");return false;")
            }
            c--
        },
        1000)
};
Mobi.memberNewFdPwdStepTwo = function() {
    var e = jm("#memCodeSign").val();
    if (Mobi.isNull(e) || !e) {
        Mobi.ing(LS.memberDialogGetCodeFirst);
        return
    }
    var a = jm("#memCodeInput").val();
    if (Mobi.isNull(a) || !a) {
        Mobi.ing(LS.memberInputCaptcha);
        return
    }
    var d = "";
    var c = jm("#acquirerInput").val();
    if (Mobi.isNull(c) || !c) {
        return false
    } else {
        if (Mobi.isEmail(c)) {
            d = "mail"
        } else {
            if (jm.isMobile(c)) {
                d = "mobile"
            } else {
                return false
            }
        }
    }
    var b = "memCode=" + jm.encodeUrl(a) + "&memCodeSign=" + jm.encodeUrl(e) + "&acquirer=" + jm.encodeUrl(c) + "&mode=" + jm.encodeUrl(d);
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=checkMobileCodeGeneral",
        data: b,
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(f) {
            var f = jm.parseJSON(f);
            if (f.success) {
                jm(".loginContent").html("");
                var h = ["<div>", "<input type='password' class='itemEdit g_input mustItem' style='padding-left: 0.75rem;' id='newPwInput' placeholder='" + LS.memberDialogNewPwd + "' style='margin-left: 0;'>", "<input type='password' class='itemEdit g_input mustItem' style='padding-left: 0.75rem;' id='assureNewPwInput' placeholder='" + LS.memberDialogAssurePwd + "' style='margin-left: 0;'>", "<div class='g_globalLine J_memberFdPwdBtn'>", "<input type='button' class='g_button sendIcon' value='" + LS.memberOtherLgnSure + "' onclick='Mobi.memberNewFdPwdLastStep(" + f.memId + ")'/>", "</div>", "</div>"];
                h = h.join("");
                jm(".loginContent").html(h)
            } else {
                if (f.notFound) {
                    Mobi.ing(LS.memberDialogNotFound, true)
                } else {
                    if (f.rt == 1) {
                        Mobi.ing(LS.memberSignupRegisterCaptchaNotMatch)
                    }
                }
            }
        }
    })
};
Mobi.memberNewFdPwdLastStep = function(b) {
    var d = jm("#newPwInput").val();
    if (Mobi.isNull(d) || !d) {
        Mobi.ing(LS.memberDialogPleaseEnterPwd);
        return
    }
    var a = jm("#assureNewPwInput").val();
    if (Mobi.isNull(a) || !a) {
        Mobi.ing(LS.memberDialogPleaseEnterPwd2);
        return
    }
    if (d !== a) {
        Mobi.ing(LS.memberDialogPwdDifToPwd2);
        return
    }
    if (d.length < 4 || d.length > 20) {
        Mobi.ing(jm.format(LS.memberDialogPwdLimit, 4, 20));
        return
    }
    var c = "newPw=" + jm.md5(d) + "&memId=" + jm.encodeUrl(b);
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=setMemberPwdGeneral",
        data: c,
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(e) {
            var e = jm.parseJSON(e);
            if (e.success) {
                jm(".loginContent").html("");
                var f = ['<div class="formMiddleContent moduleContent" id="memberFdPwdStepLast">', '<div class="loginContent">', '<div class="g_globalLine" style="text-align: center;">', '<div class="g_circle" style="margin: 1rem auto 1.5rem">', '<span class="icon-lockstarIcon g_mainColor"></span>', "</div>", '<span class="title">', LS.memberDialogPwdforced, "</span>", "</div>", '<div class="g_globalLine" style="margin-top:1.5rem;">', '<input type="button" class="g_button sendIcon" onclick="document.location.href=\'login.jsp\'" value="', LS.memberDialogLoginInstantly, '"/>', "</div> ", "</div>", "</div>", ];
                f = f.join("");
                jm(".loginContent").html(f)
            } else {
                if (e.notFound) {
                    Mobi.ing(LS.memberDialogNotFound, true)
                } else {
                    Mobi.ing(LS.argsError, true)
                }
            }
        }
    })
};
Mobi.memberFdPwd = function(a, d) {
    jm(".J_showFindPwWay").html("");
    var c = jm.trim(jm("#macct").val());
    if (c == "") {
        Mobi.ing(LS.memberInputAcct, true);
        Mobi.getPreviewObject("macct").focus();
        return
    }
    function b(k, j, f) {
        var h = Fai.top.jm,
            e;
        if (h.type(j) !== "array" || h.type(k) !== "string") {
            return ""
        }
        e = j.length;
        while (e) {
            e--;
            if (h.type(j[e]) === "string") {
                j[e] = [f, j[e], f].join("")
            }
        }
        return k + "(" + j.join(",") + ")"
    }
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=getMAcctMail",
        data: "mAcct=" + jm.encodeUrl(c),
        error: function() {
            Mobi.ing(LS.systemError, false)
        },
        success: function(e) {
            var e = jm.parseJSON(e);
            if (e.success) {
                if (!e.findPwByMobileOpen) {
                    if (e.noMail) {
                        Mobi.ing(LS.memberDialogNoEmailMsg);
                        return
                    }
                }
                if (!e.findPwByMailOpen) {
                    if (e.mobile == null || e.mobile == "null" || "" == e.mobile) {
                        Mobi.ing(LS.memberDialogNoMobile);
                        return
                    }
                }
                if (e.noMail && (e.mobile == "null" || "" == e.mobile)) {
                    Mobi.ing(LS.memberDialogNoMailMobile);
                    return
                }
                jm(".J_memberFdPwdBtn").remove();
                var f = [];
                f.push('<div class="fk-mem-findPwStepOneFindWay"style="">');
                f.push(LS.memberFdPwdWay + ":");
                f.push("</div>");
                if (e.findPwByMailOpen) {
                    if (e.noMail) {
                        f.push('<div class="fk-mem-findPwStepOne" onclick="Mobi.findPwByMailShowNoMail()">')
                    } else {
                        f.push('<div class="fk-mem-findPwStepOne" onclick="' + b("Mobi.findPwByMailStepTwo", [c, a, d, e.mail], "'") + '">')
                    }
                    f.push('<span class="content">');
                    f.push(LS.memberFdPwdWayByMail);
                    f.push("</span>");
                    f.push('<span class="icon-gGoforward">');
                    f.push("</span>");
                    f.push("</div>")
                }
                if (e.findPwByMobileOpen) {
                    if (e.mobile == "null" || "" == e.mobile) {
                        f.push('<div class="fk-mem-findPwStepOne" onclick="Mobi.findPwByMobileShowNoMb()">')
                    } else {
                        f.push('<div class="fk-mem-findPwStepOne" onclick="' + b("Mobi.sendFindPwMobileCode", [c, true, a, d, e.mobile], "'") + '">')
                    }
                    f.push('<span class="content">');
                    f.push(LS.memberFdPwdWayByMobile);
                    f.push("</span>");
                    f.push('<span class="icon-gGoforward">');
                    f.push("</span>");
                    f.push("</div>")
                }
                f = f.join("");
                jm(".J_showFindPwWay").append(f)
            } else {
                if (e.notFound) {
                    Mobi.ing(LS.memberDialogNotFound, true)
                } else {
                    Mobi.ing(LS.argsError, true)
                }
            }
        }
    })
};
Mobi.findPwByMailShowNoMail = function() {
    Mobi.ing(LS.memberShowNoMail)
};
Mobi.findPwByMobileShowNoMb = function() {
    Mobi.ing(LS.memberShowNoMobile)
};
Mobi.findPwByMailStepTwo = function(c, b, e, a) {
    jm("#memberFdPwdStepOne").hide();
    var d = ['<div class="formMiddleContent moduleContent" id="memberFdPwdStepTwo">', '<div class="loginHeader webHeaderBg">', '<a onclick="history.go(0);" class="g_close icon-gClose"></a>', '<span class="title pageTitle">', LS.memberDialogFwdStepOneTitle, "</span>", "</div>", '<div class="g_globalLine fk-mem-findPw-showMsg"><div class="showMsg">', "", LS.memberDialogSendedMsg, "&nbsp", a, "&nbsp", LS.memberDialogViewMail, "", "</div></div>", '<div class="loginContent">', '<div class="g_globalLine">', '<input type="text" maxlength="4"  id="memEmailCode" class="itemEdit g_input mustItem" placeholder="', LS.memberDialogPleaseEnterCode, '"/>', '<input style="display:none;" type="text" id="memMailCodeSign" disabled/>', '<span class="icon-pswIcon icon-codeIcon g_mainColor"></span>', "</div>", '<div class="g_globalLine">', '<input type="button" id="sendEmailCode" style="width:49%;float:left;" class="g_button sendIcon" onclick="Mobi.sendMemberEmailPwdCode(\'' + c + '\');" value="', LS.memberDialogReSendMsg, '(60)" disabled/>', '<input type="button" style="width:49%;float:left;margin-left:2%;" class="g_button sendIcon" onclick="Mobi.memberFdPwdStepThree(\'' + c + "','" + b + "','" + e + '\');" value="', LS.memberDialogNextStep, '"/>', "</div>", "</div>", "</div>", ];
    d = d.join("");
    jm(".middleCenter").append(d);
    Mobi.sendMemberEmailCodeImgFix("#memEmailCode", b);
    Mobi.sendMemberEmailPwdCode(c)
};
Mobi.findPwByMobileStepTwo = function(d, b, h, c, a) {
    jm("#memberFdPwdStepOne").hide();
    jm("#memberFdPwdStepTwo").remove();
    var e = ['<div class="formMiddleContent moduleContent" id="memberFdPwdStepTwo">', '<div class="loginHeader webHeaderBg">', '<a onclick="history.go(0);" class="g_close icon-gClose"></a>', '<span class="title pageTitle">', LS.memberDialogFwdStepOneTitle, "</span>", "</div>", '<div class="g_globalLine fk-mem-findPw-showMsg"><div class="showMsg">', "", LS.fdPwdHasSendMobileCode, "&nbsp", c, "&nbsp", LS.pleaseCheckMobileCode, "", "</div></div>", '<div class="loginContent">', '<div class="g_globalLine fk-findPwByMobile">', '<input type="text" maxlength="6"  id="memEmailCode" class="itemEdit g_input mustItem" placeholder="', LS.inputMobileCode, '"/>', '<input style="display:none;" type="text" id="memMailCodeSign" value="' + a + '" disabled/>', '<span class="icon-pswIcon icon-codeIcon g_mainColor"></span>', "</div>", '<div class="g_globalLine">', '<input type="button" id="sendEmailCode" style="width:49%;float:left;" class="g_button sendIcon" onclick="Mobi.sendFindPwMobileCode(\'' + d + "','" + true + "','" + b + "','" + h + "','" + c + '\')" value="', LS.memberDialogReSendMsg, '(60)" disabled/>', '<input type="button" style="width:49%;float:left;margin-left:2%;" class="g_button sendIcon" onclick="Mobi.memberFdPwdByMobileStepThree(\'' + d + "','" + b + "','" + h + '\')" value="', LS.memberDialogNextStep, '"/>', "</div>", "</div>", "</div>", ];
    e = e.join("");
    jm(".middleCenter").append(e);
    Mobi.sendMemberEmailCodeImgFix("#memEmailCode", b);
    var f = jm("#sendEmailCode");
    Mobi.codeTimeCountDown(f)
};
Mobi.sendFindPwMobileCode = function(d, b, a, e, c) {
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=sendMemberPwdMobileCode",
        data: "memName=" + jm.encodeUrl(d),
        error: function() {
            Mobi.ing(LS.systemError, false)
        },
        success: function(f) {
            var f = jm.parseJSON(f);
            if (f.success) {
                if (b) {
                    Mobi.findPwByMobileStepTwo(d, a, e, c, f.mobileCodeSign)
                }
            } else {
                if (f.argErr) {
                    Mobi.ing(LS.memberDialogSendMobileClose)
                } else {
                    if (f.apiKeyNotFound) {
                        Mobi.ing(LS.memberDialogYunPianErr)
                    } else {
                        if (f.tplNotFound) {
                            Mobi.ing(LS.memberDialogMobileTplErr)
                        } else {
                            if (f.notFound) {
                                Mobi.ing(LS.memberDialogNotFound)
                            } else {
                                if (f.limitOne) {
                                    Mobi.ing(LS.getMobileOneMin)
                                } else {
                                    if (f.limitTwo) {
                                        Mobi.ing(LS.getMobileHalfHour)
                                    } else {
                                        if (f.noMoney) {
                                            Mobi.ing(LS.memberDialogMobileMoneyErr)
                                        } else {
                                            if (f.mobileErr) {
                                                Mobi.ing(LS.memberDialogSendMobileCodeErr)
                                            } else {
                                                if (f.sendLimit) {
                                                    Mobi.ing(LS.memberDialogSendMobileCodeLimit)
                                                } else {
                                                    if (f.mobileSysErr) {
                                                        Mobi.ing(LS.memberDialogSendMobileSysErr)
                                                    } else {
                                                        if (f.systemErr) {
                                                            Mobi.ing(LS.systemError)
                                                        } else {
                                                            if (f.tplNationErr) {
                                                                Mobi.ing(LS.mobileNationTplErr)
                                                            } else {
                                                                Mobi.ing(LS.argsError)
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    })
};
Mobi.sendMemberEmailCodeImgFix = function(b, a) {
    if (a == 2052) {
        jm(b).css("padding-left", "3.5rem")
    } else {
        jm(b).css("padding-left", "2rem")
    }
};
Mobi.sendMemberEmailPwdCode = function(a) {
    var b = jm("#sendEmailCode");
    Mobi.codeTimeCountDown(b);
    jm.ajax({
        type: "post",
        url: "ajax/mail_h.jsp?cmd=sendMemberPwdEmail",
        data: "memName=" + jm.encodeUrl(a),
        error: function() {
            Mobi.ing(LS.systemError, false)
        },
        success: function(c) {
            var c = jm.parseJSON(c);
            if (c.success) {
                jm("#memMailCodeSign").val(c.emailCodeSign)
            } else {
                if (c.notFound) {
                    Mobi.ing(LS.memberDialogNotFound, true)
                } else {
                    Mobi.ing(LS.argsError, true);
                    b.val(LS.memberDialogReSendMsg)
                }
            }
        }
    })
};
Mobi.codeTimeCountDown = function(c) {
    var b = 60;
    a(c);
    function a(d) {
        if (b == 0) {
            d.removeAttr("disabled");
            d.val(LS.memberDialogReSendMsg);
            return
        } else {
            d.attr("disabled", true);
            d.val("" + LS.memberDialogReSendMsg + "(" + b + ")");
            b--
        }
        setTimeout(function() {
                a(d)
            },
            1000)
    }
};
Mobi.memberFdPwdByMobileStepThree = function(b, a, f) {
    var d = jm("#memEmailCode").val();
    if (!d || d.length < 0) {
        Mobi.ing(LS.inputMobileCode);
        return
    }
    var c = jm("#memMailCodeSign").val();
    var e = "memMobileCode=" + jm.encodeUrl(d) + "&memMobileCodeSign=" + jm.encodeUrl(c) + "&memName=" + jm.encodeUrl(b);
    jm.ajax({
        type: "post",
        url: "ajax/member_h.jsp?cmd=checkFindPwdByMobileCode",
        data: e,
        error: function() {
            Mobi.ing(LS.systemError, false)
        },
        success: function(h) {
            var h = jm.parseJSON(h);
            if (h.success) {
                Mobi.memberFdPwdStepThreeSd(b, a, f)
            } else {
                if (h.argErr) {
                    Mobi.ing(LS.argsError, true)
                } else {
                    if (h.notFound) {
                        Mobi.ing(LS.memberDialogNotFound, true)
                    } else {
                        Mobi.ing(LS.reGetMobileCode, true)
                    }
                }
            }
        }
    })
};
Mobi.memberFdPwdStepThree = function(d, c, f) {
    var a = jm("#memEmailCode").val();
    if (!a || a.length < 0) {
        Mobi.ing(LS.memberDialogPleaseEnterCode);
        return
    }
    var b = jm("#memMailCodeSign").val();
    var e = "memEmailCode=" + jm.encodeUrl(a) + "&memMailCodeSign=" + jm.encodeUrl(b) + "&memName=" + jm.encodeUrl(d);
    jm.ajax({
        type: "post",
        url: "ajax/mail_h.jsp?cmd=checkPwdEmailCode",
        data: e,
        error: function() {
            Mobi.ing(LS.systemError, false)
        },
        success: function(h) {
            var h = jm.parseJSON(h);
            if (h.success) {
                Mobi.memberFdPwdStepThreeSd(d, c, f)
            } else {
                Mobi.ing(LS.memberDialogCodeMailFailure, true)
            }
        }
    })
};
Mobi.memberFdPwdStepThreeSd = function(b, a, d) {
    jm("#memberFdPwdStepTwo").hide();
    var c = ['<div class="formMiddleContent moduleContent" id="memberFdPwdStepThree">', '<div class="loginHeader webHeaderBg">', '<a onclick="history.go(0);" class="g_close icon-gClose"></a>', '<span class="title  pageTitle">', LS.memberDialogResetPwd, "</span>", "</div>", '<div class="loginContent">', '<div class="g_globalLine">', '<input type="password" id="memPwd" class="itemEdit g_input mustItem" placeholder="', LS.memberDialogPleaseEnterPwd, '"/>', '<span class="icon-pswIcon icon-npwdIcon g_mainColor"></span>', "</div>", '<div class="g_globalLine">', '<input type="password" id="memPwd2" class="itemEdit g_input mustItem" placeholder="', LS.memberDialogPleaseEnterPwd2, '"/>', '<span class="icon-pswIcon icon-npwdIcon g_mainColor"></span>', "</div>", '<div class="g_globalLine">', '<input type="button" class="g_button sendIcon" onclick="Mobi.memberFdPwdStepLast(\'' + b + "','" + d + '\');" value="', LS.memberDialogConfirm, '"/>', "</div> ", "</div>", "</div>", ];
    c = c.join("");
    jm(".middleCenter").append(c);
    Mobi.sendMemberEmailCodeImgFix("#memPwd", a);
    Mobi.sendMemberEmailCodeImgFix("#memPwd2", a)
};
Mobi.memberFdPwdStepLast = function(b, e) {
    var a = jm("#memPwd").val();
    var d = jm("#memPwd2").val();
    if (!a) {
        Mobi.ing(LS.memberDialogPleaseEnterPwd, true);
        return
    } else {
        if (!d) {
            Mobi.ing(LS.memberDialogPleaseEnterPwd2, true);
            return
        } else {
            if (a != d) {
                Mobi.ing(LS.memberDialogPwdDifToPwd2, true);
                return
            } else {
                if (a.length < 4 || a.length > 20) {
                    Mobi.ing(jm.format(LS.memberDialogPwdLimit, 4, 20));
                    return
                }
            }
        }
    }
    var c = "&memPwd=" + jm.md5(a) + "&memName=" + jm.encodeUrl(b);
    jm.ajax({
        type: "post",
        url: "ajax/mail_h.jsp?cmd=setMemberPwd",
        data: c,
        error: function() {
            Mobi.ing(LS.systemError, false)
        },
        success: function(f) {
            var f = jm.parseJSON(f);
            if (f.success) {
                jm("#memberFdPwdStepThree").hide();
                var h = ['<div class="formMiddleContent moduleContent" id="memberFdPwdStepLast">', '<div class="loginContent">', '<div class="g_globalLine" style="text-align: center;">', '<div class="g_circle">', '<span class="icon-lockstarIcon g_mainColor"></span>', "</div>", '<span class="title">', LS.memberDialogPwdforced, "</span>", "</div>", '<div class="g_globalLine" style="margin-top:1.5rem;">', '<input type="button" class="g_button sendIcon" onclick="document.location.href=\'' + e + '\'" value="', LS.memberDialogHome, '"/>', "</div> ", "</div>", "</div>", ];
                h = h.join("");
                jm(".middleCenter").append(h)
            } else {
                if (f.notFound) {
                    Mobi.ing(LS.memberDialogNotFound, true)
                } else {
                    Mobi.ing(LS.argsError, true)
                }
            }
        }
    })
};
Mobi.memberModuleReturnUrlInit = function(a) {
    var b = Mobi.getPreviewWindow().location.href;
    var c = Mobi.getUrlParam(b, "returnUrl");
    if (!c) {
        c = a
    }
    jm("#profile").find(".loginHeader .g_close").attr("href", c)
};
Mobi.fixMyMallOrderDiviceLine = function() {
    jm(".mallDiviceLine20 .mallOrderDiviceItem").css("width", "16%");
    jm(".mallDiviceLine20 .diviceOrderNum").css("right", "0.32rem")
};
Mobi.initModulePhotoList = function(u, e, c) {
    if (!u || !c) {
        return
    }
    var n = Mobi.getPreviewObject("photoListDetailShow" + u);
    if (n) {
        n.parentNode.removeChild(n)
    }
    module = "module" + u;
    var k = document.getElementById(module),
        d = document.getElementById("webFooterBox"),
        v = document.createElement("div"),
        o = document.createElement("div"),
        h = document.createElement("div"),
        m = document.createElement("div");
    m.className = "photoDetailClose";
    v.appendChild(m);
    o.className = "webPhotoListDetail";
    o.id = "webPhotoListDetail" + u;
    for (var r = 0; r < c.length; r++) {
        var a = document.createElement("div");
        a.className = "photoDetail";
        var j = document.createElement("img");
        var l = document.createElement("span");
        l.className = "imageSpan";
        j.setAttribute("vwidth", c[r].width);
        j.setAttribute("vheight", c[r].height);
        a.appendChild(l);
        a.appendChild(j);
        o.appendChild(a)
    }
    v.appendChild(o);
    h.className = "photoDetailDescription descriptionClose";
    h.id = "photoDetailDescription" + u;
    var p = document.createElement("div");
    p.className = "handleDiv";
    var b = document.createElement("div");
    b.className = "drawer_handle";
    var t = document.createElement("div");
    t.className = "handleIcon handleUp";
    p.appendChild(b);
    p.appendChild(t);
    h.appendChild(p);
    var s = document.createElement("div");
    s.className = "descriptionFilter";
    h.appendChild(s);
    var f = document.createElement("div");
    f.className = "descriptionDom";
    f.id = "descriptionDom" + u;
    h.appendChild(f);
    v.appendChild(h);
    v.className = "photoListDetailShow";
    v.id = "photoListDetailShow" + u;
    d.appendChild(v);
    var q = jm(o).carousel({
        carouselIndex: 3,
        photoAllJson: c,
        preventDefaults: false,
        photoListDetailShowDom: v,
        moduleId: u
    });
    jm("#webModuleContainer").on("click", "#" + module + " .photoModule img",
        function() {
            if (this.getAttribute("linkType") != 1) {
                return
            }
            Mobi.getPreviewObject("photoListDetailShow" + u).style.top = "0px";
            var w = parseInt(this.getAttribute("photoIndex"));
            q.onMoveIndex(w, "1ms", c[w]);
            q.photoDetailAjax(c[w])
        });
    jm(o).bind("click",
        function(z) {
            var y = z.target || z.srcElement;
            if (y.className == "prevPhoto" || y.className == "nextPhoto") {
                return
            }
            var x = this.querySelector(".prevPhoto"),
                w = this.querySelector(".nextPhoto");
            if (this.getAttribute("full") == "true") {
                this.setAttribute("full", false);
                m.style.opacity = 1;
                h.style.opacity = 1;
                w.style.opacity = 1;
                x.style.opacity = 1;
                h.style.visibility = "visible";
                m.style.visibility = "visible";
                w.style.visibility = "visible";
                x.style.visibility = "visible";
                if (h.className.indexOf("descriptionClose") === -1) {
                    o.className = "webPhotoListDetail photoFilter"
                }
            } else {
                this.setAttribute("full", true);
                m.style.opacity = 0;
                h.style.opacity = 0;
                w.style.opacity = 0;
                x.style.opacity = 0;
                h.style.visibility = "hidden";
                m.style.visibility = "hidden";
                w.style.visibility = "hidden";
                x.style.visibility = "hidden";
                o.className = "webPhotoListDetail"
            }
        });
    jm(h).bind("click",
        function(z) {
            var x = this.querySelector(".handleIcon");
            if (this.className.indexOf("descriptionOpen") === -1) {
                var y = f.offsetHeight,
                    w = Mobi.getPreviewWindow().innerHeight;
                if (jm.os.android) {
                    w = Mobi.getPreviewWindow().screen.height / Mobi.getPreviewWindow().devicePixelRatio - Mobi.getPreviewWindow().screenTop
                }
                if (w > y) {
                    if (f.innerHTML) {
                        this.style.bottom = "0px";
                        o.className = "webPhotoListDetail photoFilter"
                    }
                } else {
                    this.style.bottom = w * 0.8 - y + "px";
                    o.className = "webPhotoListDetail photoFilter"
                }
                this.className = "photoDetailDescription descriptionOpen";
                if (f.innerHTML) {
                    x.className = "handleIcon handleDown"
                }
            } else {
                if (f.innerHTML) {
                    this.style.bottom = -(f.offsetHeight - b.offsetHeight) + "px"
                }
                this.className = "photoDetailDescription descriptionClose";
                o.className = "webPhotoListDetail";
                if (f.innerHTML) {
                    x.className = "handleIcon handleUp"
                }
            }
        });
    jm(m).bind("click",
        function() {
            v.style.top = "150%";
            o.className = "webPhotoListDetail"
        })
};
Mobi.clickPhoto = function(a, c) {
    var b = Mobi.getPreviewWindow;
    if (Fai.top.document.getElementById("mobiReviewPageFrame")) {
        Fai.top.document.getElementById("mobiReviewPageFrame").scrolling = "no"
    }
    jm(".imgDetailDiv").show();
    Mobi.getPhotoDetail(a, c)
};
Mobi.exitPhotoDetail = function() {
    if (Fai.top.document.getElementById("mobiReviewPageFrame")) {
        Fai.top.document.getElementById("mobiReviewPageFrame").scrolling = "yes"
    }
    jm(".imgDetailDiv").hide()
};
Mobi.getPhotoDetail = function(a, b) {
    jm.ajax({
        type: "post",
        url: "ajax/photo_h.jsp",
        data: "cmd=get&id=" + jm.encodeUrl(b) + "&groupId=" + jm.encodeUrl(a),
        error: function() {},
        success: function(d) {
            d = jm.parseJSON(d);
            jm(".showImg").attr("src", d.picPath);
            var c = parseInt(d.nextId) === -1 ? false: true;
            var e = parseInt(d.prevId) === -1 ? false: true;
            if (e) {
                jm(".prevPhoto").show();
                jm(".prevPhoto").attr("onclick", "Mobi.getPhotoDetail('" + d.groupId + "','" + d.prevId + "')")
            } else {
                jm(".prevPhoto").hide()
            }
            if (c) {
                jm(".nextPhoto").show();
                jm(".nextPhoto").attr("onclick", "Mobi.getPhotoDetail('" + d.groupId + "','" + d.nextId + "')")
            } else {
                jm(".nextPhoto").hide()
            }
            jm(".imgDesc").html(d.basic);
            jm(".imgName").html(d.name);
            jm(".imgDetailArea").html(d.detail)
        }
    })
};
Mobi.toNextPhoto = function(h) {
    var b = jm(Mobi.getPreviewObject("module" + h)).find(".photoBox");
    var d = parseInt(jm(b).css("width")) - 300;
    var f = parseInt(jm(b).css("left").split("px")[0]);
    var a = Math.abs(f / 300) + 2;
    var c = jm(b).find("li:nth-child(" + a + ") img").attr("lazysrc");
    if (c) {
        jm(b).find("li:nth-child(" + a + ") img").attr("src", c)
    }
    if (f <= -d) {
        if (!jm(b).hasClass("moving")) {
            jm(b).addClass("moving");
            jm(b).css("left", (f - 50) + "px");
            setTimeout(function() {
                    jm(b).css("left", (f) + "px");
                    jm(b).removeClass("moving")
                },
                600)
        }
        return
    }
    var e = f - 300;
    jm(b).css("left", e + "px")
};
Mobi.toPrevPhoto = function(e) {
    var a = jm(Mobi.getPreviewObject("module" + e)).find(".photoBox");
    var b = parseInt(jm(a).css("width"));
    var d = parseInt(jm(a).css("left").split("px")[0]);
    if (d == 0) {
        if (!jm(a).hasClass("moving")) {
            jm(a).addClass("moving");
            jm(a).css("left", (d + 50) + "px");
            setTimeout(function() {
                    jm(a).css("left", (d) + "px");
                    jm(a).removeClass("moving")
                },
                600)
        }
        return
    }
    var c = d + 300;
    jm(a).css("left", c + "px")
};
Mobi.handEvent = function(b) {
    var a = jm(Mobi.getPreviewObject("module" + b)).find(".photoModule");
    jm(a).bind("swipeLeft",
        function() {
            Mobi.toNextPhoto(b);
            return false
        });
    jm(a).bind("swipeRight",
        function() {
            Mobi.toPrevPhoto(b);
            return false
        })
};
Mobi.autoSetPhotoHeight = function(a) {
    Mobi.unifiedAttrVal(jm(Mobi.getPreviewObject("module" + a)), ".photoModule .photoDiv", "height")
};
Mobi.initPhotoSwipe = function(a, d, h, e, c) {
    var k = Mobi.getPreviewObject("imgName" + a);
    jm(k).html(d[0]);
    var j = Mobi.getJQMobi();
    var f = Mobi.getPreviewObject("photoSwipe" + a);
    if (!f) {
        return
    }
    if (c == 1) {
        Mobi.initScaleImage(f)
    } else {
        if (c == 2) {
            Mobi.initDefScaleImage(f)
        } else {
            Mobi.noScaleImage(f)
        }
    }
    j("#photoSwipe" + a).swipehandle(f, {
        auto: h,
        speed: e,
        continuous: true,
        bulletsClick: true,
        callback: function(m) {
            var l = b.length;
            while (l--) {
                b[l].className = " "
            }
            if (!b[m]) {
                b[m - b.length].className = "on";
                jm(k).html(d[m - b.length])
            } else {
                b[m].className = "on";
                jm(k).html(d[m])
            }
        }
    });
    j("#photoSwipe" + a).find(".imageDiv").show();
    if (!f.querySelector("#bullets" + a)) {
        return
    }
    var b = f.querySelector("#bullets" + a).getElementsByTagName("li")
};
Mobi.initScaleImage = function(c) {
    if (c) {
        var h = c.querySelectorAll("img"),
            e = c.clientWidth,
            f = 0;
        if (h) {
            for (var j = 0; j < h.length; j++) {
                var a = parseInt(h[j].getAttribute("vwidth") ? h[j].getAttribute("vwidth") : 1),
                    k = parseInt(h[j].getAttribute("vheight") ? h[j].getAttribute("vheight") : 1),
                    d = k / a;
                if (d === NaN) {
                    continue
                }
                h[j].style.width = e + "px";
                h[j].style.height = "100%";
                if (d > f) {
                    f = d
                }
            }
            if (e * f != 0) {
                c.style.height = Math.floor(e * f) + "px"
            }
            if (c.className == "proImgSwipe") {
                var b = c.querySelector(".proDetailImg");
                if (b) {
                    c.style.height = b.clientHeight + "px"
                }
            }
        }
    }
};
Mobi.noScaleImage = function(c) {
    if (c) {
        var h = c.querySelectorAll("img"),
            e = c.clientWidth,
            f = 0;
        if (h) {
            for (var j = 0; j < h.length; j++) {
                var a = parseInt(h[j].getAttribute("vwidth") ? h[j].getAttribute("vwidth") : 1),
                    k = parseInt(h[j].getAttribute("vheight") ? h[j].getAttribute("vheight") : 1),
                    d = k / a;
                if (d === NaN) {
                    continue
                }
                h[j].style.width = e + "px";
                h[j].style.height = Math.floor(e * d) + "px";
                if (d > f) {
                    f = d
                }
            }
            if (e * f != 0) {
                c.style.height = Math.floor(e * f) + "px"
            }
            if (c.className == "proImgSwipe") {
                var b = c.querySelector(".proDetailImg");
                if (b) {
                    c.style.height = b.clientHeight + "px"
                }
            }
        }
    }
};
Mobi.initDefScaleImage = function(c) {
    if (c) {
        var k = c.querySelectorAll("img"),
            h = c.clientWidth,
            j = 0;
        var a = c.querySelectorAll(".photoImageItem");
        var l = c.querySelectorAll(".imageMiddleSpan");
        if (k) {
            for (var m = 0; m < k.length; m++) {
                var b = parseInt(k[m].getAttribute("vwidth") ? k[m].getAttribute("vwidth") : 1),
                    n = parseInt(k[m].getAttribute("vheight") ? k[m].getAttribute("vheight") : 1),
                    e = n / b;
                if (e === NaN) {
                    continue
                }
                var f = b / n,
                    d = h / 417;
                if (d <= f) {
                    jm(k[m]).css({
                        width: f * 417 + "px",
                        height: "417px",
                        maxWidth: "inherit",
                        marginLeft: ((h - f * 417) / 2) + "px"
                    });
                    jm(l[m]).css("display", "none")
                } else {
                    jm(k[m]).css({
                        height: h / f + "px",
                        width: h + "px",
                        marginTop: ((417 - h / f) / 2) + "px"
                    });
                    jm(l[m]).css("display", "none")
                }
            }
            if (h * j != 0) {
                c.style.height = Math.floor(h * j) + "px"
            }
        }
    }
};
Mobi.initPhotoImageSwipe = function(a, e) {
    var b = Mobi.getJQMobi();
    var d = Mobi.getPreviewObject(a),
        c = d.querySelector(".imgName");
    if (!d) {
        return
    }
    if (e == 1) {
        Mobi.initScaleImage(d)
    }
    if (e == 2) {
        Mobi.initDefScaleImage(d)
    }
    b("#" + a).swipehandle(d, {
        isOpenNextAndPrevious: true,
        callback: function(k, f) {
            var j = f.querySelector("img"),
                h = j.getAttribute("lazysrc");
            if ( !! h && !j.src) {
                j.src = h;
                j.onload = function() {}
            }
            if (j.alt) {
                c.innerHTML = j.alt
            } else {
                c.innerHTML = ""
            }
            setTimeout(function() {
                    jm(j).trigger("clickPic")
                },
                300)
        }
    })
};
Mobi.initModulePhotoSwipe = function(f, c) {
    var b;
    if (c === "rich") {
        b = document.querySelectorAll("." + f + " img")
    } else {
        b = document.querySelectorAll("#" + f + " img")
    }
    if (b.length < 1) {
        return
    }
    var e = {
            imageScaleMethod: "fitNoUpscale",
            getImageCaption: function(h, j) {
                var l, k;
                l = h + "/" + j;
                k = document.createElement("div");
                k.appendChild(document.createTextNode(l));
                return k
            },
            getToolbar: function() {
                return '<div class="ps-toolbar-close"><div class="ps-toolbar-content"></div></div><div class="ps-toolbar-previous"><div class="ps-toolbar-content"></div></div><div class="ps-toolbar-next"><div class="ps-toolbar-content"></div></div>'
            }
        },
        d = window.Code.PhotoSwipe,
        a = d.attach(b, e)
};
Mobi.initModulePhotoGroupManage = function(a) {
    if (!a) {
        return
    }
    if (!a.moduleId) {
        return
    }
    jm("#" + a.photoParent).find(">." + a.photo).each(function() {
        var c = jm(this);
        var b = c.find("." + a.photoChild).eq(0);
        c.mouseover(function() {
            var h = c.attr("id").replace(/[^0-9]/ig, "");
            var j = c.attr("class");
            var f = c.find(".photoGroup-title").text();
            var d = [{
                operationText: "编辑图册",
                className: "edit",
                evalScript: "Mobi.logDog(100048, 0);top.Mobi.popupWindow({title:'编辑图册', frameSrcUrl:'" + a.frameSrcUrl + "&id=" + h + "&_mobi=1', width:860, height:682, version: 2 })"
            },
                {
                    operationText: "删除图册",
                    className: "close",
                    evalScript: "Mobi.deletePhotoGroupManage('" + h + "', '" + Fai.top.Fai.encodeHtmlJs(f) + "', '', 0)"
                }];
            var e = "";
            if (/photoGroupStyle1/.test(j)) {
                e = Mobi.addEditLayer(b, d, 6, a)
            } else {
                e = Mobi.addEditLayer(b, d, 106, a)
            }
        }).mouseleave(function() {
            var d = c.attr("class");
            if (/photoGroupStyle1/.test(d)) {
                Mobi.removeEditLayer(b)
            } else {
                Mobi.removeEditLayer(b, null, 106)
            }
        })
    })
};
Mobi.deletePhotoGroupManage = function(f, c, a, b) {
    Mobi.removeAllEditLayer();
    if (Fai.top.Mobi.checkSaveBar()) {
        return
    }
    if (c.length > 15) {
        c = c.slice(0, 15) + "..."
    }
    c = jm.encodeHtml(c);
    var e = new Array();
    e.push("<div style='line-height:20px; font-size: 14px; color:black; padding:55px 0px; text-align:center;'>");
    e.push("确定删除图册“" + c + "”?");
    e.push("</div>");
    var d = top.Fai.popupBodyWindow({
        title: "删除图册",
        content: e.join(""),
        width: 370,
        height: 130
    });
    top.Fai.addPopupBodyWindowCheckBox(d, {
        id: "checkbox",
        text: "同时删除图册图片",
        init: "checked",
        click: function() {}
    });
    top.Fai.addPopupBodyWindowBtn(d, {
        id: "save",
        text: "确 定",
        extClass: "saveButton",
        click: function() {
            var h = top.$("#popup" + d + "checkbox").attr("checked") ? true: false;
            top.Fai.ing("正在处理中，请稍候...", false);
            $.ajax({
                type: "post",
                url: Mobi.genAjaxUrl("photoGroup_h.jsp"),
                data: "cmd=del&id=" + f + "&delImgs=" + h,
                error: function() {
                    top.Fai.ing("系统繁忙，请稍候重试", false)
                },
                success: function(j) {
                    top.Fai.successHandle(j, "删除成功", "", a, b, 1);
                    Mobi.jumpUrlMobi(Mobi.getPreviewDocument().location.href)
                }
            });
            top.Fai.closePopupBodyWindow(d)
        }
    });
    top.Fai.addPopupBodyWindowBtn(d, {
        id: "cancel",
        text: "取 消",
        click: "close"
    })
};
Mobi.initModulePhotoDetailSwipe = function(x, v, l, t) {
    if (v.length < 1) {
        return
    }
    var k = [];
    if (l) {
        k = document.querySelectorAll("#" + x + " .photoGroup-img")
    } else {
        k = document.querySelectorAll("#" + x + " img")
    }
    var c = [],
        r = 0;
    for (var s = 0; s < k.length; s++) {
        if (!jm(k[s]).is(".garbage")) {
            c[r] = k[s];
            r++
        }
    }
    k = c;
    if (k.length < 1) {
        return
    }
    if (l || t) {
        var m = [];
        var h = Math.min(v.length, k.length);
        for (var s = 0; s < h; s++) {
            if (k[s].nodeName === "DIV") {
                k[s].src = k[s].getAttribute("datasrc") || ""
            }
            m.push(k[s])
        }
        for (var u = h,
                 o = v.length; u < o; u++) {
            var n = new Image();
            if (u < 3) {
                n.src = v[u].picPath
            }
            n.style.display = "none";
            jm("body").append(n);
            m.push(n)
        }
        k = m
    }
    var e = {
            imageScaleMethod: "fitNoUpscale",
            enableMouseWheel: false,
            resetToolbarPosition: true,
            loop: false,
            photoJson: v,
            captionAndToolbarAutoHideDelay: 0,
            getImageCaption: function(j, y) {
                var A, z;
                A = j + " / " + y;
                z = document.createElement("div");
                z.className = "ps-page";
                z.appendChild(document.createTextNode(A));
                return z
            },
            getToolbar: function() {
                return '<div class="ps-toolbar-close ps-toolbar-close-style icon-toolbar-close-style"></div><div class="ps-toolbar-base"><div class="ps-toolbar-base-title" id="wrapperTitle"></div><div class="ps-toolbar-base-detail icon-toolbar-base-detail" id="wrapperTitleDetail"></div></div><div class="ps-toolbar-base-describe" id="wrapperBasic"><div id="scrollerBasic"></div></div>'
            },
            uiDetailCallBack: function(y, C, j) {
                var z = this;
                jm(y).html("");
                var E = v[w.currentIndex],
                    B = E.groupId,
                    D = E.id,
                    A = E.name;
                jm(j).html(A);
                jm(C).addClass(f.Carousel.CssClasses.itemLoading);
                jm.ajax({
                    type: "post",
                    url: "ajax/photo_h.jsp",
                    data: "cmd=getInfo&id=" + jm.encodeUrl(D) + "&groupId=" + jm.encodeUrl(B),
                    error: function() {
                        Mobi.ing(LS.systemError)
                    },
                    success: function(F) {
                        jm(y).html(F);
                        var I = y.querySelectorAll("img");
                        if (I.length === 0) {
                            z.detailScroll && z.detailScroll.destroy();
                            z.detailScroll = null;
                            z.destroyScroll = new iScroll(C);
                            jm(C).removeClass(f.Carousel.CssClasses.itemLoading)
                        } else {
                            for (var G = 0; G < I.length; G++) {
                                var H = new Image();
                                H.src = I[G].src;
                                H.onload = function() {
                                    if (G === I.length) {
                                        z.detailScroll && z.detailScroll.destroy();
                                        z.detailScroll = null;
                                        z.destroyScroll = new iScroll(C);
                                        jm(C).removeClass(f.Carousel.CssClasses.itemLoading)
                                    }
                                }
                            }
                        }
                    }
                })
            }
        },
        b = null,
        q = null,
        d = null,
        a = null,
        f = window.Code.PhotoSwipe,
        w = f.attach(k, e);
    w && w.addEventHandler(f.EventTypes.onCaptionAndToolbarShow,
        function(j) {
            if (this.scroll) {
                this.scroll.destroy()
            }
            this.scroll = new iScroll("wrapperBasic")
        });
    if (l || t) {
        w.addEventHandler(f.EventTypes.onDisplayImage,
            function(A) {
                var j = A.target.currentIndex;
                if (j > 1) {
                    var y = v[j + 1],
                        z = A.target.cache.images[A.target.currentIndex + 1],
                        B;
                    if (z) {
                        B = z.imageEl;
                        B.src = y.picPath;
                        p(true, B)
                    }
                }
            })
    }
    if (navigator.userAgent.indexOf("baidubrowser")) {
        jm("body").off("touchstart.photoSwipe").on("touchstart.photoSwipe",
            function(j) {})
    }
    function p(y, j) {
        if (!y) {
            return
        }
        Mobi.recoverPhotoSwipeImgSize(j)
    }
};
Mobi.recoverPhotoSwipeImgSize = function(b) {
    var d = jm(b),
        a = false,
        e = b.complete;
    if (b.style.width === "0px") {
        a = true;
        d.css("width", "")
    }
    if (b.style.height === "0px") {
        a = true;
        d.css("height", "")
    }
    if (!a) {
        return
    }
    if (e) {
        c(d)
    } else {
        d.hide();
        d.parent().addClass("ps-carousel-item-loading");
        d.one("load.adjust",
            function(h) {
                var f = jm(this);
                f.parent().removeClass("ps-carousel-item-loading");
                f.show();
                c(f)
            })
    }
    function c(h) {
        var k = document.body.clientWidth,
            f = document.body.clientHeight,
            j = h.width(),
            l = h.height();
        h.css({
            height: l + "px",
            width: j + "px",
            left: (k - j) / 2 + "px",
            top: (f - l) / 2 + "px"
        })
    }
};
Mobi.copyModulePhotoDetailSwipe = function(c) {
    var d = c.substring(c.lastIndexOf("e") + 1);
    var b = jm("#" + c).find(".J_contentPanelCopy" + d).find(".style2Img.photoListImg");
    var a = jm("#" + c).find("#photoSlideList" + d).find(".style2Img.photoListImg");
    jm(b).each(function(e, f) {
        jm(f).on("click",
            function() {
                jm(a[e]).trigger("click")
            })
    })
};
Mobi.PhotoDetailSwipeForJumpCtrl = function(a) {
    var b = [];
    jm.ajax({
        type: "get",
        url: "ajax/getPhotoData_h.jsp?groupId=" + a + "&cmd=getPhotoData",
        success: function(p) {
            var p = jm.parseJSON(p);
            if (p && p.success) {
                if (p.info != null) {
                    b = p.info
                }
            }
            var l = [],
                e;
            for (var d = 0,
                     k = b.length; d < k; d++) {
                e = new Image();
                if (d < 3) {
                    e.src = b[d].picPath
                }
                l.push(e)
            }
            if (l.length < 1) {
                return
            }
            var o = {
                    imageScaleMethod: "fitNoUpscale",
                    jQueryMobile: true,
                    enableMouseWheel: false,
                    resetToolbarPosition: true,
                    loop: false,
                    photoJson: b,
                    captionAndToolbarAutoHideDelay: 0,
                    getImageCaption: function(q, r) {
                        var t, s;
                        t = q + " / " + r;
                        s = document.createElement("div");
                        s.className = "ps-page";
                        s.appendChild(document.createTextNode(t));
                        return s
                    },
                    getToolbar: function() {
                        return '<div class="ps-toolbar-close ps-toolbar-close-style icon-toolbar-close-style"></div><div class="ps-toolbar-base"><div class="ps-toolbar-base-title" id="wrapperTitle"></div><div class="ps-toolbar-base-detail icon-toolbar-base-detail" id="wrapperTitleDetail"></div></div><div class="ps-toolbar-base-describe" id="wrapperBasic"><div id="scrollerBasic"></div></div>'
                    },
                    uiDetailCallBack: function(r, v, q) {
                        var s = this;
                        jm(r).html("");
                        var x = b[n.currentIndex],
                            u = x.groupId,
                            w = x.id,
                            t = x.name;
                        jm(q).html(t);
                        jm(v).addClass(c.Carousel.CssClasses.itemLoading);
                        jm.ajax({
                            type: "post",
                            url: "ajax/photo_h.jsp",
                            data: "cmd=getInfo&id=" + jm.encodeUrl(w) + "&groupId=" + jm.encodeUrl(u),
                            error: function() {
                                Mobi.ing(LS.systemError)
                            },
                            success: function(y) {
                                jm(r).html(y);
                                var B = r.querySelectorAll("img");
                                if (B.length === 0) {
                                    s.detailScroll && s.detailScroll.destroy();
                                    s.detailScroll = null;
                                    s.destroyScroll = new iScroll(v);
                                    jm(v).removeClass(c.Carousel.CssClasses.itemLoading)
                                } else {
                                    for (var z = 0; z < B.length; z++) {
                                        var A = new Image();
                                        A.src = B[z].src;
                                        A.onload = function() {
                                            if (z === B.length) {
                                                s.detailScroll && s.detailScroll.destroy();
                                                s.detailScroll = null;
                                                s.destroyScroll = new iScroll(v);
                                                jm(v).removeClass(c.Carousel.CssClasses.itemLoading)
                                            }
                                        }
                                    }
                                }
                            }
                        })
                    }
                },
                m = null,
                f = null,
                j = null,
                h = null,
                c = window.Code.PhotoSwipe,
                n = c.attach(l, o);
            n && n.addEventHandler(c.EventTypes.onCaptionAndToolbarShow,
                function(q) {
                    if (this.scroll) {
                        this.scroll.destroy()
                    }
                    this.scroll = new iScroll("wrapperBasic")
                });
            jm(l[0]).trigger("click");
            n.addEventHandler(c.EventTypes.onDisplayImage,
                function(u) {
                    var q = u.target.currentIndex,
                        t, s, r;
                    if (q > 1) {
                        s = b[q + 1];
                        t = u.target.cache.images[u.target.currentIndex + 1];
                        if (t) {
                            r = t.imageEl;
                            r.src = s.picPath;
                            Mobi.recoverPhotoSwipeImgSize(r)
                        }
                    }
                })
        }
    })
};
Mobi.photoCrossedSlideSecSwipe = function(a, e, b) {
    var c = Mobi.getPreviewObject(e),
        h = Mobi.getPreviewObject(b),
        f = c,
        k = parseInt(jm(h).width()),
        m = 0,
        j = jm(".photoCrossedSlideSec", h);
    function d(o) {
        var n = 0;
        n += parseFloat(o.width());
        n += (parseFloat(o.css("padding-left")) + parseFloat(o.css("padding-right")));
        n += (parseFloat(o.css("border-left-width")) + parseFloat(o.css("border-right-width")));
        n += (parseFloat(o.css("margin-left")) + parseFloat(o.css("margin-right")));
        return n
    }
    if (j.length > 0) {
        m = d(jm(j[0])) * j.length
    }
    if (m > k) {
        if (navigator.appVersion.match(/MSIE [\d.]+/)) {
            if (parseInt(navigator.appVersion.match(/MSIE ([\d.]+)/)[1]) === 10) {
                m = m + j.length * 2
            }
        }
        m = m + 10;
        jm(f).css("width", m + "px");
        if (jm.os.supportsTouch) {
            var l = new iScroll(h, {
                scrollX: true,
                scrollY: false,
                mouseWheel: true,
                remarkXCoordinate: true,
                onBeforeScrollStart: null
            })
        }
    }
    j.show()
};
Mobi.initModuleMultiPhotoListItemManage = function(a) {
    if (!a || !a.moduleId) {
        return
    }
    var c = $("#module" + a.moduleId);
    c.data("options", a);
    var b = a.content;
    $.each(b.picList,
        function(f, j) {
            var l = j.id,
                h = j.desc,
                e = j.ide,
                d = j.openLink;
            var k = $("#module" + a.moduleId).find(".style2Img.photoListImg.stretchImg").parent();
            k.mouseover(function() {
                var m = [{
                    operationText: "编辑图片",
                    className: "edit",
                    evalScript: "top.Mobi.popupWindow({title:'编辑图片', frameSrcUrl:'mobiPhotoEdit.jsp?moduleId=" + a.moduleId + "&id=" + l + "&linkType=" + a.linkType + "', width:580, height:420, closeFunc: closeMobiPhotoEdit, saveBeforePopup: true });"
                },
                    {
                        operationText: "删除图片",
                        className: "close",
                        evalScript: "Mobi.deleteMultiPhotoItem('" + l + "', " + a.moduleId + ");"
                    }];
                if (a.type === 1) {
                    layer = Mobi.addEditLayer($(this), m, 106)
                } else {
                    layer = Mobi.addEditLayer($(this), m, 6)
                }
            }).mouseleave(function() {
                if (a.type === 1) {
                    Mobi.removeEditLayer($(this), null, 106)
                } else {
                    Mobi.removeEditLayer($(this))
                }
            })
        })
};
Mobi.initModuleMultiPhotoCarouselItemManage = function(a) {
    if (!a || !a.moduleId) {
        return
    }
    var c = $("#module" + a.moduleId);
    c.data("options", a);
    var b = a.content,
        d = b.picList;
    $.each(d,
        function(h, l) {
            var m = l.id,
                j = l.desc,
                f = l.ide,
                e = l.openLink;
            var k = $("#module" + a.moduleId).find("img[id=" + m + "]");
            k.each(function(n, o) {
                $(o).mouseover(function() {
                    var p = [{
                        operationText: "编辑图片",
                        className: "edit",
                        evalScript: "top.Mobi.popupWindow({title:'编辑图片', frameSrcUrl:'mobiPhotoEdit.jsp?moduleId=" + a.moduleId + "&id=" + m + "&linkType=" + a.linkType + "', width:580, height:420, closeFunc: closeMobiPhotoEdit, saveBeforePopup: true});"
                    },
                        {
                            operationText: "删除图片",
                            className: "close",
                            evalScript: "Mobi.deleteMultiPhotoItem('" + m + "', " + a.moduleId + ");"
                        }];
                    Mobi.addEditLayer($(o), p, 1)
                }).mouseleave(function() {
                    Mobi.removeEditLayer($(o), null, 1)
                })
            })
        })
};
function closeMobiPhotoEdit(k) {
    if (k != null && k != undefined) {
        var d = jm.parseJSON(k);
        var h = d.photoList,
            a = d.moduleId,
            f = $("#module" + a),
            j = f.data("options"),
            e = j.content;
        if ( !! h) {
            e.picList = h;
            var c = new Array();
            var b = "ajax/mobimodule_h.jsp?cmd=setBack&id=" + j.moduleId + "&colId=" + Fai.top._colId + "&style=" + j.style + "&extId=" + Fai.top._extId;
            c.push("&content=" + jm.encodeUrl(jm.toJSON(e)));
            Mobi.ing("正在保存...", false);
            jm.ajax({
                type: "post",
                url: b,
                data: c.join(""),
                error: function() {
                    Mobi.ing("服务繁忙，请稍后重试。", true)
                },
                success: function(l) {
                    var m = jm.parseJSON(l);
                    if (m.success) {
                        Mobi.ing("保存成功。", true);
                        Mobi.jumpUrlMobi(Mobi.getPreviewDocument().location.href)
                    } else {
                        Mobi.ing(m.msg, false)
                    }
                }
            })
        } else {
            Mobi.ing("图片信息错误。", true)
        }
    }
}
Mobi.deleteMultiPhotoItem = function(f, b) {
    var a, d = $("#module" + b);
    options = d.data("options");
    content = options.content,
        picList = content.picList;
    $.each(picList,
        function(h, j) {
            if (j.id == f) {
                a = h
            }
        });
    if (confirm("确定删除图片？")) {
        if (typeof a != "undefined") {
            picList.splice(a, 1);
            var e = new Array();
            var c = "ajax/mobimodule_h.jsp?cmd=setBack&id=" + b + "&colId=" + Fai.top._colId + "&style=" + options.style + "&extId=" + Fai.top._extId;
            e.push("&content=" + jm.encodeUrl(jm.toJSON(content)));
            $.ajax({
                type: "post",
                url: c,
                data: e.join(""),
                error: function() {
                    Mobi.ing("服务繁忙，请稍后重试。", true)
                },
                success: function(h) {
                    var j = jm.parseJSON(h);
                    if (j.success) {
                        Mobi.ing("保存成功。", true);
                        Mobi.jumpUrlMobi(Mobi.getPreviewDocument().location.href)
                    } else {
                        Mobi.ing(j.msg, false)
                    }
                }
            })
        }
    }
};
Mobi.initPhotoDetailManage = function(c, a) {
    var b = Mobi.getPreviewDocument().getElementById("photoGroupDetailPanel" + c);
    $(b).mousemove(function() {
        Mobi.addModuleLayer("photoGroupDetailPanel" + c, a)
    }).mouseleave(function() {
        Mobi.removeModuleLayer("photoGroupDetailPanel" + c)
    })
};
Mobi.photoGroupContentInit = function(c) {
    var f = jm("#photoGroupDetailPanel" + c),
        b = f.find(".photoGroupDetail").width(),
        a = f.find(".photoGroupPic"),
        e = f.find(".icon-gClose");
    jm("#photoGroupPicList" + c).width(b * a.length + "px");
    a.width(b + "px");
    var d = {
        triggerId: "newsDetailShare",
        pageBg: true,
        pageHtml: Mobi.sharePage(Fai.top._shareDataPhotoGroup),
        direction: "bottom",
        callback: function() {
            Mobi.initProductSwipe("shareListShowSwipe")
        },
        closeWebPage: ".shareListPanelBg"
    };
    Mobi.initWebPage(d);
    jm(e).bind("click",
        function() {
            if (window.history.length <= 1) {
                window.location.href = "index.jsp"
            } else {
                history.back();
                var h = setTimeout(function() {
                        window.location.href = "index.jsp";
                        h = null
                    },
                    500)
            }
            return false
        });
    Mobi.scrollFadeIn("photoGroupDetailHeader" + c, "photoGroupPicPanel" + c, 1)
};
Mobi.initPhotoGroupSwipe = function(b) {
    var f = Mobi.getJQMobi();
    var c = Mobi.getPreviewObject(b),
        e = jm(c);
    if (!c) {
        return
    }
    Mobi.initScaleImage(c);
    if (!c.querySelector(".bullets")) {
        return
    }
    var a = c.querySelector(".bullets").getElementsByTagName("li"),
        j,
        e,
        h,
        d;
    h = parseInt(e.find(".J_maxNum").text());
    j = f("#" + b).swipehandle(c, {
        continuous: true,
        bulletsClick: true,
        callback: function(m) {
            var l = a.length,
                k;
            while (l--) {
                a[l].className = " "
            }
            if (!a[m]) {
                a[m - a.length].className = "on"
            } else {
                a[m].className = "on"
            }
            k = (m + 1) % h;
            if (k == 0) {
                k = h
            }
            e.find(".J_curPhotoNumber").text(k)
        }
    });
    if ((/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent))) {
        return
    }
    d = e.find(".J_btn");
    e.on("mouseover",
        function() {
            d.show()
        }).on("mouseleave",
        function() {
            d.hide()
        });
    e.find(".J_preBtn").on("click",
        function() {
            j.prev()
        });
    e.find(".J_nextBtn").on("click",
        function() {
            j.next()
        })
};
Mobi.getPhotoListInfo = function(c) {
    var b = new Array();
    var d = $("#module" + c);
    var a = {};
    if (d.data("options")) {
        var e = d.data("options").content.picList;
        for (index in e) {
            a = {
                id: e[index].id,
                desc: e[index].desc,
                openLink: e[index].openLink,
                ide: e[index].ide
            };
            b.push(a)
        }
    }
    return b
};
Mobi.photoCardInit = function(t) {
    var b = jm("#module" + t),
        a = b.find(".J_photoListCard"),
        c = a.find(".J_cardContainer"),
        j = a.find("li"),
        p = j.length,
        n = 0,
        h = 0,
        r,
        l,
        s,
        w,
        m,
        e,
        u,
        d,
        k,
        v;
    if (p > 1 && p <= 3) {
        c.append(j.clone(true, true));
        j = a.find("li");
        p = j.length;
        for (var q = p / 2; q < p; q++) {
            jm(a.find("img").get(q)).addClass("garbage")
        }
    }
    e = jm(j.get(0)).find(".J_imgContainer");
    d = e.width();
    k = e.height();
    j.each(function(x, y) {
        h = jm(y).height();
        n = n < h ? h: n
    });
    j.each(function(x, y) {
        s = jm(y);
        w = s.find("img");
        m = parseInt(w.attr("faiWidth"));
        u = parseInt(w.attr("faiHeight"));
        v = f(m, u, d, k);
        w.css({
            height: v.height + "px",
            width: v.width + "px",
            marginTop: -(parseFloat(v.height / 2)) + "px",
            marginLeft: -(parseFloat(v.width / 2)) + "px",
            position: "absolute"
        });
        s.height(n + "px");
        if (p <= 1) {
            return false
        }
        s.on("webkitAnimationStart mozAnimationStart MSAnimationStart oanimationstart animationstart",
            function(z) {
                b.data("animated", "running")
            }).on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",
            function(z) {
                jm(this).removeClass("f-cardAnimation_right f-cardAnimation_left").addClass("f-showPic_0");
                b.data("animated", "");
                l = jm(this).find("a");
                r = l.data("href");
                if ( !! r) {
                    l.attr("href", r)
                }
            });
        switch (x) {
            case 0:
                jm(y).addClass("f-showPic_1");
                break;
            case 1:
                jm(y).removeClass("f-showPic_1 f-showPic_2 f-showPic_3").addClass("f-showPic_2");
                break;
            case 2:
                jm(y).removeClass("f-showPic_1 f-showPic_2 f-showPic_3").addClass("f-showPic_3");
                break;
            default:
                jm(y).removeClass("f-showPic_1 f-showPic_2 f-showPic_3").addClass("f-showPic_0")
        }
    });
    Mobi.bindTouchEvent(j, null, {
        callBack: o,
        args: [j, b],
        stopPropagation: true
    });
    function o(B, A, G) {
        if (Fai.top._manageMode && (Fai.top.Fai.isIE10() || Fai.top.Fai.isSafari())) {
            Fai.top.Fai.ing("当下浏览器不支持查看效果，请在手机上查看，或更换最新浏览器", true);
            return
        }
        var z = jm(this),
            E = B.length,
            x = 3,
            F = [],
            D,
            y,
            C;
        if (!G.touchMove) {
            z.find("img").trigger("click");
            return
        }
        if (! (G.toRight || G.toLeft || A.data("animated") == "running")) {
            return
        }
        if (E <= 1) {
            return false
        }
        y = z.find("a").attr("href");
        if ( !! y) {
            z.find("a").data("href", y).attr("href", "javascript:void(0);")
        }
        C = G.toRight ? "f-cardAnimation_right": "f-cardAnimation_left";
        z.addClass(C);
        B.each(function(H, I) {
            jm(I).removeClass("f-showPic_0 f-showPic_1 f-showPic_2 f-showPic_3")
        });
        F[0] = z.index();
        for (D = 1; D <= x; D++) {
            F[D] = D <= E ? ((F[0] + D) % E) : -1
        }
        B.each(function(H, I) {
            switch (H) {
                case F[1]:
                    jm(I).addClass("f-showPic_1");
                    break;
                case F[2]:
                    jm(I).addClass("f-showPic_2");
                    break;
                case F[3]:
                    jm(I).addClass("f-showPic_3");
                    break;
                case F[0]:
                    break;
                default:
                    jm(I).addClass("f-showPic_0")
            }
        })
    }
    function f(x, E, C, D) {
        var F = {
                width: x,
                height: E
            },
            y = C / D,
            z = x / E;
        if (z < y) {
            var B = x / C;
            F.width = C;
            F.height = E / B
        } else {
            if (z > y) {
                var A = E / D;
                F.width = x / A;
                F.height = D
            }
        }
        return F
    }
}; (function(e, j, f) {
    e.photoGroup = j.extend({},
        e.photoGroup, {
            bindInteractive: c,
            unBindInteractive: h
        });
    j(q);
    function q() {
        j(".formStyle34").each(function(r, s) {
            var t = j(s);
            c(t)
        })
    }
    function h(s) {
        var r, t;
        if (s.length === 0) {
            return
        }
        t = s.find(".J_photoGroupAll");
        if (t.hasClass("J_photoGroupAll4")) {
            r = 4
        }
        if (t.hasClass("J_photoGroupAll5")) {
            r = 5
        }
        d(r).destory(s);
        l(s)
    }
    function c(s) {
        var r, t;
        if (s.length === 0) {
            return
        }
        t = s.find(".J_photoGroupAll");
        if (t.hasClass("J_photoGroupAll4")) {
            r = 4
        }
        if (t.hasClass("J_photoGroupAll5")) {
            r = 5
        }
        d(r).create(s);
        m(s, r)
    }
    function m(r) {
        o(r)
    }
    function l(r) {
        o(r, false)
    }
    function o(s, r) {
        n(s, r);
        k(s, r);
        b(s, r);
        p(s, r)
    }
    function n(t, s) {
        if (!Fai.top._manageMode) {
            return
        }
        var r = t.find(".J_photoGroupAll");
        r.off("mousedown.photoGroup").off("mouseup.photoGroup");
        if (s === false) {
            return
        }
        r.on("mousedown.photoGroup",
            function() {
                $("#webModuleContainer").sortable("disable")
            }).on("mouseup.photoGroup",
            function(u) {
                $("#webModuleContainer").sortable("enable")
            })
    }
    function k(w, t) {
        var s = w.find(".J_photoGroupAll"),
            r,
            x;
        if (!s.hasClass("J_photoGroupAll4") && !s.hasClass("J_photoGroupAll5")) {
            return
        }
        r = s.find(".J_photoGroup-img-mask");
        r.off("mousedown.photoGroupScan mouseup.photoGroupScan");
        r.remove();
        if (t === false) {
            return
        }
        if (!Mobi.isPC()) {
            return
        }
        x = {
            startX: 0,
            startY: 0,
            endX: 0,
            endY: 0,
            time: 0
        };
        s.find(".f-photoGroup-a").each(function(A, z) {
            var C = j(z),
                B = C.find(".f-photoGroup-img"),
                y = (B.height() / window._htmlFontSize + "rem"),
                D;
            if (C.find(".J_photoGroup-img-mask").length === 0) {
                D = j("<div class='f-photoGroup-img-mask J_photoGroup-img-mask'></div>");
                D.height(y);
                C.append(D)
            }
        });
        s.find(".J_photoGroup-img-mask").off("mousedown.photoGroupScan mouseup.photoGroupScan").on("mousedown.photoGroupScan", u).on("mouseup.photoGroupScan", v);
        function u(y) {
            x.time = new Date();
            x.startX = y.pageX;
            x.startY = y.pageY
        }
        function v(y) {
            var A = j(y.target),
                z = new Date() - x.time;
            x.endX = y.pageX;
            x.endY = y.pageY;
            if (z > 200) {
                return
            }
            if (x.startX !== x.endX || x.startY !== x.endY) {
                return
            }
            A.parent().find(".f-photoGroup-img").click()
        }
    }
    function b(t, s) {
        var w = a(),
            v;
        t.off(w.downLink).off(w.clickLink);
        if (s === false) {
            return
        }
        v = {
            startX: 0,
            startY: 0,
            endX: 0,
            endY: 0,
            time: null
        };
        t.on(w.downLink, ".J_photoGroup-a", u).on(w.clickLink, ".J_photoGroup-a", r);
        function u(x) {
            var y = e.photoGroup.utils.getPosByEvent(x);
            v.startX = parseInt(y.pageX);
            v.startY = parseInt(y.pageY);
            v.time = new Date()
        }
        function r(x) {
            var A = e.photoGroup.utils.getPosByEvent(x),
                y = new Date(),
                z = false;
            v.endX = parseInt(A.pageX);
            v.endY = parseInt(A.pageY);
            if (Math.abs(v.endX - v.startX) > 1) {
                z = true
            }
            if (Math.abs(v.endY - v.startY) > 1) {
                z = true
            }
            if (y - v.time > 200 || z) {
                x.preventDefault()
            }
        }
    }
    function p(t, r) {
        var s = e.photoGroup;
        if (!Fai.top._manageMode) {
            return
        }
        if (j.isFunction(s.bindWithEditLayer)) {
            s.bindWithEditLayer(t, r)
        }
    }
    function d(r) {
        var t = {
                4 : e.photoGroup.zoomSlider,
                5 : e.photoGroup.pokerSlider
            },
            s = function() {};
        if (!r) {
            return {
                create: s,
                destory: s
            }
        }
        return t[r]
    }
    function a() {
        var r, s;
        r = {
            downLink: "touchstart.ctrlLink",
            clickLink: "click.ctrlLink"
        };
        s = {
            downLink: "mousedown.ctrlLink",
            clickLink: "click.ctrlLink"
        };
        return (Mobi.isPC() ? s: r)
    }
} (Mobi, jm)); (function(a, d, b) {
    var l = {
        getImgByCard: j,
        getSliderDir: c,
        getPosByEvent: k,
        getStyleType: f,
        isInDom: h
    };
    a.photoGroup = d.extend({},
        a.photoGroup, {
            utils: l
        });
    function c(p, r, n, q) {
        var o = Math.abs(p - n);
        var m = Math.abs(r - q);
        if (m === 0 && m === 0) {
            return void 0
        }
        if (o > 0 && m === 0) {
            return true
        }
        if (o === 0 && m > 0) {
            return false
        }
        return o / m > 1
    }
    function e(m) {
        if (!m.touches && !m.changedTouches) {
            return {}
        }
        return (m.touches[0] || m.changedTouches[0])
    }
    function k(o) {
        var n = o.pageX || e(o).pageX,
            m = o.pageY || e(o).pageY;
        return {
            pageX: n,
            pageY: m
        }
    }
    function j(m) {
        var o = d(m),
            n = d(m).find(".J_photoGroup-img-mask");
        if (n.length > 0) {
            return n
        }
        return o.find(".J_photoGroup-img")
    }
    function f(o) {
        var n = o.find(".J_photoGroupAll"),
            m;
        if (n.hasClass("J_photoGroupAll1")) {
            m = 1
        } else {
            if (n.hasClass("J_photoGroupAll2")) {
                m = 2
            } else {
                if (n.hasClass("J_photoGroupAll3")) {
                    m = 3
                } else {
                    if (n.hasClass("J_photoGroupAll4")) {
                        m = 4
                    } else {
                        if (n.hasClass("J_photoGroupAll5")) {
                            m = 5
                        }
                    }
                }
            }
        }
        return m
    }
    function h(q, m, r) {
        var p = d(q)[0].getBoundingClientRect(),
            o = false,
            n = false;
        if (m >= p.left && m <= p.right) {
            o = true
        }
        if (r >= p.top && r <= p.bottom) {
            n = true
        }
        return o && n
    }
} (Mobi, jm)); (function(d, j, m, h) {
    var p = m(j),
        e = {
            moveX: 0,
            moveY: 0,
        };
    j(window).load(q);
    d.photoGroup = j.extend({},
        d.photoGroup, {
            bindWithEditLayer: b
        });
    function q(s) {
        if (!Fai.top._manageMode) {
            return
        }
        j(".formStyle34").forEach(function(u, t) {
            b(j(u))
        })
    }
    function b(w, t) {
        var x = n(),
            v = w.find(".J_photoGroupAll5"),
            s = d.photoGroup.utils,
            u = s.getStyleType(w);
        w.off(x.moduleMouseLeave).off(x.moduleMouseEnter);
        if (t === false) {
            return
        }
        w.on(x.moduleMouseEnter,
            function(y) {
                c(w)
            }).on(x.moduleMouseLeave,
            function(y) {
                c(w, false)
            });
        if ([4, 5].indexOf(u) > -1) {
            r(w, t)
        }
    }
    function c(w, s) {
        var v = w.find(".J_photoGroupAll-wrap"),
            u = w.find(".J_photoGroupStyle"),
            x = n(),
            t = d.photoGroup.utils;
        u.off(x.imgMouseLeave).off(x.imgMouseEnter);
        if (s === false) {
            return
        }
        u.on(x.imgMouseEnter,
            function(D) {
                var A = j(this),
                    z = d.photoGroup.utils,
                    B = z.getImgByCard(A),
                    C = z.getStyleType(w),
                    y = A.data("fk-is-enter");
                if (C === 4 && !A.hasClass("f-active")) {
                    return
                }
                if (C === 5 && A.index() !== 0) {
                    return
                }
                if (y === "true") {
                    return
                }
                p.add(B, w);
                A.data("fk-is-enter", "true")
            }).on(x.imgMouseLeave,
            function(z) {
                var y = j(this);
                $img = d.photoGroup.utils.getImgByCard(y),
                    flag = y.data("fk-is-enter");
                if (flag !== "true") {
                    return
                }
                p.remove($img, w);
                y.data("fk-is-enter", "false")
            })
    }
    function r(u, s) {
        var t = u.find(".J_photoGroupAll-wrap"),
            v = n();
        u.off(v.transBefore).off(v.transAfter);
        if (s === false) {
            return
        }
        u.on(v.transBefore,
            function(w) {
                k(u)
            }).on(v.transAfter,
            function(w) {
                f(u)
            })
    }
    function k(v) {
        var s = a(v),
            u = s.active,
            t = s.all;
        o(v, e);
        t.each(function(x, w) {
            var y = d.photoGroup.utils.getImgByCard(w);
            p.remove(y, v)
        });
        p.ctrl(v, false)
    }
    function f(v) {
        var s = d.photoGroup.utils,
            u = a(v).active,
            t = s.getImgByCard(u);
        o(v, e, false);
        if (!s.isInDom(u, e.moveX, e.moveY)) {
            return
        }
        p.ctrl(v);
        p.add(t, v)
    }
    function a(w) {
        var t = d.photoGroup.utils,
            u = t.getStyleType(w),
            v = w.find(".J_photoGroupStyle"),
            s;
        if (u === 4) {
            s = w.find(".f-active")
        }
        if (u === 5) {
            s = v.eq(0)
        }
        return {
            all: v,
            active: s
        }
    }
    function o(u, v, s) {
        var t = u.find(".J_photoGroupAll-wrap"),
            w = n();
        t.off(w.wrapMousemove);
        if (s === false) {
            return
        }
        t.on(w.wrapMousemove,
            function(x) {
                v.moveX = x.clientX;
                v.moveY = x.clientY
            })
    }
    function l(t) {
        var s = t.find(".J_photoGroup-img-mask");
        if (s.length > 0) {
            return s
        }
        return t.find(".J_photoGroup-img")
    }
    function n() {
        return {
            moduleMouseEnter: "mouseenter.bindEidtLayer",
            moduleMouseLeave: "mouseleave.bindEditLayer",
            imgMouseEnter: "mouseenter.eidtLayer",
            imgMouseLeave: "mouseleave.eidtLayer",
            imgDwon: "mousedown.editLayer",
            imgUp: "mouseup.editLayer",
            wrapMousemove: "mousemove.editLayer",
            transBefore: "transitionBefore",
            transAfter: "transitionAfter"
        }
    }
})(Mobi, jm,
    function(c) {
        var j = {},
            h = {
                add: l,
                remove: d,
                ctrl: a
            };
        return h;
        function l(n, s) {
            var p = b(n),
                o = p.attr("id"),
                q,
                r;
            if (!Fai.top._manageMode) {
                return
            }
            if (!c.isFunction(Mobi.addEditLayer)) {
                return
            }
            if (e(s) === false) {
                return
            }
            r = k(p);
            q = Mobi.addEditLayer(o, r, 6, {
                extCls: "editLayer_2"
            });
            f(q, p)
        }
        function d(n, q) {
            if (!Fai.top._manageMode) {
                return
            }
            if (e(q) === false) {
                return
            }
            if (!c.isFunction(Mobi.removeEditLayer)) {
                return
            }
            var p = b(n),
                o = p.attr("id");
            if (o) {
                Mobi.removeEditLayer(o)
            }
        }
        function a(p, o) {
            var q = p.attr("id"),
                n = j[q];
            if (o === false) {
                j[q] = false;
                return
            }
            if (n !== void 0) {
                j[q] = void 0;
                delete j[q]
            }
        }
        function f(o, n) {
            var p = n.offset(),
                q = o[0].getBoundingClientRect();
            o.css({
                left: p.right - q.width,
                top: p.bottom - q.height
            })
        }
        function e(n) {
            var o = n.attr("id");
            return j[o]
        }
        function k(r) {
            var n = c(r).parent().find(".J_photoGroup-img"),
                q = n.attr("_groupid"),
                w = $("#photoGroup" + q),
                v = w.find(".J_photoGroup-title"),
                x = v.text(),
                p = "",
                u,
                s,
                t,
                o;
            u = "Fai.top.Mobi.popupWindow({title:'编辑图册', frameSrcUrl:'" + m(q) + "', width:860, height:682, version:2});";
            s = {
                operationText: "编辑图册",
                className: "edit_2",
                evalScript: u
            };
            t = "Mobi.deletePhotoGroupManage('" + q + "', '" + Fai.top.Fai.encodeHtmlJs(x) + "', '', 0)";
            o = {
                operationText: "删除图册",
                className: "close_2",
                evalScript: t
            };
            return [s, o]
        }
        function m(p) {
            var n = Fai.top.location,
                o = n.origin,
                s = n.pathname,
                r = s.split("/"),
                q;
            r.pop();
            r.pop();
            r.push("manage_v2");
            r.push("photoGroupEdit.jsp");
            q = Fai.top._siteDomain + r.join("/") + "?fromManage=true&mobiSettingState=3&id=" + p;
            return q
        }
        function b(n) {
            var o = c(n);
            if (!o.hasClass("J_photoGroup-img")) {
                o = o.parent().find(".J_photoGroup-img")
            }
            return o
        }
    }); (function(b, e, c) {
    var h = {
            create: f,
            destory: a
        },
        l = {
            small: "f-small",
            active: "f-active"
        },
        o = b.photoGroup.utils;
    b.photoGroup = e.extend({},
        b.photoGroup, {
            zoomSlider: h
        });
    function f(q) {
        p(q);
        m(q)
    }
    function a(r) {
        var q = r.find(".J_photoGroupAll-wrap"),
            s = j();
        q.off(s.dragStart).off(s.selectStart).off(s.dragOriginStart)
    }
    function p(u) {
        var t = u.find(".J_photoGroupAll-wrap"),
            q = u.find(".J_photoGroupStyle"),
            r = 0,
            s = q.eq(0);
        q.addClass(l.small);
        if (s.length > 0) {
            s.addClass(l.active)
        }
        q.each(function(x, w) {
            var v = e(w);
            r += parseFloat(v.width());
            r += parseFloat(v.css("margin-left"));
            r += parseFloat(v.css("margin-right"))
        });
        t.width(r + "px")
    }
    function n(s) {
        var r = e("#g_web"),
            q = r.offset(),
            v = s.offset(),
            u = q.left + q.width / 2,
            t = v.left + v.width / 2,
            w = t - u;
        return w
    }
    function m(v) {
        var t = v.find(".J_photoGroupAll-wrap"),
            x = j(),
            w = k();
        t.off(x.dragStart).off(x.selectStart).off(x.dragOriginStart).on(x.dragStart, r).on(x.selectStart, u).on(x.dragOriginStart, u);
        function u(y) {
            y.preventDefault()
        }
        function r(y) {
            var A = o.getPosByEvent(y),
                z = j();
            w.isStart = true;
            w.startX = A.pageX;
            w.startY = A.pageY;
            t.off(z.dragMove).on(z.dragMove, s).off(z.dragEnd).on(z.dragEnd, q)
        }
        function s(z) {
            var y = o.getSliderDir(w.startX, w.startY, w.moveX, w.moveY),
                A;
            if (!w.isStart) {
                return
            }
            A = o.getPosByEvent(z);
            w.moveX = A.pageX;
            w.moveY = A.pageY;
            if (!w.isMove) {
                w.isMove = true;
                if (y === void 0) {
                    return
                }
                if (y === true) {
                    w.isXMove = true;
                    Mobi.lockDocScroll()
                } else {
                    Mobi.openDocScroll()
                }
            }
        }
        function q(A) {
            var C = o.getPosByEvent(A),
                z = C.pageX - w.startX,
                B = j(),
                y = (w.isStart && w.isMove && !w.isTrans);
            Mobi.openDocScroll();
            t.off(B.dragMove).off(B.dragEnd);
            if (y && w.isXMove) {
                if (z < 0) {
                    w.currIndex++
                } else {
                    if (z > 0) {
                        w.currIndex--
                    }
                }
                d(t, w, v, A)
            }
            w.isXMove = w.isStart = w.isMove = void 0
        }
    }
    function d(q, u, A, r) {
        var x = q.find(".J_photoGroupStyle"),
            z,
            t = j(),
            w = true,
            s = ["-ms-", "", "moz", "-webkit-"],
            y,
            v;
        if (u.currIndex < 0) {
            u.currIndex = 0;
            w = false
        } else {
            if (u.currIndex >= x.length) {
                u.currIndex = x.length - 1;
                w = false
            }
        }
        y = x.eq(u.oldIndex).find(".J_photoGroup-img");
        if (u.oldIndex === u.currIndex) {
            return
        }
        v = x.eq(u.currIndex);
        z = x.eq(u.oldIndex);
        z.removeClass(l.active);
        v.addClass(l.active);
        u.isTrans = true;
        v.off(t.transEnd).on(t.transEnd,
            function(C) {
                var B = e(C.target).find(".J_photoGroup-img-mask");
                u.isTrans = false;
                v.off(t.transEnd);
                u.oldIndex = u.currIndex;
                A.trigger("transitionAfter", [C])
            });
        u.disLeft -= n(v);
        A.trigger("transitionBefore", [r]);
        e(s).each(function(C, E) {
            var B = E + "transform",
                D = "translate(" + (u.disLeft) + "px,0)";
            q.css(B, D)
        })
    }
    function j() {
        var q, r;
        r = {
            dragStart: "mousedown.photoStyle4",
            dragMove: "mousemove.photoStyle4",
            dragEnd: "mouseup.photoStyle4",
            transEnd: "transitionend.photoStyle4",
            selectStart: "selectstart.photoStyle4",
            dragOriginStart: "dragstart.photoStyle4"
        };
        q = {
            dragStart: "touchstart.photoStyle4",
            dragMove: "touchmove.photoStyle4",
            dragEnd: "touchend.photoStyle4",
            transEnd: "transitionend.photoStyle4",
            selectStart: "selectstart.photoStyle4",
            dragOriginStart: "dragstart.photoStyle4"
        };
        if (Fai.top._manageMode) {
            return r
        } else {
            if (Mobi.isPC()) {
                return r
            } else {
                return q
            }
        }
    }
    function k() {
        return {
            currIndex: 0,
            oldIndex: 0,
            isStart: false,
            isXMove: false,
            isMove: false,
            isTrans: false,
            startX: 0,
            startY: 0,
            moveX: 0,
            moveY: 0,
            endX: 0,
            endY: 0,
            time: 0,
            disLeft: 0
        }
    }
} (Mobi, jm)); (function(b, e, d) {
    var h = {
            create: f,
            destory: a
        },
        m = b.photoGroup.utils;
    b.photoGroup = e.extend({},
        b.photoGroup, {
            pokerSlider: h
        });
    function f(o) {
        n(o);
        l(o)
    }
    function a(p) {
        var o = p.find(".J_photoGroupAll"),
            q = j();
        o.off(q.dragStart).off(q.selectStart).off(q.dragOrginStart)
    }
    function n(r) {
        var q = r.find(".J_photoGroupAll-wrap"),
            p = q.find(".J_photoGroupStyle").find(".J_photoGroup-a"),
            o = p.height() + "px";
        if (p.find(".J_photoGroup-detail").length === 0) {
            q.css({
                height: o,
                transform: "translateY(0.725rem)"
            })
        }
    }
    function l(t) {
        var q = t.find(".J_photoGroupAll"),
            v = j(),
            u = c();
        if (q.find(".J_photoGroupStyle").length <= 1) {
            return
        }
        q.off(v.dragStart).off(v.selectStart).off(v.dragOrginStart).on(v.dragStart, p).on(v.dragOrginStart, ".J_photoGroup-a", s).on(v.selectStart, s);
        function s(w) {
            w.preventDefault()
        }
        function p(w) {
            var x = m.getPosByEvent(w);
            u.startX = x.pageX;
            u.startY = x.pageY;
            u.isStart = true;
            q.off(v.dragMove).off(v.dragEnd).on(v.dragMove, ".J_photoGroupStyle", r).on(v.dragEnd, ".J_photoGroupStyle", o)
        }
        function r(x) {
            var y = m.getPosByEvent(x),
                w;
            if (!u.isStart) {
                return
            }
            if (!u.isMove) {
                u.isMove = true;
                w = m.getSliderDir(u.startX, u.startY, u.endX, u.endY);
                if (w === void 0) {
                    return
                }
                if (w === true) {
                    u.isXMove = true;
                    Mobi.lockDocScroll()
                } else {
                    Mobi.openDocScroll()
                }
            }
        }
        function o(z) {
            var A = m.getPosByEvent(z),
                w = u.isStart,
                x = u.isMove,
                y = u.isXMove;
            Mobi.openDocScroll();
            u.endX = A.pageX;
            u.endY = A.pageY;
            q.off(v.dragMove).off(v.dragEnd);
            if (w && x && u.isXMove) {
                k(q, t, u)
            }
            u.isStart = u.isMove = u.isXMove = void 0
        }
    }
    function k(t, x, q) {
        var z = t.find(".J_photoGroupStyle"),
            u = z.eq(0),
            y = z.eq(1),
            v = z.eq(2),
            w = z.eq(3),
            s = j(),
            A = (q.endX - q.startX),
            o = false,
            p;
        if (q.isAnimate) {
            return
        }
        if (A === 0) {
            return
        }
        if (A < 0) {
            o = true
        }
        p = {
            dir: (o ? "f-toLeft": "f-toRight"),
            toOne: "f-toOne",
            toTwo: "f-toTwo",
            toThree: "f-toThree"
        };
        if (u.length > 0) {
            q.isAnimate = true;
            u.on(s.transEnd, r);
            x.trigger("transitionBefore");
            u.addClass(p.dir)
        }
        if (y.length > 0) {
            y.addClass(p.toOne)
        }
        if (v.length > 0) {
            v.addClass(p.toTwo)
        }
        if (w.length > 0) {
            w.addClass(p.toThree)
        }
        function r(C) {
            var D = j(),
                E = u.parent(),
                B = u.siblings();
            u.off(D.transEnd);
            u.parent()[0].removeChild(u[0]);
            B.removeClass(p.toOne).removeClass(p.toTwo).removeClass(p.toThree);
            u.removeClass(p.dir);
            E.append(u);
            q.isAnimate = false;
            x.trigger("transitionAfter")
        }
    }
    function j() {
        var p, o;
        p = {
            dragStart: "mousedown.photoGroup5",
            dragMove: "mousemove.photoGroup5",
            dragEnd: "mouseup.photoGroup5",
            selectStart: "selectstart.photoGroup5",
            transEnd: "transitionend.photoGroup5",
            dragOrginStart: "dragstart.photoGroup5"
        };
        o = {
            dragStart: "touchstart.photoGroup",
            dragMove: "touchmove.photoGroup",
            dragEnd: "touchend.photoGroup",
            selectStart: "selectstart.photoGroup5",
            transEnd: "transitionend.photoGroup5",
            dragOrginStart: "dragstart.photoGroup5"
        };
        if (Fai.top._manageMode) {
            return p
        } else {
            if (Mobi.isPC()) {
                return p
            } else {
                return o
            }
        }
    }
    function c() {
        return {
            startX: 0,
            startY: 0,
            endX: 0,
            endY: 0,
            isStart: false,
            isMove: false,
            isXMove: false,
            isAnimate: false
        }
    }
} (Mobi, jm)); (function(a, b, f) {
    b(e);
    function e() {
        if (!Fai.top._manageMode) {
            return
        }
        b(".formStyle48").each(function(h, j) {
            b(j).on("mouseenter.bindEditLayer",
                function() {
                    d(b(this))
                }).on("mouseleave.bindEditLayer",
                function() {
                    d(b(this), false)
                })
        })
    }
    function d(j, h) {
        var k = j.find(".f-photoGroupItem");
        k.off("mouseenter.editLayer mouseleave.editLayer");
        if (h === false) {
            return
        }
        k.on("mouseenter.editLayer",
            function() {
                var s = b(this),
                    u = s.find(".f-photoGroupR-title").text().trim(),
                    m = s.attr("id"),
                    o = m.replace("photoGroupR", ""),
                    r = "Fai.top.Mobi.popupWindow({title:'编辑图册', frameSrcUrl:'" + c(o) + "', width:860, height:682, version:2});",
                    p = {
                        operationText: "编辑图册",
                        className: "edit_2",
                        evalScript: r
                    },
                    q = "Mobi.deletePhotoGroupManage('" + o + "', '" + Fai.top.Fai.encodeHtmlJs(u) + "', '', 0)",
                    l = {
                        operationText: "删除图册",
                        className: "close_2",
                        evalScript: q
                    },
                    t = [p, l],
                    n;
                n = a.addEditLayer(s, t, 6);
                n.css({
                    left: s.offset().right - n.width() - 2,
                    top: s.offset().bottom - n.height() - 2
                })
            }).on("mouseleave.editLayer",
            function() {
                var l = b(this);
                a.removeEditLayer(l)
            })
    }
    function c(k) {
        var h = Fai.top.location,
            j = h.origin,
            n = h.pathname,
            m = n.split("/"),
            l;
        m.pop();
        m.pop();
        m.push("manage_v2");
        m.push("photoGroupEdit.jsp");
        l = Fai.top._siteDomain + m.join("/") + "?fromManage=true&mobiSettingState=3&id=" + k;
        return l
    }
} (Mobi, jm));
Mobi.initMbPdCollection = function(d, c, b, a) {
    this.sessionMid = d;
    this.collectionList = c;
    this.pid = b;
    this._manageMode = a
}; (function(e, a, b) {
    var f = a.prototype,
        c, l, h, d;
    f.init = function() {
        c = this.sessionMid,
            l = this.collectionList,
            h = this.pid,
            d = this._manageMode;
        m();
        j();
        if (e("#_TOKEN").length != 0 && !d && e.getCookie("m_collectID") == h + "" && !e(".shareBlock .icon-collection ").hasClass("icon-collectSelect")) {
            if (l.indexOf(h) == -1) {
                l.push(h);
                e(".shareBlock .icon-collection").addClass("icon-collectSelect");
                k("suc")
            }
        }
        e.setCookie("m_collectID", "", -1)
    };
    function m() {
        Mobi.bindTouchAndClickEvent(e(".shareBlock"),
            function(n) {
                if (c == 0) {
                    if (d) {
                        Mobi.ing(LS.isManageFailCollection)
                    } else {
                        window.location.href = "login.jsp?returnUrl=" + e.encodeUrl(window.location.href);
                        e.setCookie("m_collectID", h)
                    }
                } else {
                    if (l.indexOf(h) == -1) {
                        l.push(h);
                        e(".shareBlock .icon-collection").addClass("icon-collectSelect");
                        k("suc")
                    } else {
                        if (l.indexOf(h) != -1) {
                            l.splice(l.indexOf(h), 1);
                            e(".shareBlock .icon-collection").removeClass("icon-collectSelect");
                            k("warn")
                        }
                    }
                }
            })
    }
    function j() {
        if (c != 0 && l.indexOf(h) != -1) {
            e(".shareBlock .icon-collection").addClass("icon-collectSelect")
        }
    }
    function k(n) {
        var o = {};
        o.productCollections = l + "";
        e.post("ajax/member_h.jsp", {
                cmd: "set",
                id: c,
                info: e.toJSON(o)
            },
            function(p) {
                if (p.success) {
                    if (n == "suc") {
                        Mobi.ing(LS.sucCollection, 1)
                    } else {
                        Mobi.ing(LS.cancelledCollection)
                    }
                }
            },
            "json")
    }
})(jm, Mobi.initMbPdCollection);
Mobi.initProductEvent = function(a) {
    Mobi.initProductSwipe(a)
};
Mobi.initRepPropValueOfURL = function() {
    var a = new RegExp("https?|ftp|file://");
    jm(".paramCollection .propVal").each(function(b, d) {
        var c = jm(this).text();
        if (a.test(c)) {
            jm(this).html(c.replace(/((https?|ftp|file):\/\/[-a-zA-Z0-9+&@#\/%?=~_|!:,.;]*)/g, '<a href="$1" target="_blank" style="text-decoration:underline">$1</a>'))
        }
    })
};
Mobi.initProductRestrict = function(m, j, h, e, k, c) {
    if (!m) {
        return
    }
    var b = k ? "#productMallOptionPanel" + c: "",
        l = 0;
    if (e.count != null) {
        l = e.count
    }
    var n = h - l;
    if (jm.fkEval(n) < 0) {
        n = -1
    }
    var d = 1,
        f = -1;
    if (j > 1 && h != 0) {
        jm(b + " #limitAmountDiv").parent().attr("style", "line-height:1.5rem;");
        jm(b + " #limitAmountDiv").text("( " + LS.minAmount + " : " + j + " ; " + LS.maxAmount + " : " + n + " )");
        d = j;
        f = n
    } else {
        if (j == 1 && h != 0) {
            jm(b + " #limitAmountDiv").parent().attr("style", "line-height:1.5rem;");
            jm(b + " #limitAmountDiv").text("( " + LS.maxAmount + " : " + n + " )");
            f = n
        } else {
            if (j > 1 && h == 0) {
                jm(b + " #limitAmountDiv").parent().attr("style", "line-height:1.5rem;");
                jm(b + " #limitAmountDiv").text("( " + LS.minAmount + " : " + j + " )");
                d = j
            }
        }
    }
    jm(b + " #productNum").val(d).unbind("change").change(function() {
        var o = a();
        if (o < d || o == d) {
            o = d;
            jm("#g_decrease").addClass("g_opacity50");
            jm("#g_increase").removeClass("g_opacity50");
            if (f < d || f == d) {
                jm("#g_increase").addClass("g_opacity50")
            }
        } else {
            if (f != -1 && (o > f || o == f)) {
                o = f;
                jm("#g_decrease").removeClass("g_opacity50");
                jm("#g_increase").addClass("g_opacity50")
            } else {
                if (o > 9999998) {
                    o = 9999999;
                    jm("#g_decrease").removeClass("g_opacity50");
                    jm("#g_increase").addClass("g_opacity50")
                } else {
                    jm("#g_decrease, #g_increase").removeClass("g_opacity50")
                }
            }
        }
        jm(this).val(o)
    }).change();
    jm(b + " #g_decrease").click(function() {
        var o = a();
        if (o < d + 1) {
            jm(b + " #productNum").val(d)
        }
        jm(b + " #productNum").change()
    });
    jm(b + " #g_increase").click(function() {
        var o = a();
        if (o > f - 1 && f != -1) {
            jm(b + " #productNum").val(f > d ? f: d)
        }
        jm(b + " #productNum").change()
    });
    function a() {
        var o = jm(b + " #productNum").val(),
            p = 1;
        if (jm.isInteger(o)) {
            p = parseInt(o)
        }
        return p
    }
};
Mobi.initProductOptions = function(b) {
    b = b || {};
    var j = b.optionsAmountList;
    var y = b.isRelateAmount;
    var d = b.realMallPrice;
    var v = b.limitAmount_options;
    var n = b.productRestrictInfo;
    var u = b.choiceCurrencyVal;
    var a = b.entry;
    var w = b.productId;
    var A = b.moduleId;
    var h = b.weightTypeStr;
    var t = b.isGroupBuy;
    var p = b.groupPrice;
    var l = b.isCutPrice;
    var o = b.cpMinPrice;
    var B = false;
    jm.each(j,
        function(E, F) {
            if (F.t == null) {
                B = true;
                return false
            }
        });
    if (h == null) {
        h = "kg"
    }
    var e = jm(".J-op-box"),
        z = jm(".mallOptionImg"),
        x = e.find(".J-op"),
        m = "";
    if (a == 1) {
        e = jm("#productMallOptionPanel" + w + " .J-op-box");
        z = jm("#productMallOptionPanel" + w + " .mallOptionImg"),
            x = e.find(".J-op");
        m = "#productMallOptionPanel" + w
    }
    var s = [];
    var k = jm("#mallPrice").html();
    var q = jm("#mallAmount").html();
    var c = jm("#mallWeight").html();
    if (q <= 0) {
        C(x.find("label"));
        x.find("label").attr("isEmptyAmount", "1")
    } else {
        jm.each(j,
            function(E, G) {
                if (G.oAmount <= 0 && x.length <= 1) {
                    var F = x.find("label[data='" + G.t2 + "']");
                    C(F);
                    jm(F).attr("isEmptyAmount", "1")
                } else {
                    if (G.oAmount <= 0) {
                        s.push(G.t2)
                    }
                }
            })
    }
    jm(x).each(function(E) {
        var F = jm(this);
        F.find("label").click(function() {
            if (jm(this).attr("isEmptyAmount") == "1") {
                return
            }
            var O = jm(this);
            if (!O.hasClass("isSelected")) {
                if (O.parent().find(".optionSelected").length > 0) {
                    O.parent().find(".optionSelected").removeClass("optionSelected isSelected")
                }
                O.addClass("optionSelected isSelected");
                var M = O.attr("data");
                F.attr("option_data", M)
            } else {
                O.parent().find(".optionSelected").removeClass("optionSelected isSelected");
                jm("#" + O.attr("for")).prop("checked", false);
                O.parents(".J-op").removeAttr("option_data");
                jm("#mallPrice").html(k);
                jm("#mallAmount").html(q);
                jm("#mallWeight").html(c);
                if (v) {
                    jm("#g_increase").removeClass("g_opacity50");
                    jm("#limitAmountDiv").text("");
                    jm("#limitAmountDiv").parent().css("line-height", "");
                    jm("#g_increase").unbind("click.ic2");
                    jm("#g_decrease").unbind("click.dc2")
                }
            }
            if (x.length > 1 && y) {
                var ag = "";
                var aj = 0;
                x.each(function(al, am) {
                    if (jm(x[al]).find(".optionSelected").length <= 0) {
                        ag += "x_"
                    } else {
                        ag += jm(x[al]).find(".optionSelected").attr("data") + "_"
                    }
                });
                ag = ag.substring(0, ag.length - 1);
                jm.each(j,
                    function(al, am) {
                        if (D(ag, am.t2)) {
                            if (am.flag != 0 && !isNaN(am.oAmount)) {
                                aj += am.oAmount
                            }
                        }
                    });
                jm(m + " #mallAmount").text(aj)
            }
            var T = e.find(".optionSelected");
            if (z.length > 0) {
                var af = O.attr("_indeptPic");
                if (af != null) {
                    z.attr("src", af)
                }
            }
            if (x.length == T.length) {
                var K = "",
                    Z, L, G, P, R;
                jm(T).each(function(al) {
                    if (B) {
                        K += jm(this).attr("data") + "_"
                    } else {
                        K += jm(this).attr("data")
                    }
                });
                jm.each(j,
                    function(al, an) {
                        var am = an.t2;
                        if (an.t == K) {
                            Z = an.oPrice;
                            L = an.oAmount;
                            G = an.minAmount;
                            P = an.maxAmount;
                            R = an.w
                        } else {
                            if ((am + "_") == K) {
                                Z = an.oPrice;
                                L = an.oAmount;
                                G = an.minAmount;
                                P = an.maxAmount;
                                R = an.w
                            }
                        }
                    });
                if (v) {
                    jm(m + " #limitAmountDiv").text("");
                    var H = 0;
                    var ak = n.optionsCount;
                    if (ak != null && ak.d != null) {
                        for (var ad = 0; ad < ak.d.length; ad++) {
                            if ((ak.d[ad].t + "_") == K) {
                                H = ak.d[ad].c
                            }
                        }
                    }
                    var N = 0;
                    N = P - H;
                    if (jm.fkEval(N) < 0) {
                        N = -1
                    }
                    var Y = 1;
                    var ac = -1;
                    if (G > 1 && P != 0) {
                        jm(m + " #limitAmountDiv").parent().attr("style", "line-height:1.5rem;");
                        jm(m + " #limitAmountDiv").text("( " + LS.minAmount + " : " + G + " ; " + LS.maxAmount + " : " + N + " )");
                        Y = G;
                        ac = N
                    } else {
                        if (G == 1 && P != 0) {
                            jm(m + " #limitAmountDiv").parent().attr("style", "line-height:1.5rem;");
                            jm(m + " #limitAmountDiv").text("( " + LS.maxAmount + " : " + N + " )");
                            ac = N
                        } else {
                            if (G > 1 && P == 0) {
                                jm(m + " #limitAmountDiv").parent().attr("style", "line-height:1.5rem;");
                                jm(m + " #limitAmountDiv").text("( " + LS.minAmount + " : " + G + " )");
                                Y = G
                            }
                        }
                    }
                    jm(m + " #productNum").val(Y);
                    jm(m + " #productNum").unbind("change");
                    jm(m + " #productNum").bind("change",
                        function() {
                            var al = jm(m + " #productNum").val();
                            var am = 1;
                            if (jm.isInteger(al)) {
                                am = parseInt(al)
                            }
                            if (am < Y || am == Y) {
                                am = Y;
                                jm(m + " #g_decrease , .g_decrease").addClass("g_opacity50");
                                jm(m + " #g_increase , .g_increase").removeClass("g_opacity50")
                            } else {
                                if (ac != -1 && (am > ac || am == ac)) {
                                    am = ac;
                                    jm(m + " #g_decrease , .g_decrease").removeClass("g_opacity50");
                                    jm(m + " #g_increase , .g_increase").addClass("g_opacity50")
                                } else {
                                    if (am > 9999998) {
                                        am = 9999999;
                                        jm(m + " #g_decrease , .g_decrease").removeClass("g_opacity50");
                                        jm(m + " #g_increase , .g_increase").addClass("g_opacity50")
                                    } else {
                                        jm(m + " #g_decrease , .g_decrease").removeClass("g_opacity50");
                                        jm(m + " #g_increase , .g_increase").removeClass("g_opacity50")
                                    }
                                }
                            }
                            jm(m + " #productNum").val(am)
                        });
                    jm(m + " #productNum").change();
                    jm(m + " #g_decrease , .g_decrease").unbind("click.dc2");
                    jm(m + " #g_increase , .g_increase").unbind("click.ic2");
                    jm(m + " #g_decrease , .g_decrease").bind("click.dc2",
                        function() {
                            var al = jm(m + " #productNum").val();
                            var am = 1;
                            if (jm.isInteger(al)) {
                                am = parseInt(al)
                            }
                            if (am < Y + 1) {
                                jm(m + " #productNum").val(Y)
                            }
                            jm(m + " #productNum").change()
                        });
                    jm(m + " #g_increase , .g_increase").bind("click.ic2",
                        function() {
                            var al = jm(m + " #productNum").val();
                            var am = 1;
                            if (jm.isInteger(al)) {
                                am = parseInt(al)
                            }
                            if (am > ac - 1 && ac != -1) {
                                if (ac > Y) {
                                    jm(m + " #productNum").val(ac)
                                } else {
                                    jm(m + " #productNum").val(Y)
                                }
                            }
                            jm(m + " #productNum").change()
                        })
                }
                if (y) {
                    jm(m + " #mallAmount").text(L)
                }
                if (Z == null) {
                    Mobi.onlyChangeSalePrice(d, u, a, w)
                } else {
                    Mobi.onlyChangeSalePrice(Z, u, a, w)
                }
                if (R != null) {
                    jm(m + " #mallWeight").text(R + h)
                }
            }
            if (x.length != T.length && x.length != 1) {
                r()
            }
            if ((x.length - 1) <= T.length && x.length != 1) {
                var X = "";
                x.each(function(al, am) {
                    if (jm(x[al]).find(".isSelected").length <= 0) {
                        X += "x_"
                    } else {
                        X += jm(x[al]).find(".isSelected").attr("data") + "_"
                    }
                });
                if (X != "") {
                    X = X.substring(0, X.length - 1)
                }
                var Q = "";
                x.each(function(al, an) {
                    var am = jm(x[al]).find(".isSelected");
                    if (am.length <= 0) {
                        Q = jm(x[al])
                    }
                });
                if (Q != "") {
                    var ah = Q.find("label");
                    ah.each(function(al, an) {
                        var am = X.replace("x", jm(ah[al]).attr("data"));
                        if (jm.inArray(am, s) >= 0) {
                            C(ah[al]);
                            jm(ah[al]).attr("isEmptyAmount", "1")
                        } else {
                            f(ah[al])
                        }
                    })
                } else {
                    x.each(function(al, an) {
                        var am = jm(x[al]).find("label");
                        am.each(function(aq, ap) {
                            if (jm(am[aq]).hasClass("isSelected")) {
                                return
                            }
                            var ao = X.split("_");
                            ao[al] = jm(am[aq]).attr("data");
                            var ar = ao.join("_");
                            if (jm.inArray(ar, s) >= 0) {
                                C(am[aq]);
                                jm(am[aq]).attr("isEmptyAmount", "1")
                            } else {
                                f(am[aq])
                            }
                        })
                    })
                }
            }
            var ae = [];
            for (var ad = 0; ad < x.length; ad++) {
                var S = x.eq("" + ad + "");
                if (S.find(".optionSelected").length > 0) {
                    ae.push(S.find(".optionSelected").attr("data"))
                } else {
                    break
                }
            }
            var ab = false;
            if (ae.length <= x.length && ae.length > 1) {
                var V = ae.length;
                for (var ad = 0; ad < V; ad++) {
                    jm.each(j,
                        function(am, ao) {
                            var an = ao.t2;
                            var al = an.split("_");
                            if (ao.flag == undefined) {
                                ao.flag = 1
                            }
                            if (ao.flag == 1 && arrHasSameBegin(al, ae)) {
                                ab = true;
                                return false
                            }
                        });
                    if (!ab) {
                        var W = x.eq(ae.length - 1).find("label");
                        x.eq(ae.length - 1).removeAttr("option_data");
                        W.removeClass("optionSelected isSelected");
                        var U = ae.pop();
                        W.each(function() {
                            if (jm(this).attr("data") == U) {
                                jm(this).hide()
                            }
                        })
                    } else {
                        break
                    }
                }
            }
            var ai = x.index(F);
            for (var aa = ai; aa < ae.length; aa++) {
                var I = ae.slice(0, aa + 1);
                ab = false;
                for (var ad = I.length; ad < x.length; ad++) {
                    var J = x.eq("" + ad + "");
                    J.find("label").each(function() {
                        var al = jm(this).attr("data");
                        ab = false;
                        jm.each(j,
                            function(an, ap) {
                                var ao = ap.t2;
                                var am = ao.split("_");
                                if (ap.flag == undefined) {
                                    ap.flag = 1
                                }
                                if (al == am[ad] && ap.flag == 1 && arrHasSameBegin(am, I)) {
                                    ab = true;
                                    return false
                                }
                            });
                        if (!ab) {
                            jm(this).hide()
                        } else {
                            jm(this).show()
                        }
                    })
                }
            }
            if (t && Mobi.isPtBtn) {
                jm("#mallPrice").html(p)
            }
            if (l) {
                jm("#mallPrice").html(o)
            }
            if (Mobi.productNewDetailIScrollObj != null) {
                Mobi.productNewDetailIScrollObj.refresh()
            }
        })
    });
    function C(E) {
        jm(E).css("border-style", "dashed").css("color", "#CDCDCD");
        jm("#" + jm(E).attr("for")).attr("disabled", true)
    }
    function f(E) {
        jm(E).css("border-style", "").css("color", "");
        jm(E).attr("isEmptyAmount", "");
        jm("#" + jm(E).attr("for")).removeAttr("disabled")
    }
    function r() {
        jm(".J-op-box label").css("border-style", "").css("color", "");
        jm(".J-op-box label").attr("isEmptyAmount", "");
        jm(".J-op-box input[type='radio']").removeAttr("disabled")
    }
    function D(G, I) {
        if (G == "") {
            return false
        }
        var H = true;
        var F = G.split("_");
        var E = I.split("_");
        if (F.length != E.length) {
            return false
        }
        jm.each(F,
            function(J, K) {
                if (F[J] == "x") {
                    return
                }
                if (F[J] != E[J]) {
                    H = false
                }
            });
        return H
    }
};
Mobi.onlyChangeSalePrice = function(h, f, e, c) {
    h = parseFloat(h);
    if (isNaN(h)) {
        return
    }
    var b = jm("#mallPrice");
    if (e == 1) {
        b = jm("#productMallOptionPanel" + c + " #mallPrice")
    }
    var j = Mobi.salePromotionDetail.salePromotionParam;
    if (typeof(j) == "undefined" || j == null || j == "") {
        b.html(h.toFixed(2));
        return
    }
    if (Mobi.salePromotionDetail.showType == "1") {
        b.html(h.toFixed(2));
        return
    }
    if (j.saleType == "1") {
        var d = parseFloat(j.other.ruleData.d[0].m);
        var a = 0;
        if (j.other.ruleData.s == "1") {
            a = h * (d / 10)
        } else {
            a = h - d
        }
        if (a < 0) {
            a = 0
        }
        if (jm(".J_saleProductNew").css("width").length == 0 && e != 1) {
            b.html(h.toFixed(2));
            jm(".J_salePriceSet").html(f + a.toFixed(2))
        } else {
            b.html(a.toFixed(2));
            jm(".J_salePriceSet").html(f + a.toFixed(2))
        }
    } else {
        b.html(h.toFixed(2))
    }
};
function arrHasSameBegin(b, d) {
    var a = true;
    for (var c = 0; c < d.length; c++) {
        if (d[c] != b[c]) {
            a = false
        }
    }
    return a
}
Mobi.autoSetProductHeight = function(a) {
    Mobi.unifiedAttrVal(jm(Mobi.getPreviewObject("module" + a)), ".styleForm1 .mProductTileForm", "height")
};
Mobi.initProductSwipe = function(b) {
    var d = Mobi.getJQMobi();
    var c = Mobi.getPreviewObject(b);
    if (!c) {
        return
    }
    Mobi.initScaleImage(c);
    d("#" + b).swipehandle(c, {
        continuous: true,
        bulletsClick: true,
        callback: function(f) {
            var e = a.length;
            while (e--) {
                a[e].className = " "
            }
            if (!a[f]) {
                a[f - a.length].className = "on"
            } else {
                a[f].className = "on"
            }
        }
    });
    if (!c.querySelector(".bullets")) {
        return
    }
    var a = c.querySelector(".bullets").getElementsByTagName("li")
};
Mobi.pdCommentAddCom = function() {
    var j = jm.trim(jm("#productCommentCreator").val());
    var n = jm("#productCommentCreator").attr("minlength");
    var b = jm("#productCommentInput").val();
    var f = jm("#productCommentInput").attr("minlength");
    var d = jm("#validateCodeInput").val();
    var o = jm("#productCommentInput").attr("productId");
    if (typeof(j) != "string") {
        Mobi.ing(LS.creatorTips);
        return
    }
    if (typeof(b) != "string" || "" == b) {
        Mobi.ing(LS.commentNotEmpty);
        return
    }
    if (b.length < f) {
        Mobi.ing(jm.format(LS.commentLenTips, jm.encodeHtml(f)));
        return
    }
    if (typeof(d) != "string" || "" == d) {
        Mobi.ing(LS.memberInputCaptcha);
        return
    }
    var l = jm(".J_productCommImg").find("img");
    var e = [];
    if (l != null && typeof(l) != "undefined") {
        var a = l.length;
        if (a > 0) {
            for (var q = 0; q < a; q++) {
                var c = l.eq(q);
                if (c != null && c != "undefined") {
                    var s = {};
                    var p = c.attr("_id");
                    var t = c.attr("_name");
                    var k = c.attr("_file_size");
                    var m = c.attr("_file_id");
                    s.imgId = p;
                    s.imgName = t;
                    s.imgSize = k;
                    s.tempFileId = m;
                    e.push(s)
                }
            }
        }
    }
    var r = "ajax/productComment_h.jsp?cmd=submitPC";
    var h = {
        validateCode: d,
        commentsObjId: o,
        creator: j,
        commImgList: JSON.stringify(e),
        comment: b
    };
    Mobi.ing(LS.siteFormSubmitIng);
    jm.ajax({
        type: "POST",
        url: r,
        data: h,
        error: function() {
            Mobi.ing(LS.systemError);
            jm("#captchaChange").click()
        },
        success: function(u) {
            var w = jm.parseJSON(u);
            if (!w || !w.success) {
                jm("#captchaChange").click()
            }
            if (w.hasFW) {
                Mobi.ing(w.msg);
                return
            }
            switch (w.msg) {
                case 1:
                    Mobi.ing(LS.captchaError);
                    break;
                case 2:
                    Mobi.ing(LS.creatorError);
                    break;
                case 3:
                    Mobi.ing(LS.commentError);
                    break;
                case 4:
                    Mobi.getCommentDiv("product", o);
                    jm(".comm-find-tb-remove").remove();
                    if (w.autoOpenComm || w.autoOpenComm == undefined) {
                        Mobi.ing(LS.commentSuccess, 1)
                    } else {
                        Mobi.ing(LS.commentSuccessNeedReview, 1)
                    }
                    break;
                case 5:
                    Mobi.ing(LS.paramError);
                    break;
                case 6:
                    var v = jm.encodeUrl(window.location.href);
                    window.location.href = "login.jsp?returnUrl=" + v + "&errno=11";
                    break;
                case 7:
                    Mobi.ing(LS.commentClosed);
                    break;
                case 8:
                    Mobi.ing(LS.commentSubmitError);
                    break;
                case 9:
                    Mobi.ing(LS.commentCountLimit);
                    break;
                default:
            }
        }
    })
};
Mobi.waterFall = function(z, C, A, m, h, l, n, E) {
    var d = parseInt(jm("#" + C + " .productWaterFall .style8Img").width());
    var j = _htmlFontSize;
    var o = (d * l) / (h * j);
    o = parseFloat(o.toFixed(4));
    var w = (d * m) / (A * j);
    w = parseFloat(w.toFixed(4));
    var D = jm("#" + C + " .paramPadding .paramName").css("font-size");
    if (typeof D != "object") {
        var p = D.substring(0, D.indexOf("p")) / j;
        p = parseFloat(p) + 0.2;
        jm("#" + C + " .productWaterFall .paramPadding .paramName").css("line-height", p + "rem");
        p = parseFloat(p.toFixed(4)) * 2
    } else {
        p = 0
    }
    var t = "paramWrap";
    if (n == t) {
        if (Mobi.getBrowserType() == Mobi.BrowserType.FIREFOX) {
            jm("#" + C + " .productWaterFall .paramPadding .paramName").height(p + "rem")
        } else {
            jm("#" + C + " .productWaterFall .paramPadding .paramName").height(p - 0.08 + "rem")
        }
    } else {
        jm("#" + C + " .productWaterFall .paramPadding .paramName").height(p / 2 + "rem")
    }
    if (z.length == 1) {
        jm("#" + C + " .productWaterFall .style8Img").height(o + "rem");
        jm("#" + C + " .productWaterFall").eq(u).css({
            "vertical-align": "top"
        })
    } else {
        if (z.length == 2) {
            for (var u = 0; u < z.length; u++) {
                if (u % 2 == 0) {
                    jm("#" + C + " .productWaterFall .style8Img").eq(u).height(o + "rem");
                    jm("#" + C + " .productWaterFall").eq(u).css({
                        "vertical-align": "top"
                    })
                } else {
                    if (u % 2 == 1) {
                        var B = 0;
                        jm("#" + C + " .productWaterFall .style8Img").eq(u).height(w + "rem");
                        jm("#" + C + " .productWaterFall").eq(u).css({
                            position: "absolute",
                            top: B + "rem"
                        });
                        var c = parseFloat(jm("#" + C + " .productWaterFall .commonProRight").parent().parent().parent().height());
                        var r = parseFloat(jm("#" + C + " .productWaterFall .firstLastPro").parent().parent().parent().height());
                        c = c / j;
                        r = r / j;
                        if (r < c) {
                            c = c + 10 / j;
                            jm("#" + C + " .productWaterFall .firstLastPro").parent().parent().parent().parent().height(c + "rem")
                        }
                    }
                }
            }
        } else {
            for (var u = 0; u < z.length; u++) {
                var s = u;
                if (u == 0) {
                    jm("#" + C + " .productWaterFall .style8Img").eq(u).height(o + "rem");
                    jm("#" + C + " .productWaterFall").eq(u).css({
                        "vertical-align": "top"
                    })
                } else {
                    if (s + 1 == z.length) {
                        jm("#" + C + " .productWaterFall .style8Img").eq(u).height(o + "rem");
                        if (z.length % 2 == 1) {
                            jm("#" + C + " .productWaterFall").eq(u).css({
                                "vertical-align": "top"
                            })
                        } else {
                            if (z.length % 2 == 0) {
                                var b = parseFloat(jm("#" + C + " .productWaterFall .commonProRight").parent().parent().parent().height());
                                b = (b) / j;
                                var x = (b + 0.5) * ((u + 1) / 2 - 1);
                                jm("#" + C + " .productWaterFall").eq(u).css({
                                    position: "absolute",
                                    top: x + "rem"
                                })
                            }
                        }
                    } else {
                        jm("#" + C + " .productWaterFall .style8Img").eq(u).height(w + "rem");
                        var b = parseFloat(jm("#" + C + " .productWaterFall .commonProRight").parent().parent().parent().height());
                        var a = parseFloat(jm("#" + C + " .productWaterFall .commonProRight").parent().parent().parent().width());
                        b = (b) / j;
                        if (u % 2 == 0) {
                            jm("#" + C + " .productWaterFall").eq(u).css({
                                "vertical-align": "top"
                            })
                        } else {
                            if (u % 2 == 1) {
                                var v = (b + 0.5) * ((u + 1) / 2 - 1);
                                jm("#" + C + " .productWaterFall").eq(u).css({
                                    position: "absolute",
                                    top: v + "rem"
                                })
                            }
                        }
                    }
                }
            }
        }
    }
    if (Fai.top._manageMode) {
        var e = $("#" + C),
            G = e.find(".productWaterFall"),
            F = e.attr("_productselect") == "true" ? true: false,
            y,
            f;
        G.each(function(k, H) {
            y = $(H);
            f = y.attr("topswitch") == "off";
            waterFallImg = y.find(".waterFallImg");
            waterFallImg.wrap("<div class='J_productListImgWrap fk-productListImgWrap'></div>");
            if (f && !F) {
                y.find(".J_productListImgWrap").append("<div class='f-productListTopFlag' >置顶</div>")
            }
        })
    }
    var q = jm("#" + C + " .productWaterFall");
    q.each(function(k, J) {
        var K = jm(J);
        var I = K.attr("productId");
        var H = E[I];
        if (H.salePromotionOpen) {
            K.find(".waterFallImg").append("<div class='g_bgColor f-productListTopPromotion'>" + H.saleFlagName + "</div>\n")
        }
    })
};
Mobi.initProductSwipe1 = function(d) {
    var c = Mobi.getJQMobi();
    var b = Mobi.getPreviewObject(d);
    var e = c("#" + d).find(".productSwipeItem");
    if (!b) {
        return
    }
    c("#" + d).swipehandle(b, {
        auto: false,
        continuous: false,
        bulletsClick: true,
        callback: function(h) {
            var f = a.length;
            while (f--) {
                a[f].className = " "
            }
            if (!a[h]) {
                a[h - a.length].className = "on"
            } else {
                a[h].className = "on"
            }
            setTimeout(function() {
                    e.eq(h).find("div.style7Img").trigger("slidePic")
                },
                300)
        }
    });
    if (!b.querySelector(".bullets")) {
        return
    }
    var a = b.querySelector(".bullets").getElementsByTagName("li")
};
Mobi.productCrossedSlide = function(a, d, f, b) {
    var c = jm("#" + a + " .productCrossedSlide .style7Img").width();
    var h = _htmlFontSize;
    var k = (c * f) / (d * h);
    k = parseFloat(k.toFixed(4));
    var j = jm("#" + a + " .paramPadding .paramName").css("font-size");
    if (typeof j != "object") {
        var l = j.substring(0, j.indexOf("p")) / h + 0.2;
        jm("#" + a + " .productCrossedSlide .paramPadding .paramName").css("line-height", l + "rem");
        l = parseFloat(l.toFixed(4)) * 2
    } else {
        l = 0
    }
    var e = "paramWrap";
    if (b == e) {
        if (Mobi.getBrowserType() == Mobi.BrowserType.FIREFOX) {
            jm("#" + a + " .productCrossedSlide .paramPadding .paramName").height(l + "rem")
        } else {
            jm("#" + a + " .productCrossedSlide .paramPadding .paramName").height(l - 0.08 + "rem")
        }
    } else {
        jm("#" + a + " .productWaterFall .paramPadding .paramName").height(l / 2 - 0.1 + "rem")
    }
    jm("#" + a + " .productCrossedSlide .style7Img").height(k + "rem")
};
Mobi.productCrossedSlideSec = function(a, d, f, b) {
    var c = jm("#" + a + " .productCrossedSlideSec .style9Img").width();
    var h = _htmlFontSize;
    var k = (c * f) / (d * h);
    k = parseFloat(k.toFixed(4));
    var j = jm("#" + a + " .paramPadding .paramName").css("font-size");
    if (typeof j != "object") {
        var l = j.substring(0, j.indexOf("p")) / h + 0.2;
        jm("#" + a + " .productCrossedSlideSec .paramPadding .paramName").css("line-height", l + "rem");
        l = parseFloat(l.toFixed(4)) * 2
    } else {
        l = 0
    }
    var e = "paramWrap";
    if (b == e) {
        if (Mobi.getBrowserType() == Mobi.BrowserType.FIREFOX) {
            jm("#" + a + " .productCrossedSlideSec .paramPadding .paramName").height(l + "rem")
        } else {
            jm("#" + a + " .productCrossedSlideSec .paramPadding .paramName").height(l - 0.08 + "rem")
        }
    } else {
        jm("#" + a + " .productWaterFall .paramPadding .paramName").height(l / 2 - 0.1 + "rem")
    }
    jm("#" + a + " .productCrossedSlideSec .style9Img").height(k + "rem")
};
Mobi.productCrossedSlideSecSwipe = function(b, I) {
    var l = Mobi.getPreviewObject(b),
        p = Mobi.getPreviewObject(I),
        K = l,
        N = parseInt(jm(p).width()),
        k = 0,
        D = p.querySelectorAll(".productCrossedSlideSec"),
        j = _htmlFontSize,
        y = D.length * 0.5 * j,
        G = jm(p),
        E = jm("#" + b),
        M = false,
        d = true,
        H = null,
        a = jm("#webModuleContainer"),
        f = null,
        o = undefined,
        e = 0,
        c = 0,
        m = null,
        n,
        w = 0,
        F = jm("<div></div>"),
        s,
        r,
        v,
        u;
    G.css("margin-top", "30px");
    function L(O) {
        G.off("mouseup.prod");
        G.off("mousemove.prod");
        G.off("mouseout.prod")
    }
    function A(O) {
        E.find("div.style9Img").trigger("horizonScroll");
        E.append(F);
        s = v = O.pageX;
        r = u = O.pageY;
        G.off("mousemove.prod").on("mousemove.prod", J);
        G.off("mouseup.prod").on("mouseup.prod", C);
        G.off("mouseout.prod").on("mouseout.prod", L);
        O.preventDefault();
        O.stopPropagation()
    }
    function J(P) {
        var O = 0,
            R = G.width() - E.width(),
            Q = parseInt(E.css("left"));
        M = true;
        v = P.pageX;
        u = P.pageY;
        Q += (v - s);
        if (Q > O) {
            Q = O
        }
        if (Q < R) {
            Q = R
        }
        E.css("left", Q + "px");
        s = v;
        r = u;
        if (m && m.length) {
            m.hide()
        }
        P.stopPropagation()
    }
    function C(Q) {
        var O = 0,
            P;
        G.off("mouseup.prod");
        G.off("mousemove.prod");
        G.off("mouseout.prod");
        w = E.offset().left;
        if (m && m.length) {
            O = w - n;
            P = parseFloat(m.css("left"));
            m.css("left", (P + O) + "px");
            m.show()
        }
        m = null
    }
    function z(R, T, Q, S) {
        var P = Math.abs(R - Q),
            O = Math.abs(T - S);
        if (P === 0 && O === 0) {
            return
        }
        if (P === 0 && O > 0) {
            return true
        }
        if (O === 0 && P > 0) {
            return false
        }
        return O / P > 1 ? true: false
    }
    function t(O) {
        var P = O.touches.length > 0 ? O.touches[0] : O.chengedTouches[0];
        return {
            pageX: P.pageX,
            pageY: P.pageY
        }
    }
    function h(O) {
        E.find("div.style9Img").trigger("horizonScroll");
        var P = t(O);
        s = v = P.pageX;
        r = u = P.pageY;
        G.off("touchmove.prod").on("touchmove.prod", B);
        G.off("touchend.prod").on("touchend.prod", x);
        E.append(F)
    }
    function B(O) {
        var P = t(O);
        v = P.pageX;
        u = P.pageY;
        if (o === undefined) {
            if (s !== undefined && r !== undefined) {
                o = z(s, r, v, u);
                E.off("touchmove.prod")
            }
        }
        s = v;
        r = u
    }
    function x(O) {
        F.remove();
        o = s = r = v = u = undefined;
        G.off("touchmove.prod", B);
        G.off("touchend.prod", x)
    }
    if (D.length > 0) {
        k = D[0].offsetWidth * D.length
    }
    k += y;
    if (k > N) {
        if (navigator.appVersion.match(/MSIE [\d.]+/)) {
            if (parseInt(navigator.appVersion.match(/MSIE ([\d.]+)/)[1]) === 10) {
                k = k + D.length * 2
            }
        }
        k = k + 10;
        jm(K).css("width", k + "px");
        var q = jm.getCookie("startX") ? parseInt(jm.getCookie("startX")) : 0;
        if (Mobi.isPC()) {
            G.css({
                position: "relative",
                height: parseInt(E.height()) + "px"
            });
            E.css({
                position: "absolute",
                left: 0,
                top: 0
            });
            G.off("mousedown.prod").on("mousedown.prod", A);
            G.off("mousedown.prodItem").on("mousedown.prodItem", ".J_prodItem",
                function() {
                    m = jm(".editLayer");
                    n = E.offset().left
                });
            G.off("click.checkMove").on("click.checkMove",
                function() {
                    if (M) {
                        d = false
                    } else {
                        d = true
                    }
                    M = false
                });
            G.off("click.prodLink").on("click.prodLink", ".J_prodItem-a",
                function(O) {
                    return d
                })
        } else {
            f = new iScroll(p, {
                x: q,
                scrollX: true,
                scrollY: false,
                mouseWheel: true,
                remarkXCoordinate: true,
                onBeforeScrollStart: null,
                onScrollMove: null,
                onBeforeScrollEnd: null,
                onScrollEnd: function() {
                    E.find("div.style9Img").trigger("horizonScroll")
                }
            });
            G.off("touchstart.prod").on("touchstart.prod", h);
            jm("body").off("touchmove.prod").on("touchmove.prod",
                function(O) {
                    if (o === false) {
                        O.preventDefault()
                    }
                });
            F.css({
                width: "100%",
                height: "100%",
                position: "absolute",
                opacity: 0,
                left: 0,
                top: 0,
                zIndex: -1
            });
            E.children().off("touchmove.banIScroll").on("touchmove.banIScroll",
                function(O) {
                    if (o === true) {
                        O.stopPropagation()
                    }
                })
        }
    }
    E.find(".productCrossedSlideSec").show()
};
Mobi.hideProductItemContainer = function(a) {
    jm(Mobi.getPreviewObject(a)).removeAttr("style");
    jm(Mobi.getPreviewObject("productSlide")).find(".productLeft").hide();
    jm(Mobi.getPreviewObject("productSlide")).find(".productRight").hide()
};
Mobi.hideParamPadding = function(b) {
    var a = jm("#" + b + " .paramCollection").children("p").length;
    if (a === 0) {
        jm("#" + b + " .paramCollection").removeClass("paramPadding")
    }
};
Mobi.removeMarginBottom = function(c, b) {
    if (b == "styleNine") {
        var f = jm("#" + c + " .productCrossedSlideSec")
    } else {
        if (b == "styleEight") {
            var f = jm("#" + c + " .productWaterFall")
        } else {
            if (b == "styleSeven") {
                var f = jm("#" + c + " .productCrossedSlide")
            }
        }
    }
    var a = f.eq(0).find(".paramCollection").children("p").length;
    var e = f.eq(0).find(".paramCollection").children(".paramName").length;
    if (a === 1 && e === 1) {
        jm("#" + c + " .paramCollection .paramName").css("marginBottom", 0)
    }
    var d = f.eq(0).find(".paramCollection").children(".paramPrice").length;
    if (a === 2 && d === 1) {
        f.find(".paramCollection").children(".paramLine").remove()
    }
};
Mobi.productGuaranteeEventInit = function() {
    var a = Mobi.initWebPage({
        triggerId: "guaranteeContent",
        panelId: "productGuaranteePanel",
        pageBg: true,
        returnSeltFun: true,
        direction: "bottom",
        closeWebPage: "#guaranteeBtn,#closeProductGuarantee"
    })
};
Mobi.isPtBtn = false;
Mobi.productNewDetailIScrollObj = null;
Mobi.productNewDetailEventInit = function(u) {
    if (!u) {
        return
    }
    var f = u.moduleId,
        M = u.productId,
        D = u.mallOptionsOpen;
    pageStyle = u.pageStyle,
        returnUrl = u.returnUrl || "",
        isGroupBuy = u.isGroupBuy || false,
        groupBuyId = u.groupBuyId || 0,
        groupBuyDetailId = u.groupBuyDetailId || 0,
        groupPriceStr = u.groupPriceStr || "",
        isCutPrice = u.isCutPrice || false,
        cutPriceId = u.cutPriceId || 0,
        cutPriceDetailId = u.cutPriceDetailId || 0,
        cpPriceStr = u.cpPriceStr || "";
    var K = groupBuyDetailId;
    Mobi.scrollFadeIn("productDetailHeader" + f, "productNewDetailSwipe" + f, pageStyle);
    Mobi.initAjaxTab({
        pid: M,
        moduleId: f
    });
    var E = document.getElementById("productDetailHeader" + f),
        h = document.getElementById("productNewDetailPanel" + f),
        H = h.querySelector(".productNewDetail .productInfoSize"),
        v = E.querySelector(".icon-gClose.proBack"),
        B = E.querySelector(".icon-noProduct.proShopping"),
        N = E.querySelector(".tabBody .userCommentInfo"),
        w = E.querySelector(".icon-gOther.proOther"),
        j = E.querySelector(".icon-share.proShare"),
        C = E.querySelector(".proOtherPanel"),
        n = h.querySelector(".J_productImmediatelyBug"),
        t = h.querySelector(".J_groupBuyBtn"),
        r = h.querySelector(".J_cpButton"),
        I = h.querySelector(".productMallBuy"),
        y = h.querySelector(".productMallShop"),
        F = h.querySelector("#productTabUl"),
        O = document.getElementById("productNewDetailSwipe" + f),
        G = jm("#productDetailV3_title" + f);
    var L = false;
    if (window.sessionStorage) {
        L = Mobi.checkWindowSeStgValue(window.sessionStorage._isJumpFromMlist);
        try {
            window.sessionStorage._isJumpFromMlist = false
        } catch(q) {}
    }
    var m = false;
    m = jm.getCookie("_fromCollect");
    jm(v).bind("click",
        function() {
            if (window.sessionStorage) {
                if (L) {
                    if (window.sessionStorage._jumpMlistUrl.indexOf("?") <= -1) {
                        window.location.href = window.sessionStorage._jumpMlistUrl + "?commHideFlag=true"
                    } else {
                        if (window.sessionStorage._jumpMlistUrl.indexOf("commHideFlag") <= -1) {
                            window.location.href = window.sessionStorage._jumpMlistUrl + "&commHideFlag=true"
                        } else {
                            window.location.href = window.sessionStorage._jumpMlistUrl
                        }
                    }
                    window.sessionStorage._backFromProDetail = true
                } else {
                    if (m) {
                        jm.setCookie("_fromCollect", "", -1);
                        jm.setCookie("_openCollect", true);
                        window.location.href = Mobi.getQueryString("returnUrl")
                    } else {
                        if (window.history.length <= 1) {
                            window.location.href = "index.jsp"
                        } else {
                            if (returnUrl.length > 0) {
                                window.location.href = returnUrl
                            } else {
                                if (Fai.top._manageMode) {
                                    if (sessionStorage.getItem("historyList")) {
                                        jm(Fai.top.document.getElementById("jz_designerOperate").querySelector(".j_designerBack")).click()
                                    } else {
                                        window.location.href = "index.jsp"
                                    }
                                } else {
                                    window.location.href = document.referrer;
                                    setTimeout(function() {
                                            window.location.href = document.referrer;
                                            var P = setTimeout(function() {
                                                    window.location.href = "index.jsp";
                                                    P = null
                                                },
                                                4000)
                                        },
                                        300)
                                }
                            }
                        }
                    }
                }
                return false
            } else {
                if (window.history.length <= 1) {
                    window.location.href = "index.jsp"
                } else {
                    window.location.href = document.referrer;
                    setTimeout(function() {
                            window.location.href = document.referrer;
                            var P = setTimeout(function() {
                                    window.location.href = "index.jsp";
                                    P = null
                                },
                                500)
                        },
                        300)
                }
                return false
            }
        });
    jm(h).bind("click",
        function() {
            if (jm(C).hasClass("proOtherPanelOpen")) {
                jm(C).removeClass("proOtherPanelOpen")
            }
        });
    jm(w).bind("click",
        function(P) {
            if (jm(C).hasClass("proOtherPanelOpen")) {
                jm(C).removeClass("proOtherPanelOpen")
            } else {
                jm(C).addClass("proOtherPanelOpen")
            }
            P.stopPropagation()
        });
    if (G) {
        document.addEventListener("touchmove", b);
        document.addEventListener("scroll", b);
        function b() {
            if (document.body.scrollTop > O.clientHeight || document.documentElement.scrollTop > O.clientHeight) {
                G.show()
            } else {
                G.hide()
            }
        }
    }
    var s = jm(".productMallShop").html(),
        p = jm(".productMallBuyPanel").html(),
        l = Mobi.initWebPage({
            triggerId: "productInfoSize",
            panelId: "productMallOptionPanel",
            callback: d,
            pageBg: true,
            returnSeltFun: true,
            direction: "bottom",
            closeWebPage: "#productMallOptionPanel .productDetailClose.icon-Off",
            closeCallBack: function() {
                jm(".productMallOptionPanel .productMallOptionContentPanel").removeClass("mallThemeProductContentPanel")
            }
        });
    function d() {
        if (Mobi.deviceTypeIsMobi()) {
            Mobi.productNewDetailIScrollObj = new iScroll("mallOptionAndNumContainer", {
                onBeforeScrollStart: function(Q) {
                    var P = Q.target;
                    while (P.nodeType != 1) {
                        P = P.parentNode
                    }
                    if (P.tagName != "INPUT") {
                        Q.preventDefault()
                    }
                }
            })
        }
        if (!e) {
            J()
        }
        return false
    }
    jm("#productInfoSize").bind("click",
        function() {
            if (s == null || s == "") {
                return
            }
            var S = jm(".productMallBuyPanel");
            S.html(s);
            var P = Fai.top._templateFrameId;
            var Q = jm(".productMallBuyPanel .productAddMall");
            var R = (P >= 1015 && P < 2000);
            if (P < 2000 || P >= 3000) {
                Q.css("margin-left", "0.45rem");
                if (P == 1014) {
                    Q.css("margin-left", "0.85rem")
                }
            }
            if (R) {
                Q.css({
                    "margin-left": "",
                    "margin-top": ""
                });
                S.find(".mallThemeAddCartBtn").css("margin-left", "")
            }
            jm(".productMallBuyPanel .productAddMall").css("color", jm(".productNewDetailPanel .productAddMall").css("color")).css("border-color", jm(".productNewDetailPanel .productAddMall").css("border-left-color"));
            jm(".productMallBuyPanel .productImmediatelyBug").css("background-color", jm(".productNewDetailPanel .productImmediatelyBug").css("background-color")).css("border-color", jm(".productNewDetailPanel .productImmediatelyBug").css("border-left-color"));
            if (!R) {
                jm(".productMallBuyPanel div").css("margin-top", "0")
            }
            jm(".productMallOptionPanel .productMallOptionContentPanel").css("overflow", "hidden").addClass("mallThemeProductContentPanel");
            jm(".productMallBuyPanel .J_productAddMall").bind("click",
                function() {
                    Mobi.mallBuy(M, 0)
                });
            jm(".productMallBuyPanel .J_productImmediatelyBug").unbind("click").bind("click",
                function() {
                    Mobi.mallBuy(M, 1)
                });
            jm(".productMallBuyPanel .J_groupBuyBtn").unbind("click").bind("click",
                function() {
                    Mobi.mallBuy(M, 1, null, null, null, null, {
                        isGroupBuy: isGroupBuy,
                        groupBuyId: groupBuyId,
                        groupBuyDetailId: groupBuyDetailId
                    })
                });
            jm(".productMallBuyPanel .J_cpButton").unbind("click").bind("click",
                function() {
                    Mobi.logDog(200535, 0);
                    Mobi.cutPrice(cutPriceId, M)
                });
            jm(".productMallBuyPanel .serviceBtn").off("click.pp").on("click.pp",
                function() {
                    Mobi.createMallServicePanel()
                })
        });
    var e = false;
    function J() {
        var Q = document.getElementById("productMallOptionPanel"),
            R = document.getElementById("g_body").clientHeight,
            V = Q.querySelector(".productMallOptionContentPanel"),
            P = Q.querySelector(".productMallOptionContent"),
            S = Q.querySelector(".productMallOptionMargin"),
            U = Q.querySelectorAll(".productMallOptionContent>div"),
            T = true
    }
    var z;
    jm("#productNewDetailPanel" + f + " .J_productAddMall").bind("click",
        function() {
            jm(".productMallBuyPanel").html(p);
            z = 0;
            Mobi.isPtBtn = false;
            l()
        });
    jm(".J_pdJoinGroupBuyBtn").bind("click",
        function() {
            groupBuyDetailId = jm(this).attr("_groupBuyDetailId");
            z = 2;
            l();
            jm("#mallPrice").html(groupPriceStr);
            Mobi.isPtBtn = true
        });
    jm(".productMallBuyPanel").delegate(".productMallBuy", "click",
        function() {
            if (z == 1) {
                Mobi.mallBuy(M, z)
            } else {
                if (z == 2) {
                    Mobi.mallBuy(M, 1, null, null, null, null, {
                        isGroupBuy: isGroupBuy,
                        groupBuyId: groupBuyId,
                        groupBuyDetailId: groupBuyDetailId
                    })
                } else {
                    if (z == 3) {
                        Mobi.cutPrice(cutPriceId, M)
                    } else {
                        Mobi.mallBuy(M, z)
                    }
                }
            }
        });
    var A = jm("#mallPrice").html() || "";
    jm(n).bind("click",
        function() {
            jm(".productMallBuyPanel").html(p);
            z = 1;
            Mobi.isPtBtn = false;
            l();
            if (isGroupBuy) {
                jm("#mallPrice").html(A);
                jm(jm("#productMallOptionPanel .optionSelected")[0]).click().click()
            }
        });
    jm(t).bind("click",
        function() {
            if (isGroupBuy) {
                jm("#mallPrice").html(groupPriceStr)
            }
            jm(".productMallBuyPanel").html(p);
            z = 2;
            groupBuyDetailId = K;
            Mobi.isPtBtn = true;
            l()
        });
    jm(r).bind("click",
        function() {
            if (D) {
                if (isCutPrice) {
                    jm("#mallPrice").html(cpPriceStr)
                }
                jm(".productMallBuyPanel").html(p);
                z = 3;
                Mobi.isPtBtn = false;
                l()
            } else {
                Mobi.cutPrice(cutPriceId, M)
            }
        });
    var a = JSON.parse(JSON.stringify(Fai.top._shareDataProdectDetail));
    var k = jm.parseJSON(a.shareLinkList);
    var c = '[{"url":"?","icon":"Weixin"}]';
    a.shareLinkList = c;
    if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
        var x = {
            triggerId: "mallThemeProductDetailShare",
            pageBg: true,
            pageHtml: Mobi.sharePage(Fai.top._shareDataProdectDetail),
            direction: "bottom",
            callback: function() {
                Mobi.initProductSwipe("shareListShowSwipe")
            },
            closeWebPage: "#shareListPanelBg"
        };
        Mobi.initWebPage(x);
        var x = {
            triggerId: "promoShareIconForNotOpenShare",
            pageBg: true,
            pageHtml: Mobi.sharePage(a),
            direction: "bottom",
            callback: function() {
                Mobi.initProductSwipe("shareListShowSwipe")
            },
            closeWebPage: "#shareListPanelBg"
        };
        Mobi.initWebPage(x)
    } else {
        var x = {
            triggerId: "productDetailShare",
            pageBg: true,
            pageHtml: Mobi.sharePage(Fai.top._shareDataProdectDetail),
            direction: "bottom",
            callback: function() {
                Mobi.initProductSwipe("shareListShowSwipe")
            },
            closeWebPage: "#shareListPanelBg"
        };
        Mobi.initWebPage(x);
        var x = {
            triggerId: "promoShareIconForNotOpenShare",
            pageBg: true,
            pageHtml: Mobi.sharePage(a),
            direction: "bottom",
            callback: function() {
                Mobi.initProductSwipe("shareListShowSwipe")
            },
            closeWebPage: "#shareListPanelBg"
        };
        Mobi.initWebPage(x)
    }
    var o = {
        triggerId: "showCouponList",
        pageBg: true,
        pageHtml: Mobi.couponPage(Fai.top._couponInfo),
        direction: "bottom",
        closeWebPage: "#contentBottomPanel",
        callback: function() {
            jm("#couponListBottomPanel").bind("click mousedown touchstart",
                function(P) {
                    P.stopPropagation()
                });
            jm("#contentBottomPanel").show();
            jm(".toUseCoupon").bind("click",
                function(Q) {
                    var P = jm(this).parents(".couponItem").attr("couponid");
                    Fai.top.location.href = "pr.jsp?couponId=" + P;
                    Q.stopPropagation()
                })
        }
    };
    Mobi.initWebPage(o);
    Mobi.hidePlaceholder()
};
Mobi.runGroupBuyCountDown = function(d) {
    var f = new Date().getTime();
    var c = d - f;
    var b = [];
    jm(".fk_otherGroupBuy .J_gbItem, .fk-groupBuyDetail .J_gbItem, .fk-groupBuyDetail .J_contentBox").each(function(j, q) {
        var p = jm(q).attr("_groupCreateTime");
        var h = jm(q).attr("_groupEndTime");
        p = p.replace(/-/g, "/");
        h = h.replace(/-/g, "/");
        if (!p || !h || p == "null") {
            return
        }
        var k = true;
        if (jm(q).hasClass("J_contentBox")) {
            k = false
        }
        var m = new Date(p);
        var o = new Date(h);
        var l = jm(q).find(".J_gbCountDown");
        b[j] = setInterval(function() {
                e(o, j, jm(q), k, c)
            },
            1000)
    });
    function e(k, o, n, m, j) {
        var r = new Date(new Date().getTime() + j);
        var h = k.getTime() - r.getTime();
        var s = parseInt(h / 1000 / 60 / 60 / 24, 10);
        var p = parseInt(h / 1000 / 60 / 60 % 24, 10) + s * 24;
        var l = parseInt(h / 1000 / 60 % 60, 10);
        var q = parseInt(h / 1000 % 60, 10);
        if (s >= 0 || p >= 0 || l >= 0 || q >= 0) {
            n.find(".J_gbCountDown").html(a(p) + ":" + a(l) + ":" + a(q))
        }
        if (s <= 0 && p <= 0 && l <= 0 && q <= 0) {
            clearInterval(b[o]);
            b[o] = null;
            if (m) {
                n.remove()
            }
        }
    }
    function a(h) {
        if (h < 0) {
            return "00"
        }
        if (h < 10) {
            return "0" + h
        }
        return h
    }
};
Mobi.initGroupBuyDetail = function() {
    jm("#g_web").append("<div style='display:none;'>" + Mobi.sharePage(Fai.top._shareDataGroupBuyDetail) + "</div>");
    Mobi.initShare("shareLinkWeixin", "", "");
    jm("#gbSharetoFriend").click(function() {
        Mobi.logDog(200478, 1);
        jm("#shareLinkWeixin").click()
    });
    jm("#gbDetailShare").click(function() {
        Mobi.logDog(200478, 1);
        jm("#shareLinkWeixin").click()
    })
};
Mobi.initCutPriceDetail = function() {
    jm("#g_web").append("<div style='display:none;'>" + Mobi.sharePage(Fai.top._shareDataCutPriceDetail) + "</div>");
    Mobi.initShare("shareLinkWeixin", "", "");
    jm(".J_cpInvite").click(function() {
        Mobi.logDog(200535, 1);
        jm("#shareLinkWeixin").click()
    })
};
Mobi.getQueryString = function(a) {
    var b = new RegExp("(^|&)" + a + "=([^&]*)(&|$)");
    var c = window.location.search.substr(1).match(b);
    if (c != null) {
        return unescape(c[2])
    }
    return null
};
Mobi.initCommentUserTab = function(c) {
    if (c !== 3) {
        return
    }
    var b = "ajax/productComment_h.jsp?cmd=submitPC&newComment=true";
    var a = {
        triggerId: "userCommentId",
        panelId: "userCommentPanel",
        callback: function() {
            Mobi.postUserComment(b)
        },
        closeWebPage: "#userCommentPanel .userCommentGoBack"
    };
    Mobi.initWebPage(a);
    jm("#userCommentId").one("click",
        function() {
            jm("#loginCaptchaImg").attr({
                src: "validateCode.jsp?v=610"
            })
        })
};
Mobi.initStarList = function(a) {
    jm(".J-star-list").eq(a).attr("_star", 5);
    jm(".J-star-list").eq(a).html('<li class="faisco-icons-star3"></li><li class="faisco-icons-star3"></li><li class="faisco-icons-star3"></li><li class="faisco-icons-star3"></li><li class="faisco-icons-star3"></li><li class="score-tip"></li>')
};
Mobi.setStarSelect = function() {
    Mobi.onTouchAndClickEvent(".J-star-list li",
        function() {
            var f = jm(".userCommentPanel").css("background-color");
            if (typeof f != "string") {
                f = "#FFF"
            }
            var c = jm(this).index();
            if (c >= 5) {
                return true
            }
            var e = jm(this).parent();
            e.attr("_star", c + 1);
            for (var d = 0; d < 5; d++) {
                var a = e.find("li").eq(d);
                if (d < c + 1) {
                    if (c < 2) {
                        a.removeClass("select_more");
                        a.addClass("select_less")
                    } else {
                        a.removeClass("select_less");
                        a.addClass("select_more")
                    }
                } else {
                    a.removeClass("select_more");
                    a.removeClass("select_less")
                }
            }
            e.find("li.score-tip").show();
            var h = "";
            var b = "";
            if (c == 0) {
                h = LS.badComment;
                b = "#b7b6b6"
            } else {
                if (c == 1) {
                    h = LS.moderateComment;
                    b = "#b7b6b6"
                } else {
                    if (c == 2) {
                        h = LS.moderateComment;
                        b = "#ffb600"
                    } else {
                        h = LS.highComment;
                        b = "#ffb600"
                    }
                }
            }
            e.find("li.score-tip").html("<em></em><span></span>" + (c + 1) + LS.score + h);
            e.find("li.score-tip").css({
                "border-color": b,
                color: b,
                display: "inline-block",
                "max-width": "6.6rem"
            });
            e.find("li.score-tip em").css({
                borderColor: "transparent " + b + " transparent transparent"
            });
            e.find("li.score-tip span").css({
                borderColor: "transparent " + f + " transparent transparent"
            })
        })
};
Mobi.couponPage = function(f) {
    if (f == null) {
        return ""
    }
    var e = [];
    var b = "";
    for (i = 0; i < f.length; i++) {
        e.push("<div class ='couponItem' couponid = " + f[i].id + " bgid= " + 0 + " onclick='Mobi.clickCoupon(this);' >");
        var a = "g_bgColor";
        var d = "";
        var c = "couponItemRightValidity";
        e.push("<div class='couponItem-left " + a + "'>");
        e.push("<div class='couponItemLeftBackground'></div>");
        e.push("<div class='couponItemLeftData'><span style='font-size: 0.75rem;'>" + Fai.top.choiceCurrencyVal + "</span><span style='font-size: 1.625rem;'>" + f[i].savePrice + "</span></div>");
        e.push("<div class='couponItemLeftCondit'>满" + f[i].orderMinPrice + "可用</div>");
        e.push("</div>");
        e.push("<div class='couponItem-right'>");
        if (f[i].isRecieve) {
            e.push("<div class='toUseCoupon g_mainColor'>" + LS.toUseCoupon + "</div>")
        }
        e.push("<div class='couponItemRightName " + d + "'>" + f[i].couponName + "</div>");
        e.push("<div class='couponItemRightValidity " + c + "'>" + f[i].validity + "</div>");
        e.push("</div>");
        e.push("</div>")
    }
    b = "<div style='display:none; width:100%;' id ='contentBottomPanel'><div class='couponListBottomPanel' id ='couponListBottomPanel'><div class='couponListTitle'>优惠券</div><div id='slideCouponPanel' style='max-height: 10rem;overflow: auto;'><div class='couponListContainer'>" + e.join("") + "</div></div></div></div>";
    return b
};
Mobi.sharePage = function(q) {
    if (!q) {
        return
    }
    var o = jm.parseJSON(q.shareLinkList),
        e = q.shareUrl,
        j = q.browserTitle,
        b = window.location.href,
        c = q.fromOks || false;
    var p = "",
        l = [];
    if (Fai.top._manageMode) {
        var a = Mobi.getPreviewDocument().URL;
        a = a.replace("http://" + Fai.top._userHostName, "");
        a = a.replace("https://" + Fai.top._userHostName, "");
        if (a.indexOf("_safeMode=false&") > -1) {
            a = a.replace("_safeMode=false&", "")
        } else {
            if (a.indexOf("?_safeMode=false") > -1) {
                a = a.replace("?_safeMode=false", "")
            } else {
                if (a.indexOf("&_safeMode=false") > -1) {
                    a = a.replace("&_safeMode=false", "")
                }
            }
        }
        var b = Fai.top._visitorHostName + a
    } else {
        var b = window.location.href
    }
    var d = false;
    var h = null;
    if (!Fai.top._manageMode) {
        jm.ajax({
            url: "ajax/promoter_h.jsp?cmd=getInfo&productId=" + q.productId,
            async: false,
            success: function(r) {
                r = jm.parseJSON(r);
                if (r.success) {
                    h = r.info.config;
                    if (r.info.isPromoter && r.info.isPromotePd) {
                        d = true
                    }
                }
            }
        })
    }
    for (var f in o) {
        var a = o[f].url,
            k = o[f].icon;
        if (k == "baidu_tieba" && Fai.top._isFaiHost) {
            p += "<a hidefocus='true' class='shareLink' href='javascript:;' onclick='Mobi.ing(\"" + LS.shareNot + "\");'><div class='shareNewIcon g_iconMiddle icon-" + k + "'></div><div class='shareText icon-" + k + "-text'></div></a>"
        } else {
            if (k == "Weixin") {
                shareIcon = true;
                p += "<a hidefocus='true' class='shareLink' id='shareLinkWeixin' href='javascript:;'><div class='shareNewIcon g_iconMiddle icon-" + k + "'></div><div class='shareText icon-" + k + "-text'></div></a>"
            } else {
                if (k == "qq_share") {
                    shareIcon = true;
                    p += "<a hidefocus='true' class='shareLink' id='shareLinkQQ' href='javascript:;'><div class='shareNewIcon g_iconMiddle icon-" + k + "'></div><div class='shareText icon-" + k + "-text'></div></a>"
                } else {
                    if (k == "copy_url") {
                        p += "<a hidefocus='true' class='shareLink' id='copy_url' data-clipboard-text='" + a + "' href='javascript:;' style='outline:none;'><div class='shareNewIcon g_iconMiddle icon-" + k + "'></div><div class='shareText icon-" + k + "-text'></div></a>"
                    } else {
                        p += "<a hidefocus='true' class='shareLink' href='javascript:;' onclick='window.open(\"" + a + "\")'><div class='shareNewIcon g_iconMiddle icon-" + k + "'></div><div class='shareText icon-" + k + "-text'></div></a>"
                    }
                }
            }
        }
        if ((parseInt(f) + 1) % 8 === 0) {
            l.push("<div class='swipImgBox'>" + p + "</div>");
            p = ""
        }
    }
    p && l.push("<div class='swipImgBox'>" + p + "</div>");
    var n = "";
    if (o.length <= 4) {
        n = "style='height:5rem';"
    }
    var m = "<div class='shareListPanel' id='shareListPanel" + (c ? "2": "") + "'><div class='shareListPanelBg' id='shareListPanelBg" + (c ? "2": "") + "'></div><div class='shareListContent'>";
    if (d) {
        m += "<div class='shareTitle' style='color: #333; margin-top: .5rem;'>分享后可赚" + h.promoteAward + "%的推广奖励</div>";
        m += "<div class='promoterPdShare'>他人通过你的分享进商城购买后，你可获得推广奖励，奖励金额将根据买家的实付金额进行计算。</div>"
    } else {
        m += "<div class='shareTitle'>" + LS.shareIt + "</div>"
    }
    m += "<div class='shareListShow' id='shareListShowSwipe" + (c ? "2": "") + "' " + n + "><div class='shareListSwipe'>" + l.join("") + "</div>";
    if (o.length > 8) {
        m += '<div class="shareBullet"><ul id="bullets" class="bullets"><li class="on"></li><li></li></ul></div>'
    }
    return m
};
Mobi.showPbSingalInstCommImg = function() {
    var a = jm(".J_productCommImg").eq(0)[0].querySelectorAll("img");
    if (typeof(a) != "undefined" && a != null && a.length > 0) {
        Mobi.bindCommImgShow(a, true, 0)
    }
};
Mobi.setMemberPriceLabelColot2ThemeBackgroundColor = function() {
    var a = jm(".productImmediatelyBug").css("background-color");
    jm(".memberPrice").css("background-color", a)
};
Mobi.initPbCommUploadImgParam = function(c, d, k, l, e, f, o, b) {
    _pbCommUploadImgParam = {
        upImgMaxSize: c,
        imgType: d,
        upImgMaxNum: k,
        jsJquery: l,
        jsUpload: e,
        swfUpload: o,
        isIE: b,
        siteMainDomain: f
    };
    var h = document.body;
    if (!m(l)) {
        var a = document.createElement("script");
        a.type = "text/javascript";
        a.src = l;
        a.onload = function() {
            n()
        };
        h.appendChild(a)
    } else {
        n()
    }
    function n() {
        var q = e,
            p;
        if (b == "true") {
            q = o
        }
        if (!m(q)) {
            p = document.createElement("script");
            p.src = q;
            p.type = "text/javascript";
            h.appendChild(p);
            p.onload = function() {
                j()
            }
        } else {
            j()
        }
    }
    function j() {
        if (b == "true") {
            Mobi.mobiPbCommUploadImgSWF("comm-img-swfu-placeholder", c, d, k)
        } else {
            Mobi.mobiPbCommUploadImgHtml("comm-img-swfu-placeholder", c, d, f)
        }
    }
    function m(u) {
        var r = document.getElementsByTagName("script"),
            s = false,
            q = "";
        for (var t = 0,
                 p = r.length; t < p; t++) {
            q = (r[t].getAttribute && r[t].getAttribute("src")) || "";
            if (q == u) {
                s = true;
                break
            }
        }
        return s
    }
};
Mobi.mobiPbCommUploadImgSWF = function(d, b, f, a) {
    var e = f.split(",");
    var c = {
        file_post_name: "Filedata",
        upload_url: "/ajax/commUpsiteimg_h.jsp",
        button_placeholder_id: d,
        file_size_limit: b + "MB",
        button_image_type: 3,
        file_queue_limit: 1,
        button_width: "50px",
        button_height: "50px",
        button_cursor: SWFUpload.CURSOR.HAND,
        button_image_url: _resRoot + "/image/mobi/msgUpImg/upload.png",
        requeue_on_error: false,
        post_params: {
            ctrl: "Filedata",
            app: 21,
            type: 0,
            fileUploadLimit: a
        },
        file_types: e.join(";"),
        file_dialog_complete_handler: function(h) {
            this._allSuccess = false;
            this.startUpload()
        },
        file_queue_error_handler: function(j, h, k) {
            switch (h) {
                case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:
                    Mobi.ing(LS.mobiFormSubmitCheckFileSizeErr, true);
                    break;
                case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:
                    Mobi.ing(LS.mobiFormSubmitFileUploadNotAllow, true);
                    break;
                case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadOneTimeNum, "1"), true);
                    break;
                default:
                    Mobi.ing(LS.mobiFormSubmitFileUploadReSelect, true);
                    break
            }
        },
        upload_success_handler: function(j, h) {
            var k = jQuery.parseJSON(h);
            this._allSuccess = k.success;
            this._sysResult = k.msg;
            if (k.success) {
                setTimeout(function() {
                        Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSucess, jm.encodeHtml(j.name)), true)
                    },
                    1800);
                Mobi.onPbCommFileUploadEvent("upload", k)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadFile + j.name + "   " + k.msg)
            }
        },
        upload_error_handler: function(j, h, k) {
            if (h == -280) {
                Mobi.ing(LS.mobiFormSubmitFileUploadFileCancle, false)
            } else {
                if (h == -270) {
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadFileExist, jm.encodeHtml(j.name)), true)
                } else {
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSvrBusy, jm.encodeHtml(j.name)))
                }
            }
        },
        upload_complete_handler: function(h) {
            if (h.filestatus == SWFUpload.FILE_STATUS.COMPLETE) {
                setTimeout(function() {
                        swfObj.startUpload()
                    },
                    swfObj.upload_delay)
            } else {
                if (h.filestatus == SWFUpload.FILE_STATUS.ERROR) {
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSvrBusy, jm.encodeHtml(h.name)))
                }
            }
        },
        upload_start_handler: function(h) {
            Mobi.ing(LS.mobiFormSubmitFileUploadPrepare, false)
        },
        view_progress: function(h, l, k, j) {
            var j = Math.ceil((l / k) * 100);
            if (isNaN(j)) {
                return
            }
            if (j == 100) {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + j + "%", true)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + j + "%", false)
            }
        }
    };
    swfObj = SWFUploadCreator.create(c)
};
Mobi.mobiPbCommUploadImgHtml = function(h, c, d, f) {
    var a = d.split(",");
    var j = {
        siteFree: false,
        updateUrlViewRes: "",
        auto: true,
        fileTypeExts: a.join(";"),
        multi: false,
        fileSizeLimit: c * 1024 * 1024,
        breakPoints: true,
        saveInfoLocal: false,
        showUploadedPercent: true,
        removeTimeout: 9999999,
        getFileSizeUrlFlag: true,
        post_params: {
            app: 21,
            type: 0,
            fileUploadLimit: c,
            isSiteForm: true
        },
        buttonText: "",
        uploader: "http://" + f + '/ajax/commUpsiteimg_h.jsp?cmd="mobiUpload"',
        onUploadStart: function(l) {
            _uTime = new Date().getTime()
        },
        onUploadSuccess: function(m, o) {
            var n = jm.parseJSON(o);
            if (n.success) {
                var l = {
                    status: "end",
                    id: m.id,
                    title: "上传成功。"
                };
                e(l);
                setTimeout(function() {
                        Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSucess, jm.encodeHtml(m.name)), true)
                    },
                    1800);
                Mobi.onPbCommFileUploadEvent("upload", n)
            } else {
                var l = {
                    status: "end",
                    id: m.id,
                    title: n.msg
                };
                e(l);
                Mobi.ing(LS.mobiFormSubmitFileUploadFile + m.name + "   " + n.msg)
            }
        },
        onUploadError: function(l, m) {
            jm("#progressBody_ " + l.id).remove();
            jm("#progressWrap_" + l.id).remove();
            Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSvrBusy, jm.encodeHtml(l.name)));
            _uTime = new Date().getTime() - _uTime
        },
        view_progress: function(l) {
            var l = Math.ceil(l);
            if (isNaN(l)) {
                return
            }
            if (l == 100) {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + l + "%", true)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + l + "%", false)
            }
        }
    };
    function e(l) {
        if (isNaN(Math.round(l.percent))) {
            return
        }
        if (l.status == "start") {
            var m = ['<div id="progressBody_' + l.id + '" class="bodyDisable"></div>', '<div id="progressWrap_' + l.id + '" class="bodyProgressWrap">', '<div class="progressCenter"></div>', '<div class="progressIngBody">', '<div id="progressTitle' + l.id + '" class="progressIngTitle">' + l.title + "</div>", '<div class="progressIngMission">', '<div class="mission"><div id="progress' + l.id + '" class="progress" style="width:1%;"></div></div>', '<div id="progressNum' + l.id + '" class="progressNum">0%</div>', "</div>", '<div class="progressInfo"><span id="progressTips' + l.id + '" class="progressFileSize"></span><a class="progressCancel" href="javascript:uploadCancel(\'' + l.id + "');\">取消</a></div>", "</div>", "</div>"];
            jm("body").append(m.join(""))
        } else {
            if (l.status == "ing") {
                jm("#progressTitle" + l.id).text(l.title);
                jm("#progress" + l.id).css("width", Math.round(l.percent) + "%");
                jm("#progressNum" + l.id).html(Math.round(l.percent) + "%")
            } else {
                if (l.status == "end") {
                    jm("#progressTitle" + l.id).text(l.title);
                    jm("#progressBody_" + l.id).remove();
                    jm("#progressWrap_" + l.id).remove()
                } else {
                    if (l.status == "error") {
                        jm("#progress" + l.id).addClass("progressError")
                    }
                }
            }
        }
    }
    upload = jm("#" + h).uploadify(j);
    var k = "file_upload_pt_1";
    var b = "select_btn_pt_1";
    jm("#file_upload_1-button").attr("id", k);
    jm("#select_btn_1").attr("id", b);
    if (Fai.top._manageMode) {
        jQuery("#select_btn_pt_1").attr("disabled", "true");
        jQuery("#file_upload_pt_1").attr("disabled", "true").off("click").on("click",
            function(l) {
                Mobi.ing("管理状态下，不能上传图片。");
                return false
            })
    }
};
Mobi.onPbCommFileUploadEvent = function(k, f) {
    if (k == "upload") {
        var c = f.id;
        var j = f.name;
        var e = f.size;
        var d = f.path;
        var l = f.pathSmall;
        var b = f.fileId;
        var a = f.width;
        var h = f.height;
        Mobi.pbCommImgTableCtrl(d, j, c, e, b)
    }
};
Mobi.pbCommImgTableCtrl = function(l, a, b, h, d) {
    var j = $("#pt_add_img_tb").eq(0);
    var k = j.find(".comm-find-tb").length;
    var e = j.find(".comm-find-tb").eq(k - 1);
    var c = e.attr("maxNum");
    if (parseInt(k - 1) >= c) {
        return
    }
    var f = [];
    f.push("<td  class='comm-find-tb comm-find-tb-remove'>");
    f.push("<table style='width:100%; height:100%; table-layout:fixed;'  cellpadding='0'  cellspacing='0'>");
    f.push(" <tr>");
    f.push("    <td valign='middle'   align='center' class='comm-show-td-bd'>");
    f.push("      <img src='" + l + "' alt='' onclick='Mobi.pbRemoveBodyStyle()'  _name='" + a + "' _id='" + b + "' _file_size='" + h + "' _file_id='" + d + "' class='comm-up-set'>");
    f.push("     </td>");
    f.push(" </tr>");
    f.push("</table>");
    f.push("<div class='comm-up-div'>");
    f.push("  <span onclick=Mobi.pbCommTableImgDelete(this) class='comm-up-div-set'/>");
    f.push("</div>");
    f.push("</td>");
    e.before(f.join(""));
    k = j.find(".comm-find-tb").length;
    if (parseInt(k - 1) >= c) {
        e.css("display", "none")
    }
    Mobi.showPbSingalInstCommImg()
};
Mobi.pbCommTableImgDelete = function(a) {
    var d = jm("#pt_add_img_tb").eq(0);
    var b = d.find(".comm-find-tb").length;
    for (var c = 0; c < b; c++) {
        if (d.find(".comm-find-tb").eq(c).find(".comm-up-div-set")[0] === a) {
            d.find(".comm-find-tb").eq(c).remove();
            break
        }
    }
    b = d.find(".comm-find-tb").length;
    var e = d.find(".comm-find-tb").eq(b - 1);
    if (b <= e.attr("maxNum")) {
        e.css("display", "block")
    }
    Mobi.showPbSingalInstCommImg()
};
Mobi.postUserComment = function(f) {
    var c = document.getElementById("userCommentPanel"),
        e = c.querySelector(".tabUl"),
        b = c.querySelector(".tabLi"),
        a = c.querySelector(".tabUserPanel"),
        d = function(m) {
            if (m) {
                var n = m.getAttribute("data"),
                    l = c.querySelector(".tabActive").getAttribute("data"),
                    k = document.getElementById("tabUserPanel" + n);
                jm(c.querySelector(".tabActive")).removeClass("tabActive");
                jm(c.querySelector(".tabPanelAtive")).removeClass("tabPanelAtive");
                jm("#userCommentRemarkPanel" + n).append(jm("#userCommentRemarkPanel" + l + " .g_globalLine"));
                jm(k).append(jm("#userCommentRemarkPanel"));
                jm("#tabUserLi" + n).addClass("tabActive");
                jm(k).addClass("tabPanelAtive")
            }
        },
        j = function() {
            var n = jm("#user").val();
            var m = jm("#password").val();
            var k = (jm(".loginCaptchaCtrl").css("display") != "none");
            var l = jm("#loginCaptcha").val();
            if (n == null || n == "") {
                Mobi.ing(LS.memberInputAcct);
                return
            }
            if (m == null || m == "") {
                Mobi.ing(LS.memberInputPwd);
                return
            }
            if (k && (l == null || l == "")) {
                Mobi.ing(LS.memberInputCaptcha);
                return
            }
            m = jm.md5(m);
            jm.ajax({
                type: "post",
                url: "ajax/login_h.jsp",
                data: "cmd=loginMember&acct=" + jm.encodeUrl(n) + "&pwd=" + jm.encodeUrl(m) + "&captcha=" + jm.encodeUrl(l),
                error: function() {
                    loginBtn.removeAttr("disabled");
                    Mobi.showMemberLoginMsg( - 1)
                },
                success: function(o) {
                    var o = jm.parseJSON(o);
                    if (o.success) {
                        Fai.top.sessionMemberId = o.sessionMemberId;
                        jm("#_TOKEN").remove();
                        jm("head").append(o._HEADTOKEN);
                        h(true);
                        return
                    } else {
                        if (o.active) {
                            Mobi.ing(LS.memberLoginMailActivation)
                        } else {
                            Mobi.showMemberLoginMsg(o.rt, o.captcha)
                        }
                    }
                }
            })
        },
        h = function(p) {
            var v = jm("#postCommentId").val();
            var l = jm("#userCommentRemark").val();
            var q = jm("#userCommentRemark").attr("minlength");
            var n;
            var s;
            if (typeof(l) != "string" || "" == l) {
                Mobi.ing(LS.commentNotEmpty);
                return
            }
            if (l.length < q) {
                Mobi.ing(jm.format(LS.commentLenTips, jm.encodeHtml(q)));
                return
            }
            var t = (jm(".loginCaptchaCtrl").css("display") != "none");
            if (!p) {
                s = jm.trim(jm("#anonymityCommentUser").val());
                var y = jm("#anonymityCommentUser").attr("minlength");
                n = jm("#loginCaptcha").val();
                if (typeof(s) != "string") {
                    Mobi.ing(LS.creatorTips);
                    return
                }
            } else {
                s = jm.trim(jm("#user").val());
                n = jm("#loginCaptcha").val()
            }
            if (t && (typeof(n) != "string" || "" == n)) {
                Mobi.ing(LS.memberInputCaptcha);
                return
            }
            var w = jm(".J_productCommImg").find("img");
            var o = [];
            if (w != null && typeof(w) != "undefined") {
                var k = w.length;
                if (k > 0) {
                    for (var A = 0; A < k; A++) {
                        var m = w.eq(A);
                        if (m != null && m != "undefined") {
                            var B = {};
                            var z = m.attr("_id");
                            var D = m.attr("_name");
                            var u = m.attr("_file_size");
                            var x = m.attr("_file_id");
                            B.imgId = z;
                            B.imgName = D;
                            B.imgSize = u;
                            B.tempFileId = x;
                            o.push(B)
                        }
                    }
                }
            }
            var r = {
                validateCode: n,
                commentsObjId: v,
                creator: s,
                commImgList: JSON.stringify(o),
                comment: l,
                anonymity: !p
            };
            var C;
            if (p) {
                C = jm(".J-star-list").eq(0).attr("_star")
            } else {
                C = jm(".J-star-list").eq(1).attr("_star")
            }
            if (C) {
                r.star = C
            }
            Mobi.ing(LS.siteFormSubmitIng);
            jm.ajax({
                type: "POST",
                url: f,
                data: r,
                error: function() {
                    Mobi.ing(LS.systemError);
                    jm("#captchaChange").click()
                },
                success: function(E) {
                    var F = jm.parseJSON(E);
                    if (!F || !F.success) {
                        jm("#captchaChange").click()
                    }
                    if (F.hasFW) {
                        Mobi.ing(F.msg);
                        return
                    }
                    switch (F.msg) {
                        case 1:
                            Mobi.showMemberLoginMsg( - 301, F.captcha);
                            Mobi.ing(LS.captchaError);
                            jm("#loginCaptchaImg").click();
                            jm("#loginCaptcha").val("");
                            break;
                        case 2:
                            Mobi.ing(LS.creatorError);
                            break;
                        case 3:
                            Mobi.ing(LS.commentError);
                            break;
                        case 4:
                            if (C) {
                                F.comment.star = C
                            }
                            Mobi.addTheNewComment(F.comment);
                            if (F.autoOpenComm || F.autoOpenComm == undefined) {
                                Mobi.ing(LS.commentSuccess, 1)
                            } else {
                                Mobi.ing(LS.commentSuccessNeedReview, 1)
                            }
                            jm("#userCommentRemark").val("");
                            jm("#loginCaptchaImg").click();
                            jm("#loginCaptcha").val("");
                            jm(".comm-find-tb-remove").remove();
                            if (p) {
                                Mobi.initStarList(0)
                            } else {
                                Mobi.initStarList(1)
                            }
                            break;
                        case 5:
                            Mobi.ing(LS.paramError);
                            break;
                        case 6:
                            Mobi.ing(LS.OnlyMembersCanComment);
                            d(jm("#tabUserLi1")[0]);
                            break;
                        case 7:
                            Mobi.ing(LS.commentClosed);
                            break;
                        case 8:
                            Mobi.ing(LS.commentSubmitError);
                            break;
                        case 9:
                            Mobi.ing(LS.commentCountLimit);
                            break;
                        case 10:
                            Mobi.ing(LS.msgBoardInputValidateCode);
                            if (F.needCode) {
                                jm(".J_newsCommentCaptcha").removeClass("captchaHide")
                            }
                            break;
                        default:
                    }
                    return
                }
            })
        };
    Mobi.bindTouchAndClickEvent(jm(e),
        function(l) {
            var k = l.target;
            d(k)
        });
    Mobi.bindTouchAndClickEvent(jm("#userCommentLoginAndComform"),
        function(k) {
            if (Fai.top._manageMode) {
                Mobi.ing("您目前处于网站管理状态，请先退出再登录");
                return
            }
            if (Fai.top.sessionMemberId > 0) {
                h(true)
            } else {
                j()
            }
            k.stopPropagation();
            return false
        });
    Mobi.bindTouchAndClickEvent(jm("#anonymityCommentComform"),
        function(k) {
            if (Fai.top._manageMode) {
                Mobi.ing("您目前处于网站管理状态，请先退出再登录");
                return
            }
            h(false);
            k.stopPropagation();
            return false
        })
};
Mobi.addTheNewComment = function(w) {
    var d = [];
    var c = "VIP";
    if (w.newsId != null) {
        if (w.memberId == 0) {
            c = LS.Incognito
        }
        var t = new Date(w.createTime);
        t = Mobi.formatDate(t);
        d.push("<div class='msgArea'>");
        d.push("  <div class='msgTitle'>");
        d.push("  <div class='msgUser'><span class='g_mainColor'>[" + c + "]</span>" + w.creator + "</div>");
        d.push("  <div class='msgTime'>" + t + "</div>");
        d.push("  </div>");
        d.push("  <div class='msgContent'>" + w.comment + "</div>");
        d.push("</div>");
        if (jm(".nnewsComHeader").length != 0) {
            jm(d.join("")).insertAfter(jm(".nnewsComHeader"))
        } else {
            location.reload()
        }
    } else {
        if (w.memberId == 0) {
            c = LS.Incognito
        } else {
            c = w.level
        }
        var t = new Date(w.createTime);
        t = Mobi.formatDate(t);
        var n = jm("html").css("font-size");
        n = n.substring(0, n.length - 2);
        var p = w.headPic;
        d.push("<div class='msgArea ct-panel productCommentPanel'>");
        d.push("<div class='pdMsgTitle'>");
        d.push('<div class="msgUserHeacPic"><img src="' + p.path + '" ');
        if (p.thumbId) {
            var o = p.width,
                e = p.left,
                m = p.top,
                b = p.imgW,
                j = p.imgH;
            var v = o / (n * 1.8);
            d.push('style="top:' + -m / v + "px; left:" + -e / v + "px; width:" + b / v + "px; height:" + j / v + 'px"')
        } else {
            d.push('style="height:' + (n * 1.8) + 'px"')
        }
        d.push(" /></div>");
        d.push("<div class='msgUser g_mirrorColor'>&nbsp;" + w.creator + "</div>");
        d.push("<span class='msgLevalUser'></span>");
        d.push("<div class='msgTime g_mirrorColor'>" + t + "</div>");
        d.push("</div>");
        if ("star" in w) {
            d.push("<div class='fk-star-list'>");
            var s = Number(w.star);
            for (var q = 0; q < 5; q++) {
                if (q < s) {
                    d.push("<li class='faisco-icons-star3 select_more'></li>")
                } else {
                    d.push("<li class='faisco-icons-star3 select_less'></li>")
                }
            }
            d.push("</div>");
            if (s == 1) {
                var f = Number(jm(".fk-right-statisBox .badComm").text());
                jm(".fk-right-statisBox .badComm").text(f + 1)
            } else {
                if (s > 3) {
                    var f = Number(jm(".fk-right-statisBox .hignComm").text());
                    jm(".fk-right-statisBox .hignComm").text(f + 1)
                } else {
                    var f = Number(jm(".fk-right-statisBox .middComm").text());
                    jm(".fk-right-statisBox .middComm").text(f + 1)
                }
            }
            var k = jm(".fk-comm-avgScore"),
                h = Number(k.attr("_tc")) + s,
                l = Number(k.attr("_ts")) + 1;
            var u = h / l;
            k.text(u.toFixed(1));
            k.attr("_tc", h);
            k.attr("_ts", l)
        }
        d.push("<div class='msgContent g_defaultColor'>" + w.comment + "</div>");
        if (typeof(w.commImgList) != "undefined" && w.commImgList != "null") {
            var a = jm.parseJSON(w.commImgList);
            if (a != null && a.length > 0) {
                d.push("<div class='ct-s-content-m' style='padding:0;'>");
                d.push("<table>");
                d.push("<tr>");
                for (var q = 0; q < a.length; q++) {
                    d.push("<td class='s-img-f-tb'>");
                    d.push("<table class='s-img-tb' cellpadding='0' cellspacing='0'>");
                    d.push("<tr>");
                    d.push("<td class='s-img-bd' valign='middle'   align='center'>");
                    d.push("<img src='" + a[q].path + "' alt='' class='s-img-set'>");
                    d.push("</td>");
                    d.push("</tr>");
                    d.push("</table>");
                    d.push("</td>")
                }
                d.push("</tr>");
                d.push("</table>");
                d.push("</div>")
            }
        }
        d.push("</div>");
        if (jm("#tabPanel3 .msgArea")[0] != undefined) {
            jm(d.join("")).insertBefore(jm("#tabPanel3 .msgArea")[0]);
            Mobi.setNewCommImgBindShow()
        } else {
            location.reload()
        }
    }
    jm("#userCommentPanel .userCommentGoBack").click()
};
Mobi.setNewCommImgBindShow = function() {
    setTimeout(function() {
            var b = jm("#tabPanel3 .msgArea").eq(0).find(".ct-s-content-m").eq(0)[0];
            if (typeof(b) != "undefined" && b != "null") {
                var a = b.querySelectorAll("img");
                if (typeof(a) != "undefined" && a != null && a.length > 0) {
                    Mobi.bindCommImgShow(a, false, 0)
                }
            }
        },
        500)
};
Mobi.formatDate = function(b) {
    var l = new Date(b);
    var k = b.getFullYear();
    var a = parseInt(b.getMonth() + 1) > 9 ? parseInt(b.getMonth() + 1) : ("0" + parseInt(b.getMonth() + 1));
    var j = b.getDate() > 9 ? b.getDate() : ("0" + b.getDate());
    var e = b.getHours() > 9 ? b.getHours() : ("0" + b.getHours());
    var f = b.getMinutes() > 9 ? b.getMinutes() : ("0" + b.getMinutes());
    var c = b.getSeconds() > 9 ? b.getSeconds() : ("0" + b.getSeconds());
    return k + "-" + a + "-" + j
};
Mobi.initAjaxTab = function(c) {
    if (!c) {
        return
    }
    var b = c.pid,
        f = c.moduleId,
        j = document.querySelector("#productDetailTabPanel" + f + " .tabUl"),
        d = document.querySelector("#productDetailTabPanel" + f + " .tabBody"),
        e = document.getElementById("productNewDetailPanel" + f),
        a = function(o) {
            if (!o) {
                return
            }
            var m = parseInt(o.getAttribute("data")),
                l = document.getElementById("tabPanel" + m),
                t = document.getElementById("tabLi" + m),
                p = e.querySelector(".tabLi.tabActive"),
                s = e.querySelector(".tabPanel.tabPanelAtive");
            if (!l) {
                return
            }
            jm(p).removeClass("tabActive");
            jm(s).removeClass("tabPanelAtive");
            jm(t).addClass("tabActive");
            jm(l).addClass("tabPanelAtive");
            setTimeout(function() {
                    Mobi.productTabUlScroll()
                },
                0);
            var k = jm("html").css("font-size");
            k = k.substring(0, k.length - 2);
            if (l.innerHTML == "") {
                var n = "<div id='tabPanelLoading' class='tabPanelLoading'></div>";
                jm(d).append(n);
                var q = "pid=" + b + "&type=" + m + "&moduleId=" + f + "&rem=" + k;
                jm.ajax({
                    type: "post",
                    url: "ajax/product_h.jsp?cmd=getProductDetailInfo",
                    data: q,
                    error: function() {
                        Mobi.ing("error")
                    },
                    success: function(r) {
                        var u = jm.parseJSON(r);
                        if (!u.html) {
                            jm("#tabPanelLoading").remove();
                            u.html = ""
                        }
                        if (m == 3) {
                            l.innerHTML = u.html;
                            Mobi.initCommentUserTab(3);
                            Mobi.setCommImgBindShow()
                        } else {
                            if (m === 1) {
                                u.html = "<div class='productDetailInfoPanel g_defaultColor'>" + u.html + "</div>";
                                if (!Fai.top._productRecommentData) {
                                    l.innerHTML = u.html;
                                    jm("#tabPanelLoading").remove();
                                    Mobi.switchJump();
                                    Mobi.addParentDivToTable();
                                    Mobi.initModulePhotoSwipe("productDetailTabPanel" + f);
                                    return
                                }
                                l.innerHTML = u.html + Fai.top._productRecommentData;
                                Mobi.productCrossedSlideSec("mProductList" + f, 1, 1, "paramWrap");
                                Mobi.productCrossedSlideSecSwipe("productSlideList" + f, "productSlide" + f);
                                Mobi.switchJump();
                                Mobi.addParentDivToTable();
                                Mobi.initModulePhotoSwipe("productDetailTabPanel" + f)
                            } else {
                                if (m === 2) {
                                    l.innerHTML = u.html
                                }
                            }
                        }
                        jm("#tabPanelLoading").remove()
                    }
                })
            }
        },
        h = function(l) {
            var k = l.target;
            if (k) {
                a(k);
                return false
            }
        };
    jm(e).css("min-height", jm(window).height() + "px");
    if (!j.querySelector(".tabActive")) {
        return
    }
    jm(j).bind("click", h);
    a(j.querySelector(".tabActive"));
    Mobi.initCommentUserTab(parseInt(j.querySelector(".tabActive").getAttribute("data")))
};
Mobi.getCommentAjaxPagenation = function(b, d) {
    if (!b) {
        return
    }
    var c = jm("html").css("font-size");
    c = c.substring(0, c.length - 2);
    var a = "pid=" + b + "&pageno=" + d + "&ajaxPage=" + true + "&rem=" + c;
    jm.ajax({
        type: "post",
        url: "ajax/product_h.jsp?cmd=getProductInfoComment",
        data: a,
        error: function() {
            Mobi.ing("error")
        },
        success: function(e) {
            var f = jm.parseJSON(e);
            if (!f.html) {
                f.html = ""
            }
            jm("#tabPanel3 .commentBoxPanel").remove();
            document.getElementById("tabPanel3").insertBefore(jm(f.html)[0], jm("#tabPanel3 .userComment")[0]);
            Mobi.setCommImgBindShow()
        }
    })
};
Mobi.setCommImgBindShow = function() {
    setTimeout(function() {
            var b = jm(".ct-s-content-m");
            if (typeof(b) != "undefined" && b != null) {
                for (var c = 0; c < b.length; c++) {
                    var a = b.eq(c)[0].querySelectorAll("img");
                    if (typeof(a) != "undefined" && a != null && a.length > 0) {
                        Mobi.bindCommImgShow(a, false, 0)
                    }
                }
            }
        },
        500)
};
Mobi.pbSaveBodyStyle = function() {
    if (typeof(g_saveBodyIdStyle) != "undefined" && g_saveBodyIdStyle != null) {
        jm("#g_body").attr("style", g_saveBodyIdStyle);
        g_saveBodyIdStyle = null
    }
};
Mobi.pbRemoveBodyStyle = function() {
    g_saveBodyIdStyle = jm("#g_body").attr("style");
    jm("#g_body").attr("style", "")
};
Mobi.bindCommImgShow = function(h, b, c) {
    var l = {
            imageScaleMethod: "fitNoUpscale",
            enableMouseWheel: false,
            resetToolbarPosition: true,
            loop: false,
            captionAndToolbarAutoHideDelay: 0,
            showCountTextLeft: true,
            getImageCaption: function(m, n) {
                var p, o;
                p = m + " / " + n;
                o = document.createElement("div");
                o.className = "ps-comm-page";
                o.appendChild(document.createTextNode(p));
                return o
            },
            getToolbar: function() {
                return '<div onclick="Mobi.pbSaveBodyStyle()" class="ps-toolbar-close   ps-toolbar-close-style icon-toolbar-close-style"></div>'
            }
        },
        j = null,
        d = null,
        f = null,
        e = null,
        a = window.Code.PhotoSwipe;
    if (b == null || !b || b == "false") {
        var k = a.attach(h, l)
    } else {
        if (typeof(g_showCommImgInstance) != "undefined" && g_showCommImgInstance != "null") {
            if (typeof(g_showCommImgInstance[c]) != "undefined" && g_showCommImgInstance[c] != "null") {
                a.detatch(g_showCommImgInstance[c]);
                g_showCommImgInstance[c] = null
            } else {
                g_showCommImgInstance[c] = {}
            }
        } else {
            g_showCommImgInstance = [];
            g_showCommImgInstance[c] = {}
        }
        setTimeout(function() {
                g_showCommImgInstance[c] = a.attach(h, l)
            },
            1000)
    }
};
Mobi.scrollFadeIn = function(k, c, o) {
    var c = document.getElementById(c),
        k = document.getElementById(k),
        p = document.getElementById("g_body"),
        a = k.clientHeight,
        d = c && c.clientHeight,
        j = false,
        e = false,
        h = jm(k).parent().hasClass("productDetail_v3");
    document.addEventListener("touchstart",
        function(q) {
            n();
            b()
        },
        false);
    document.addEventListener("touchmove",
        function(q) {
            n();
            b()
        },
        false);
    document.addEventListener("touchend",
        function(q) {
            n();
            b()
        },
        false);
    document.addEventListener("touchcancel",
        function(q) {
            n();
            b()
        },
        false);
    document.addEventListener("scroll",
        function() {
            n();
            b()
        },
        false);
    n();
    function n() {
        var r = m();
        if (o == 1) {
            return
        }
        if (r < d + 1) {
            var q = r * 1 / d;
            k.style.background = "rgba(255,255,255," + q + ")";
            k.style.borderBottom = "";
            e = true
        }
        if (r > d && e) {
            k.style.background = "rgba(255,255,255,0.99)";
            k.style.borderBottom = "1px solid #ddd";
            e = false
        }
    }
    productTabUl = document.getElementById("productTabUl");
    if (productTabUl != null && productTabUl != undefined) {
        var l = productTabUl.clientHeight,
            f = productTabUl.offsetTop;
        Mobi.productTabUlScroll = b
    }
    function b() {
        var q = m();
        if (q > (f - a) && !j) {
            jm(productTabUl).addClass("tabUl_fix");
            j = true;
            if (h) {
                k.style.borderBottom = ""
            }
        }
        if ((q + l) < f && j) {
            jm(productTabUl).removeClass("tabUl_fix");
            j = false;
            if (h) {
                k.style.borderBottom = "1px solid #ddd"
            }
        }
    }
    function m() {
        var q = p;
        if (document.documentElement && document.documentElement.scrollTop > 0) {
            q = document.documentElement
        }
        return q.scrollTop
    }
};
Mobi.salePromotionDetail = {
    salePromotionParam: "",
    showType: "2",
    styleType: "1",
    saleCountTimeInterval: {},
    showSaleTime: false,
    showSaleDlMore: false,
    saleReSalePriceHtml: ""
};
Mobi.initSalePromotion = function(c, a, b) {
    Mobi.salePromotionDetail.salePromotionParam = c;
    Mobi.salePromotionDetail.styleType = a;
    Mobi.salePromotionDetail.saleReSalePriceHtml = b
};
Mobi.oldShowSalePromotionDl = function(k, d, e) {
    if (typeof(k) == "undefined" || k == null || k == "") {
        return
    }
    Mobi.salePromotionDetail.salePromotionParam = k;
    var b = [];
    if (k.saleType == "1") {
        var h = "";
        if (typeof(k.other.ruleData.d.length) == "undefined") {
            return
        }
        var f = parseFloat(k.other.ruleData.d[0].m);
        if (k.other.ruleData.s == "1") {
            if (Fai.top._lcid == 2052 || Fai.top._lcid == 1028) {
                h = jm.format(LS.salePromotionDisCount, f)
            } else {
                h = jm.format(LS.salePromotionDisCount, 10 * (10 - f))
            }
            d = parseFloat(d) * f / 10
        } else {
            h = jm.format(LS.salePromotionLapse, f);
            d = parseFloat(d) - f
        }
        if (d < 0) {
            d = 0
        }
        b.push("<table cellpadding='0' cellspacing='0'>");
        b.push("<tr>");
        b.push("<td>" + LS.promotionPrice + LS.colon + "</td>");
        b.push("</td>");
        b.push("<td class='J_salePriceSet'>" + e + d.toFixed(2) + "</td>");
        b.push("</td>");
        b.push("<td class='oldTbTd1'>");
        b.push("<div class='trangle'>");
        b.push("</div>");
        b.push("</td>");
        b.push("<td class='oldTbTD2'>");
        b.push("<div class='rect'>");
        b.push(h);
        b.push("</div>");
        b.push("</td>");
        b.push("</tr>");
        b.push("</table>")
    } else {
        if (typeof(k.other.ruleData.d.length) == "undefined") {
            return
        }
        var j = k.other.ruleData.d;
        var c = j.length;
        b.push("<table cellpadding='0' cellspacing='0'>");
        for (var a = 0; a < c; a++) {
            b.push("<tr>");
            if (a == 0) {
                b.push("<td>" + LS.salePromotionName + LS.colon + "</td>")
            } else {
                b.push("<td></td>")
            }
            b.push("<td>");
            b.push("<div class='oldSaleTypeBg'>");
            b.push(LS.salePromotionOnlyFullReduce);
            b.push("</div>");
            b.push("</td>");
            b.push("<td>");
            b.push("<div class='oldShowDelColor'>");
            b.push("&nbsp;&nbsp;" + jm.format(LS.salePromotionFullReduce, j[a].m, j[a].n));
            b.push("</div>");
            b.push("</td>");
            b.push("</tr>")
        }
        b.push("</table>")
    }
    jm(".J_showSaleDetail").html(b.join(""))
};
Mobi.showNewMarketPrice = function(a) {
    if (a == true) {
        jm(".marketPriceNew").css("display", "block")
    }
};
Mobi.fixMallThemePtInfo = function() {
    if (Fai.top._templateFrameId >= 2000 || Fai.top._templateFrameId < 3000) {
        jm(".proCommProperty.productPrice").css("min-height", "1.6rem")
    }
};
Mobi.showSalePromotionDl = function(m, k, c) {
    var a = "position:relative;";
    if (Mobi.salePromotionDetail.showSaleTime == true) {
        a = a + "margin-top:0.4rem;"
    }
    if (Mobi.salePromotionDetail.showType != "2") {
        return
    }
    if (typeof(m) == "undefined" || m == null || m == "") {
        return
    }
    var d = jm(".J_saleMallPrice").css("color");
    if (typeof(d) == "undefined" || d == null || d == "") {
        d = "#FC4643"
    }
    var f = [];
    if (m.saleType == "1") {
        if (c != null && c != "") {
            jm(".J_saleMallPrice").html(c)
        }
        var j = "";
        jm(".J_salePrePrice").css("display", "inline-block");
        var b = m.other.ruleData.d[0].m;
        if (m.other.ruleData.s == "1") {
            if (Fai.top._lcid == 2052 || Fai.top._lcid == 1028) {
                j = jm.format(LS.salePromotionDisCount, b)
            } else {
                j = jm.format(LS.salePromotionDisCount, 10 * (10 - b))
            }
        } else {
            j = jm.format(LS.salePromotionLapse, b)
        }
        f.push("<div class='J_salePromotionRemove saleProDetail' style='" + a + "'><table cellpadding='0' cellspacing='0'>");
        f.push("<tr>");
        f.push("<td style='color:#323232;'>");
        f.push(LS.salePromotionName + LS.colon);
        f.push("</td>");
        f.push("<td>");
        f.push("<div  style='border:1px solid;' class='saleTypeBg g_mainColor'>");
        f.push(LS.salePromotionReduce);
        f.push("</div>");
        f.push("</td>");
        f.push("<td class='g_mainColor'");
        f.push("&nbsp;&nbsp;" + j);
        f.push("</td>");
        f.push("</tr>");
        f.push("</table><div>");
        jm(".J_saleInfoDl").html(f.join(""))
    } else {
        if (typeof(m.other.ruleData.d.length) == "undefined") {
            return
        }
        var l = m.other.ruleData.d;
        var h = l.length;
        var j = "";
        if (h > 1) {
            f.push("<div  onclick='Mobi.showSaleDlMore(" + h + ")' class='J_salePromotionRemove saleProDetail' style='" + a + "'>")
        } else {
            f.push("<div class='J_salePromotionRemove saleProDetail' style='" + a + "'>")
        }
        f.push("<table cellpadding='0' cellspacing='0'><tr>");
        f.push("<td style='color:#323232;'>");
        f.push(LS.salePromotionName + LS.colon);
        f.push("</td>");
        f.push("<td>");
        f.push("<div class='J_saleFullBgShow saleTypeBg g_mainColor' >");
        f.push(LS.salePromotionOnlyFullReduce);
        f.push("</div>");
        f.push("</td>");
        f.push("<td class='g_mainColor'>");
        if (h == 1) {
            j = jm.format(LS.salePromotionFullReduce, l[0].m, l[0].n);
            f.push("&nbsp;&nbsp;" + j)
        }
        f.push("</td>");
        f.push("</tr></table>");
        if (h > 1) {
            f.push("<div class='saleProShowMore'><span class='J_saleShowMoreIcon faisco-icons-downward1'></span></div>");
            for (var e = 0; e < h; e++) {
                f.push("<div class='J_saleFullProDetail saleProDetail' style='display:none;'>");
                f.push("<table cellpadding='0' cellspacing='0'><tr>");
                f.push("<td>");
                f.push("<div class='J_saleFullBgShow saleTypeBg g_mainColor' >");
                f.push(LS.salePromotionOnlyFullReduce);
                f.push("</div>");
                f.push("</td>");
                f.push("<td class='g_mainColor'>");
                f.push("&nbsp;&nbsp;" + jm.format(LS.salePromotionFullReduce, l[e].m, l[e].n));
                f.push("</td>");
                f.push("</tr></table>");
                f.push("</div>")
            }
        }
        f.push("</div>");
        jm(".J_saleInfoDl").html(f.join(""))
    }
};
Mobi.showSaleDlMore = function(a) {
    if (typeof(a) == "undefined") {
        return
    }
    if (Mobi.salePromotionDetail.showSaleDlMore == true) {
        Mobi.salePromotionDetail.showSaleDlMore = false;
        jm(".J_saleShowMoreIcon").addClass("faisco-icons-downward1");
        jm(".J_saleShowMoreIcon").removeClass("faisco-icons-upward1");
        jm(".J_saleFullProDetail").css("display", "none")
    } else {
        Mobi.salePromotionDetail.showSaleDlMore = true;
        jm(".J_saleShowMoreIcon").addClass("faisco-icons-upward1");
        jm(".J_saleShowMoreIcon").removeClass("faisco-icons-downward1");
        jm(".J_saleFullProDetail").css("display", "block")
    }
};
Mobi.setPdMallPriceHeight = function(b) {
    var a = jm(".J_saleMallPrice").css("height");
    if (a.indexOf("rem") < 0) {
        if (a.indexOf("px") < 0) {
            a = parseFloat(a) / _htmlFontSize
        } else {
            a = parseFloat(a.substring(0, (a.length - 2))) / _htmlFontSize
        }
    } else {
        a = parseFloat(a.substring(0, (a.length - 3)))
    }
    a = a + (parseFloat(b) * 2.3);
    jm(".J_salePrePrice").css("height", a + "rem");
    jm(".J_salePrePrice").css("line-height", a + "rem")
};
Mobi.showSaleTimeType = function(c, b, d, a) {
    if (d) {
        if (1014 < Fai.top._templateFrameId && Fai.top._templateFrameId < 2000 && jm(".collectText").length > 0 && jm(".J_showCountDownClass").length == 0) {
            jm(".pd3ProductNameContent").css("padding-bottom", "0.7rem")
        }
        if (b || a == 1) {
            jm(".isShowOldSaleCountDown").show();
            jm(".isShowNewSaleCountDown").hide();
            return
        }
        if (c) {
            jm(".isShowOldSaleCountDown").hide();
            jm(".isShowNewSaleCountDown").show()
        } else {
            jm(".isShowOldSaleCountDown").show();
            jm(".isShowNewSaleCountDown").hide()
        }
    }
};
Mobi.showSaleTimeCountDown = function(l, d, k, n, j, b, e, m) {
    var c = "";
    var a = LS.salePromotionBegin;
    var h = LS.salePromotionEnd;
    var f = 0;
    Mobi.salePromotionDetail.showType = k;
    Mobi.salePromotionDetail.showSaleTime = true;
    if (k == 1) {
        c = a;
        f = l
    } else {
        c = h;
        f = d;
        jm(".J_salePromotionNewMessage").html(LS.salePromotionNewEndMessage)
    }
    if ((e || Fai.top._manageMode) && m != 1) {
        jm(".J_salePromotionDay").html(LS.salePromotionDay);
        jm(".J_salePromotionHour").html(LS.salePromotionHour);
        jm(".J_salePromotionMinute").html(LS.salePromotionMinute);
        jm(".J_salePromotionSecond").html(LS.salePromotionSecond)
    }
    window.onload = function() {
        jm(".showSaleTimeImg").css("display", "block")
    };
    clearInterval(Mobi.salePromotionDetail.saleCountTimeInterval);
    Mobi.salePromotionDetail.saleCountTimeInterval = setInterval(function() {
            var s = parseInt(f / (3600 * 24));
            var o = parseInt(f / 3600) - (s * 24);
            var p = parseInt(f / 60) - (s * 24 * 60) - (o * 60);
            var r = parseInt(f % 60);
            if (Fai.top._lcid != 2052 && Fai.top._lcid != 1028) {
                if (o < 10) {
                    o = "0" + o
                }
                if (p < 10) {
                    p = "0" + p
                }
                if (r < 10) {
                    r = "0" + r
                }
            }
            f--;
            if (k == 1 && (e || Fai.top._manageMode) && m != 1) {
                jm(".J_showCountDownClass").html("&nbsp;&nbsp;" + jm.format(c, s, o, p, r))
            }
            if (n == 1 && (!e || Fai.top._manageMode || m == 1)) {
                jm(".showSaleTimeClass").html("&nbsp;&nbsp;" + jm.format(c, s, o, p, r))
            }
            if (n == 1 && (e || Fai.top._manageMode) && m != 1) {
                if (s < 10) {
                    s = "0" + s
                }
                if (o < 10) {
                    o = "0" + o
                }
                if (p < 10) {
                    p = "0" + p
                }
                if (r < 10) {
                    r = "0" + r
                }
                jm(".J_salePromotionDayNum").html(s);
                jm(".J_salePromotionHourNum").html(o);
                jm(".J_salePromotionMinuteNum").html(p);
                jm(".J_salePromotionSecondNum").html(r)
            }
            if (f < 0) {
                if (k == 1) {
                    f = d;
                    c = h;
                    k = 2;
                    Mobi.salePromotionDetail.showType = 2;
                    Mobi.showSalePromotionDl(Mobi.salePromotionDetail.salePromotionParam, Mobi.salePromotionDetail.styleType, Mobi.salePromotionDetail.saleReSalePriceHtml)
                } else {
                    clearInterval(Mobi.salePromotionDetail.saleCountTimeInterval);
                    Mobi.salePromotionDetail.showType = 1;
                    if (Mobi.salePromotionDetail.salePromotionParam.saleType == "1") {
                        var q = jm(".J_salePrePrice").html();
                        if (q != null) {
                            jm(".J_saleMallPrice").html(q)
                        }
                    }
                    jm(".J_salePromotionRemove").remove();
                    if (j == true) {
                        jm(".productPrice").css("height", "3.75rem")
                    } else {
                        jm(".productPrice").css("height", "2.75rem")
                    }
                }
            }
        },
        1000)
};
Mobi.showGbTimeCountDown = function(j, c, h, d, k) {
    var b = "";
    var a = "距拼团活动开始仅剩：{0}天{1}小时{2}分{3}秒";
    var f = "距拼团活动结束仅剩：{0}天{1}小时{2}分{3}秒";
    var e = 0;
    if (h == 1) {
        b = a;
        e = j
    } else {
        b = f;
        e = c;
        jm(".J_salePromotionNewMessage").html(LS.salePromotionNewEndMessage)
    }
    if ((d || Fai.top._manageMode) && k != 1) {
        jm(".J_salePromotionDay").html(LS.salePromotionDay);
        jm(".J_salePromotionHour").html(LS.salePromotionHour);
        jm(".J_salePromotionMinute").html(LS.salePromotionMinute);
        jm(".J_salePromotionSecond").html(LS.salePromotionSecond)
    }
    window.onload = function() {
        jm(".showSaleTimeImg").css("display", "block")
    };
    clearInterval(Mobi.gbCountTimeInterval);
    Mobi.gbCountTimeInterval = setInterval(function() {
            var o = parseInt(e / (3600 * 24));
            var l = parseInt(e / 3600) - (o * 24);
            var m = parseInt(e / 60) - (o * 24 * 60) - (l * 60);
            var n = parseInt(e % 60);
            if (Fai.top._lcid != 2052 && Fai.top._lcid != 1028) {
                if (l < 10) {
                    l = "0" + l
                }
                if (m < 10) {
                    m = "0" + m
                }
                if (n < 10) {
                    n = "0" + n
                }
            }
            e--;
            if (h == 1 && (d || Fai.top._manageMode) && k != 1) {
                jm(".J_showCountDownClass").html("&nbsp;&nbsp;" + jm.format(b, o, l, m, n))
            }
            if (!d || Fai.top._manageMode || k == 1) {
                jm(".showSaleTimeClass").html("&nbsp;&nbsp;" + jm.format(b, o, l, m, n))
            }
            if ((d || Fai.top._manageMode) && k != 1) {
                if (o < 10) {
                    o = "0" + o
                }
                if (l < 10) {
                    l = "0" + l
                }
                if (m < 10) {
                    m = "0" + m
                }
                if (n < 10) {
                    n = "0" + n
                }
                jm(".J_salePromotionDayNum").html(o);
                jm(".J_salePromotionHourNum").html(l);
                jm(".J_salePromotionMinuteNum").html(m);
                jm(".J_salePromotionSecondNum").html(n)
            }
            if (e < 0) {
                clearInterval(Mobi.gbCountTimeInterval)
            }
        },
        1000)
};
Mobi.addProductScreenFilterModel = function(e, c) {
    var a = e;
    c = jm.parseJSON(jm.decodeUrl(c));
    var b = Mobi.initWebPage({
        triggerId: "screenButton",
        panelId: "productScreenFilterPanel",
        pageBg: true,
        returnSeltFun: true,
        callback: d,
        direction: "right",
        pageHead: "筛选",
        closeWebPage: ".screenFilterIcon"
    });
    function d() {
        var m = c.sortName,
            n = c.desc,
            l = c.groupId,
            h;
        if (c.keyword) {
            h = c.keyword
        } else {
            h = ""
        }
        var k = c.mid,
            f = c.psc;
        var j = {};
        j.sortName = m;
        j.pdListId = a;
        j.desc = n;
        j.groupID = l;
        j.searchword = h;
        j.mid = k;
        urlStr = "ajax/product_h.jsp?cmd=getScreenPrInfo";
        jm.ajax({
            type: "POST",
            url: urlStr,
            data: j,
            success: function(o) {
                var q = jm.parseJSON(o);
                if (q.success) {
                    var p = jm.toJSON(q.list);
                    Mobi.initScreenFilter(p, f, l, n, m, h)
                }
            }
        })
    }
};
Mobi.initScreenFilter = function(h, e, o, k, p, l) {
    var c = jm.parseJSON(h);
    var j = jm.parseJSON(e);
    var d = LS.productScreenAll;
    if (j) {
        var n = j.lid;
        for (var f = c.length - 1; f >= 0; f--) {
            var b = c[f];
            if (b.lid == n) {
                d = b.libName;
                break
            }
        }
    }
    var m = [];
    if (c.length > 1) {
        m.push("<div class='productScreenFilterLib' id='libTab'>");
        m.push("<div class='productScreenLibLeft'>" + LS.productScreenSort + "</div>");
        m.push("<div class='g_mainColor productScreenLibRight'>");
        m.push("<div class='icon-libNextMore libNextMoreIcon'></div>");
        m.push("<div class='productScreenLibName' id='productScreenLibName'>" + d + "</div>");
        m.push("</div>");
        m.push("</div>");
        if (j) {
            var n = j.lid;
            m.push("<input type='hidden' id='lidValue' value='" + n + "'/>")
        } else {
            m.push("<input type='hidden' id='lidValue' value='-1'/>")
        }
    } else {
        if (c.length == 1) {
            m.push("<input type='hidden' id='lidValue' value='" + c[0].lid + "'/>")
        } else {
            m.push("<input type='hidden' id='lidValue' value='-1'/>")
        }
    }
    var q = m.join("");
    jm("#baseScreenFilterContenter").append(q);
    jm("#backContent").show();
    var a = [];
    a.push("<div class='productScreenFilterBottom'>");
    a.push("<div class='g_bgColor productScreenFilterButton' id='screenCommit'>" + LS.productScreenCommit + "</div>");
    a.push("</div>");
    q = a.join("");
    jm("#basePanel").append(q);
    if (c.length > 1) {
        Mobi.changeScreenFilterLib(h)
    }
    Mobi.initScreenFilterModel(h, j);
    Mobi.screenCommitData(h, o, k, p, l)
};
Mobi.setPrImageMaxHeight = function(f, b, h) {
    var d = jm("#module" + f),
        b = d.find(b),
        c = b.find("img"),
        e = 0,
        a = 0;
    c.each(function() {
        a = parseInt(jm(this).height());
        if (a > e) {
            e = a
        }
    });
    if (e != 0) {
        if (h) {
            b.css("height", "100%")
        } else {
            b.css("height", (e / _htmlFontSize) + "rem")
        }
    }
};
Mobi.changeScreenFilterLib = function(a) {
    var b = jm.parseJSON(a);
    jm("#libTab").bind("click",
        function() {
            jm("#screenCommit").hide();
            jm("#baseScreenFilterContenter").hide();
            var h = jm("#lidValue").val();
            var e = [];
            e.push("<div class='productScreenFilterOptionContenter' id='optionSelectorLib'>");
            e.push("<div class='productScreenFilterTitle'>");
            e.push("<div id='backLib' class='icon-screenFilterRt screenFilterRtIcon'></div>");
            e.push("<div class='productScreenFilterTi'>" + LS.productScreenSort + "</div>");
            e.push("</div>");
            e.push("<div class='productScreenFilterContent'>");
            if (h < 0) {
                e.push("<div class='productScreenFilterLineCheck' id='propOptionLibAll' onclick='Mobi.changeLibValue(-1," + jm.encodeHtml(jm.toJSON(b)) + ")'>")
            } else {
                e.push("<div class='productScreenFilterLine' id='propOptionLibAll' onclick='Mobi.changeLibValue(-1," + jm.encodeHtml(jm.toJSON(b)) + ")'>")
            }
            e.push("<div class='productScreenFilterLineLf'>");
            e.push("<span>" + LS.productScreenAll + "</span>");
            e.push("</div>");
            if (h < 0) {
                e.push("<div class='entry-trangle'>");
                e.push("</div>");
                e.push("<div class='icon-check checkIcon'>");
                e.push("</div>")
            }
            e.push("</div>");
            e.push("<div class='g_separator'></div>");
            for (var d = 0; d < b.length; d++) {
                var j = b[d].lid;
                var f = b[d].libName;
                if (j == h) {
                    e.push("<div class='productScreenFilterLineCheck' id='propOptionLib'  onclick='Mobi.changeLibValue(" + b[d].lid + "," + jm.encodeHtml(jm.toJSON(b)) + ")'>")
                } else {
                    e.push("<div class='productScreenFilterLine' id='propOptionLib'  onclick='Mobi.changeLibValue(" + b[d].lid + "," + jm.encodeHtml(jm.toJSON(b)) + ")'>")
                }
                e.push("<div class='productScreenFilterLineLf'>");
                e.push("<span>" + jm.encodeHtml(f) + "</span>");
                e.push("</div>");
                if (j == h) {
                    e.push("<div class='entry-trangle'>");
                    e.push("</div>");
                    e.push("<div class='icon-check checkIcon'>");
                    e.push("</div>")
                }
                e.push("</div>");
                e.push("<div class='g_separator'></div>")
            }
            e.push("</div>");
            e.push("</div>");
            var c = e.join("");
            jm("#basePanel").append(c);
            jm("#backLib").on("click",
                function() {
                    jm("#optionSelectorLib").remove();
                    jm("#screenCommit").show();
                    jm("#baseScreenFilterContenter").show()
                })
        })
};
Mobi.changeLibValue = function(c, b) {
    if (c > 0) {
        for (var a = b.length - 1; a >= 0; a--) {
            if (b[a].lid == c) {
                jm(".productScreenLibName").html(b[a].libName);
                jm("#lidValue").val(c);
                break
            }
        }
    } else {
        jm(".productScreenLibName").html(LS.productScreenAll);
        jm("#lidValue").val( - 1)
    }
    jm("#optionSelectorLib").remove();
    jm("#screenCommit").show();
    Mobi.initScreenFilterModel(jm.toJSON(b));
    jm("#baseScreenFilterContenter").show()
};
Mobi.initScreenFilterModel = function(k, c) {
    if (jm("#productScreenFilterOptions").length > 0) {
        jm("#productScreenFilterOptions").remove()
    }
    if (jm(".noScreenProp").length > 0) {
        jm(".noScreenProp").remove()
    }
    var n = jm("#lidValue").val();
    if (!k) {
        return
    }
    if (n < 0) {
        return
    }
    var b = jm.parseJSON(k);
    var o = [];
    var m;
    if (c) {
        m = c.prop;
        n = c.lid
    }
    for (var f = 0; f < b.length; f++) {
        if (b[f].lid == n) {
            var r = b[f].propList;
            o.push("<div class='productScreenFilterContent' id='productScreenFilterOptions'>");
            for (var e = 0; e < r.length; e++) {
                var h = LS.productScreenAll;
                if (m) {
                    for (var d = 0; d < m.length; d++) {
                        var a = r[e].id;
                        if (a == m[d].k) {
                            h = m[d].v;
                            if (a == 11 || a == 12 || a == 13) {
                                var p = r[e].currency;
                                h = h.replace("[", "");
                                h = h.replace(",", "~");
                                h = h.replace("]", "");
                                h = p + h;
                                if (h.indexOf("~") < 0) {
                                    h = h + "~"
                                }
                            }
                        }
                    }
                }
                o.push("<div class='productScreenFilterLine' id='screenOption" + e + "'>");
                o.push("<div class='productScreenFilterLineLf'>");
                o.push("<span>" + r[e].name + "</span>");
                o.push("</div>");
                o.push("<div class='productScreenFilterLineRt'>");
                o.push("<div class='icon-nextMore nextMoreIcon'></div>");
                o.push("<span class='productScreenFilterOption' id='screenOptionContent" + e + "'>" + h + "</span>");
                o.push("</div>");
                o.push("</div>");
                o.push("<div class='g_separator'></div>")
            }
            o.push("</div>");
            break
        }
    }
    var q = o.join("");
    jm("#baseScreenFilterContenter").append(q);
    jm.each(b,
        function(t, u) {
            if (u.lid == n) {
                var l = u.propList;
                for (var s = 0; s < l.length; s++) {
                    Mobi.changeScreenFilterModel(s, l[s])
                }
            }
        })
};
Mobi.changeScreenFilterModel = function(e, b) {
    var d = b.name;
    var c = b.option;
    var a = b.currency;
    jm("#screenOption" + e).bind("click",
        function() {
            jm("#baseScreenFilterContenter").hide();
            var l = jm("#screenOptionContent" + e).html();
            l = jm.decodeHtml(l);
            jm("#screenCommit").hide();
            var k = [];
            k.push("<div class='productScreenFilterOptionContenter' id='optionSelector" + e + "'>");
            k.push("<div class='productScreenFilterTitle'>");
            k.push("<div id='back' class='icon-screenFilterRt screenFilterRtIcon'></div>");
            k.push("<div class='productScreenFilterTi'>" + d + "</div>");
            k.push("</div>");
            k.push("<div class='productScreenFilterContent'>");
            if (l == LS.productScreenAll) {
                k.push("<div class='productScreenFilterLineCheck' id='propOptionLineAll' onclick='Mobi.changePropValue(\"All\"," + e + ")'>")
            } else {
                k.push("<div class='productScreenFilterLine' id='propOptionLineAll' onclick='Mobi.changePropValue(\"All\"," + e + ")'>")
            }
            k.push("<div class='productScreenFilterLineLfLong'>");
            k.push("<span id='optionAll'>" + LS.productScreenAll + "</span>");
            k.push("</div>");
            if (l == LS.productScreenAll) {
                k.push("<div class='entry-trangle'>");
                k.push("</div>");
                k.push("<div class='icon-check checkIcon'>");
                k.push("</div>")
            }
            k.push("</div>");
            k.push("<div class='g_separator'></div>");
            for (var j = 0; j < c.length; j++) {
                var f = c[j];
                if (f.indexOf("[") > -1 && f.indexOf("]") > -1) {
                    f = f.replace("[", "");
                    f = f.replace(",", "~");
                    f = f.replace("]", "");
                    if (j == c.length - 1) {
                        f = f + "~"
                    }
                }
                f = a + f;
                if (l == f) {
                    k.push("<div class='productScreenFilterLineCheck' id='propOptionLine" + j + "' onclick='Mobi.changePropValue(\"" + j + '",' + e + ")'>")
                } else {
                    k.push("<div class='productScreenFilterLine' id='propOptionLine" + j + "' onclick='Mobi.changePropValue(\"" + j + '",' + e + ")'>")
                }
                k.push("<div class='productScreenFilterLineLfLong'>");
                k.push("<span id='option" + j + "'>" + f + "</span>");
                k.push("</div>");
                if (l == f) {
                    k.push("<div class='entry-trangle'>");
                    k.push("</div>");
                    k.push("<div class='icon-check checkIcon'>");
                    k.push("</div>")
                }
                k.push("</div>");
                k.push("<div class='g_separator'></div>")
            }
            k.push("</div>");
            k.push("</div>");
            var h = k.join("");
            jm("#basePanel").append(h);
            jm("#back").on("click",
                function() {
                    jm("#optionSelector" + e).remove();
                    jm("#screenCommit").show();
                    jm("#baseScreenFilterContenter").show()
                })
        })
};
Mobi.changePropValue = function(a, b) {
    jm("#screenOptionContent" + b).html(jm("#option" + a).html());
    jm("#optionSelector" + b).remove();
    jm("#screenCommit").show();
    jm("#baseScreenFilterContenter").show()
};
Mobi.screenCommitData = function(c, b, f, e, a) {
    var d = jm.parseJSON(c);
    jm("#screenCommit").bind("click",
        function() {
            var p, l = {};
            if (d.length > 1) {
                jm.each(d,
                    function(t, v) {
                        var u = jm("#productScreenLibName").html();
                        u = jm.decodeHtml(u);
                        if (u == v.libName) {
                            l.lid = v.lid;
                            p = v
                        }
                    })
            } else {
                l.lid = d[0].lid;
                p = d[0]
            }
            var r = "?";
            var k = "pr.jsp";
            if (b) {
                k += r + "groupId=" + b;
                r = "&"
            }
            if (f) {
                k += r + "desc=" + f;
                r = "&"
            }
            if (e) {
                k += r + "sortName=" + e;
                r = "&"
            }
            if (a) {
                k += r + "searchword=" + a;
                r = "&"
            }
            if (p) {
                var j = [];
                var s = p.propList;
                for (var n = 0; n < s.length; n++) {
                    var o = jm("#screenOptionContent" + n).html();
                    if (o != LS.productScreenAll) {
                        var m = {};
                        var h = s[n].id;
                        m.k = h;
                        if (h == 11 || h == 12 || h == 13) {
                            var q = s[n].currency;
                            if (q) {
                                o = o.replace(q, "")
                            }
                            if (o.charAt(o.length - 1) == "~") {
                                o = o.replace("~", "")
                            } else {
                                o = o.replace("~", ",")
                            }
                            o = "[" + o + "]"
                        } else {
                            o = jm.decodeHtml(o)
                        }
                        m.v = o;
                        j.push(m)
                    }
                }
                l.prop = j;
                k += r + "psc=" + jm.encodeUrl(jm.toJSON(l))
            }
            document.location.href = k
        })
};
Mobi.showProductCacheList = [];
Mobi.showMallCartScreen = function(e, d, c, b, j) {
    var a = jm(".productMallOptionPanel");
    jm("#module" + e + " .J_fk-mallCart").bind("click",
        function() {
            var o = j && j.replace ? (j.replace(/&nbsp;/gi, " ").replace(/&lt;/gi, "<").replace(/&gt;/g, ">").replace(/&#92;/gi, "\\").replace(/&#39;/gi, "'").replace(/&quot;/gi, '"').replace(/\<br\/\>/gi, "\n").replace(/&amp;/gi, "&")) : j;
            jm("#productMallOptionPanel_mcs_" + e + " .productMallOptionContent").append(o);
            a = jm(".productMallOptionPanel");
            var m = jm(this).attr("id") || "";
            var l = false;
            var k = {};
            var q = "";
            var p = "";
            var n = {};
            jm.each(Mobi.showProductCacheList,
                function(r, s) {
                    if (s.id == m) {
                        l = true;
                        k = s.pinfo;
                        q = s.showOptionHtml;
                        p = s.script;
                        n = s.otherHtml;
                        return false
                    }
                });
            h();
            jm("#productMallOptionPanel_mcs_" + e).find(".productMallOptionPanel").hide();
            if (l) {
                f(k, q, p, n)
            } else {
                jm.ajax({
                    type: "POST",
                    url: "ajax/product_h.jsp?cmd=getProductInfoAndDom",
                    data: {
                        pid: m,
                        moduleId: e,
                        mallShoppingOptions: c
                    },
                    error: function() {
                        Mobi.ing(LS.systemError)
                    },
                    success: function(r) {
                        var u = jm.parseJSON(r);
                        if (u.success) {
                            var w = u.pinfo;
                            var v = u.showOptionHtml;
                            var t = u.script;
                            var s = u.otherHtml;
                            Mobi.showProductCacheList.push({
                                id: m,
                                pinfo: w,
                                showOptionHtml: v,
                                script: t,
                                otherHtml: s
                            });
                            f(w, v, t, s)
                        }
                    }
                })
            }
            return false
        });
    var h = Mobi.initWebPage({
        triggerId: "f" + e,
        panelId: "productMallOptionPanel_mcs_" + e,
        pageBg: true,
        returnSeltFun: true,
        direction: "bottom",
        closeWebPage: "#productMallOptionPanel_mcs_" + e + " .productDetailClose.icon-Off",
        closeCallBack: function() {
            jm(".productMallOptionPanel .productMallOptionContentPanel").removeClass("mallThemeProductContentPanel");
            jm("#productMallOptionPanel_mcs_" + e + " .productMallOptionContent .productMallOptionHead").remove();
            jm("#productMallOptionPanel_mcs_" + e + " .productMallOptionContent .mallOptionAndNumBox").remove();
            jm("#productMallOptionPanel_mcs_" + e + " .productMallOptionContent .productMallShop").remove();
            jm("#productMallOptionPanel_mcs_" + e + " .productMallOptionContent .separatorLine").remove()
        }
    });
    function f(B, n, D, s) {
        a = jm(".productMallOptionPanel");
        var u = B.id;
        a.attr("id", "productMallOptionPanel" + u);
        var p = s.mallAmountHtml || "";
        var w = s.mallWeightHtml || "";
        var y = s.mallPriceHtml || "";
        var x = B.mallPrice;
        var o = x.toFixed(2);
        var k = o;
        var A = "";
        var t = "";
        if (c) {
            var v = o;
            var C = o;
            var r = B.optionsAmountList || {};
            var q = r.d || [];
            jm.each(q,
                function(I, K) {
                    var J = K;
                    var F = J.oPrice;
                    if (F == null || F == "") {
                        return
                    }
                    var H = J.flag || 0;
                    if (H == 0) {
                        return
                    }
                    var G = F || 0;
                    v = v < G ? v: G;
                    C = C > G ? C: G;
                    v = parseFloat(v) || 0;
                    C = parseFloat(C) || 0;
                    if (v == C) {
                        o = v.toFixed(2)
                    } else {
                        o = v.toFixed(2) + "~" + C.toFixed(2);
                        A = C.toFixed(2);
                        t = v.toFixed(2);
                        priceScope = v + "~" + C
                    }
                })
        }
        if (t != "" || A != "") {
            var z = parseFloat(A) * b * 0.01;
            var E = parseFloat(t) * b * 0.01;
            k = E + "~" + z
        }
        jm("#choiceCurrency").text(d);
        jm("#mallPrice").text(k);
        a.find(".mallOptionImg").attr("src", B.picPath);
        a.find(".productMallAmount").html(p);
        a.find(".productMallWeight").html(w);
        a.find(".productDetailName").html("<div class='productName g_middleColor'><div class='productNameWrap' style='word-break:break-all;white-space: normal;overflow:hidden;text-overflow:ellipsis;'></div></div>" + y);
        a.find(".productNameWrap").text(B.name);
        a.find(".J-op-box").html(n);
        jm("#g_increase").unbind("click.ic").bind("click.ic",
            function() {
                Mobi.decrease2(u)
            });
        jm("#g_decrease").unbind("click.dc").bind("click.dc",
            function() {
                Mobi.increase2(u)
            });
        var l = document.createElement("script");
        l.type = "text/javascript";
        l.innerHTML = D;
        l.id = "opScript_" + e;
        document.getElementById("productMallOptionPanel_mcs_" + e).appendChild(l);
        jm("#opScript_" + e).remove();
        jm("#productMallOptionPanel_mcs_" + e + " #productBuy").unbind("click.msc").bind("click.msc",
            function() {
                Mobi.mallBuy(u, 0, 1, e)
            });
        jm("#productMallOptionPanel_mcs_" + e + " .J_productImmediatelyBug").unbind("click.msc").bind("click.msc",
            function() {
                Mobi.mallBuy(u, 1, 1, e)
            });
        jm("#productMallOptionPanel_mcs_" + e).find(".productMallOptionPanel").show();
        if (Fai.top._templateFrameId >= 2000 || Fai.top._templateFrameId < 3000) {
            jm("#mallPrice").css({
                height: "",
                lineHeight: ""
            })
        }
        var m = document.createElement("script");
        m.type = "text/javascript";
        m.innerHTML = 'jm(window).bind("pageshow", function(){jm("#productNum").change();});';
        m.id = "opScript2_" + e;
        document.getElementById("productMallOptionPanel_mcs_" + e).appendChild(m)
    }
};
Mobi.showMallCart = function(b, c) {
    jm("#module" + c + " .J_fk-mallCart").bind("click",
        function() {
            if (b == jm(this).attr("id") && jm("#module" + c).length != 0) {
                d()
            }
            return false
        });
    var a = "productMallOptionPanel" + b;
    var d = Mobi.initWebPage({
        triggerId: "f",
        panelId: a,
        pageBg: true,
        returnSeltFun: true,
        direction: "bottom",
        closeWebPage: "#" + a + " .productDetailClose.icon-Off",
        closeCallBack: function() {
            jm(".productMallOptionPanel .productMallOptionContentPanel").removeClass("mallThemeProductContentPanel")
        }
    });
    jm("#" + a + " #productBuy").bind("click",
        function() {
            Mobi.mallBuy(b, 0, 1, c)
        });
    jm("#" + a + " .J_productImmediatelyBug").bind("click",
        function() {
            Mobi.mallBuy(b, 1, 1, c)
        })
};
Mobi.showFooterBox = function() {
    var a = jm("#webFooterBox");
    a.removeClass("webDetailPage");
    if (Fai.top._manageMode && Fai.top._mobiFooterClose) {
        jm("#webFooter").hide()
    }
};
Mobi.bookingPanelClickEvent = function(a, b) {
    jm("#" + a).on("click",
        function(c) {
            if (b == 1) {
                Mobi.logDog(200332, 15)
            } else {
                if (b == 2) {
                    Mobi.logDog(200332, 16)
                } else {
                    if (b == 3) {
                        Mobi.logDog(200332, 17)
                    }
                }
            }
            jm("#bookingPanelTriggle").data("pid", jm(this).attr("_pid")).trigger("click");
            c.stopPropagation();
            c.preventDefault()
        })
};
Mobi.bookingBoxBind = function(b) {
    triggerId = "bookingPanelTriggle";
    jm("#" + triggerId).click(function() {
        if (b) {
            Mobi.ing(LS.bookingSubmitFullTips)
        }
    });
    if (b) {
        return
    }
    if (jm("#productBookingPanel").length > 0) {
        return
    }
    var c = [];
    c.push("<div class='productBookingPanel' id='productBookingPanel' style='display:none; background-color:white;'>");
    c.push("<div class='ShipDetailsHeader webHeaderBg'>");
    c.push("<span class='g_close icon-gClose'></span><span class='title pageTitle'>" + Fai.top._bookingModuleTitle + "</span>");
    c.push("</div>");
    c.push("</div>");
    jm(c.join("")).insertAfter("#" + triggerId);
    var a = {
        triggerId: triggerId,
        panelId: "productBookingPanel",
        callback: function() {
            Mobi.showBookingBox()
        },
        closeWebPage: "#productBookingPanel .g_close"
    };
    Mobi.initWebPage(a)
};
Mobi.showBookingBox = function() {
    var e = [],
        a = 0,
        c = "",
        d = {},
        b = {};
    e.push("pid=" + a);
    e.push("&cmd=getPanelData");
    e.push("&_colId=" + Fai.top._colId);
    e.push("&_extId=" + Fai.top._extId);
    jm.ajax({
        type: "post",
        cache: false,
        url: "ajax/booking_h.jsp?" + e.join(""),
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(h) {
            var f = jm.parseJSON(h);
            if (f.success) {
                b = f.pageData;
                d = b.moduleInfo;
                Mobi.bookingBoxInit(b, d)
            } else {
                Mobi.ing("获取数据失败", false)
            }
        }
    })
};
Mobi.bookingBoxInit = function(b, h) {
    var f = b.bookingOpen,
        d = b.moduleId;
    jm("#module" + d).remove();
    var c = [];
    c.push("<div id='module" + b.moduleId + "'>");
    if (f) {
        var j = h.content.st;
        c.push("<div class='siteForm fk-siteForm-v " + (j == 1 ? "verticalShowTye": "") + "'>");
        c.push("<div id='siteFormItems' class='siteFormItemTable'>\n");
        jm.each(b.contentList,
            function(k, l) {
                if (l.hide) {
                    return true
                }
                c.push(Mobi.genBookingInputStr(l, b, h))
            });
        if (b.validation) {
            if (j == 1) {
                c.push("<div class='siteFormItem siteFormItemTr f-siteFormItemTr'>\n");
                c.push("<div class='siteFormItemShowName' width='100%'>验证码</div>\n");
                c.push("</div>\n");
                c.push("<div class='siteFormItem siteFormValidate siteFormItemTr'>");
                c.push("<div class='siteFormItemTd'width='100%' >");
                c.push("<input class='g_itext' type='text' placeholder='" + LS.EnterVerificationCode + "' id='M" + d + "siteFormValidateCode' maxlength='4' msg='" + LS.EnterVerificationCode + "' />");
                c.push("<img id='M" + d + "FvalidateCodeImg' class='validateCodeImg' onclick=\"Mobi.siteFormValidation('', " + d + ")\" src='/validateCode.jsp?vCodeId=" + d + "&" + Math.random() * 1000 + "'/>");
                c.push("<div onclick=\"Mobi.siteFormValidation('', " + d + ")\" class='left siteFormValidateUp changeSiteFormValidate'></div>");
                c.push("<font class='bookingSubmitItemMust'>*</font>");
                c.push("</div>");
                c.push("</div>")
            } else {
                c.push("<div class='siteFormItem siteFormValidate'>");
                c.push("<div style='width: 23%;float: left; height:100%;'><div class='siteFormItemShowName'><table style='table-layout:fixed;text-align:right; height:100%;' width='100%' cellpadding='0' cellspacing='0'><tr><td  width='100%'>验证码</td></tr></table></div></div>\n");
                c.push("<div style='width: 77%;float: left;'><div class='siteFormItemShowVal'>");
                c.push("<input class='g_itext validateInput' type='text' placeholder='" + LS.EnterVerificationCode + "' id='M" + d + "siteFormValidateCode' maxlength='4' msg='" + LS.EnterVerificationCode + "' />");
                c.push("<img class='validateCodeImg' id='M" + d + "FvalidateCodeImg' onclick=\"Mobi.siteFormValidation('', " + d + ")\" title='换一换' src='/validateCode.jsp?vCodeId=" + d + "&" + Math.random() * 1000 + "'/>");
                c.push("<div onclick=\"Mobi.siteFormValidation('', " + d + ")\" class='left changeSiteFormValidate'></div>");
                c.push("<font class='bookingSubmitItemMust'>*</font>");
                c.push("</div></div>");
                c.push("</div>")
            }
        }
        c.push("</div>");
        c.push("</div>");
        if (!Fai.top._manageMode) {
            c.push("<div id='siteFormMsgM" + b.moduleId + "F-1' class='siteFormMsg g_warning'></div>")
        }
        c.push("<div class='siteFormAddButton " + (j == 1 ? "verticalShowTye": "") + "'>\n");
        c.push("<div id='M" + b.moduleId + "siteFormAddButton' class='siteFormSend'><input type='button' class='g_button sendIcon' value='" + b.buttonName + "' /></div>\n");
        c.push("</div>\n")
    } else {
        var e = b.bookingClosedTip;
        if (Fai.top._manageMode) {
            e += ("，" + b.pleaseClick + "<a style='color:#333;' href='javascript:window.open(\"" + b.bookingEditUrl + "\");'>" + b.setUp + "</a>")
        }
        c.push("<div style='color:#333; font-size:0.6rem; text-align:center; padding-top:45%; padding-bottom:45%;'>" + e + "</div>")
    }
    c.push("</div>");
    var a = c.join("");
    jm("#productBookingPanel").append(a);
    Fai.top._bookingModuleTitle = h.content.mt;
    jm("#productBookingPanel .pageTitle").text(Fai.top._bookingModuleTitle);
    if (f) {
        Mobi.bookingSubmitPanleEventInit(b)
    }
    if (Fai.top._manageMode) {
        Mobi.initModuleLayer(d, b.itemList, [], b.canDesign)
    }
};
Mobi.mobiBookingSubmitAdd = function(b) {
    if (Fai.top._manageMode) {
        alert("当前为管理状态，提交无效。");
        return
    }
    var a = b.moduleId,
        d = b.moduleInfo,
        n = b.contentList,
        h = [],
        o = n,
        c = true,
        l = b.Def_LIMIT_INPUT_MAXLENTH,
        e = b.Def_LIMIT_TEXTAREA_MAXLEN,
        m = b.validation,
        j = jm("#M" + a + "siteFormValidateCode").val(),
        k = [];
    if (o.length < 1) {
        return false
    }
    jm.each(o,
        function(D, B) {
            var y = B.id,
                J = B.name,
                z = B.must,
                t = B.type,
                F = {};
            F.id = y,
                F.type = t;
            F.must = z;
            if (t == 0) {
                var H = jm.trim(jm("#M" + a + "siteFormInput" + y).val());
                if (z && H == "") {
                    Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(J)));
                    c = false;
                    return false
                }
                if (H.length > l) {
                    Mobi.ing(jm.format(LS.siteFormSubmitInputMaxLength, jm.encodeHtml(J), l));
                    c = false;
                    return false
                }
                F.val = H
            } else {
                if (t == 1) {
                    var p = jm.trim(jm("#M" + a + "siteFormTextArea" + y).val());
                    if (z && p == "") {
                        Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(J)));
                        c = false;
                        return false
                    }
                    if (p.length > e) {
                        Mobi.ing(jm.format(LS.siteFormSubmitInputMaxLength, jm.encodeHtml(J), e));
                        c = false;
                        return false
                    }
                    F.val = p
                } else {
                    if (t == 2) {
                        var v = document.querySelectorAll("input[name='M" + a + "siteFormRadioR" + y + "']:checked");
                        if (z && v.length == 0) {
                            Mobi.ing(jm.format(LS.siteFormSubmitCheckIsEmpty, jm.encodeHtml(J)));
                            c = false;
                            return false
                        }
                        if (v.length > 0) {
                            F.val = v[0].value
                        } else {
                            F.val = ""
                        }
                    } else {
                        if (t == 3) {
                            var w = document.querySelectorAll("input[name='M" + a + "siteFormCheckboxR" + y + "']:checked");
                            if (z && w.length == 0) {
                                Mobi.ing(jm.format(LS.siteFormSubmitCheckIsEmpty, jm.encodeHtml(J)));
                                c = false;
                                return false
                            }
                            var C = [];
                            for (var D = 0; D < w.length; D++) {
                                C.push(w[D].value)
                            }
                            F.val = C.join("\n")
                        } else {
                            if (t == 4) {
                                var A = jm("#M" + a + "siteFormSelect" + y).val();
                                if (z && (A.length == 0 || A == "none")) {
                                    Mobi.ing(jm.format(LS.siteFormSubmitCheckIsEmpty, jm.encodeHtml(J)));
                                    c = false;
                                    return false
                                }
                                F.val = A
                            } else {
                                if (t == 5) {
                                    return true
                                } else {
                                    if (t == 6) {
                                        var H = jm("#Mobi" + a + "Calendar" + y + "Pluginsinput").val(),
                                            u = B.dateSetting ? B.dateSetting.type: 0,
                                            x = u == 1 ? jm("#Mobi" + a + "Calendar" + y + "Plugins_endinput").val() : "";
                                        if (z && (H == "" || (u == 1 && x == ""))) {
                                            Mobi.ing(jm.format(LS.siteFormSubmitCheckIsEmpty, jm.encodeHtml(J)));
                                            c = false;
                                            return false
                                        }
                                        if (u == 1) {
                                            if (jm.trim(H) == "" && jm.trim(x) == "") {
                                                H = ""
                                            } else {
                                                H = H + " 至 " + x
                                            }
                                        }
                                        F.val = H
                                    } else {
                                        if (t == 7) {
                                            var q = jm("#module" + a).find("#siteForm" + a + "fileName" + y);
                                            var G = {};
                                            if (z && q.attr("_tmpFileId") == "") {
                                                Mobi.ing("请选择文件上传");
                                                c = false;
                                                return false
                                            }
                                            if (q.attr("_tmpFileId") == "") {
                                                F.val = ""
                                            } else {
                                                F.val = q.attr("_fileId");
                                                G.tmpFileName = q.attr("_tmpFileName");
                                                G.fileId = F.val;
                                                G.tmpFileId = q.attr("_tmpFileId");
                                                k.push(G)
                                            }
                                        } else {
                                            if (t == 8) {
                                                var I = jm.trim(jm("#M" + a + "siteFormPhoneInput" + y).val());
                                                if (z && I == "") {
                                                    Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(J)));
                                                    c = false;
                                                    return false
                                                }
                                                if (!jm.isNationMobile(I) && I != "") {
                                                    Mobi.ing(LS.mobileNumRegular);
                                                    c = false;
                                                    return false
                                                }
                                                F.val = I
                                            } else {
                                                if (t == 9) {
                                                    var E = jm.trim(jm("#M" + a + "siteFormMailInput" + y).val());
                                                    if (z && E == "") {
                                                        Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(J)));
                                                        c = false;
                                                        return false
                                                    }
                                                    if (!jm.isEmail(E) && E != "") {
                                                        Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, jm.encodeHtml(J)));
                                                        c = false;
                                                        return false
                                                    }
                                                    F.val = E
                                                } else {
                                                    if (t == 10) {
                                                        var s = jm.trim(jm("#M" + a + "siteFormIndentityInput" + y).val());
                                                        if (z && s == "") {
                                                            Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(J)));
                                                            c = false;
                                                            return false
                                                        }
                                                        if (!jm.isCardNo(s) && s != "") {
                                                            Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, jm.encodeHtml(J)));
                                                            c = false;
                                                            return false
                                                        }
                                                        F.val = s
                                                    } else {
                                                        if (t == 11) {
                                                            var r = jm("#M" + a + "siteFormAddressInput" + y).val();
                                                            if (z && r == "") {
                                                                Mobi.ing(jm.format(LS.siteFormSubmitInputIsEmpty, jm.encodeHtml(J)));
                                                                c = false;
                                                                return false
                                                            }
                                                            F.val = r
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            h.push(F)
        });
    if (!c) {
        return false
    }
    if (m && j == "") {
        Mobi.ing(jm.format(tmpFormValidation.attr("msg")));
        c = false;
        return false
    }
    var f = "pid=" + jm("#bookingPanelTriggle").data("pid") + "&submitContentList=" + jm.encodeUrl(jm.toJSON(h)) + "&vCodeId=" + a + "&validateCode=" + j + "&tmpFileList=" + jm.encodeUrl(jm.toJSON(k));
    Mobi.ing(LS.siteFormSubmitIng, -1);
    jm.ajax({
        type: "post",
        url: "ajax/booking_h.jsp?cmd=add",
        data: f,
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(p) {
            p = jm.parseJSON(p);
            if (p.success) {
                Mobi.ing(LS.siteFormSubmitOk, 1);
                jm("#M" + a + "siteFormAddButton .sendIcon").attr("disabled", true);
                var q = d[b.Def_BookingSubmit_JUMP_URL];
                setTimeout(function() {
                        q.lt == 1 ? (function() {
                            Fai.top.location.href = d.jumpToUrl
                        })() : Fai.top.location.reload()
                    },
                    2500)
            } else {
                if (p.hasFW) {
                    Mobi.ing(p.msg);
                    return
                }
                if (p.rt == -4) {
                    Mobi.ing(LS.siteFormSubmitCountLimit)
                } else {
                    if (p.rt == -20) {
                        Mobi.ing(p.msg)
                    } else {
                        if (p.rt == -401) {
                            Mobi.ing(LS.siteFormSubmitValidateCodeErr);
                            jm("#M" + a + "siteFormValidateCode").val("");
                            Mobi.siteFormValidation("", a)
                        } else {
                            if (p.rt == -4) {
                                Mobi.ing(LS.bookingSubmitFullTips)
                            } else {
                                if (p.rt == -7) {
                                    Mobi.ing(LS.siteImgFull)
                                } else {
                                    if (p.rt == -2) {
                                        Mobi.ing(LS.argsError)
                                    } else {
                                        Mobi.ing(LS.systemError)
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    })
};
Mobi.genBookingInputStr = function(t, c, h) {
    var r = c.moduleId,
        j = t.id,
        a = t.type,
        u = t.name,
        l = t.must,
        d = t.headline,
        f = t.input;
    b = (t.placeholder == undefined) ? "": t.placeholder,
        dateSettingList = [],
        isIpad = c.isIpad;
    showType = h.content.st;
    var e = f.split("\n");
    var m = "";
    var s = "";
    var p = (t.openAreaCode == undefined) ? true: t.openAreaCode;
    var b = (t.placeholder == undefined) ? "": t.placeholder;
    if (a == c.Def_ContentList_Type_SINGLE_LINE) {
        s = "<input type='text' class='g_itext' placeholder='" + jm.encodeHtml(b) + "' maxlength='" + c.Def_LIMIT_INPUT_MAXLENTH + "' name='M" + r + "siteFormInput" + j + "' value='" + jm.encodeHtml(typeof(c.memberName) == "undefined" || !t.sys ? "": c.memberName) + "' id='M" + r + "siteFormInput" + j + "' />\n"
    } else {
        if (a == c.Def_ContentList_Type_MULTI_LINE) {
            s = "<textArea class='g_textarea fk_formTextareaStyle' placeholder='" + jm.encodeHtml(b) + "' maxlength='" + c.Def_LIMIT_TEXTAREA_MAXLEN + "' id='M" + r + "siteFormTextArea" + j + "' cols='50' rows='3' /></textArea>\n"
        } else {
            if (a == c.Def_ContentList_Type_RADIO) {
                s += "<div class='fk-siteFormItemCheckWrap'>";
                s += "<div class='fk-siteFormItemCheckList'>";
                for (var o = 0; o < e.length; o++) {
                    s += "<div class='siteFormItemCheckItem " + (isIpad ? "fk-siteFormItemCheckItem-isIpad": "") + "'><input type='radio' id='M" + r + "siteFormRadio" + j + "I" + o + "' name='M" + r + "siteFormRadioR" + j + "' value='" + jm.encodeHtml(e[o]) + "'/><label for='M" + r + "siteFormRadio" + j + "I" + o + "'>" + jm.encodeHtml(e[o]) + "</label></div>\n"
                }
                s += "</div>";
                s += "</div>"
            } else {
                if (a == c.Def_ContentList_Type_MULTIPLECHOICE) {
                    s += "<div class='fk-siteFormItemCheckWrap'>";
                    s += "<div class='fk-siteFormItemCheckList'>";
                    for (var o = 0; o < e.length; o++) {
                        s += "<div class='siteFormItemCheckItem " + (isIpad ? "fk-siteFormItemCheckItem-isIpad": "") + "'><input type='checkbox' id='M" + r + "siteFormCheckbox" + j + "I" + o + "' name='M" + r + "siteFormCheckboxR" + j + "' value='" + jm.encodeHtml(e[o]) + "'/><label for='M" + r + "siteFormCheckbox" + j + "I" + o + "'>" + jm.encodeHtml(e[o]) + "</label></div>\n"
                    }
                    s += "</div>";
                    s += "</div>"
                } else {
                    if (a == c.Def_ContentList_Type_DROPDOWN) {
                        s += "<select class='g_selectTag fk-selectStyle' id='M" + c.moduleId + "siteFormSelect" + j + "' name='M" + r + "siteFormSelect" + j + "'>\n";
                        s += "<option value='none'>" + LS.mallPleaseChoose + "</option>";
                        for (var o = 0; o < e.length; o++) {
                            s += "<option value='" + jm.encodeHtml(e[o]) + "'>" + jm.encodeHtml(e[o]) + "</option>\n"
                        }
                        s += "</select>"
                    } else {
                        if (a == c.Def_ContentList_Type_DESC) {
                            s += "<div class='fk-siteFormTextTip fk-siteFormTextTipMain'>" + jm.encodeHtml(d) + "</div>\n";
                            s += "<div class='fk-siteFormTextTip fk-siteFormTextTipSecond'>" + jm.encodeHtml(f) + "</div>\n"
                        } else {
                            if (a == c.Def_ContentList_Type_DATE) {
                                var q = t.dateSetting;
                                var n = (q.type == undefined ? 0 : q.type) == 1;
                                s += "<div class='" + (n ? "fk-startDateInput": "") + " mobiCalendarPlugins' id='Mobi" + r + "Calendar" + j + "Plugins' val=''></div>\n";
                                if (n) {
                                    s += "<div class='fk-endDateInput mobiCalendarPlugins' id='Mobi" + r + "Calendar" + j + "Plugins_end' val=''></div>\n"
                                }
                            } else {
                                if (a == c.Def_ContentList_Type_FILE_UPLOAD) {
                                    var k = c.isIE;
                                    s += "<div class='fk-uploadComponent'>\n";
                                    s += "<span id='uploadButton" + c.moduleId + j + "'>\n";
                                    if (k) {
                                        s += "<input readonly='readonly' type='button' id='siteForm" + r + "fileUpload" + j + "'  class='uploadify-button' onclick='" + (Fai.top._manageMode ? 'javascript:alert("当前为管理状态，提交无效。");': "") + "' value='选择文件'/>\n"
                                    } else {
                                        s += "<input readonly='readonly' type='button' class='uploadify-button' onclick='" + (Fai.top._manageMode ? 'javascript:alert("当前为管理状态，提交无效。");': "") + "' value='选择文件'/>\n"
                                    }
                                    s += "<div class='uploadify-text' id='siteForm" + r + "fileName" + j + "' _tmpFileId='' >未选择文件</div>\n";
                                    s += "</span>\n";
                                    s += "</div>\n"
                                } else {
                                    if (a == c.Def_ContentList_Type_PHONE) {
                                        s = "<input onkeyup='(this.v=function(){this.value=this.value.replace(/[^0-9-]+/,\"\");}).call(this)' oninput='if(value.length>11)value=value.slice(0,11);' type='number' class='g_itext' maxlength='11' id='M" + r + "siteFormPhoneInput" + j + "' value='" + jm.encodeHtml(typeof(c.memberMobile) == "undefined" || !/^[0-9]*$/.test(c.memberMobile) || !t.sys ? "": c.memberMobile) + "' />"
                                    } else {
                                        if (a == c.Def_ContentList_Type_MAIL) {
                                            s = "<input type='text' class='g_itext' maxlength='20' name='M" + r + "siteFormMailInput" + j + "' id='M" + r + "siteFormMailInput" + j + "' />\n"
                                        } else {
                                            if (a == c.Def_ContentList_Type_IDENTITY) {
                                                s = "<input type='text' class='g_itext' maxlength='18' name='M" + r + "siteFormIndentityInput" + j + "' id='M" + r + "siteFormIndentityInput" + j + "' />\n"
                                            } else {
                                                if (a == c.Def_ContentList_Type_ADDRESS) {
                                                    s = "<input type='text' class='g_itext' placeholder='" + LS.mallPleaseChoose + "' maxlength='20' name='M" + r + "siteFormAddressInput" + j + "' id='M" + r + "siteFormAddressInput" + j + "' />\n"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    if (showType == 1) {
        if (a != 5) {
            m += "<div class='siteFormItem siteFormItemTr f-siteFormItemTr' >\n";
            m += "<div class='siteFormItemShowName' width='100%'>" + jm.encodeHtml(u) + "</div>\n";
            m += "</div>\n";
            m += "<div class='siteFormItem siteFormItemTr' id='siteFormItem" + j + "'>\n";
            m += "<div class='siteFormItemTd' width='100%'>" + s + ((l && a != 7) ? "<font class='bookingSubmitItemMust'>*</font>": "") + "</div>\n";
            m += "</div>\n"
        } else {
            m += "<div class='siteFormItem siteFormItemTr'>\n";
            m += "<div class='siteFormItemTd'>" + s + "</div>\n";
            m += "</div>\n"
        }
    } else {
        m += "<div class='siteFormItem' id='siteFormItem" + j + "'>\n";
        if (a != 5) {
            m += "<div style='width: 23%;float: left; height:100%;'><div class='siteFormItemShowName'><table style='table-layout:fixed;text-align:right; height:100%;' width='100%' cellpadding='0' cellspacing='0'><tr><td style='overflow:hidden; text-overflow:ellipsis; white-space:nowrap; padding-left:0.5rem;' width='100%'>" + jm.encodeHtml(u) + "</td></tr></table></div></div>\n";
            m += "<div style='width: 77%;float: left;'><div class='siteFormItemShowVal'>" + s + (l ? "<font class='bookingSubmitItemMust'>*</font>": "") + "</div></div>\n"
        } else {
            m += "<div style='width: 23%;float: left; height:100%;'><div class='siteFormItemShowName'><table style='table-layout:fixed;text-align:right; height:100%;' width='100%' cellpadding='0' cellspacing='0'><tr><td style='overflow:hidden; text-overflow:ellipsis; white-space:nowrap; padding-left:0.5rem;' width='100%'>" + jm.encodeHtml(d) + "</td></tr></table></div></div>\n";
            m += "<div style='width: 77%;float: left; height:100%; font-size:0.6rem;'><div class='siteFormItemShowVal' style='height:100%;'><table style='height:100%;'><tr><td>" + jm.encodeHtml(f) + "</td></tr></table></div></div>\n"
        }
        m += "</div>\n";
        m += "<div class='siteFormItemLink'></div>\n"
    }
    return m
};
Mobi.bookingSubmitPanleEventInit = function(a) {
    var b = a.moduleId;
    jm.each(a.contentList,
        function(j, h) {
            if (h.hide) {
                return true
            }
            var p = h.id,
                l = h.type;
            if (l == a.Def_ContentList_Type_DATE) {
                var k = h.dateSetting;
                var o = (k.type == undefined ? 0 : k.type) == 1;
                Mobi.initmobiFormTimeBtn({
                    moduleId: b,
                    siteFormItemId: p,
                    minDate: new Date(),
                    yearChangeable: true,
                    monthChangeable: true,
                    swipeable: true,
                    placeholder: LS.mallPleaseChoose,
                    dateSetting: k
                });
                jm("<span class='fk-dateRangeUtil' id='Mobi" + b + "CalendarInput" + p + "'>" + LS.to + "</span>\n").insertAfter("#module" + b + " #siteFormItem" + p + " .fk-dateInputMaskWrap")
            } else {
                if (l == a.Def_ContentList_Type_FILE_UPLOAD) {
                    if (Fai.top._manageMode) {
                        return true
                    }
                    var e = a.isIE;
                    fileSize = (h.size > a.fileSizeLimit) ? a.fileSizeLimit: h.size,
                        fileTypeList = [];
                    if (!h.isAllFile) {
                        var m = (h.dftl || "") + (h.cftl || "");
                        var d = m.split(" ");
                        jm.each(d,
                            function(s, q) {
                                if (q.length > 0) {
                                    var r = "*." + q + ";";
                                    fileTypeList.push(r)
                                }
                            })
                    }
                    if (e) {
                        Mobi.siteFormFileUpload(srcjQuery, size, id, p, b, fileTypeList, srcUpload, "选择文件")
                    } else {
                        if (Fai.top._cid == 11496535) {
                            Mobi.siteFormFileUploadHtml(p, b, fileTypeList, a.isOverLimit, a.updateUrlViewRes, a.mobiVer, fileSize, a.srcjQuery, a.srcUploadjQuery, "www.jihosen.icoc.me", LS.mobiFormSubmitFileUploadReSelect)
                        } else {
                            Mobi.siteFormFileUploadHtml(p, b, fileTypeList, a.isOverLimit, a.updateUrlViewRes, a.mobiVer, fileSize, a.srcjQuery, a.srcUploadjQuery, a.siteMainDomain, LS.mobiFormSubmitFileUploadReSelect)
                        }
                    }
                } else {
                    if (l == a.Def_ContentList_Type_ADDRESS) {
                        var n, f = a.currentLcid;
                        if (f == 2052 || f == 1028) {
                            n = site_cityUtil.getProvince()
                        } else {
                            n = site_cityUtil.getProvinceEn()
                        }
                        var c = new MobileSelectArea();
                        c.init({
                            level: h.openMunicipalCode ? 3 : 2,
                            lcid: f,
                            trigger: "#M" + a.moduleId + "siteFormAddressInput" + p + "",
                            value: jm("#M" + a.moduleId + "siteFormAddressInput" + p + "").data("value"),
                            data: n,
                            eventName: "click",
                            init: 0
                        })
                    }
                }
            }
        });
    jm("#module" + b + " .siteFormSend").bind("click",
        function() {
            Mobi.mobiBookingSubmitAdd(a)
        })
};
Mobi.fixPorductDetailStyle = function(b) {
    var c = jm("#productNewDetailPanel" + b),
        a = c.find(".J_pricePlaceHolder"),
        e = c.find(".mallThemeProductWrap"),
        d = e.css("display") == "none";
    if (a.length > 0 && d) {
        a.addClass("fk-pricePlaceHolder")
    }
};
Mobi.initOnlineServiceWidth = function() {
    var a = jm("body");
    if (a.hasClass("mobiCol20")) {
        if (Fai.top._isMobiMallOpen) {
            jm("#webCustomerServiceBox").css("display", "none");
            return
        } else {
            if (Fai.top._bookingOpen) {
                jm("#webCustomerServiceBox").css("display", "none");
                return
            }
        }
    }
    if (a.hasClass("mobiCol21") || a.hasClass("mobiCol28") || a.hasClass("mobiCol4")) {
        if (Fai.top._newsCommentOpen) {
            jm("#webCustomerServiceBox").css("display", "none");
            return
        }
    }
    if (Fai.top.independentSetFooterBar) {
        jm("#webCustomerServiceBox").css("display", "none")
    }
    if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
        return
    }
    var c = Mobi.getPreviewObject("customerServiceDiv");
    if (!c) {
        return
    }
    var b = c.querySelectorAll(".service").length;
    if (b === 0) {
        jm("#webCustomerServiceBox").css("opacity", 0);
        Fai.top._openOnlineService = false;
        Fai.top._onlineServiceJson.open = false
    } else {
        jm("#webCustomerServiceBox").css("opacity", 1);
        Fai.top._openOnlineService = true;
        Fai.top._onlineServiceJson.open = true
    }
    Mobi.allFixWXPA(1);
    jm("#customerServiceDiv .service").css("width", 100 / b + "%");
    jm("#customerServiceDiv .serviceClass_1").off("click.log").on("click.log",
        function() {
            Mobi.logDog(200171, 2)
        });
    jm("#customerServiceDiv .serviceClass_5").off("click.log").on("click.log",
        function() {
            Mobi.logDog(200171, 1)
        });
    jm("#customerServiceDiv .serviceClass_-1").off("click.log").on("click.log",
        function() {
            Mobi.logDog(200171, 3)
        })
};
Mobi.showMapService = function(c) {
    var a = Fai.top._onlineServiceJson.map,
        b = a.city + a.d_address,
        e = c ? JSON.parse(c) : c;
    if (e) {
        var h = e.c,
            f = e.a;
        if (h && jm.trim(h) != "" && f && jm.trim(f) != "") {
            b = h + f
        }
    }
    if (b == "") {
        b = "附近"
    }
    if (!b) {
        alert("请填写正确的地址");
        if (Fai.top._manageMode) {
            Fai.top.Mobi.getPreviewWindow().Mobi.onlineServiceClickCallBack(a.type, a.typeStr)
        }
        return false
    }
    var d = "https://map.baidu.com/mobile/webapp/search/search/qt=s&wd=" + encodeURIComponent(b) + "&c=348&searchFlag=bigBox&version=5&exptype=dep/vt=map/?fromhash=1";
    jm("#webMapServiceBox").addClass("showMapService");
    jm("#mobiSearchMapFrame").attr("src", d);
    jm("#mobiSearchMapFrame").off("load.map").on("load.map",
        function() {
            Mobi.mobiHideScroll()
        })
};
Mobi.closeMapService = function() {
    Mobi.mobiShowScroll();
    jm("#webMapServiceBox").removeClass("showMapService")
};
Mobi.unloadForATag = function() {
    if (!jm.os.supportsTouch) {
        // jm("#g_body").delegate("#customerServiceDiv a", "click",
        //     function(j) {
        //         var h = j.target || j.srcElement;
        //         var f = this;
        //         var b = Fai.top._onlineServiceJson,
        //             a;
        //         if (!f) {
        //             return
        //         }
        //         var d = parseInt(f.getAttribute("id").substring(11));
        //         if (parseInt(d) === 2 || parseInt(d) === 1) {
        //             if (Fai.top._manageMode) {
        //                 for (var c in b) {
        //                     if (b[c].type == d) {
        //                         a = b[c];
        //                         break
        //                     }
        //                 }
        //                 if (a.baseSetting.jumpCtrl) {
        //                     var k = a.baseSetting.jumpCtrl.jumpType;
        //                     if (k != 1 && k != 2) {
        //                         return
        //                     }
        //                 }
        //             }
        //             if ( !! a && parseInt(d) == 2 && a.number == "") {
        //                 alert("请输入接受信息的电话");
        //                 Fai.top.Mobi.getPreviewWindow().Mobi.onlineServiceClickCallBack(d, a.typeStr)
        //             } else {
        //                 if ( !! a && d == 1 && !!a.phoneInfo && a.phoneInfo[0].number == "") {
        //                     alert("请输入电话号码");
        //                     Fai.top.Mobi.getPreviewWindow().Mobi.onlineServiceClickCallBack(d, a.typeStr)
        //                 } else {
        //                     alert("该功能无法在桌面浏览器中启动")
        //                 }
        //             }
        //             return false
        //         }
        //     })
    }
};
Mobi.triggerServiceNumber = function(a, b) {
    if (jm.os.supportsTouch) {
        if (a == 1) {
            window.location.href = "tel:" + b
        } else {
            if (a == 2) {
                window.location.href = "sms:" + b
            }
        }
    } else {
        alert("该功能无法在桌面浏览器中启动")
    }
};
Mobi.showPhonesBg = function() {
    var a = jm(".J_showMorePhone");
    if (a.length < 1) {
        return
    }
    a.on("click.phone",
        function(b) {
            Mobi.showJumpPhone()
        })
};
Mobi.showJumpPhone = function() {
    var a = Fai.top._onlineServiceJson.phone.phoneInfo;
    if (!a) {
        return
    }
    if (a.length >= 1) {
        Mobi.mobiHideScroll();
        var L = document.body.clientHeight;
        var C = document.body.clientWidth;
        var e = document.getElementById("g_web");
        var A = document.createElement("div");
        var J = document.createElement("div");
        var w = document.createElement("div");
        var d = document.createElement("div");
        var t = document.createElement("div");
        A.id = "phoneDiv";
        J.id = "fullbg";
        w.id = "tablesDiv";
        d.id = "scrollTable";
        A.className = "phoneDiv";
        w.className = "tablesDiv";
        J.className = "phoneFullBg";
        d.className = "scrollTable";
        t.id = "iScrollDiv";
        e.appendChild(A);
        var F = document.getElementById("phoneDiv");
        F.appendChild(J);
        F.appendChild(w);
        w.appendChild(d);
        var z = document.getElementById("fullbg");
        var c = document.getElementById("tablesDiv");
        var s = document.getElementById("scrollTable");
        s.appendChild(t);
        var G = document.getElementById("iScrollDiv");
        z.style.height = L + "px";
        z.style.width = C + "px";
        z.style.position = "fixed";
        for (var H = 0; H < a.length; H++) {
            var M = H + 1;
            var f = decodeURIComponent(a[H].name);
            var O = a[H].number;
            var m = document.createElement("div");
            m.id = "fullTableDiv" + M;
            m.className = "fullTableDiv";
            G.appendChild(m);
            var j = document.getElementById("fullTableDiv");
            m.innerHTML = "<a id='numberHref_" + Fai.top._onlineServiceJson.phone.type + M + "' href='tel:" + O + "'>";
            var y = F.getElementsByClassName("fullTableDiv")[H].getElementsByTagName("a")[0];
            var I = document.createElement("div");
            I.id = "tableDiv";
            I.className = "tableBox tableDiv";
            y.appendChild(I);
            var n = document.getElementById("tableDiv");
            var r = document.createElement("div");
            var B = document.createElement("div");
            var h = document.createElement("div");
            var p = document.createElement("div");
            var u = document.createElement("div");
            var E = document.createElement("div");
            r.className = "phoneName phonebox";
            r.id = "phoneName" + M;
            B.className = "phoneNumber phonebox";
            B.id = "phoneNumber" + M;
            h.className = "phoneOperation phonebox";
            h.id = "phoneOperation" + M;
            p.id = "phoneLine";
            p.className = "phoneLine";
            E.id = "phoneOperImg" + M;
            E.className = "phoneOperImg icon-phoneOperImg";
            I.appendChild(r);
            I.appendChild(B);
            I.appendChild(h);
            G.appendChild(p);
            h.appendChild(E);
            var l = document.getElementById("phoneName" + M);
            var b = document.getElementById("phoneNumber" + M);
            var q = document.getElementById("phoneOperation" + M);
            var K = document.getElementById("phoneOperImg");
            var o = document.createTextNode(f);
            l.appendChild(o);
            b.innerHTML = O;
            if (!jm.os.supportsTouch) {
                y.onclick = function() {
                    alert("该功能无法在桌面浏览器中启动")
                }
            }
        }
        var x = document.createElement("div");
        var D = document.createElement("div");
        x.id = "pCancle";
        x.className = "pCancle";
        D.id = "phoneCancle";
        D.className = "phoneCancle";
        c.appendChild(x);
        x.appendChild(D);
        var k = document.getElementById("phoneCancle");
        k.innerHTML = LS.cancel;
        var N = document.documentElement.clientHeight - k.offsetHeight;
        var v = s.offsetHeight;
        if (v > N) {
            d.style.height = (document.documentElement.clientHeight - k.offsetHeight) + "px"
        }
        if (Mobi.deviceTypeIsMobi()) {
            new iScroll("scrollTable")
        }
        setTimeout("tablesDiv.style.cssText = 'bottom: 0; ';", 10);
        setTimeout(function() {
                z.style.opacity = "0.3"
            },
            10);
        z.onclick = function() {
            var P = document.getElementById("phoneDiv");
            c.style.cssText = "bottom: -100%";
            z.style.opacity = "0";
            Mobi.mobiShowScroll();
            setTimeout(function() {
                    P.parentNode.removeChild(P)
                },
                100)
        };
        k.onclick = function() {
            var P = document.getElementById("phoneDiv");
            c.style.cssText = "bottom: -100%";
            z.style.opacity = "0";
            Mobi.mobiShowScroll();
            setTimeout(function() {
                    P.parentNode.removeChild(P)
                },
                100)
        }
    }
};
Mobi.showQqBg = function() {
    var a = jm(".J_showMoreQq");
    if (a.length < 1) {
        return
    }
    a.on("click.qq",
        function(b) {
            Mobi.showMoreQQ()
        })
};
Mobi.showMoreQQ = function() {
    var b = Fai.top._onlineServiceJson.tcInfo || Fai.top._onlineServiceJson.qq.qqInfo,
        h = 5;
    if (b.length >= 1) {
        Mobi.mobiHideScroll();
        var K = document.body.clientHeight;
        var B = document.body.clientWidth;
        var f = document.getElementById("g_web");
        var z = document.createElement("div");
        var J = document.createElement("div");
        var v = document.createElement("div");
        var d = document.createElement("div");
        z.id = "qqDiv";
        J.id = "fullbg";
        v.id = "tablesDiv";
        d.id = "scrollTable";
        z.className = "qqDiv";
        v.className = "tablesDiv";
        J.className = "qqFullBg";
        d.className = "scrollTable";
        f.appendChild(z);
        var E = document.getElementById("qqDiv");
        E.appendChild(J);
        E.appendChild(v);
        v.appendChild(d);
        var y = document.getElementById("fullbg");
        var c = document.getElementById("tablesDiv");
        var r = document.getElementById("scrollTable");
        y.style.height = K + "px";
        y.style.width = B + "px";
        y.style.position = "fixed";
        for (var H = 0; H < b.length; H++) {
            var L = H + 1;
            var j = decodeURIComponent(b[H].name);
            var N = b[H].number;
            var n = document.createElement("div");
            n.id = "fullTableDiv" + L;
            n.className = "fullTableDiv";
            r.appendChild(n);
            var l = document.getElementById("fullTableDiv");
            n.innerHTML = "<a id='numberHref_" + h + L + "' target='_blank' href='http://wpa.qq.com/msgrd?v=3&uin=" + N + "&site=qq&menu=yes'>";
            var x = document.getElementById("numberHref_" + h + L);
            var I = document.createElement("div");
            I.id = "tableDiv";
            I.className = "tableBox tableDiv";
            x.appendChild(I);
            var o = document.getElementById("tableDiv");
            var e = document.createElement("div");
            var A = document.createElement("div");
            var q = document.createElement("div");
            var a = document.createElement("div");
            var C = document.createElement("div");
            var G = document.createElement("div");
            e.className = "qqName qqbox";
            e.id = "qqName" + L;
            A.className = "qqNumber qqbox";
            A.id = "qqNumber" + L;
            q.className = "qqOperation qqbox";
            q.id = "qqOperation" + L;
            a.id = "qqLine";
            a.className = "qqLine";
            G.id = "qqOperImg" + L;
            G.className = "qqOperImg icon-qqOperImg";
            I.appendChild(e);
            I.appendChild(A);
            I.appendChild(q);
            r.appendChild(a);
            q.appendChild(G);
            var s = document.getElementById("qqName" + L);
            var t = document.getElementById("qqNumber" + L);
            var F = document.getElementById("qqOperation" + L);
            var k = document.getElementById("qqOperImg");
            var p = document.createTextNode(j);
            s.appendChild(p);
            t.innerHTML = N
        }
        var w = document.createElement("div");
        var D = document.createElement("div");
        w.id = "qCancle";
        w.className = "qCancle";
        D.id = "qqCancle";
        D.className = "qqCancle";
        c.appendChild(w);
        w.appendChild(D);
        var m = document.getElementById("qqCancle");
        m.innerHTML = LS.cancel;
        var M = document.documentElement.clientHeight - m.offsetHeight;
        var u = r.offsetHeight;
        if (u > M) {
            d.style.height = (document.documentElement.clientHeight - m.offsetHeight) + "px"
        }
        setTimeout("tablesDiv.style.cssText = 'bottom: 0; ';", 10);
        setTimeout(function() {
                y.style.opacity = "0.3"
            },
            10);
        y.onclick = function() {
            var O = document.getElementById("qqDiv");
            c.style.cssText = "bottom: -100%";
            y.style.opacity = "0";
            Mobi.mobiShowScroll();
            setTimeout(function() {
                    O.parentNode.removeChild(O)
                },
                100)
        };
        m.onclick = function() {
            var O = document.getElementById("qqDiv");
            c.style.cssText = "bottom: -100%";
            y.style.opacity = "0";
            Mobi.mobiShowScroll();
            setTimeout(function() {
                    O.parentNode.removeChild(O)
                },
                100)
        }
    }
};
Mobi.bindServiceBtnEvent = function() {
    var a = jm(".serviceBtn");
    if (a.length < 1) {
        return
    }
    a.off("click.ser").on("click.ser",
        function() {
            Mobi.createMallServicePanel()
        });
    a.on("mouseover",
        function() {
            var b = [{
                text: "编辑客服",
                display: "text",
                className: "edit",
                evalScript: "Mobi.getPreviewWindow().Mobi.setServiceTool();"
            }];
            if (Fai.top._manageMode) {
                Mobi.addModuleLayer(jm(this).attr("id"), b, 4, true)
            }
        });
    a.on("mouseout",
        function() {
            if (Fai.top._manageMode) {
                Mobi.removeModuleLayer(jm(this).attr("id"))
            }
        })
};
Mobi.createMallServicePanel = function() {
    if (Fai.top._mallService == 2) {
        Mobi.mallServiceList()
    } else {
        Mobi.notMallServiceList()
    }
};
Mobi.mallServiceList = function() {
    var c = Fai.top._serviceList;
    var a = [];
    var p;
    $(c).each(function(l, r) {
        if (r.showType == true) {
            a.push(r)
        }
    });
    if (a.length == 1) {
        p = a[0];
        if (p.serviceType == 0) {
            window.open("http://wpa.qq.com/msgrd?v=3&uin=" + p.serviceAccount + "&site=qq&menu=yes")
        } else {
            if (p.serviceType == 1) {
                Mobi.showWeChatService(p.code)
            } else {
                if (p.serviceType == 2) {
                    Mobi.showBaiduBridge()
                } else {
                    if (Mobi.isPC()) {
                        alert("该功能无法在桌面浏览器中启动！");
                        return
                    }
                    window.location.href = "tel:" + p.serviceAccount
                }
            }
        }
        return
    }
    Mobi.mobiHideScroll();
    var n = "<div class='serviceFullBg'></div>",
        j, e, q, d = "",
        o = "",
        b = "",
        h, m, f;
    n += "<div id='J_serviceListPanel' class='serviceListPanel'>";
    for (j = 0, e = a.length; j < e; j++) {
        q = a[j];
        showType = q.showType;
        d = q.classname;
        h = q.serviceType;
        m = q.isFontIcon;
        if (m == "true") {
            d = q.classname;
            b = ""
        } else {
            f = q.filePath;
            d = "";
            b = "background-image:url(" + f + ");"
        }
        o = q.color ? ("color:" + q.color + ";") : "";
        if (showType) {
            if (q.serviceType == 0) {
                n += "<div class='serviceItem qqServiceLine'>";
                n += "<a id='qqServiceItem" + j + "' target='_blank' href='http://wpa.qq.com/msgrd?v=3&uin=" + q.serviceAccount + "&site=qq&menu=yes'>";
                n += "<div class='serviceIcon'><span style='" + b + o + ";' class=' serviceIconText " + d + "'></span></div>";
                n += "<div class='serviceName'><span class='serviceNameText'>" + q.showFont + "</span></div>";
                n += "<div class='serviceNumber'><span class='serviceNumberText'>" + q.serviceAccount + "</span></div>";
                n += "<div class='operationBox'><div class='operationIcon icon-operation'></div></div>";
                n += "</a>";
                n += "</div>"
            } else {
                if (q.serviceType == 1) {
                    n += "<div class='serviceItem weChatServiceLine'>";
                    n += "<a id='weChatServiceItem" + j + "' href='javascript:;' onclick='Mobi.showWeChatService(\"" + q.code + "\")'>";
                    n += "<div class='serviceIcon'><span style='" + b + o + "' class=' serviceIconText " + d + "'></span></div>";
                    n += "<div class='serviceName'><span class='serviceNameText'>" + q.showFont + "</span></div>";
                    n += "<div class='serviceNumber'><span class='serviceNumberText'>点击咨询</span></div>";
                    n += "<div class='operationBox'><div class='operationIcon icon-operation'></div></div>";
                    n += "</a>";
                    n += "</div>"
                } else {
                    if (q.serviceType == 2) {
                        n += "<div class='serviceItem baiduBridgeServiceLine'>";
                        n += "<a id='baiduBridgeServiceItem" + j + "' href='javascript:;' onclick='Mobi.showBaiduBridge()'>";
                        n += "<div class='serviceIcon'><span style='" + b + o + ";' class=' serviceIconText " + d + "'></span></div>";
                        n += "<div class='serviceName'><span class='serviceNameText'>" + q.showFont + "</span></div>";
                        n += "<div class='serviceNumber'><span class='serviceNumberText'>点击咨询</span></div>";
                        n += "<div class='operationBox'><div class='operationIcon icon-operation'></div></div>";
                        n += "</a>";
                        n += "</div>"
                    } else {
                        n += "<div class='serviceItem phoneServiceLine'>";
                        n += "<a id='phoneServiceItem" + j + "' href='tel:" + q.serviceAccount + "'>";
                        n += "<div class='serviceIcon'><span style='" + b + o + "' class=' serviceIconText " + d + "'></span></div>";
                        n += "<div class='serviceName'><span class='serviceNameText'>" + q.showFont + "</span></div>";
                        n += "<div class='serviceNumber'><span class='serviceNumberText'>" + q.serviceAccount + "</span></div>";
                        n += "<div class='operationBox'><div class='operationIcon icon-operation'></div></div>";
                        n += "</a>";
                        n += "</div>"
                    }
                }
            }
        }
    }
    n += "<div id='cancleSer' class='cancleSer'>" + LS.cancel + "</div>";
    n += "</div>";
    jm(n).appendTo(jm("body"));
    jm(".serviceFullBg, .cancleSer").off("click.ser").on("click.ser",
        function() {
            $(window).off("scroll");
            jm(".serviceFullBg").remove();
            jm(".serviceSettingEntrance").remove();
            jm(".serviceListPanel").remove();
            Mobi.mobiShowScroll();
            if (Fai.top._manageMode) {
                Mobi.removeEditLayer($(".serviceListPanel"))
            }
        });
    jm(".serviceListPanel .qqServiceLine").off("click.log").on("click.log",
        function(l) {
            Mobi.logDog(200171, 1)
        });
    jm(".serviceListPanel .baiduBridgeServiceLine").off("click.log").on("click.log",
        function(l) {
            Mobi.logDog(200171, 3)
        });
    jm(".serviceListPanel .phoneServiceLine").off("click.log").on("click.log",
        function(l) {
            Mobi.logDog(200171, 2)
        });
    if (Mobi.isPC()) {
        jm(".phoneServiceLine").off("click.ser").on("click.ser",
            function() {
                alert("该功能无法在桌面浏览器中启动！");
                return
            })
    }
    var k = $(window).scrollTop();
    Mobi.banScroll(k)
};
Mobi.banScroll = function(a) {
    $(window).scroll(function() {
        $(window).scrollTop(a)
    })
};
Mobi.notMallServiceList = function() {
    var p = Fai.top._onlineServiceJson.phone,
        m = Fai.top._onlineServiceJson.qq;
    var o = p && p.phoneInfo && p.phoneInfo.length > 0,
        k = m && m.qqInfo && m.qqInfo.length > 0;
    if (!o && !k && !p.open && !m.open) {
        return
    }
    Mobi.mobiHideScroll();
    var n = "<div class='serviceFullBg'></div>",
        f, c, r, b = "",
        q = "",
        a = "",
        e, j, d;
    n += "<div id='J_serviceListPanel' class='serviceListPanel'>";
    if (o && p.open) {
        b = p.baseSetting.classname;
        e = p.baseSetting.colIconCusType;
        j = p.baseSetting.colIconType;
        if (j != 2) {
            b = p.baseSetting.classname + " icon-phoneServiceIcon"
        } else {
            d = p.baseSetting.iconFilePath;
            a = "background-image:url(" + d + ");"
        }
        q = p.baseSetting.color ? ("background-color:" + p.baseSetting.color + ";") : "";
        for (f = 0, c = p.phoneInfo.length; f < c; f++) {
            r = p.phoneInfo[f];
            n += "<div class='serviceItem phoneServiceLine'>";
            n += "<a id='phoneServiceItem" + f + "' href='tel:" + r.number + "'>";
            n += "<div class='serviceIcon'><span style='" + a + q + "' class='phoneServiceIcon serviceIconText " + b + "'></span></div>";
            n += "<div class='serviceName'><span class='serviceNameText'>" + r.name + "</span></div>";
            n += "<div class='serviceNumber'><span class='serviceNumberText'>" + r.number + "</span></div>";
            n += "<div class='operationBox'><div class='operationIcon icon-operation'></div></div>";
            n += "</a>";
            n += "</div>"
        }
    }
    b = "";
    e = 1;
    j = 0;
    b = "";
    d = "";
    a = "";
    q = "";
    if (k && m.open) {
        b = m.baseSetting.classname;
        e = m.baseSetting.colIconCusType;
        j = m.baseSetting.colIconType;
        if (j != 2) {
            b = m.baseSetting.classname + " icon-qqServiceIcon"
        } else {
            d = m.baseSetting.iconFilePath;
            a = "background-image:url(" + d + ");"
        }
        q = m.baseSetting.color ? ("background-color:" + p.baseSetting.color + ";") : "";
        for (f = 0, c = m.qqInfo.length; f < c; f++) {
            r = m.qqInfo[f];
            n += "<div class='serviceItem qqServiceLine'>";
            n += "<a id='qqServiceItem" + f + "' target='_blank' href='http://wpa.qq.com/msgrd?v=3&uin=" + r.number + "&site=qq&menu=yes'>";
            n += "<div class='serviceIcon'><span style='" + a + q + ";' class='qqServiceIcon serviceIconText " + b + "'></span></div>";
            n += "<div class='serviceName'><span class='serviceNameText'>" + r.name + "</span></div>";
            n += "<div class='serviceNumber'><span class='serviceNumberText'>" + r.number + "</span></div>";
            n += "<div class='operationBox'><div class='operationIcon icon-operation'></div></div>";
            n += "</a>";
            n += "</div>"
        }
    }
    n += "<div id='cancleSer' class='cancleSer'>" + LS.cancel + "</div>";
    n += "</div>";
    jm(n).appendTo(jm("body"));
    jm(".serviceFullBg, .cancleSer").off("click.ser").on("click.ser",
        function() {
            $(window).off("scroll");
            jm(".serviceFullBg").remove();
            jm(".serviceSettingEntrance").remove();
            jm(".serviceListPanel").remove();
            Mobi.mobiShowScroll();
            if (Fai.top._manageMode) {
                Mobi.removeEditLayer($(".serviceListPanel"))
            }
        });
    if (Mobi.isPC()) {
        jm(".phoneServiceLine").off("click.ser").on("click.ser",
            function() {
                alert("该功能无法在桌面浏览器中启动！");
                return
            })
    }
    $(".serviceListPanel").mouseover(function() {
        var l = [{
            text: "编辑客服",
            display: "text",
            className: "edit",
            evalScript: "Mobi.getPreviewWindow().Mobi.setServiceTool();"
        }];
        if (Fai.top._manageMode) {
            Mobi.addModuleLayer($(this).attr("id"), l, -1, true)
        }
    });
    $(".serviceListPanel").mouseout(function() {
        if (Fai.top._manageMode) {
            Mobi.removeModuleLayer($(this).attr("id"))
        }
    });
    var h = $(window).scrollTop();
    Mobi.banScroll(h)
};
Mobi.setServiceTool = function() {
    top.Fai.popupWindowVersionTwo.createPopupWindow({
        title: "设置客服",
        frameSrcUrl: "mobiServiceOnline.jsp",
        width: 750,
        height: 600,
        version: 2,
        closeFunc: a
    });
    Mobi.logDog(200166, 2);
    function a() {
        jm(".serviceFullBg").remove();
        jm(".serviceSettingEntrance").remove();
        jm(".serviceListPanel").remove();
        $(window).off("scroll")
    }
};
Mobi.unLoadForWechat = function() {
    var e = document.querySelector("#customerServiceDiv");
    if (!e) {
        return
    }
    var b = e.querySelectorAll("a"),
        c = false;
    for (var d = 0,
             a = b.length; d < a; d++) {
        if (b[d].href.indexOf("mailto:") !== -1) {
            c = true;
            break
        }
    }
    if (c) {
        e.onclick = function(f) {
            var n = f.target;
            var h = jm(n).parents("a").attr("href");
            var o;
            if (h.indexOf("mailto:") !== -1 && Mobi.getPreviewWindow().Mobi.isWechat()) {
                f.stopPropagation();
                f.preventDefault();
                var m = window,
                    r = document,
                    l = r.querySelector("body"),
                    s = r.querySelector(".fk-unloadForWechatBg"),
                    p = s ? s.querySelector(".fk-unloadForWechat") : null,
                    q = p ? p.querySelector(".f-cross") : null,
                    k = m._htmlFontSize / 40;
                l.ontouchmove = function(t) {
                    t.preventDefault()
                };
                if (s == null) {
                    o = "<div class='fk-unloadForWechatBg'>";
                    o += "  <div class='fk-unloadForWechat'>";
                    o += "      <div class='f-crossWrap'>";
                    o += "          <div class='f-cross'></div>";
                    o += "      </div>";
                    o += "      <div class='f-tipImgWrap'>";
                    o += "          <div class='f-tipImg'></div>";
                    o += "      </div>";
                    o += "      <p>微信暂不支持发送邮件功能</p>";
                    o += "      <p>请到浏览器打开！</p>";
                    o += "  </div>";
                    o += "</div>";
                    jm(o).appendTo(jm("body"));
                    r = document;
                    s = r.querySelector(".fk-unloadForWechatBg");
                    p = s.querySelector(".fk-unloadForWechat");
                    q = p.querySelector(".f-cross");
                    p.querySelector(".f-tipImg").style.transform = "scale(" + k + ", " + k + ") ";
                    q.style.transform = "scale(" + k + ", " + k + ")";
                    p.style.top = (m.screen.availHeight - p.clientWidth) / 2 - 60 + "px";
                    p.style.left = (m.screen.availWidth - p.clientWidth) / 2 + "px";
                    q.onclick = j
                } else {
                    s.style.display = "block";
                    p.style.display = "block";
                    q.onclick = j
                }
                function j() {
                    s.style.display = "none";
                    p.style.display = "none";
                    s = null;
                    p = null;
                    l.ontouchmove = null;
                    l = null;
                    q.onclick = null;
                    q = null
                }
            }
        }
    }
};
Mobi.isOpenBaiduBridge = function() {
    var c = Fai.top.Mobi.getPreviewWindow()._hmt;
    var a = false;
    if (typeof(c) != "undefined") {
        var b = c.id;
        if (typeof(b) != "undefined") {
            a = true
        }
    }
    return a
};
Mobi.showBaiduBridge = function() {
    if (Mobi.isOpenBaiduBridge()) {
        Mobi.showBaiduBridgeV2()
    } else {
        if (Fai.top._manageMode) {
            var a = [];
            if (Fai.top._oem) {
                a.push("<div id='baiduBridgeTips'>开启该功能需先接入百度商桥 <a href='" + Mobi.getOemViewUrl(589) + "' target='_blank'>接入教程</a></div>")
            } else {
                a.push("<div id='baiduBridgeTips'>开启该功能需先接入百度商桥 <a href='http://" + Fai.top._jzProUrl + "/blog/604' target='_blank'>接入教程</a></div>")
            }
            var b = Fai.top.Fai.popupWindow({
                title: "温馨提示",
                divContent: a,
                width: 374,
                height: 88
            });
            var c = function() {
                Fai.top.Fai.closePopupWindow(b)
            };
            Fai.top.Fai.addPopupWindowBtn(b, {
                id: "save",
                text: "知道了",
                extClass: "saveButton",
                click: c
            })
        } else {
            alert("未接入百度商桥")
        }
    }
};
Mobi.showBaiduBridgeV2 = function() {
    jm("ins#newBridge").show();
    jm("ins#newBridge").find("#nbWebImLightContainer").hide();
    jm("ins#newBridge").find("#nb_icon_wrap").hide();
    jm("ins#newBridge").find("#nb_nodeboard").hide();
    jm("ins#newBridge").off("click", "#nb_icon_wrap").on("click", "#nb_icon_wrap",
        function() {
            jm("ins#newBridge").find("#nbWebImLightContainer").show()
        });
    if (jm("ins#newBridge").find("#nbWebImLightContainer").length > 0) {
        jm("ins#newBridge").find("#nb_invite_wrap").remove()
    } else {
        jm("ins#newBridge").find("#nb_invite_wrap").show()
    }
    Fai.top.Mobi.getPreviewWindow().jm("#nb_icon_wrap").click();
    jm("ins#newBridge").off("click", "#nbwlToggle").on("click", "#nbwlToggle",
        function() {
            jm("ins#newBridge").hide()
        });
    jm("ins#newBridge").off("click", "#nb_nodeboard_close").on("click", "#nb_nodeboard_close",
        function() {
            jm("ins#newBridge").hide()
        });
    jm("ins#newBridge").off("click", "#sucess_close").on("click", "#sucess_close",
        function() {
            jm("ins#newBridge").hide()
        })
};
Mobi.showWeChatService = function(c) {
    var b;
    if (Fai.top._manageMode && top.Mobi.checkSaveBar()) {
        return false
    }
    if (Mobi.isWechat()) {
        b = LS.weChatCodeTip
    } else {
        b = LS.scanWeChatCodeTip
    }
    var a = "";
    a += "<div class='weChatCodeBg' style='position:absolute;top:0;width:100%;height:100%;z-index:9998;'>";
    a += "<div class='weChatBg' style='position:absolute;top:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);'></div>";
    a += "</div>";
    a += "<div class='weChatCodePanel' style='top:0;width:100%;z-index: 9999;'>";
    a += "<div class='weChatBackground' style='z-index:9999;background:#fff;border-radius:0.25rem;width:10.9rem;height:11.9rem;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-moz-transform:translate(-50%,-50%);transform:translate(-50%,-50%);'></div>";
    a += "<img class='weChatCode' style='z-index:9999;width:8rem;height:8rem;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-moz-transform:translate(-50%,-50%);transform:translate(-50%,-50%);margin-top:-0.50rem;' src='" + c + "'>";
    a += "<span class='weChatCodeFont' style='z-index:9999;width:8rem;height:8rem;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-moz-transform:translate(-50%,-50%);transform:translate(-50%,-50%);margin-top:7.925rem;font-size:0.65rem;text-align:center;'>" + b + "</span>";
    a += "</div>";
    jm("#g_web").append(a);
    jm("html,body").css("overflow", "hidden");
    jm("html,body").css("height", "100%");
    jm("#g_web").on("touchmove",
        function(d) {
            d.preventDefault()
        });
    jm("#g_web").find(".weChatCodeBg, .weChatCodeFont").click(function() {
        jm("#g_web").find(".weChatCodeBg").hide();
        jm("#g_web").find(".weChatCodePanel").hide();
        jm("html,body").css("overflow", "");
        jm("#g_web").off("touchmove")
    })
};
Mobi.showShare = function() {
    var b = Fai.top.all_oks_LinkUrl;
    var c = Fai.top._onlineServiceJson.oneKeySharing.shareLinkList;
    var a = [];
    b.forEach(function(h, f) {
        if (c.indexOf(h.icon) != -1) {
            a.push(h)
        }
    });
    var d = {
        shareLinkList: JSON.stringify(a),
        fromOks: true
    };
    var e = {
        triggerId: "oneKeySharing",
        pageBg: true,
        pageHtml: Mobi.sharePage(d),
        direction: "bottom",
        callback: function() {
            Mobi.initProductSwipe("shareListShowSwipe2")
        },
        closeWebPage: "#shareListPanelBg2",
    };
    if (Fai.top._oneKeySharingChanged) {
        e.redo = true
    }
    Mobi.showPanel(e)
};
Mobi.initLocater = function() {
    var b = jm("#multiLanguageCtrl ");
    if (!b) {
        return false
    } else {
        var h = jm("#lanSelect .lanContainer").find("div[currentlan]"),
            a = h.length === 1 ? jm(h[0]).text() : jm(h[1]).text(),
            e = h.length === 1 ? jm(h[0]).attr("currentlan") : jm(h[1]).attr("currentlan");
        h.hide();
        jm(b).addClass("Icon" + e);
        jm("#lanSelected").addClass("Icon" + e);
        b.find(".lanTitle").eq(0).text(a);
        jm("#lanSelected").find(".lanTitle").eq(0).text(a);
        jm(".lanItem ").click(function(j) {
            if (jm("#lanSelect").length < 1 || parseInt(jm("#lanSelect").height()) == 0) {
                return
            }
            j.stopPropagation();
            document.location.href = jm(this).attr("value")
        });
        jm(document).unbind("click").bind("click",
            function(k) {
                var j = k.target || k.srcElement;
                if (j.id === "multiLanguageCtrl") {
                    return
                }
                var l = jm(j);
                if (l.closest("#lanSelect").length == 0) {
                    Mobi.closeLanSelect()
                }
                if (! (navigator.userAgent.toLowerCase().indexOf("sogoumobilebrowser") > -1)) {
                    k.stopPropagation()
                }
            });
        jm("#lanSelect .lanContainer").height(0);
        var f = Mobi.getUrlParam(Mobi.getPreviewWindow().location.href, "returnUrl");
        if (!f) {
            f = Mobi.getPreviewWindow().location.pathname + Mobi.getPreviewWindow().location.search
        }
        f = jm.encodeUrl(f);
        var c = jm("#topBarMemberSignup").attr("href");
        jm("#topBarMemberSignup").attr("href", c + f);
        var d = jm("#topBarMemberName").attr("href");
        jm("#topBarMemberName").attr("href", d + f)
    }
};
Mobi.languageCtrl = function() {
    var b = function(d) {
        if (parseInt(jm("#lanSelect").height()) > 0) {
            Mobi.closeLanSelect()
        } else {
            if (Fai.top._manageMode) {
                Mobi.removeAllEditLayer()
            }
            Mobi.openLanSelect()
        }
        d.stopPropagation();
        return false
    };
    var a = Mobi.getTransitionEndEventName(),
        c = "";
    if (Fai.top._manageMode) {
        setTimeout(function() {
                $(Mobi.getPreviewObject("multiLanguageCtrl")).unbind("click").bind("click", b);
                $(Mobi.getPreviewObject("lanSelected")).unbind("click").bind("click", b)
            },
            2000);
        c = Mobi.getPreviewObject("lanSelect")
    } else {
        jm("#multiLanguageCtrl").unbind("click").bind("click", b);
        jm("#lanSelected").unbind("click").bind("click", b);
        c = document.getElementById("lanSelect")
    }
};
Mobi.closeLanSelect = function() {
    if (jm("#lanSelect").length < 1 || parseInt(jm("#lanSelect").height()) == 0) {
        return
    }
    if (jm("#bgm_icon").length > 0 && jm("#bgm_icon").hasClass("bgm_rightUp")) {
        jm("#bgm_icon").css("visibility", "visible")
    }
    jm("#lanSelect").height(0);
    jm("#lanSelect").css("opacity", 0.3);
    jm("#lanSelect .lanContainer").height(0);
    if (Fai.top._manageMode) {
        jm("#lanFixed").remove()
    }
};
Mobi.openLanSelect = function() {
    if (jm("#lanSelect").length < 1 || parseInt(jm("#lanSelect").height()) > 0) {
        return
    }
    if (jm("#bgm_icon").length > 0 && jm("#bgm_icon").hasClass("bgm_rightUp")) {
        jm("#bgm_icon").css("visibility", "hidden")
    }
    jm("#lanSelect .lanContainer").height("");
    var b = parseFloat(jm("#lanSelected").height()) + parseFloat(jm("#lanSelect .lanContainer").height());
    var a = jm(".multiLanguageCtrl ").css("margin-top");
    if (a.indexOf("px") > 0) {
        a = parseFloat(a.substr(0, a.length - 2))
    } else {
        a = parseFloat(a)
    }
    b = b + a;
    jm("#lanSelect").height(b + "px");
    jm("#lanSelect").css("opacity", 1);
    if (Fai.top._manageMode) {
        jm("#webMultilingualArea").append("<div id='lanFixed' class='lanFixed'></div>")
    }
};
Mobi.removeLanSelectFlag = function() {
    jm("#lanSelect").removeClass("lanDisabled")
};
Mobi.addLanSelectFlag = function() {
    jm("#lanSelect").addClass("lanDisabled")
};
Mobi.initFooterLanguageEvent = function() {
    if (Fai.top.templateFrameId < 2000 || Fai.top.templateFrameId >= 3000) {
        return
    }
    var e = jm("#footer"),
        d = e.find(".languageVis"),
        a = e.find(".languageFullBg"),
        c = e.find(".languageListPanel");
    if (e.find(".langItem").length == 1) {
        e.find(".footLanguageItem").hide()
    }
    d.off("click.lang").on("click.lang",
        function() {
            a.show();
            c.addClass("langPanelUp")
        });
    a.off("click.lang").on("click.lang",
        function() {
            jm(this).hide();
            c.removeClass("langPanelUp")
        });
    var b = e.find(".langItem[currentlan='" + Fai.top._lcid + "']").text();
    e.find(".languageVis").eq(0).text(Fai.top._lcid == 2052 ? "中文版": b);
    jm(".langItem").click(function(f) {
        f.stopPropagation();
        document.location.href = jm(this).attr("value")
    })
};
Mobi.initFooterStyle = function(b) {
    var a = jm("#footer");
    var e = b.rt.c,
        f = b.rt.s,
        d = a.find(".technicalSupport"),
        c = d.find("a"),
        h = d.eq(1).find(".footerSep");
    linkFontColor = b.gt.c,
        linkFontSize = b.gt.s;
    if (b.fb.y == 0) {
        Mobi.removeCtrlStyleCssList("fixedAreaBoxStyle", "", [{
            cls: "#footer",
            key: "background"
        }])
    } else {
        if (b.fb.y == 2) {
            refreshFooterBg(b)
        } else {
            Mobi.setCtrlStyleCssList("fixedAreaBoxStyle", "", [{
                cls: "#footer",
                key: "background",
                value: "none"
            }])
        }
    }
    if (b.rt.y == 0) {
        d.css({
            color: "#999",
            fontSize: "0.6rem"
        })
    } else {
        d.css({
            color: e,
            fontSize: f + "px"
        })
    }
    if (b.gt.y == 0) {
        h.css({
            color: "#999",
            fontSize: "0.6rem"
        });
        c.css({
            color: "#999",
            fontSize: "0.6rem"
        })
    } else {
        h.css({
            color: linkFontColor,
            fontSize: linkFontSize + "px"
        });
        c.css({
            color: linkFontColor,
            fontSize: linkFontSize + "px"
        })
    }
};
function refreshFooterBg(a) {
    var c = a.fb.r;
    var b = "";
    b += a.fb.c;
    var e = a.fb.p;
    if (e) {
        if (c != -1) {
            var d = "";
            if (c == 0 || c == 6 || c == 7 || c == 8 || c == 9 || c == 13 || c == 14 || c == 15 || c == 16) {
                d = "no-repeat"
            }
            if (c == 1 || c == 11 || c == 12) {
                d = "repeat-x"
            }
            if (c == 2 || c == 21 || c == 22) {
                d = "repeat-y"
            }
            if (c == 3) {
                d = "repeat"
            }
            if (c == 4 || c == 5) {
                d = "repeat"
            }
            var f = "center";
            if (c == 9 || c == 12) {
                f = "bottom"
            }
            if (c == 6 || c == 21) {
                f = "left"
            }
            if (c == 7 || c == 22) {
                f = "right"
            }
            if (c == 4 || c == 5 || c == 8 || c == 11) {
                f = "top"
            }
            if (c == 13) {
                f = "left top"
            }
            if (c == 14) {
                f = "right top"
            }
            if (c == 15) {
                f = "left bottom"
            }
            if (c == 16) {
                f = "right bottom"
            }
            b += " url(" + e + ") " + d + " " + f
        }
    }
    Mobi.setFooterBg(b, a)
}
Mobi.setFooterBg = function(c, b) {
    var f = b,
        e = "",
        d = false;
    var a = jm("#footer");
    if (f.fb.r == 4) {
        e = "100% 100%";
        d = true
    } else {
        if (f.fb.r == 5) {
            e = "100%";
            d = true
        }
    }
    a.css("background", c);
    if (d) {
        a.css("background-size", e)
    }
};
Mobi.decrease = function(b) {
    var a = parseInt(jm("#productNum").val());
    if (isNaN(a)) {
        a = 1
    }
    if (a > 99999998) {
        a = 99999998
    }
    if (a < 0) {
        a = 0
    }
    if (a + 1 > 1) {
        jm("#g_decrease").removeClass("g_opacity50")
    }
    jm("#productNum").val(a + 1)
};
Mobi.increase = function(b) {
    var a = parseInt(jm("#productNum").val());
    if (isNaN(a)) {
        a = 1
    }
    if (a < 2) {
        a = 2
    }
    if ((a - 1) === 1) {
        jm("#g_decrease").addClass("g_opacity50")
    }
    jm("#productNum").val(a - 1)
};
Mobi.decrease2 = function(b) {
    var a = parseInt(jm("#productMallOptionPanel" + b + " #productNum").val());
    if (isNaN(a)) {
        a = 1
    }
    if (a > 99999998) {
        a = 99999998
    }
    if (a < 0) {
        a = 0
    }
    if (a + 1 > 1) {
        jm("#productMallOptionPanel" + b + " #g_decrease").removeClass("g_opacity50")
    }
    jm("#productMallOptionPanel" + b + " #productNum").val(a + 1)
};
Mobi.increase2 = function(b) {
    var a = parseInt(jm("#productMallOptionPanel" + b + " #productNum").val());
    if (isNaN(a)) {
        a = 1
    }
    if (a < 2) {
        a = 2
    }
    if ((a - 1) === 1) {
        jm("#productMallOptionPanel" + b + " #g_decrease").addClass("g_opacity50")
    }
    jm("#productMallOptionPanel" + b + " #productNum").val(a - 1)
};
Mobi.removeMallTIps = function() {
    jm("#mallBuyTips").remove();
    jm(".productDetailClose").each(function() {
        jm(this).click()
    });
    document.getElementById("webLoading").style.display = "none"
};
Mobi.MallAjaxErrno = {
    ok: 0,
    error: 1,
    manager: 2,
    login: 3,
    idNotExist: 4,
    orderSettle: 5,
    noMall: 6,
    toProductDetail: 7,
    orderNotExist: 8,
    networkError: 9,
    outOfMallAmount: 10,
    mallAmountZero: 11,
    mallOptionStop: 12,
    OutOfAllowAmount: 13,
    notAdded: 14,
    payDomainError: 15,
    couponNotFound: 16,
    couponUnavail: 17,
    couponOverTime: 18,
    authMemberNotAllow: 19
};
Mobi.returnMallErrorMsg = function(a) {
    var b;
    switch (parseInt(a)) {
        case Mobi.MallAjaxErrno.error:
            Mobi.ing(LS.mallAjaxErrno_error);
            break;
        case Mobi.MallAjaxErrno.manager:
            Mobi.showMallTips(LS.mallAjaxErrno_manager);
            break;
        case Mobi.MallAjaxErrno.login:
            goToMallCartUrl = "login.jsp?returnUrl=" + jm.encodeUrl(jm.getUrlRoot(location.href)) + "&errno=11";
            location.href = goToMallCartUrl;
            break;
        case Mobi.MallAjaxErrno.idNotExist:
            Mobi.ing(LS.mallAjaxErrno_idNotExist);
            break;
        case Mobi.MallAjaxErrno.orderSettle:
            Mobi.ing(LS.mallAjaxErrno_orderSettle);
            break;
        case Mobi.MallAjaxErrno.noMall:
            Mobi.ing(LS.mallAjaxErrno_noMall);
            break;
        case Mobi.MallAjaxErrno.orderNotExist:
            Mobi.ing(LS.mallAjaxErrno_orderNotExist);
            break;
        case Mobi.MallAjaxErrno.networkError:
            Mobi.ing(LS.networkError);
            break;
        case Mobi.MallAjaxErrno.outOfMallAmount:
            Mobi.ing(LS.mallAmountOverFlow);
            break;
        case Mobi.MallAjaxErrno.mallAmountZero:
        case - 11 : Mobi.ing(LS.mallAmountZero);
            break;
        case Mobi.MallAjaxErrno.mallOptionStop:
            Mobi.ing(LS.mallOptionStop);
            break;
        case Mobi.MallAjaxErrno.OutOfAllowAmount:
            Mobi.ing(LS.allowAmountOverFlow);
            break;
        case Mobi.MallAjaxErrno.notAdded:
            Mobi.ing(LS.mallProductNotAdded);
            break;
        default:
            Mobi.ing(LS.systemError);
            location.reload()
    }
};
Mobi.initOptionsStr = function(b, a) {
    if (typeof a != "number") {
        a = ""
    }
    Mobi.optionsStr["oldOptionsStr" + a] = b
};
Mobi.optionsStr = {};
Mobi.mallBuying = {};
Mobi.mallBuy = function(u, r, b, A, a, h, d) {
    d = d || {};
    var s = d.isGroupBuy || false;
    var p = d.groupBuyId || 0;
    var q = d.groupBuyDetailId || 0;
    if (typeof(Mobi.mallBuying[u]) == "undefined") {
        Mobi.mallBuying[u] = false
    }
    var o = false;
    jm.each(Mobi.mallBuying,
        function(D, j) {
            if (j) {
                o = true;
                return false
            }
        });
    if (o) {
        return
    }
    Mobi.mallBuying[u] = true;
    jm("#productNum").change();
    var t = "id=" + u + "&fromDetail=true",
        z = [],
        x = jm(".J-op"),
        n = true;
    if (b == 1) {
        x = jm("#productMallOptionPanel" + u + "[moduleId='" + A + "'] .J-op")
    }
    var e = false;
    if ( !! a) {
        t += "&optionList=" + jm.encodeUrl(jm.toJSON(a))
    } else {
        jm(x).each(function() {
            if (e) {
                return
            }
            var G = jm(this),
                D = G.attr("option_name"),
                F = G.attr("data"),
                E = G.attr("type"),
                j = G.attr("option_data");
            if (j) {
                var H = {};
                H.name = F;
                H.value = parseInt(j);
                if (E != null) {
                    H.name = F.replace(/^opIndept/, "");
                    H.type = parseInt(E)
                }
                z.push(H);
                e = false
            } else {
                Mobi.ing(jm.format(LS.mallCartChoiceItemError, jm.encodeHtml(D)));
                e = true;
                n = false;
                return false
            }
        });
        var B = "oldOptionsStr";
        if (b == 1) {
            B += u
        }
        if (Mobi.optionsStr[B] != "null" && Mobi.optionsStr[B]) {
            var l = Mobi.optionsStr[B].split("_"),
                C = [];
            for (var w = 0; w < l.length; w++) {
                for (var v = 0; v < z.length; v++) {
                    if (z[v].name == l[w]) {
                        C.push(z[v])
                    }
                }
            }
            z = C
        }
        if (!n) {
            Mobi.mallBuying[u] = false;
            return false
        }
        if (z.length > 0) {
            t += "&optionList=" + jm.encodeUrl(jm.toJSON(z))
        }
    }
    var c = jm("#productNum");
    if (jm("#productMallOptionPanel" + u + " #productNum").length != 0) {
        c = jm("#productMallOptionPanel" + u + " #productNum")
    }
    var k = c.val(),
        m = 1;
    if (jm.isInteger(k)) {
        m = parseInt(k)
    }
    if (m < 1) {
        m = 1
    } else {
        if (m > 9999999) {
            m = 9999999
        }
    }
    c.val(m);
    if ( !! h) {
        m = h
    }
    t += "&amount=" + m;
    var f = "addCartItem";
    if (r === 1) {
        var y = {
            pid: u,
            amount: m,
            optList: jm.toJSON(a),
            isGroupBuy: s
        };
        if (y.optList == null || y.optList.length == 0 || !y.optList || y.optList == "null") {
            y.optList = jm.toJSON(z)
        }
        f = "addIme";
        t += "&codata=" + jm.toJSON(y)
    }
    jm.ajax({
        type: "post",
        url: "ajax/order_h.jsp?cmd=" + f,
        data: t,
        error: function() {
            Mobi.ing(LS.systemError);
            Mobi.mallBuying[u] = false
        },
        success: function(j) {
            var G = jm.parseJSON(j);
            if (G.success) {
                if (r === 1) {
                    var F = "";
                    if (s) {
                        F += "&isGroupBuy=" + s;
                        F += "&groupBuyId=" + p;
                        F += "&groupBuyDetailId=" + q;
                        Mobi.logDog(200479, 0)
                    }
                    if (window.self != window.top && /(iPhone|iPad|iPod|safari)/i.test(navigator.userAgent.toLowerCase())) {
                        location.href = "mstl.jsp?immeData=" + jm.encodeUrl(jm.toJSON(y)) + F
                    } else {
                        location.href = "mstl.jsp?imme" + F
                    }
                } else {
                    Mobi.showMallTips(LS.mallAddSuc)
                }
                Mobi.refreshMallCartNum();
                Mobi.mallBuying[u] = false
            } else {
                if (G.rt == Mobi.MallAjaxErrno.authMemberNotAllow) {
                    Mobi.ing(G.data + LS.authLevelBuy)
                } else {
                    if (G.rt == Mobi.MallAjaxErrno.login) {
                        var D = {};
                        D.buyType = r;
                        D.productId = u;
                        D.entry = b;
                        D.moduleId = A;
                        D.option = jm.toJSON(z);
                        D.count = m;
                        D.options = d;
                        localStorage.setItem("mallBuyCallBack", jm.toJSON(D));
                        var E = "login.jsp?returnUrl=" + jm.encodeUrl(jm.getUrlRoot(location.href)) + "&errno=11";
                        location.href = E
                    } else {
                        Mobi.returnMallErrorMsg(G.rt)
                    }
                }
                Mobi.mallBuying[u] = false
            }
        }
    })
};
Mobi.initBuyNumber = function(e, c, a, d) {
    jm(".mall_product").eq(0).css("border-top", "1px solid #fff");
    var b = jm(".itemLine" + e);
    if (c == a) {
        b.find(".icon-minisIcon").addClass("g_opacity50")
    }
    if (c == d) {
        b.find(".icon-plusIcon").addClass("g_opacity50")
    }
};
Mobi.ajaxChangeAmount = function(b, a, c) {
    jm.ajax({
        type: "post",
        url: "ajax/order_h.jsp?cmd=setItem&orderId=" + a,
        data: "itemId=" + c + "&amount=" + b,
        error: function() {
            Mobi.ing(LS.mallCartUpdateError)
        },
        success: function(d) {
            var d = jm.parseJSON(d);
            if (d.success) {
                Mobi.setAcSaleList(c, b);
                Mobi.reCtOrderMoney();
                return true
            } else {
                if (d.rt == -3) {
                    Mobi.ing(LS.mallCartUpdateNotFound)
                } else {
                    if (d.rt == -9) {
                        Mobi.ing(LS.mallCartUpdateStatusError)
                    } else {
                        Mobi.ing(LS.mallCartUpdateError)
                    }
                }
                return false
            }
        }
    })
};
Mobi.mallCartAmountChange = function(a, c, j, h, l, b, k) {
    var m = jm(".itemLine" + a);
    var d = m.find(".buyNumber");
    var f = d.val();
    var e = 1;
    if (jm.isInteger(f)) {
        e = parseInt(f)
    }
    if (e < h || e == h) {
        e = h;
        m.find(".icon-minisIcon").addClass("g_opacity50");
        m.find(".icon-plusIcon").removeClass("g_opacity50")
    } else {
        if ((e > l || e == l) && l != 0) {
            e = l;
            Mobi.ing(LS.mallAmountOverFlow, true);
            m.find(".icon-plusIcon").addClass("g_opacity50");
            m.find(".icon-minisIcon").removeClass("g_opacity50")
        } else {
            if (e > b && k) {
                e = b;
                m.find(".icon-plusIcon").addClass("g_opacity50");
                m.find(".icon-minisIcon").removeClass("g_opacity50")
            } else {
                if (e > 9999998) {
                    e = 9999999
                }
            }
        }
    }
    if (isNaN(e) || e <= 0 || e > 9999999) {
        Mobi.ing(LS.mallCartAmountError);
        return
    }
    Mobi.ajaxChangeAmount(e, c, j);
    d.val(e);
    if (e > 1) {
        m.find(".icon-minisIcon").removeAttr("disabled")
    } else {
        m.find(".icon-minisIcon").attr("disabled", "true")
    }
};
Mobi.mallCartAmountPlus = function(a, b, d, k, j, o, c, l) {
    if (jm(a).attr("disabled") != "true") {
        var n = jm(".itemLine" + b);
        var e = n.find(".buyNumber");
        var h = e.val();
        if (jm.isInteger(h)) {
            h = parseInt(h) + 1
        }
        if (h < 2) {
            h = 1
        } else {
            if ((h > o || h == o) && o != 0) {
                h = o;
                n.find(".icon-plusIcon").addClass("g_opacity50 ");
                if (j != o) {
                    n.find(".icon-minisIcon").removeClass("g_opacity50")
                }
            } else {
                if (l && (h > c)) {
                    h = c;
                    Mobi.ing(LS.mallAmountOverFlow, true);
                    n.find(".icon-plusIcon").addClass("g_opacity50 ");
                    if (j != c) {
                        n.find(".icon-minisIcon").removeClass("g_opacity50")
                    }
                } else {
                    if (h > 9999998) {
                        h = 9999999
                    }
                }
            }
        }
        if (h > j) {
            n.find(".icon-minisIcon").removeClass("g_opacity50")
        }
        if (isNaN(h) || h <= 0 || h > 9999999) {
            Mobi.ing(LS.mallCartAmountError);
            return
        }
        Mobi.ajaxChangeAmount(h, d, k);
        e.val(h);
        var m = LS.pay;
        var f = Mobi.countSelectNum();
        if (jm(".J_select").length != 0) {
            jm(".cartSettle").val(m + "(" + f + ")")
        }
        if (h > 1) {
            n.find(".icon-minisIcon").removeAttr("disabled")
        } else {
            n.find(".icon-minisIcon").attr("disabled", "true")
        }
    } else {
        return
    }
};
Mobi.mallCartAmountMinis = function(a, b, c, j, h, l) {
    var m = jm(".itemLine" + b);
    var d = m.find(".buyNumber");
    var f = d.val();
    if (jm.isInteger(f)) {
        f = parseInt(f) - 1
    }
    if (f == 0) {
        return
    } else {
        m.find(".icon-plusIcon").removeClass("g_opacity50");
        if (f < h || f == h) {
            f = h;
            m.find(".icon-minisIcon").addClass("g_opacity50");
            if (h != l) {
                m.find(".icon-plusIcon").removeClass("g_opacity50")
            }
        } else {
            if (f <= 1) {
                f = 1;
                m.find(".icon-minisIcon").addClass("g_opacity50")
            } else {
                if (f > 9999998) {
                    f = 9999999
                }
            }
        }
        if (f < l) {
            m.find(".icon-plusIcon").removeClass("g_opacity50")
        }
        if (isNaN(f) || f <= 0 || f > 9999999) {
            Mobi.ing(LS.mallCartAmountError);
            return
        }
        Mobi.ajaxChangeAmount(f, c, j);
        d.val(f);
        var k = LS.pay;
        var e = Mobi.countSelectNum();
        if (jm(".J_select").length != 0) {
            jm(".cartSettle").val(k + "(" + e + ")")
        }
        if (f > 1) {
            m.find(".icon-minisIcon").removeAttr("disabled")
        } else {
            m.find(".icon-minisIcon").attr("disabled", "true")
        }
    }
};
Mobi.acSaleProShowList = {};
Mobi.initAcSaleList = function(a) {
    Mobi.acSaleProShowList = jm.parseJSON(a)
};
Mobi.removeAcSaleList = function(h) {
    if (isNaN(h)) {
        return
    }
    var a = Mobi.acSaleProShowList;
    if (a.length <= 0) {
        return
    }
    var b = false;
    for (var d = 0; d < a.length && b == false; d++) {
        var f = a[d];
        var e = f.acList;
        if (typeof(e) == "undefined" || e == null) {
            continue
        }
        for (var c = 0; c < e.length; c++) {
            if (e[c].id == h) {
                e.splice(c, 1);
                b = true;
                break
            }
        }
    }
};
Mobi.setAcSaleList = function(k, d) {
    if (isNaN(k)) {
        return
    }
    var a = Mobi.acSaleProShowList;
    if (a.length <= 0) {
        return
    }
    var e = false;
    for (var c = 0; c < a.length && e == false; c++) {
        var h = a[c];
        var f = h.acList;
        if (typeof(f) == "undefined" || f == null) {
            continue
        }
        for (var b = 0; b < f.length; b++) {
            if (f[b].id == k) {
                f[b].amount = d;
                e = true;
                break
            }
        }
    }
};
Mobi.countItsSaveMoney = function() {
    var b = 0;
    var a = [];
    jm(".J_select").each(function(l, c) {
        var j = jm.parseJSON(jm(this).attr("saleInfo"));
        if (j == null || j == "{}" || j == {}) {
            return
        }
        var t = 0;
        if (typeof(j) != "undefined" && j != null && Mobi.checkSaleProVal(j)) {
            var k = j.other.ruleData.d;
            var f = j.id;
            if (j.saleType == 2 && j.other.ruleData.s == "1") {
                var o = jm(this).find(".buyNumber").val() || 1;
                var q = jm(this).find(".mall_product").attr("price") || 0;
                var m = parseFloat(o) * parseFloat(q);
                var p = 0;
                jm.each(k,
                    function(u, n) {
                        if (m >= n.m) {
                            p = n.n
                        }
                    });
                b += p
            } else {
                if (j.saleType == 2 && j.other.ruleData.s == "2") {
                    if (jm.inArray(j.id, a) < 0) {
                        var e = 0;
                        a.push(f);
                        jm(".J_select[promotionid='" + f + "']").each(function(v, y) {
                            var x = jm(this).find(".buyNumber").val() || 1;
                            var u = jm(this).find(".mall_product").attr("price") || 0;
                            var w = parseInt(x) * parseFloat(u);
                            e += w
                        });
                        var s = 0;
                        var h = 0;
                        for (var l = 0; l < k.length; l++) {
                            var r = parseFloat(k[l].m);
                            var d = parseFloat(k[l].n);
                            if (r <= 0) {
                                r = 0;
                                d = 0
                            }
                            if (e >= r) {
                                if (r > s) {
                                    s = r;
                                    h = d
                                }
                            }
                        }
                        b += h
                    }
                }
            }
        }
    });
    return b
};
Mobi.checkSaleProVal = function(a) {
    if (typeof(a.other) != "undefined") {
        if (typeof(a.other.ruleData) != "undefined") {
            if (typeof(a.other.ruleData.s) != "undefined" && typeof(a.other.ruleData.d) != "undefined") {
                if (a.other.ruleData.d != null && a.other.ruleData.d.length > 0) {
                    return true
                }
            }
        }
    }
    return false
};
Mobi.countFoldOfSigle = function(h, b, f) {
    var j = 0;
    var d = 0;
    for (var e = 0; e < h.length; e++) {
        saleDataParam = h[e];
        var c = saleDataParam.m;
        var a = saleDataParam.n;
        if (c <= 0) {
            c = 0;
            a = 0
        }
        if (b >= c) {
            if (c > j) {
                j = c;
                d = a
            }
        }
    }
    if (d > 0 && b >= j && b >= d) {
        f += d
    }
    return f
};
Mobi.reCtOrderMoney = function() {
    var b = jm(".J_select .mall_product");
    var e = 0;
    b.each(function() {
        var k = parseFloat(jm(this).attr("price"), 2);
        var h = parseInt(jm(this).find(".buyNumber").val());
        if (isNaN(h)) {
            h = 0
        }
        var j = (k * h);
        e += j
    });
    var f = Mobi.countItsSaveMoney();
    f = parseFloat(f);
    if (e != 0) {
        e = e - f
    }
    var c = jm("#count");
    var d = c.attr("choiceCurrencyVal");
    var a;
    if (e < 100000000000) {
        a = e.toFixed(2)
    } else {
        if (e < 1000000000000) {
            a = e.toFixed(1)
        } else {
            a = e.toFixed(0)
        }
    }
    c.html(isNaN(a) ? d + "0.00": d + a);
    jm(".saleSaveMoney").html(isNaN(f.toFixed(2)) ? d + "0.00": d + f.toFixed(2))
};
Mobi.mallCartItemDel = function(b, a, c) {
    Mobi.ing(LS.mallCartUpdating);
    jm.ajax({
        type: "post",
        url: "ajax/order_h.jsp?cmd=delItem&orderId=" + a,
        data: "itemIds=[" + c + "]",
        error: function() {
            Mobi.ing(LS.mallCartUpdateError)
        },
        success: function(d) {
            var d = jm.parseJSON(d);
            if (d.success) {
                Mobi.ing(LS.mallCartUpdateOk, 1);
                jm(".itemLine" + b).parent().remove();
                Mobi.removeAcSaleList(c);
                var e = jm(".mall_product");
                if (e.length == 0) {
                    Fai.top.location.reload()
                } else {
                    Mobi.reCtOrderMoney();
                    jm(".mall_product").eq(0).css("border-top", "1px solid #fff")
                }
            } else {
                if (d.rt == -3) {
                    Mobi.ing(LS.mallCartUpdateNotFound)
                } else {
                    if (d.rt == -9) {
                        Mobi.ing(LS.mallCartUpdateStatusError)
                    } else {
                        Mobi.ing(LS.mallCartUpdateError)
                    }
                }
            }
            var h = LS.pay;
            var f = Mobi.countSelectNum();
            jm(".cartSettle").val(h + "(" + f + ")");
            Mobi.reCtOrderMoney()
        }
    })
};
Mobi.selectInMallCart = function(c) {
    var b = LS.pay;
    if (jm("#selectBtn" + c).hasClass("faisco-icons-right")) {
        jm("#selectBtn" + c).removeClass().addClass("faisco-icons-shape11").addClass("g_color").css("font-size", "1rem");
        jm("#selectBtn" + c).parent().parent().removeClass().addClass("J_noSelect");
        if (jm("#selectAllInMallCart").hasClass("faisco-icons-right")) {
            jm("#selectAllInMallCart").removeClass().addClass("faisco-icons-shape11").addClass("g_color").css("font-size", "1rem")
        }
        var a = Mobi.countSelectNum();
        if (a == 0) {
            jm(".cartSettle").val(b)
        } else {
            jm(".cartSettle").val(b + "(" + a + ")")
        }
    } else {
        jm("#selectBtn" + c).removeClass().addClass("faisco-icons-right").addClass("g_color").css("font-size", "0.75rem");
        jm("#selectBtn" + c).parent().parent().removeClass().addClass("J_select");
        if (jm(".J_noSelect").length == 0 && jm(".J_select").length != 0) {
            jm("#selectAllInMallCart").removeClass().addClass("faisco-icons-right").addClass("g_color").css("font-size", "0.75rem")
        }
        var a = Mobi.countSelectNum();
        jm(".cartSettle").val(b + "(" + a + ")")
    }
    Mobi.reCtOrderMoney()
};
Mobi.selectAllInMallCart = function() {
    var b = LS.pay;
    if (jm("#selectAllInMallCart").hasClass("faisco-icons-right")) {
        jm("#selectAllInMallCart").removeClass().addClass("faisco-icons-shape11").addClass("g_color").css("font-size", "1rem");
        jm("div[id^='selectBtn']").each(function() {
            jm(this).removeClass().addClass("faisco-icons-shape11").addClass("g_color").css("font-size", "1rem");
            jm(this).parent().parent().removeClass().addClass("J_noSelect")
        });
        jm(".cartSettle").val(b)
    } else {
        jm("#selectAllInMallCart").removeClass().addClass("faisco-icons-right").addClass("g_color").css("font-size", "0.75rem");
        jm("div[id^='selectBtn']").each(function() {
            jm(this).removeClass().addClass("faisco-icons-right").addClass("g_color").css("font-size", "0.75rem");
            jm(this).parent().parent().removeClass().addClass("J_select")
        });
        var a = Mobi.countSelectNum();
        jm(".cartSettle").val(b + "(" + a + ")")
    }
    Mobi.reCtOrderMoney()
};
Mobi.countSelectNum = function() {
    var a = 0;
    jm(".mallCart .J_select").each(function() {
        a = a + parseInt(jm(this).find(".buyNumber").val())
    });
    return a
};
Mobi.showMallTips = function(c) {
    if (Fai.top._templateFrameId >= 2000) {
        Mobi.removeMallTIps();
        Mobi.ing(LS.addToMallCatSuccess, true)
    } else {
        document.getElementById("webLoading").style.display = "block";
        var b = document.getElementById("webLoading");
        var a = "<div id='mallBuyTips' class='mallTips'><div class='top wekitBox'><div class='topIcon'></div><div class='topText flex1'>" + c + "</div></div><div class='bottom wekitBox'><div class='left flex1' onclick='Mobi.removeMallTIps();'>" + LS.mallContinueShopping + "</div><a href='mcart.jsp' class='right flex1'>" + LS.mallToCartCount + "</a></div></div>";
        b.innerHTML = a
    }
};
Mobi.initModuleMallAddrInfo = function(A, J, P, u, F) {
    var o = LS.mallPleaseChoose,
        H = [],
        O,
        n,
        t,
        f,
        w,
        y,
        I;
    site_cityUtil.initProvinces(u);
    jm(".orderSettle").css("min-height", jm(window).height() + "px");
    var p = Mobi.initWebPage({
        triggerId: "areaBoxInput",
        panelId: "areaBox",
        pageBg: true,
        returnSeltFun: true,
        direction: "bottom",
        closeWebPage: "#areaBoxClose"
    });
    jm("#areaBox").unbind("click").bind("click",
        function(R) {
            var j = R.target.className;
            if (!j) {
                return
            }
            if (jm.inArray("areaBox", j.split(" ")) >= 0) {
                jm("#areaBoxClose").click();
                jm("#areaBox1").hide();
                jm("#areaBox2").hide()
            }
        });
    var h = "";
    jm.each(site_cityUtil.getAreaGroupsPinYin(),
        function(j, R) {
            h += "<div class='pv_group' style='" + (R[0] == "OS" ? "display:none;": "") + "'>";
            h += "<div class='group_head'>" + R[0] + "</div>";
            h += "<div class='group_content'>";
            jm.each(R[1],
                function(T, S) {
                    if (u == 2052 || u == 1028) {
                        h += "<div class='group_item' pid='" + S + "' pname='" + site_cityUtil.getInfo(S).name + "'>" + site_cityUtil.simpleProvinceNameStr(site_cityUtil.getInfo(S).name) + "</div>"
                    } else {
                        h += "<div class='group_item' pid='" + S + "' pname='" + site_cityUtil.getInfoEn(S).name + "'>" + site_cityUtil.simpleProvinceNameStrEn(site_cityUtil.getInfoEn(S).name) + "</div>"
                    }
                });
            h += "</div>";
            h += "</div>"
        });
    jm("#areaBox1 .pv_content").html("").append(h);
    jm("#allArea").change(function() {
        if (jm("#allArea").val() == null || jm("#allArea").val() == "" || jm("#allArea").val() == "os") {
            jm("#areaBoxInput").parent(".edit_line").hide()
        } else {
            jm("#areaBoxInput").parent(".edit_line").show()
        }
        jm("#areaBox1").hide();
        jm("#areaBox2").hide();
        jm("#areaBoxInput").attr("isCn", 0);
        jm("#areaBoxInput").attr("isCus", 0);
        jm("#areaBoxInput").attr("isOs", 0);
        jm("#areaBoxInput").attr("area1", "");
        jm("#areaBoxInput").attr("area2", "");
        jm("#areaBoxInput").attr("area3", "");
        jm("#areaBoxInput").attr("area4", "");
        if (jm("#allArea").val() == "cn") {
            jm("#areaBoxInput").attr("isCn", 1);
            jm("#areaBox1 .pv").click();
            jm("#areaBox1 .city_content").remove();
            jm("#areaBox1 .county_content").remove();
            jm("#areaBox1 .street_content").remove();
            jm("#areaBox1").show();
            jm("#areaBoxInput").val("")
        } else {
            if (jm("#allArea").val() == "os") {
                jm("#areaBoxInput").attr("isOs", 1);
                jm("#areaBoxInput").attr("area1", 990000);
                jm("#areaBoxInput").attr("area2", 990100);
                jm("#areaBoxInput").val(jm("#areaBox1").find(".group_item[pid='990000']").text())
            } else {
                jm("#areaBoxInput").attr("isCus", 1);
                jm("#areaBoxInput").attr("area1", jm("#allArea").val());
                jm("#areaBox2 .sec_content").html("");
                jm("#areaBox2 .thd_content").html("");
                jm("#areaBox2").show();
                jm("#areaBoxInput").val("")
            }
        }
        jm("#mallShipTemplate_allArea").val(jm("#allArea").val());
        jm("#mallShipTemplate_allArea").change();
        if (jm("#allArea").val() == "cn" || jm("#allArea").val() == "os") {
            jm(".J_ssq").show();
            jm(".J_administrativeRegion").hide()
        } else {
            var j = v(jm("#allArea").val());
            jm("#sec_box .sec_content").append(j);
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + jm("#allArea option[value='" + jm("#allArea").val() + "']").text());
            jm(".J_ssq").hide();
            jm(".J_administrativeRegion").show();
            if (j === null || j === undefined || j === "") {
                jm("#areaBoxInput").parents(".edit_line").hide()
            }
        }
    });
    jm("#areaBoxInput").unbind("click").bind("click",
        function() {
            if (jm("#allArea").val() == "cn") {
                p();
                jm("#areaBox1").show();
                jm("#areaBox2").hide();
                jm("#areaBox1 .J_areaHead .pv").click()
            } else {
                if (jm("#allArea").val() == null || jm("#allArea").val() == "os") {} else {
                    p();
                    jm("#areaBox2").show();
                    jm("#areaBox1").hide();
                    jm("#areaBox2 .J_areaHead2 .sec").click()
                }
            }
            jm(this)[0].blur()
        });
    jm("#areaBoxInput").unbind("focus").bind("focus",
        function() {
            if (jm("#allArea").val() == "cn") {
                p();
                jm("#areaBox1").show();
                jm("#areaBox2").hide();
                jm("#areaBox1 .J_areaHead .pv").click()
            } else {
                if (jm("#allArea").val() == null || jm("#allArea").val() == "os") {} else {
                    p();
                    jm("#areaBox2").show();
                    jm("#areaBox1").hide();
                    jm("#areaBox2 .J_areaHead2 .sec").click()
                }
            }
            jm(this)[0].blur()
        });
    jm("#areaBox1 .J_areaHead .pv").click(function() {
        jm("#province_box").show();
        jm("#city_box").hide();
        jm("#county_box").hide();
        jm("#street_box").hide()
    });
    jm("#areaBox1 .J_areaHead .city").click(function() {
        jm("#province_box").hide();
        jm("#city_box").show();
        jm("#county_box").hide();
        jm("#street_box").hide()
    });
    jm("#areaBox1 .J_areaHead .county").click(function() {
        jm("#province_box").hide();
        jm("#city_box").hide();
        jm("#county_box").show();
        jm("#street_box").hide()
    });
    jm("#areaBox1 .J_areaHead .street").click(function() {
        jm("#province_box").hide();
        jm("#city_box").hide();
        jm("#county_box").hide();
        jm("#street_box").show()
    });
    jm("#areaBox2 .J_areaHead2 .sec").click(function() {
        jm("#sec_box").show();
        jm("#thd_box").hide()
    });
    jm("#areaBox2 .J_areaHead2 .thd").click(function() {
        jm("#sec_box").hide();
        jm("#thd_box").show()
    });
    jm("#province_box .group_item").bind("click",
        function() {
            jm("#areaBox1 .city_content").remove();
            jm("#areaBox1 .county_content").remove();
            var j = jm(this).attr("pname");
            var R = jm(this).attr("pid");
            jm("#areaBox1 .J_areaHead .city").click();
            jm("#areaBoxInput").val("");
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + j);
            jm("#areaBoxInput").removeAttr("lastArea");
            jm("#areaBoxInput").removeAttr("lastAreaType");
            jm("#areaBoxInput").attr("area1", R);
            jm("#areaBoxInput").attr("area2", "");
            jm("#areaBoxInput").attr("area3", "");
            jm("#areaBoxInput").attr("area4", "");
            var T = "";
            if (u == 2052 || u == 1028) {
                T = c(site_cityUtil.getCities(R))
            } else {
                T = c(site_cityUtil.getCitiesEn(R))
            }
            var S = jm(T).html();
            if (S === null || S === undefined || S === "") {
                jm("#areaBox1").hide();
                jm("#areaBoxClose").click()
            }
            jm("#city_box").append(T);
            jm("#mallShipTemplate_province_box .group_item[pid='" + R + "']").click()
        });
    jm("#city_box").delegate(".group_item", "click",
        function() {
            jm("#areaBox1 .county_content").remove();
            var j = jm(this).attr("cname");
            var S = jm(this).attr("cid");
            jm("#areaBox1 .J_areaHead .county").click();
            var V = jm("#areaBoxInput").attr("lastArea");
            var R = jm("#areaBoxInput").attr("lastAreaType");
            if (R != null && R != "") {
                jm("#areaBoxInput").val(jm("#areaBoxInput").val().substring(0, jm("#areaBoxInput").val().indexOf("-")))
            }
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + "-" + j);
            jm("#areaBoxInput").attr("lastArea", "-" + j);
            jm("#areaBoxInput").attr("lastAreaType", "city");
            jm("#areaBoxInput").attr("area2", S);
            jm("#areaBoxInput").attr("area3", "");
            jm("#areaBoxInput").attr("area4", "");
            var U = "";
            if (u == 2052 || u == 1028) {
                U = s(site_cityUtil.getCounty(S))
            } else {
                U = s(site_cityUtil.getCountyEn(S))
            }
            var T = jm(U).html();
            if (T === null || T === undefined || T === "") {
                jm("#areaBox1").hide();
                jm("#areaBoxClose").click()
            }
            jm("#county_box").append(U);
            jm("#mallShipTemplate_city_box .group_item[cid='" + S + "']").click()
        });
    jm("#county_box").delegate(".group_item", "click",
        function() {
            jm("#areaBox1 .street_content").remove();
            var R = jm(this).attr("cname");
            var T = jm(this).attr("cid");
            var V = jm("#areaBoxInput").attr("lastArea");
            var S = jm("#areaBoxInput").attr("lastAreaType");
            jm("#areaBox1 .J_areaHead .street").click();
            if (S != null && (S == "street" || S == "county")) {
                jm("#areaBoxInput").val(jm("#areaBoxInput").val().substring(0, jm("#areaBoxInput").val().indexOf("-", jm("#areaBoxInput").val().indexOf("-") + 1)))
            }
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + "-" + R);
            jm("#areaBoxInput").attr("lastArea", "-" + R);
            jm("#areaBoxInput").attr("lastAreaType", "county");
            jm("#areaBoxInput").attr("area3", T);
            jm("#areaBoxInput").attr("area4", "");
            var j = "";
            if (u == 2052 || u == 1028) {
                j = Q(site_cityUtil.getStreet(T))
            } else {
                j = Q(site_cityUtil.getStreetEn(T))
            }
            var U = jm(j).html();
            if (U === null || U === undefined || U === "") {
                jm("#areaBox1").hide();
                jm("#areaBoxClose").click()
            }
            jm("#street_box").append(j);
            jm("#mallShipTemplate_county_box .group_item[cid='" + T + "']").click()
        });
    jm("#street_box").delegate(".group_item", "click",
        function() {
            var j = jm(this).attr("cname");
            var S = jm(this).attr("cid");
            var T = jm("#areaBoxInput").attr("lastArea");
            var R = jm("#areaBoxInput").attr("lastAreaType");
            if (R != null && R == "street") {
                jm("#areaBoxInput").val(jm("#areaBoxInput").val().replace(T, ""))
            }
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + "-" + j);
            jm("#areaBoxInput").attr("lastArea", "-" + j);
            jm("#areaBoxInput").attr("lastAreaType", "street");
            jm("#areaBoxInput").attr("area4", S);
            jm("#areaBox1").hide();
            jm("#areaBoxClose").click();
            jm("#mallShipTemplate_street_box .group_item[cid='" + S + "']").click()
        });
    jm("#sec_box").delegate(".group_item", "click",
        function() {
            jm("#areaBox2 .thd_content").html("");
            var j = jm(this).attr("cname");
            var S = jm(this).attr("cid");
            jm("#areaBox2 .J_areaHead2 .thd").click();
            var U = jm("#areaBoxInput").attr("lastArea");
            var R = jm("#areaBoxInput").attr("lastAreaType");
            if (R != null && R != "" && jm("#areaBoxInput").val().indexOf("-") != -1) {
                jm("#areaBoxInput").val(jm("#areaBoxInput").val().substring(0, jm("#areaBoxInput").val().indexOf("-")))
            }
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + "-" + j);
            jm("#areaBoxInput").attr("lastArea", "-" + j);
            jm("#areaBoxInput").attr("lastAreaType", "sec");
            jm("#areaBoxInput").attr("area2", S);
            jm("#areaBoxInput").attr("area3", "");
            var T = v(S);
            if (T === null || T === undefined || T === "") {
                jm("#areaBox2").hide();
                jm("#areaBoxClose").click()
            }
            jm("#thd_box .thd_content").append(T);
            jm("#mallShipTemplate_sec_box .group_item[cid='" + S + "']").click()
        });
    jm("#thd_box").delegate(".group_item", "click",
        function() {
            var j = jm(this).attr("cname");
            var S = jm(this).attr("cid");
            var T = jm("#areaBoxInput").attr("lastArea");
            var R = jm("#areaBoxInput").attr("lastAreaType");
            if (R != null && R == "thd") {
                jm("#areaBoxInput").val(jm("#areaBoxInput").val().replace(T, ""))
            }
            jm("#areaBoxInput").val(jm("#areaBoxInput").val() + "-" + j);
            jm("#areaBoxInput").attr("lastArea", "-" + j);
            jm("#areaBoxInput").attr("lastAreaType", "thd");
            jm("#areaBoxInput").attr("area3", S);
            jm("#areaBox2").hide();
            jm("#areaBoxClose").click();
            jm("#mallShipTemplate_thd_box .group_item[cid='" + S + "']").click()
        });
    jm("#addrInfo_street").change(function(j) {
        jm("#edit_addrDetal").val(jm("#addrInfo_street").val())
    });
    for (var L = 0; L < J.length; L++) {
        var d = J[L];
        if (d.isDefault == 1) {
            for (var K = 0; K < P.length; K++) {
                var N = P[K]["fieldKey"];
                var G = d[N] || "";
                jm(".orderSettle").find(".propItemValue").each(function() {
                    if (jm(this).attr("_field") == N) {
                        var S = jm(this).attr("proptype");
                        var T = jm(this).attr("id") || "";
                        if (S == 9) {
                            if (G != undefined) {
                                var R = G || {};
                                jm(this).val(R.s);
                                if (R.e != undefined) {
                                    var j = T.replace("input", "") + "_endinput";
                                    jm("#" + j).val(R.e)
                                }
                            }
                        } else {
                            jm(this).val(G)
                        }
                    }
                    if ("mobile" == N) {
                        if ("mobileCt" in d) {
                            if (d.mobileCt != null && d.mobileCt != "") {
                                jm("#mobileCt").val(d.mobileCt)
                            }
                        }
                    }
                })
            }
            if (jm("#mallShipTemplate_province").length == 1 && d.addr_info != null) {
                var q = d.addr_info["isCus"];
                if (!q) {
                    var a = "";
                    var m = "";
                    var M = "";
                    var x = "";
                    if (u == 2052 || u == 1028) {
                        a = site_cityUtil.getInfo(d.addr_info.streetCode).name;
                        m = site_cityUtil.getInfo(d.addr_info.countyCode).name;
                        M = site_cityUtil.getInfo(d.addr_info.cityCode).name;
                        x = site_cityUtil.getInfo(d.addr_info.provinceCode).name
                    } else {
                        a = site_cityUtil.getInfoEn(d.addr_info.streetCode).name;
                        m = site_cityUtil.getInfoEn(d.addr_info.countyCode).name;
                        M = site_cityUtil.getInfoEn(d.addr_info.cityCode).name;
                        x = site_cityUtil.getInfoEn(d.addr_info.provinceCode).name
                    }
                    if (d.addr_info.provinceCode == 990000) {
                        jm("#mallShipTemplate_areaBoxInput").attr("isOs", 1);
                        jm("#mallShipTemplate_allArea").val("os");
                        jm("#mallShipTemplate_allArea").change()
                    } else {
                        jm("#mallShipTemplate_areaBoxInput").attr("isCn", 1);
                        jm("#mallShipTemplate_allArea").val("cn");
                        jm("#mallShipTemplate_allArea").change()
                    }
                    jm("#mallShipTemplate_areaBoxInput").attr("area1", d.addr_info.provinceCode);
                    jm("#mallShipTemplate_areaBoxInput").attr("area2", d.addr_info.cityCode);
                    jm("#mallShipTemplate_areaBoxInput").attr("area3", d.addr_info.countyCode);
                    jm("#mallShipTemplate_areaBoxInput").attr("area4", d.addr_info.streetCode);
                    jm("#mallShipTemplate_areaBox1 .group_item[pid='" + d.addr_info.provinceCode + "']").click();
                    jm("#mallShipTemplate_areaBox1 .group_item[cid='" + d.addr_info.cityCode + "']").click();
                    jm("#mallShipTemplate_areaBox1 .group_item[cid='" + d.addr_info.countyCode + "']").click();
                    jm("#mallShipTemplate_areaBox1 .group_item[cid='" + d.addr_info.streetCode + "']").click()
                } else {
                    jm("#mallShipTemplate_allArea").val(d.addr_info.provinceCode);
                    jm("#mallShipTemplate_allArea").change();
                    jm("#mallShipTemplate_areaBox2 .group_item[cid='" + d.addr_info.cityCode + "']").click();
                    jm("#mallShipTemplate_areaBox2 .group_item[cid='" + d.addr_info.countyCode + "']").click()
                }
                jm("#edit_addrDetal").val(d.addr_info["streetAddr"])
            }
        }
    }
    if (A <= 0) {
        jm("#allArea").val("");
        jm("#allArea").change();
        jm(".orderSettle").find(".propItemValue").each(function() {
            jm(this).val("")
        })
    }
    jm("#addrInfo").delegate(".addrInfo .info_name", "click",
        function() {
            var W = jm(this).parent().attr("_item");
            var S = J[W];
            for (var T = 0; T < P.length; T++) {
                var j = P[T].fieldKey;
                if (j == "name") {
                    jm("#info_name").text(S.name)
                }
                if (j == "mobile") {
                    jm("#info_phone").text(S.mobile)
                }
                if (j == "addr") {
                    var U = jm("#info_addr").attr("ismalltheme");
                    jm("#info_addr").text(S.addr)
                }
            }
            jm("#assignItemline").attr("_index", W);
            if (S.isDefault == 1) {
                jm(".mallTheme_defaultAddr").show()
            } else {
                jm(".mallTheme_defaultAddr").hide()
            }
            if (jm("#mallShipTemplate_province").length == 1 && S.addr_info != null) {
                var Y = S.addr_info["isCus"];
                if (!Y) {
                    var R = "";
                    var aa = "";
                    var X = "";
                    var V = "";
                    if (u == 2052 || u == 1028) {
                        R = site_cityUtil.getInfo(S.addr_info.streetCode).name;
                        aa = site_cityUtil.getInfo(S.addr_info.countyCode).name;
                        X = site_cityUtil.getInfo(S.addr_info.cityCode).name;
                        V = site_cityUtil.getInfo(S.addr_info.provinceCode).name
                    } else {
                        R = site_cityUtil.getInfoEn(S.addr_info.streetCode).name;
                        aa = site_cityUtil.getInfoEn(S.addr_info.countyCode).name;
                        X = site_cityUtil.getInfoEn(S.addr_info.cityCode).name;
                        V = site_cityUtil.getInfoEn(S.addr_info.provinceCode).name
                    }
                    if (S.addr_info.provinceCode == 990000) {
                        jm("#mallShipTemplate_areaBoxInput").attr("isOs", 1);
                        jm("#mallShipTemplate_allArea").val("os");
                        jm("#mallShipTemplate_allArea").change()
                    } else {
                        jm("#mallShipTemplate_areaBoxInput").attr("isCn", 1);
                        jm("#mallShipTemplate_allArea").val("cn");
                        jm("#mallShipTemplate_allArea").change()
                    }
                    jm("#mallShipTemplate_areaBoxInput").attr("area1", S.addr_info.provinceCode);
                    jm("#mallShipTemplate_areaBoxInput").attr("area2", S.addr_info.cityCode);
                    jm("#mallShipTemplate_areaBoxInput").attr("area3", S.addr_info.countyCode);
                    jm("#mallShipTemplate_areaBoxInput").attr("area4", S.addr_info.streetCode);
                    jm("#mallShipTemplate_areaBox1 .group_item[pid='" + S.addr_info.provinceCode + "']").click();
                    jm("#mallShipTemplate_areaBox1 .group_item[cid='" + S.addr_info.cityCode + "']").click();
                    jm("#mallShipTemplate_areaBox1 .group_item[cid='" + S.addr_info.countyCode + "']").click();
                    jm("#mallShipTemplate_areaBox1 .group_item[cid='" + S.addr_info.streetCode + "']").click()
                } else {
                    jm("#mallShipTemplate_allArea").val(S.addr_info.provinceCode);
                    jm("#mallShipTemplate_allArea").change();
                    jm("#mallShipTemplate_areaBox2 .group_item[cid='" + S.addr_info.cityCode + "']").click();
                    jm("#mallShipTemplate_areaBox2 .group_item[cid='" + S.addr_info.countyCode + "']").click()
                }
                jm("#edit_addrDetal").val(S.addr_info["streetAddr"])
            }
            if (jm("#mallShipTemplate_province").length == 1 && S.addr_info == null) {
                jm("#mallShipTemplate_allArea").val("");
                jm("#mallShipTemplate_allArea").trigger("change");
                jm("#edit_addrDetal").val("")
            }
            for (var T = 0; T < P.length; T++) {
                var j = P[T]["fieldKey"];
                var Z = S[j];
                jm(".orderSettle").find(".propItemValue").each(function() {
                    if (jm(this).attr("_field") == j) {
                        if (jm(this).attr("proptype") == 9) {
                            var ac = jm(this).attr("id");
                            var ad = jm("#" + ac);
                            if (ad.length > 0) {
                                if (Z.s != undefined) {
                                    ad.val(Z.s);
                                    var ab = ac.replace("input", "") + "_endinput";
                                    var ae = jm(".orderSettle").find("#" + ab);
                                    if (ae.length > 0) {
                                        if (Z.e != undefined) {
                                            ae.val(Z.e)
                                        } else {
                                            ae.val("")
                                        }
                                    }
                                } else {
                                    ad.val("")
                                }
                            }
                        } else {
                            jm(this).val(Z)
                        }
                    }
                    if ("mobile" == j) {
                        if ("mobileCt" in S) {
                            if (S.mobileCt != null && S.mobileCt != "") {
                                jm("#mobileCt").val(S.mobileCt)
                            }
                        }
                    }
                })
            }
        });
    var D = J,
        C = "",
        z = "",
        l = true;
    length = D.length,
        isAddAddrInfoClick = false;
    var k = {};
    jm("#addrInfoList .orderAddAddrInfo").click(function() {
        isAddAddrInfoClick = true;
        jm("#editAddrInfo").find(".propItemValue").each(function() {
            var S = jm(this).attr("proptype");
            if (S == 9) {
                var R = jm(this).attr("id");
                if (R != undefined && R != "") {
                    var j = R.replace("input", "") + "_endinput";
                    jm("#" + R).val("");
                    jm("#" + j).val("")
                }
            }
            jm(this).val("")
        });
        jm("#allArea").val("");
        jm("#allArea").change();
        jm("#areaBoxInput").attr("isCn", 0);
        jm("#areaBoxInput").attr("isCus", 0);
        jm("#areaBoxInput").attr("isOs", 0);
        jm("#areaBoxInput").attr("area1", "");
        jm("#areaBoxInput").attr("area2", "");
        jm("#areaBoxInput").attr("area3", "");
        jm("#areaBoxInput").attr("area4", "");
        jm("#areaBoxInput").removeAttr("lastArea");
        jm("#areaBoxInput").removeAttr("lastAreaType");
        jm("#addrInfo_street").val();
        C = "addAddr"
    });
    jm("#addrInfo").delegate(".edit", "click",
        function() {
            jm("#addrInfoList .orderAddAddrInfo").click();
            isAddAddrInfoClick = false;
            if (jm(this).attr("class") == "edit") {
                z = jm(this).attr("_index")
            } else {
                z = jm(this).parent().attr("_item")
            }
            C = "editAddr";
            var j = D[z];
            jm("#editAddrInfo").find(".propItemValue").each(function() {
                var ab = jm(this).attr("_field");
                var ac = jm(this).attr("proptype");
                var ad = jm(this).attr("id") || "";
                if (ac == 9) {
                    var Z = j[ab];
                    if (Z == "" || Z == undefined) {
                        Z = {}
                    }
                    var aa = Z;
                    jm(this).val(aa.s);
                    if (aa.e != undefined) {
                        var Y = ad.replace("input", "") + "_endinput";
                        jm("#" + Y).val(aa.e)
                    }
                } else {
                    jm(this).val(j[ab])
                }
            });
            var X = j.addr_info;
            if (X != null) {
                var T = X.isCus;
                if (!T) {
                    var W = "";
                    var U = "";
                    var S = "";
                    var R = "";
                    if (u == 2052 || u == 1028) {
                        W = site_cityUtil.getInfo(X.streetCode).name;
                        U = site_cityUtil.getInfo(X.countyCode).name;
                        S = site_cityUtil.getInfo(X.cityCode).name;
                        R = site_cityUtil.getInfo(X.provinceCode).name
                    } else {
                        W = site_cityUtil.getInfoEn(X.streetCode).name;
                        U = site_cityUtil.getInfoEn(X.countyCode).name;
                        S = site_cityUtil.getInfoEn(X.cityCode).name;
                        R = site_cityUtil.getInfoEn(X.provinceCode).name
                    }
                    if (X.provinceCode == 990000) {
                        jm("#areaBoxInput").attr("isOs", 1);
                        jm("#allArea").val("os");
                        jm("#allArea").change()
                    } else {
                        jm("#areaBoxInput").attr("isCn", 1);
                        jm("#allArea").val("cn");
                        jm("#allArea").change()
                    }
                    jm("#areaBoxInput").attr("area1", X.provinceCode);
                    jm("#areaBoxInput").attr("area2", X.cityCode);
                    jm("#areaBoxInput").attr("area3", X.countyCode);
                    jm("#areaBoxInput").attr("area4", X.streetCode);
                    jm("#areaBox1 .group_item[pid='" + X.provinceCode + "']").click();
                    jm("#areaBox1 .group_item[cid='" + X.cityCode + "']").click();
                    jm("#areaBox1 .group_item[cid='" + X.countyCode + "']").click();
                    jm("#areaBox1 .group_item[cid='" + X.streetCode + "']").click()
                } else {
                    jm("#allArea").val(X.provinceCode);
                    jm("#allArea").change();
                    jm("#areaBox2 .group_item[cid='" + X.cityCode + "']").click();
                    jm("#areaBox2 .group_item[cid='" + X.countyCode + "']").click()
                }
                jm("#addrInfo_street").val(X.streetAddr)
            } else {
                jm("#addrInfo_street").val(j.addr)
            }
            var V = j.isDefault
        });
    jm("#addrInfo").delegate(".selectedDiv label", "click",
        function() {
            C = "setDefault";
            var S = 0;
            if (D.length == 1) {
                return
            }
            z = jm(this).parents(".selectedArea").parent().attr("_item");
            var j = {};
            j.isDefault = 1;
            k.opera = C;
            k._item = z;
            k.addrInfo = j;
            J[z]["isDefault"] = j.isDefault;
            var R = this;
            jm.ajax({
                type: "post",
                url: "ajax/member_h.jsp?cmd=set&id=" + A,
                data: "info=" + jm.encodeUrl(jm.toJSON(k)),
                error: function() {
                    Mobi.ing(LS.memberProfileError)
                },
                success: function(U) {
                    var V = jm.parseJSON(U);
                    if (V.success) {
                        jm(".addrInfo").each(function() {
                            jm(this).find(".text").text(LS.mallSetDefault);
                            jm(this).find(".cutOut").css("display", "block");
                            D[jm(this).attr("_item")]["isDefault"] = 0
                        });
                        jm(R).find(".text").text(LS.mallDefault);
                        jm(R).parents(".addrInfo").find(".cutOut").css("display", "none");
                        var T = jm(R).parents(".addrInfo");
                        D[jm(T).attr("_item")]["isDefault"] = 1
                    } else {
                        Mobi.ing(V.msg)
                    }
                }
            })
        });
    jm("#g_body").append(jm("<div id='temBox' class='g_color'></div>"));
    var e = jm("#temBox");
    var b = e.css("color");
    jm("head").append("<style>.checkbox-comp:checked +.text:before{background-color:" + b + ";}</style>");
    jm("#g_body").children("#temBox").remove();
    jm("#editCusInfo").delegate(".info_name", "click",
        function() {
            jm("#editCusInfo").removeClass("webPagePanelShow")
        });
    jm("#addrInfo").delegate(".cutOut", "click",
        function() {
            var S = jm(this);
            z = S.parents(".selectedArea").parent().attr("_item");
            k.opera = "delAddr";
            k._item = z;
            var j = function(T, U) {
                jm.ajax({
                    type: "post",
                    url: "ajax/member_h.jsp?cmd=set&id=" + T,
                    data: "info=" + jm.encodeUrl(jm.toJSON(k)),
                    error: function() {
                        Mobi.ing(LS.systemError)
                    },
                    success: function(V) {
                        var X = jm.parseJSON(V);
                        if (X.success) {
                            jm("#mobiPrompt").remove();
                            jm("#mobiPrompt_Bg").remove();
                            var W = 0;
                            jm("#addrInfoList").find(".addrInfo").each(function() {
                                if (jm(this).attr("_item") == U) {
                                    jm(this).remove()
                                } else {
                                    jm(this).attr("_item", W);
                                    W++
                                }
                            });
                            length--;
                            D.splice(U, 1)
                        } else {
                            Mobi.ing(X.msg)
                        }
                    }
                })
            };
            var R = {
                textClass: "confirm",
                content: "确定要删除该收货人信息吗？",
                callback: function() {
                    j(A, z)
                }
            };
            Mobi.prompt(R)
        });
    jm("#noAddrListInfo").click(function() {
        z = jm("#assignItemline").attr("_index");
        C = "editAddr";
        l = false
    });
    var r = false;
    jm(".orderSaveAddrInfo").click(function() {
        if (r) {
            return
        }
        r = true;
        var af = true;
        if (D.length >= 6 && C == "addAddr") {
            Mobi.ing(LS.mallAddrInfoAmountLimit, true);
            af = false;
            jm("#editAddrInfo .g_close").click()
        }
        var ah = 0;
        if (D.length == 0) {
            ah = 1
        }
        if (C == "editAddr") {
            if (D[z].isDefault == 1) {
                ah = 1
            }
        }
        var V = jm(this);
        var W = {};
        var ai = {};
        var j = {};
        var ag = "";
        var R = "";
        var ac = "";
        var Y = false;
        var aj = {};
        jm(".editPanel").find(".propItemValue").each(function() {
            ag = jm(this).attr("_field");
            R = jm(this).val();
            ac = jm(this).attr("_prop");
            id = jm(this).attr("id");
            propType = jm(this).attr("proptype");
            Y = jm(this).attr("_required") == "1" ? true: false;
            if (Y && (R == null || R == "")) {
                Mobi.ing(jm.format(LS.memberSignupUserAddItemCorrect, ac));
                this.focus();
                af = false
            }
            if (propType == 8 || propType == 10) {
                if (R.length > 0) {
                    if (!jm.isNationMobile(R)) {
                        msg = LS.mobileNumRegular;
                        Mobi.ing(msg);
                        this.focus();
                        af = false
                    }
                }
            }
            if (propType == 3 || propType == 12) {
                if (R.length > 0) {
                    if (!jm.isEmail(R)) {
                        msg = LS.mallStlSubmitInput2 + jm(this).attr("_prop");
                        Mobi.ing(msg);
                        this.focus();
                        af = false
                    }
                }
            }
            if (propType == 9) {
                var ao = {};
                if (R.length > 0) {
                    var am = {};
                    am.s = R;
                    var ak = id.replace("input", "") + "_endinput";
                    var an = jm(this).parents(".edit_line").find("#" + ak);
                    if (an.length > 0) {
                        var al = an.val();
                        if (al == "") {
                            msg = LS.mallStlSubmitInput2 + jm(this).attr("_prop");
                            Mobi.ing(msg);
                            af = false
                        } else {
                            am.e = al
                        }
                    }
                    ao = am
                }
                R = ao
            }
            ai[ag] = R;
            aj[ag] = R
        });
        var U = jm("#allArea");
        var Z = !(U.val() == "os" || U.val() == "cn");
        var ad = jm("#areaBoxInput").attr("area4");
        var ae = jm("#areaBoxInput").attr("area3");
        var S = jm("#areaBoxInput").attr("area2");
        var X = jm("#areaBoxInput").attr("area1");
        var T = jm("#addrInfo_street");
        Y = V.parent().find("#addrInfo_street").attr("_required") == "1" ? true: false;
        if (Y) {
            if (U.val() == null || U.val() == "") {
                Mobi.ing("请选择地区", 1);
                r = false;
                return
            }
            if ((X == null || X == "") && !Z) {
                Mobi.ing(LS.mallStlSubmitAddrErr, 1);
                r = false;
                return
            }
            if ((S == null || S == "") && !Z) {
                Mobi.ing(LS.mallStlSubmitAddrErr, 1);
                r = false;
                return
            }
        }
        if (isNaN(ad)) {
            ad = -1
        }
        if (isNaN(ae)) {
            ae = -1
        }
        if (isNaN(S)) {
            S = -1
        }
        W.isCus = Z;
        W.provinceCode = X;
        W.cityCode = S;
        W.countyCode = ae;
        W.streetCode = ad;
        W.streetAddr = T.val();
        ai.addr_info = W;
        var aa = "";
        if (U.length == 1) {
            var ab = jm("#areaBoxInput");
            if (Fai.top._lcid == 2052 || Fai.top.lcid == 1028) {
                aa = ab.val().replace(/-/g, "") + jm("#addrInfo_street").val();
                if (W.provinceCode == 990000) {
                    aa = aa.replace(jm("div[pid='990000']").text() + jm("div[pid='990000']").text(), jm("div[pid='990000']").text())
                }
            } else {
                aa = ab.val().replace(/-/g, " ") + " " + jm("#addrInfo_street").val();
                if (W.provinceCode == 990000) {
                    aa = aa.replace(jm("div[pid='990000']").text() + " " + jm("div[pid='990000']").text(), jm("div[pid='990000']").text())
                }
            }
        }
        ai.addr = aa;
        ai.isDefault = ah;
        k.opera = C;
        k._item = z;
        k.addrInfo = ai;
        if (af) {
            jm.ajax({
                type: "post",
                url: "ajax/member_h.jsp?cmd=set&id=" + A,
                data: "info=" + jm.encodeUrl(jm.toJSON(k)),
                error: function() {
                    Mobi.ing(LS.memberProfileError)
                },
                complete: function() {
                    r = false
                },
                success: function(aw) {
                    var ap = jm.parseJSON(aw);
                    if (ap.success) {
                        var al = ai.name || "";
                        var ar = ai.mobile || "";
                        var aq = ai.addr || "";
                        if (al == "" || ar == "" || aq == "") {
                            jm("#editAddrInfo").find(".propItemValue").each(function() {
                                var az = jm(this).attr("_field");
                                if (az != null && az != "addrDetail") {
                                    var aA = jm(this).attr("proptype");
                                    var aB = jm(this).attr("id") || "";
                                    var ax = ai[az];
                                    if (aA != 2 && aA != 4 && aA != 7 && aA != 8) {
                                        if (aA == 9) {
                                            var ay = ax;
                                            if (ay.s != undefined) {
                                                ax = ay.s;
                                                if (ay.e != undefined) {
                                                    ax += LS.to + ay.e
                                                }
                                            } else {
                                                ax = ""
                                            }
                                        }
                                        if (al == undefined || al == "") {
                                            al = ax
                                        } else {
                                            if (ar == undefined || ar == "") {
                                                ar = ax
                                            } else {
                                                if (aq == undefined || aq == "") {
                                                    aq = ax
                                                }
                                            }
                                        }
                                    }
                                }
                            })
                        }
                        if (C == "editAddr") {
                            if (jm("#assignItemline").attr("_index") == z) {
                                var au = ai;
                                jm("#info_name").text(au.name);
                                jm("#info_phone").text(au.phone);
                                jm("#assignItemline").attr("_index", z);
                                if (au.addr == null) {
                                    jm("#info_addr").text("")
                                } else {
                                    jm("#info_addr").text(au.addr)
                                }
                            }
                            var am;
                            if (ah) {
                                jm("#addrInfoList").find(".addrInfo").each(function() {
                                    if (jm(this).find(".cutOut").attr("display") == "block") {
                                        D[jm(this).attr("_item")]["isDefault"] = 0
                                    }
                                    if (jm(this).attr("_item") == z) {
                                        jm(this).find(".name").text(al);
                                        jm(this).find(".phone").text(ar);
                                        jm(this).find("#addr").text(aq);
                                        am = jm(this)
                                    }
                                })
                            } else {
                                jm("#addrInfoList").find(".addrInfo").each(function() {
                                    if (jm(this).attr("_item") == z) {
                                        jm(this).find(".name").text(al);
                                        jm(this).find(".phone").text(ar);
                                        jm(this).find("#addr").text(aq);
                                        am = jm(this)
                                    }
                                })
                            }
                            D.splice(z, 1, ai);
                            if (l) {
                                am.click();
                                jm("#editAddrInfo .g_close").click()
                            } else {
                                jm("#editCusInfo .g_close").click();
                                for (noShowFieldKey in aj) {
                                    if (aj[noShowFieldKey] != undefined) {
                                        var ak = jm("#info_" + noShowFieldKey).attr("proptype");
                                        if (ak == 9) {
                                            var av = aj[noShowFieldKey] || {};
                                            var ao = "";
                                            if (av.s != undefined) {
                                                ao = av.s;
                                                if (av.e != undefined) {
                                                    ao += " " + LS.to + " " + av.e
                                                }
                                            }
                                            jm("#info_" + noShowFieldKey).text(ao)
                                        } else {
                                            jm("#info_" + noShowFieldKey).text(aj[noShowFieldKey])
                                        }
                                    }
                                }
                            }
                        } else {
                            if (C == "addAddr") {
                                if (ah) {
                                    jm("#addrInfoList").find(".addrInfo").each(function() {
                                        if (jm(this).find("input").attr("checked") != "checked") {
                                            D[jm(this).attr("_item")]["isDefault"] = 0
                                        }
                                    })
                                }
                                var at = D.length;
                                var an = [];
                                an.push("<div class='addrInfo' _item=" + at + ">");
                                an.push("<div class='" + (ah ? "": "middle") + " info_name' style='width:100%;'>");
                                an.push("<div class='nameAndPhone'><span class='name'>" + al + "</span><span class='phone'>" + ar + "</span></div><div class='address'><span id='addr'>" + aq + "</span></div>");
                                an.push("</div>");
                                an.push("<div class='selectedArea'>");
                                an.push("<div class='left'>");
                                an.push("<div class='selectedDiv'><label for='input" + at + "'><input type='radio' class='checkbox-comp' id='input" + at + "' name='defaultLogo'><span class='text'>设为默认</span></label></div>");
                                an.push("</div>");
                                an.push("<div class='right'>");
                                an.push("<div class='edit' _index=" + at + "><span>编辑</span></div><div class='cutOut'><span>删除</span></div>");
                                an.push("</div>");
                                an.push("</div>");
                                an.push("</div>");
                                jm("#addrInfo").append(an.join(""));
                                D.push(ai);
                                jm("#editAddrInfo .g_close").click();
                                jm(".addrInfo").each(function() {
                                    if (jm(this).attr("_item") == (J.length - 1)) {
                                        jm(this).click()
                                    }
                                })
                            }
                        }
                        jm(".addrInfo[_item='" + z + "'] .info_name").click()
                    } else {
                        Mobi.ing(ap.msg);
                        r = false
                    }
                }
            })
        }
    });
    function c(R) {
        var j = "";
        j += "<div class='city_content'>";
        jm.each(R,
            function(S, T) {
                if (u == 2052 || u == 1028) {
                    j += "<div class='group_item' cid='" + T.id + "' cname='" + site_cityUtil.getInfo(T.id).name + "'>" + site_cityUtil.simpleCityNameStr(site_cityUtil.getInfo(T.id).name) + "</div>"
                } else {
                    j += "<div class='group_item' cid='" + T.id + "' cname='" + site_cityUtil.getInfoEn(T.id).name + "'>" + site_cityUtil.simpleCityNameStrEn(site_cityUtil.getInfoEn(T.id).name) + "</div>"
                }
            });
        j += "</div>";
        return j
    }
    function s(R) {
        var j = "";
        j += "<div class='county_content'>";
        jm.each(R,
            function(S, T) {
                if (u == 2052 || u == 1028) {
                    j += "<div class='group_item' cid='" + T.id + "' cname='" + site_cityUtil.getInfo(T.id).name + "'>" + site_cityUtil.getInfo(T.id).name + "</div>"
                } else {
                    j += "<div class='group_item' cid='" + T.id + "' cname='" + site_cityUtil.getInfoEn(T.id).name + "'>" + site_cityUtil.getInfoEn(T.id).name + "</div>"
                }
            });
        j += "</div>";
        return j
    }
    function Q(R) {
        var j = "";
        j += "<div class='street_content'>";
        jm.each(R,
            function(S, T) {
                if (u == 2052 || u == 1028) {
                    j += "<div class='group_item' cid='" + T.id + "' cname='" + site_cityUtil.getInfo(T.id).name + "'>" + site_cityUtil.getInfo(T.id).name + "</div>"
                } else {
                    j += "<div class='group_item' cid='" + T.id + "' cname='" + site_cityUtil.getInfoEn(T.id).name + "'>" + site_cityUtil.getInfoEn(T.id).name + "</div>"
                }
            });
        j += "</div>";
        return j
    }
    function E(R) {
        var j = "";
        var S = false;
        jm.each(F,
            function(T, U) {
                if (S) {
                    return
                }
                if (U.id == R) {
                    j = U.name;
                    S = true
                }
            });
        return j
    }
    function B(R) {
        var j = [];
        jm.each(F,
            function(S, T) {
                if (T.parentId == R) {
                    j.push(T)
                }
            });
        return j
    }
    function v(j) {
        if (isNaN(j)) {
            return ""
        }
        var S = parseInt(j);
        var R = "";
        jm.each(B(S),
            function(T, U) {
                R += "<div class='group_item' cid='" + U.id + "' cname='" + U.name + "'>" + U.name + "</div>"
            });
        return R
    }
};
Mobi.initModuleMallShipTemplate = function(A, b, C, n, t, p, c) {
    var j = C.vType || 1,
        v = C.sco || 0,
        f = C.openItemList;
    var s = LS.mallPleaseChoose,
        z = [],
        l,
        B,
        q,
        x,
        D,
        o,
        y;
    var h = true;
    site_cityUtil.initProvinces(t);
    var e = jm("#shipValue").attr("shiptype");
    jm(".modifyShipDetails .faisco-icons-shape11").each(function(F, G) {
        if (jm(this).parent().find(".J_shipPrice").attr("shiptype") == e) {
            jm(this).removeAttr("style").attr("style", "margin-right:0.15rem;height:2.5rem;line-height:2.5rem;float:right;").removeAttr("class").attr("class", "faisco-icons-right g_color J_selectShip")
        }
    });
    var E = Mobi.initWebPage({
        triggerId: "mallShipTemplate_areaBoxInput",
        panelId: "mallShipTemplate_areaBox",
        pageBg: true,
        returnSeltFun: true,
        direction: "bottom",
        closeWebPage: "#mallShipTemplate_areaBoxClose"
    });
    jm("#mallShipTemplate_areaBox").unbind("click").bind("click",
        function(G) {
            var F = G.target.className;
            if (!F) {
                return
            }
            if (jm.inArray("areaBox", F.split(" ")) >= 0) {
                jm("#mallShipTemplate_areaBoxClose").click();
                jm("#mallShipTemplate_areaBox1").hide();
                jm("#mallShipTemplate_areaBox2").hide()
            }
        });
    var m = "";
    jm.each(site_cityUtil.getAreaGroupsPinYin(),
        function(F, G) {
            m += "<div class='pv_group' style='" + (G[0] == "OS" ? "display:none;": "") + "'>";
            m += "<div class='group_head'>" + G[0] + "</div>";
            m += "<div class='group_content'>";
            jm.each(G[1],
                function(I, H) {
                    if (t == 2052 || t == 1028) {
                        m += "<div class='group_item' pid='" + H + "' pname='" + site_cityUtil.getInfo(H).name + "'>" + site_cityUtil.simpleProvinceNameStr(site_cityUtil.getInfo(H).name) + "</div>"
                    } else {
                        m += "<div class='group_item' pid='" + H + "' pname='" + site_cityUtil.getInfoEn(H).name + "'>" + site_cityUtil.simpleProvinceNameStrEn(site_cityUtil.getInfoEn(H).name) + "</div>"
                    }
                });
            m += "</div>";
            m += "</div>"
        });
    jm("#mallShipTemplate_areaBox1 .pv_content").html("").append(m);
    jm("#mallShipTemplate_allArea").change(function() {
        if (jm("#mallShipTemplate_allArea").val() == null || jm("#mallShipTemplate_allArea").val() == "" || jm("#mallShipTemplate_allArea").val() == "os") {
            jm("#mallShipTemplate_areaBoxInput").parent(".edit_line").hide();
            jm("#mallShipTemplate_areaBox1").hide();
            jm("#mallShipTemplate_areaBox2").hide()
        } else {
            jm("#mallShipTemplate_areaBoxInput").parent(".edit_line").show()
        }
        if (jm("#mallShipTemplate_allArea").val() == null || jm("#mallShipTemplate_allArea").val() == "") {
            return
        }
        jm("#mallShipTemplate_areaBoxInput").attr("isCn", 0);
        jm("#mallShipTemplate_areaBoxInput").attr("isCus", 0);
        jm("#mallShipTemplate_areaBoxInput").attr("isOs", 0);
        jm("#mallShipTemplate_areaBoxInput").attr("area1", "");
        jm("#mallShipTemplate_areaBoxInput").attr("area2", "");
        jm("#mallShipTemplate_areaBoxInput").attr("area3", "");
        jm("#mallShipTemplate_areaBoxInput").attr("area4", "");
        if (jm("#mallShipTemplate_allArea").val() == "cn") {
            jm("#mallShipTemplate_areaBoxInput").attr("isCn", 1);
            jm("#mallShipTemplate_areaBox1 .pv").click();
            jm("#mallShipTemplate_areaBox1 .city_content").remove();
            jm("#mallShipTemplate_areaBox1 .county_content").remove();
            jm("#mallShipTemplate_areaBox1 .street_content").remove();
            jm("#mallShipTemplate_areaBoxInput").val("")
        } else {
            if (jm("#mallShipTemplate_allArea").val() == "os") {
                jm("#mallShipTemplate_areaBoxInput").attr("isOs", 1);
                jm("#mallShipTemplate_areaBoxInput").attr("area1", 990000);
                jm("#mallShipTemplate_areaBoxInput").attr("area2", 990100);
                jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBox1").find(".group_item[pid='990000']").text());
                Mobi.mallStlCalcTotal()
            } else {
                jm("#mallShipTemplate_areaBoxInput").attr("isCus", 1);
                jm("#mallShipTemplate_areaBoxInput").attr("area1", jm("#mallShipTemplate_allArea").val());
                jm("#mallShipTemplate_areaBox2 .sec_content").html("");
                jm("#mallShipTemplate_areaBox2 .thd_content").html("");
                jm("#mallShipTemplate_areaBoxInput").val("")
            }
        }
        if (jm("#mallShipTemplate_allArea").val() == "cn" || jm("#mallShipTemplate_allArea").val() == "os") {
            jm(".J_ssq").show();
            jm(".J_administrativeRegion").hide()
        } else {
            var F = a(jm("#mallShipTemplate_allArea").val());
            jm("#mallShipTemplate_sec_box .sec_content").append(F);
            jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val() + jm("#mallShipTemplate_allArea option[value='" + jm("#mallShipTemplate_allArea").val() + "']").text());
            jm(".J_ssq").hide();
            jm(".J_administrativeRegion").show();
            var G = jm("#mallShipTemplate_allArea").val();
            h = false;
            if (A === 0 && c) {
                Mobi.mallStlCalcTotal();
                return
            }
            jm.each(f,
                function(J, L) {
                    if (v) {
                        var K = false,
                            I = C.scrl || [];
                        jm.each(I,
                            function(N, M) {
                                if (M.st === L.type) {
                                    var O = false;
                                    if (h) {
                                        O = jm.inArray(parseInt(G), M.arl) > -1
                                    } else {
                                        O = jm.inArray(parseInt(G), M.carl) > -1
                                    }
                                    if (O) {
                                        if (M.fc === 1) {
                                            if (j === 1) {
                                                if (A >= M.d1) {
                                                    K = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= M.d1) {
                                                    K = true;
                                                    return false
                                                }
                                            }
                                        }
                                        if (M.fc === 2) {
                                            if (b >= M.d2) {
                                                K = true;
                                                return false
                                            }
                                        }
                                        if (M.fc === 3) {
                                            if (j === 1) {
                                                if (A >= M.d1 && b >= M.d2) {
                                                    K = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= M.d1 && b >= M.d2) {
                                                    K = true;
                                                    return false
                                                }
                                            }
                                        }
                                        if (M.fc === 4) {
                                            if (j === 1) {
                                                if (A >= M.d1 || b >= M.d2) {
                                                    K = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= M.d1 || b >= M.d2) {
                                                    K = true;
                                                    return false
                                                }
                                            }
                                        }
                                    }
                                }
                            });
                        if (K) {
                            var H = {};
                            H.type = L.type;
                            H.defaultPrice = 0;
                            Mobi.changeShipTplPrice(H);
                            return
                        } else {
                            Mobi.changeShipTplPrice(L)
                        }
                    }
                    jm.each(L.regionList,
                        function(T, W) {
                            var N = false;
                            if (h) {
                                N = jm.inArray(parseInt(G), W.areaList) < 0
                            } else {
                                N = jm.inArray(parseInt(G), W.cusAreaList) < 0
                            }
                            if (N) {
                                Mobi.changeShipTplPrice(L);
                                return true
                            }
                            var S = 0,
                                O = W.price,
                                U = W.rha == null ? 1 : W.rha,
                                V = W.ria == null ? 1 : W.ria,
                                Q = W.rip || 0;
                            var R = A;
                            if (U > 0) {
                                S = O;
                                R -= U
                            }
                            if (V > 0 && R > 0) {
                                var M = (R / V).toFixed(1);
                                M = Math.ceil(M);
                                S += Q * M
                            }
                            var P = {};
                            P.type = L.type;
                            P.defaultPrice = S;
                            Mobi.changeShipTplPrice(P);
                            return false
                        })
                });
            Mobi.mallStlCalcTotal()
        }
    });
    jm("#mallShipTemplate_areaBoxInput").unbind("click").bind("click",
        function() {
            if (jm("#mallShipTemplate_allArea").val() == "cn") {
                E();
                jm("#mallShipTemplate_areaBox1").toggle();
                jm("#mallShipTemplate_areaBox2").hide();
                jm("#mallShipTemplate_areaBox1 .J_areaHead .pv").click()
            } else {
                if (jm("#mallShipTemplate_allArea").val() == null || jm("#mallShipTemplate_allArea").val() == "os") {} else {
                    E();
                    jm("#mallShipTemplate_areaBox2").toggle();
                    jm("#mallShipTemplate_areaBox1").hide();
                    jm("#mallShipTemplate_areaBox2 .J_areaHead2 .sec").click()
                }
            }
        });
    jm("#mallShipTemplate_areaBox1 .J_areaHead .pv").click(function() {
        jm("#mallShipTemplate_province_box").show();
        jm("#mallShipTemplate_city_box").hide();
        jm("#mallShipTemplate_county_box").hide();
        jm("#mallShipTemplate_street_box").hide()
    });
    jm("#mallShipTemplate_areaBox1 .J_areaHead .city").click(function() {
        jm("#mallShipTemplate_province_box").hide();
        jm("#mallShipTemplate_city_box").show();
        jm("#mallShipTemplate_county_box").hide();
        jm("#mallShipTemplate_street_box").hide()
    });
    jm("#mallShipTemplate_areaBox1 .J_areaHead .county").click(function() {
        jm("#mallShipTemplate_province_box").hide();
        jm("#mallShipTemplate_city_box").hide();
        jm("#mallShipTemplate_county_box").show();
        jm("#mallShipTemplate_street_box").hide()
    });
    jm("#mallShipTemplate_areaBox1 .J_areaHead .street").click(function() {
        jm("#mallShipTemplate_province_box").hide();
        jm("#mallShipTemplate_city_box").hide();
        jm("#mallShipTemplate_county_box").hide();
        jm("#mallShipTemplate_street_box").show()
    });
    jm("#mallShipTemplate_areaBox2 .J_areaHead2 .sec").click(function() {
        jm("#mallShipTemplate_sec_box").show();
        jm("#mallShipTemplate_thd_box").hide()
    });
    jm("#mallShipTemplate_areaBox2 .J_areaHead2 .thd").click(function() {
        jm("#mallShipTemplate_sec_box").hide();
        jm("#mallShipTemplate_thd_box").show()
    });
    jm("#mallShipTemplate_province_box .group_item").bind("click",
        function() {
            jm("#mallShipTemplate_areaBox1 .city_content").remove();
            jm("#mallShipTemplate_areaBox1 .county_content").remove();
            var F = jm(this).attr("pname");
            var G = jm(this).attr("pid");
            jm("#mallShipTemplate_areaBox1 .J_areaHead .city").click();
            jm("#mallShipTemplate_areaBoxInput").val("");
            jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val() + F);
            jm("#mallShipTemplate_areaBoxInput").removeAttr("lastArea");
            jm("#mallShipTemplate_areaBoxInput").removeAttr("lastAreaType");
            jm("#mallShipTemplate_areaBoxInput").attr("area1", G);
            jm("#mallShipTemplate_areaBoxInput").attr("area2", "");
            jm("#mallShipTemplate_areaBoxInput").attr("area3", "");
            jm("#mallShipTemplate_areaBoxInput").attr("area4", "");
            var H = "";
            if (t == 2052 || t == 1028) {
                H = r(site_cityUtil.getCities(G))
            } else {
                H = r(site_cityUtil.getCitiesEn(G))
            }
            jm("#mallShipTemplate_city_box").append(H);
            jm.each(f,
                function(I, J) {
                    Mobi.changeShipTplPrice(J)
                });
            Mobi.mallStlCalcTotal()
        });
    jm("#mallShipTemplate_city_box").delegate(".group_item", "click",
        function() {
            Mobi.mallStlCalcTotal();
            if (jm("#mallShipTemplate_allArea").val() == "" || jm("#mallShipTemplate_allArea").val() == "cn" || jm("#mallShipTemplate_allArea").val() == "os") {
                h = true
            } else {
                h = false
            }
            jm("#mallShipTemplate_areaBox1 .county_content").remove();
            var F = jm(this).attr("cname");
            var H = jm(this).attr("cid");
            jm("#mallShipTemplate_areaBox1 .J_areaHead .county").click();
            var J = jm("#mallShipTemplate_areaBoxInput").attr("lastArea");
            var G = jm("#mallShipTemplate_areaBoxInput").attr("lastAreaType");
            if (G != null && G != "") {
                jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val().substring(0, jm("#mallShipTemplate_areaBoxInput").val().indexOf("-")))
            }
            jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val() + "-" + F);
            jm("#mallShipTemplate_areaBoxInput").attr("lastArea", "-" + F);
            jm("#mallShipTemplate_areaBoxInput").attr("lastAreaType", "city");
            jm("#mallShipTemplate_areaBoxInput").attr("area2", H);
            jm("#mallShipTemplate_areaBoxInput").attr("area3", "");
            jm("#mallShipTemplate_areaBoxInput").attr("area4", "");
            var I = "";
            if (t == 2052 || t == 1028) {
                I = k(site_cityUtil.getCounty(H))
            } else {
                I = k(site_cityUtil.getCountyEn(H))
            }
            jm("#mallShipTemplate_county_box").append(I);
            if (A === 0 && c) {
                Mobi.mallStlCalcTotal();
                return
            }
            jm.each(f,
                function(M, O) {
                    if (v) {
                        var N = false,
                            L = C.scrl || [];
                        jm.each(L,
                            function(Q, P) {
                                if (P.st === O.type) {
                                    var R = false;
                                    if (h) {
                                        R = jm.inArray(parseInt(H), P.arl) > -1
                                    } else {
                                        R = jm.inArray(parseInt(H), P.carl) > -1
                                    }
                                    if (R) {
                                        if (P.fc === 1) {
                                            if (j === 1) {
                                                if (A >= P.d1) {
                                                    N = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= P.d1) {
                                                    N = true;
                                                    return false
                                                }
                                            }
                                        }
                                        if (P.fc === 2) {
                                            if (b >= P.d2) {
                                                N = true;
                                                return false
                                            }
                                        }
                                        if (P.fc === 3) {
                                            if (j === 1) {
                                                if (A >= P.d1 && b >= P.d2) {
                                                    N = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= P.d1 && b >= P.d2) {
                                                    N = true;
                                                    return false
                                                }
                                            }
                                        }
                                        if (P.fc === 4) {
                                            if (j === 1) {
                                                if (A >= P.d1 || b >= P.d2) {
                                                    N = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= P.d1 || b >= P.d2) {
                                                    N = true;
                                                    return false
                                                }
                                            }
                                        }
                                    }
                                }
                            });
                        if (N) {
                            var K = {};
                            K.type = O.type;
                            K.defaultPrice = 0;
                            Mobi.changeShipTplPrice(K);
                            return
                        } else {
                            Mobi.changeShipTplPrice(O)
                        }
                    }
                    jm.each(O.regionList,
                        function(W, Z) {
                            var Q = false;
                            if (h) {
                                Q = jm.inArray(parseInt(H), Z.areaList) < 0
                            } else {
                                Q = jm.inArray(parseInt(H), Z.cusAreaList) < 0
                            }
                            if (Q) {
                                Mobi.changeShipTplPrice(O);
                                return true
                            }
                            var V = 0,
                                R = Z.price,
                                X = Z.rha == null ? 1 : Z.rha,
                                Y = Z.ria == null ? 1 : Z.ria,
                                T = Z.rip || 0;
                            var U = A;
                            if (X > 0) {
                                V = R;
                                U -= X
                            }
                            if (Y > 0 && U > 0) {
                                var P = (U / Y).toFixed(1);
                                P = Math.ceil(P);
                                V += T * P
                            }
                            var S = {};
                            S.type = O.type;
                            S.defaultPrice = V;
                            Mobi.changeShipTplPrice(S);
                            return false
                        })
                });
            Mobi.mallStlCalcTotal()
        });
    jm("#mallShipTemplate_county_box").delegate(".group_item", "click",
        function() {
            jm("#mallShipTemplate_areaBox1 .street_content").remove();
            var G = jm(this).attr("cname");
            var I = jm(this).attr("cid");
            jm("#mallShipTemplate_areaBox1 .J_areaHead .street").click();
            var K = jm("#mallShipTemplate_areaBoxInput").attr("lastArea");
            var H = jm("#mallShipTemplate_areaBoxInput").attr("lastAreaType");
            if (H != null && (H == "street" || H == "county")) {
                jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val().substring(0, jm("#mallShipTemplate_areaBoxInput").val().indexOf("-", jm("#mallShipTemplate_areaBoxInput").val().indexOf("-") + 1)))
            }
            jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val() + "-" + G);
            jm("#mallShipTemplate_areaBoxInput").attr("lastArea", "-" + G);
            jm("#mallShipTemplate_areaBoxInput").attr("lastAreaType", "county");
            jm("#mallShipTemplate_areaBoxInput").attr("area3", I);
            jm("#mallShipTemplate_areaBoxInput").attr("area4", "");
            var F = "";
            if (t == 2052 || t == 1028) {
                F = u(site_cityUtil.getStreet(I))
            } else {
                F = u(site_cityUtil.getStreetEn(I))
            }
            var J = jm(F).html();
            if (J === null || J === undefined || J === "") {
                jm("#mallShipTemplate_areaBox1").hide();
                jm("#mallShipTemplate_areaBoxClose").click()
            }
            jm("#mallShipTemplate_street_box").append(F);
            Mobi.mallStlCalcTotal()
        });
    jm("#mallShipTemplate_street_box").delegate(".group_item", "click",
        function() {
            var F = jm(this).attr("cname");
            var H = jm(this).attr("cid");
            var I = jm("#mallShipTemplate_areaBoxInput").attr("lastArea");
            var G = jm("#mallShipTemplate_areaBoxInput").attr("lastAreaType");
            if (G != null && G == "street") {
                jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val().replace(I, ""))
            }
            jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val() + "-" + F);
            jm("#mallShipTemplate_areaBoxInput").attr("lastArea", "-" + F);
            jm("#mallShipTemplate_areaBoxInput").attr("lastAreaType", "street");
            jm("#mallShipTemplate_areaBoxInput").attr("area4", H);
            jm("#mallShipTemplate_areaBox1").hide();
            jm("#mallShipTemplate_areaBoxClose").click();
            Mobi.mallStlCalcTotal()
        });
    jm("#mallShipTemplate_sec_box").delegate(".group_item", "click",
        function() {
            if (jm("#mallShipTemplate_allArea").val() == "" || jm("#mallShipTemplate_allArea").val() == "cn" || jm("#mallShipTemplate_allArea").val() == "os") {
                h = true
            } else {
                h = false
            }
            Mobi.mallStlCalcTotal();
            jm("#mallShipTemplate_areaBox2 .thd_content").html("");
            var F = jm(this).attr("cname");
            var H = jm(this).attr("cid");
            jm("#mallShipTemplate_areaBox2 .J_areaHead2 .thd").click();
            var J = jm("#mallShipTemplate_areaBoxInput").attr("lastArea");
            var G = jm("#mallShipTemplate_areaBoxInput").attr("lastAreaType");
            if (G != null && G != "" && jm("#mallShipTemplate_areaBoxInput").val().indexOf("-") != -1) {
                jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val().substring(0, jm("#mallShipTemplate_areaBoxInput").val().indexOf("-")))
            }
            jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val() + "-" + F);
            jm("#mallShipTemplate_areaBoxInput").attr("lastArea", "-" + F);
            jm("#mallShipTemplate_areaBoxInput").attr("lastAreaType", "sec");
            jm("#mallShipTemplate_areaBoxInput").attr("area2", H);
            jm("#mallShipTemplate_areaBoxInput").attr("area3", "");
            var I = a(H);
            jm("#mallShipTemplate_thd_box .thd_content").append(I);
            if (A === 0 && c) {
                Mobi.mallStlCalcTotal();
                return
            }
            jm.each(f,
                function(M, O) {
                    if (v) {
                        var N = false,
                            L = C.scrl || [];
                        jm.each(L,
                            function(Q, P) {
                                if (P.st === O.type) {
                                    var R = false;
                                    if (h) {
                                        R = jm.inArray(parseInt(H), P.arl) > -1
                                    } else {
                                        R = jm.inArray(parseInt(H), P.carl) > -1
                                    }
                                    if (R) {
                                        if (P.fc === 1) {
                                            if (j === 1) {
                                                if (A >= P.d1) {
                                                    N = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= P.d1) {
                                                    N = true;
                                                    return false
                                                }
                                            }
                                        }
                                        if (P.fc === 2) {
                                            if (b >= P.d2) {
                                                N = true;
                                                return false
                                            }
                                        }
                                        if (P.fc === 3) {
                                            if (j === 1) {
                                                if (A >= P.d1 && b >= P.d2) {
                                                    N = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= P.d1 && b >= P.d2) {
                                                    N = true;
                                                    return false
                                                }
                                            }
                                        }
                                        if (P.fc === 4) {
                                            if (j === 1) {
                                                if (A >= P.d1 || b >= P.d2) {
                                                    N = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= P.d1 || b >= P.d2) {
                                                    N = true;
                                                    return false
                                                }
                                            }
                                        }
                                    }
                                }
                            });
                        if (N) {
                            var K = {};
                            K.type = O.type;
                            K.defaultPrice = 0;
                            Mobi.changeShipTplPrice(K);
                            return
                        } else {
                            Mobi.changeShipTplPrice(O)
                        }
                    }
                    jm.each(O.regionList,
                        function(W, Z) {
                            var Q = false;
                            if (h) {
                                Q = jm.inArray(parseInt(x), Z.areaList) < 0
                            } else {
                                Q = jm.inArray(parseInt(H), Z.cusAreaList) < 0
                            }
                            if (Q) {
                                Mobi.changeShipTplPrice(O);
                                return true
                            }
                            var V = 0,
                                R = Z.price,
                                X = Z.rha == null ? 1 : Z.rha,
                                Y = Z.ria == null ? 1 : Z.ria,
                                T = Z.rip || 0;
                            var U = A;
                            if (X > 0) {
                                V = R;
                                U -= X
                            }
                            if (Y > 0 && U > 0) {
                                var P = (U / Y).toFixed(1);
                                P = Math.ceil(P);
                                V += T * P
                            }
                            var S = {};
                            S.type = O.type;
                            S.defaultPrice = V;
                            Mobi.changeShipTplPrice(S);
                            return false
                        })
                });
            Mobi.mallStlCalcTotal()
        });
    jm("#mallShipTemplate_thd_box").delegate(".group_item", "click",
        function() {
            if (jm("#mallShipTemplate_allArea").val() == "" || jm("#mallShipTemplate_allArea").val() == "cn" || jm("#mallShipTemplate_allArea").val() == "os") {
                h = true
            } else {
                h = false
            }
            Mobi.mallStlCalcTotal();
            var F = jm(this).attr("cname");
            var H = jm(this).attr("cid");
            var I = jm("#mallShipTemplate_areaBoxInput").attr("lastArea");
            var G = jm("#mallShipTemplate_areaBoxInput").attr("lastAreaType");
            if (G != null && G == "thd") {
                jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val().replace(I, ""))
            }
            jm("#mallShipTemplate_areaBoxInput").val(jm("#mallShipTemplate_areaBoxInput").val() + "-" + F);
            jm("#mallShipTemplate_areaBoxInput").attr("lastArea", "-" + F);
            jm("#mallShipTemplate_areaBoxInput").attr("lastAreaType", "thd");
            jm("#mallShipTemplate_areaBoxInput").attr("area3", H);
            jm("#mallShipTemplate_areaBox2").hide();
            jm("#mallShipTemplate_areaBoxClose").click();
            if (A === 0 && c) {
                Mobi.mallStlCalcTotal();
                return
            }
            jm.each(f,
                function(L, N) {
                    if (v) {
                        var M = false,
                            K = C.scrl || [];
                        jm.each(K,
                            function(P, O) {
                                if (O.st === N.type) {
                                    var Q = false;
                                    if (h) {
                                        Q = jm.inArray(parseInt(H), O.arl) > -1
                                    } else {
                                        Q = jm.inArray(parseInt(H), O.carl) > -1
                                    }
                                    if (Q) {
                                        if (O.fc === 1) {
                                            if (j === 1) {
                                                if (A >= O.d1) {
                                                    M = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= O.d1) {
                                                    M = true;
                                                    return false
                                                }
                                            }
                                        }
                                        if (O.fc === 2) {
                                            if (b >= O.d2) {
                                                M = true;
                                                return false
                                            }
                                        }
                                        if (O.fc === 3) {
                                            if (j === 1) {
                                                if (A >= O.d1 && b >= O.d2) {
                                                    M = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= O.d1 && b >= O.d2) {
                                                    M = true;
                                                    return false
                                                }
                                            }
                                        }
                                        if (O.fc === 4) {
                                            if (j === 1) {
                                                if (A >= O.d1 || b >= O.d2) {
                                                    M = true;
                                                    return false
                                                }
                                            } else {
                                                if (A <= O.d1 || b >= O.d2) {
                                                    M = true;
                                                    return false
                                                }
                                            }
                                        }
                                    }
                                }
                            });
                        if (M) {
                            var J = {};
                            J.type = N.type;
                            J.defaultPrice = 0;
                            Mobi.changeShipTplPrice(J);
                            return
                        } else {
                            Mobi.changeShipTplPrice(N)
                        }
                    }
                    jm.each(N.regionList,
                        function(V, Y) {
                            var P = false;
                            if (h) {
                                P = jm.inArray(parseInt(x), Y.areaList) < 0
                            } else {
                                P = jm.inArray(parseInt(H), Y.cusAreaList) < 0
                            }
                            if (P) {
                                Mobi.changeShipTplPrice(N);
                                return true
                            }
                            var U = 0,
                                Q = Y.price,
                                W = Y.rha == null ? 1 : Y.rha,
                                X = Y.ria == null ? 1 : Y.ria,
                                S = Y.rip || 0;
                            var T = A;
                            if (W > 0) {
                                U = Q;
                                T -= W
                            }
                            if (X > 0 && T > 0) {
                                var O = (T / X).toFixed(1);
                                O = Math.ceil(O);
                                U += S * O
                            }
                            var R = {};
                            R.type = N.type;
                            R.defaultPrice = U;
                            Mobi.changeShipTplPrice(R);
                            return false
                        })
                });
            Mobi.mallStlCalcTotal()
        });
    function r(G) {
        var F = "";
        F += "<div class='city_content'>";
        jm.each(G,
            function(H, I) {
                if (t == 2052 || t == 1028) {
                    F += "<div class='group_item' cid='" + I.id + "' cname='" + site_cityUtil.getInfo(I.id).name + "'>" + site_cityUtil.simpleCityNameStr(site_cityUtil.getInfo(I.id).name) + "</div>"
                } else {
                    F += "<div class='group_item' cid='" + I.id + "' cname='" + site_cityUtil.getInfoEn(I.id).name + "'>" + site_cityUtil.simpleCityNameStrEn(site_cityUtil.getInfoEn(I.id).name) + "</div>"
                }
            });
        F += "</div>";
        return F
    }
    function k(G) {
        var F = "";
        F += "<div class='county_content'>";
        jm.each(G,
            function(H, I) {
                if (t == 2052 || t == 1028) {
                    F += "<div class='group_item' cid='" + I.id + "' cname='" + site_cityUtil.getInfo(I.id).name + "'>" + site_cityUtil.getInfo(I.id).name + "</div>"
                } else {
                    F += "<div class='group_item' cid='" + I.id + "' cname='" + site_cityUtil.getInfoEn(I.id).name + "'>" + site_cityUtil.getInfoEn(I.id).name + "</div>"
                }
            });
        F += "</div>";
        return F
    }
    function u(G) {
        var F = "";
        F += "<div class='street_content'>";
        jm.each(G,
            function(H, I) {
                if (t == 2052 || t == 1028) {
                    F += "<div class='group_item' cid='" + I.id + "' cname='" + site_cityUtil.getInfo(I.id).name + "'>" + site_cityUtil.getInfo(I.id).name + "</div>"
                } else {
                    F += "<div class='group_item' cid='" + I.id + "' cname='" + site_cityUtil.getInfoEn(I.id).name + "'>" + site_cityUtil.getInfoEn(I.id).name + "</div>"
                }
            });
        F += "</div>";
        return F
    }
    function d(G) {
        var F = "";
        var H = false;
        jm.each(p,
            function(I, J) {
                if (H) {
                    return
                }
                if (J.id == G) {
                    F = J.name;
                    H = true
                }
            });
        return F
    }
    function w(G) {
        var F = [];
        jm.each(p,
            function(H, I) {
                if (I.parentId == G) {
                    F.push(I)
                }
            });
        return F
    }
    function a(F) {
        if (isNaN(F)) {
            return ""
        }
        var H = parseInt(F);
        var G = "";
        jm.each(w(H),
            function(I, J) {
                G += "<div class='group_item' cid='" + J.id + "' cname='" + J.name + "'>" + J.name + "</div>"
            });
        return G
    }
};
Mobi.changeShipTplPrice = function(a) {
    var b = jm("#shipPrice").attr("currency");
    if (a.defaultPrice == 0) {
        jm("#tmpType_" + a.type).text(LS.freeShipping)
    } else {
        jm("#tmpType_" + a.type).text(b + a.defaultPrice.toFixed(2))
    }
    jm("#tmpType_" + a.type).attr("value", a.defaultPrice.toFixed(2));
    if (jm("#shipValue").attr("shiptype") == a.type) {
        jm("#shipPrice").attr("value", a.defaultPrice.toFixed(2));
        jm("#shipPrice").text(a.defaultPrice == 0 ? LS.freeShipping: b + a.defaultPrice.toFixed(2));
        Mobi.mallStlCalcTotal()
    }
};
Mobi.changeShipType = function() {
    var a = Fai.top._choiceCurrencyVal;
    jm(".ShipItem").click(function() {
        var e = jm(this),
            c = parseFloat(jm("#shipPrice").attr("value")),
            b = parseFloat(jm("#totalValue").text()),
            f = parseFloat(e.find(".J_shipPrice").attr("value")),
            j = parseFloat(e.find(".J_shipPrice").attr("shipType")),
            d = e.find(".J_shipPrice").text(),
            h = e.find(".J_shipName").text();
        jm("#shipPrice").attr("value", f).text(f == 0 ? LS.freeShipping: a + f);
        jm("#shipValue").attr("shiptype", j).text(h + "  ");
        b = Mobi.calculate(Mobi.calculate(b, c, 1), f, 0);
        jm("#totalValue").text(b);
        jm(".modifyShipDetails .g_close").click();
        jm(".modifyShipDetails .J_selectShip").removeAttr("style").attr("style", "font-size:1rem;height:2.5rem;line-height:2.5rem;float:right;").removeAttr("class").attr("class", "faisco-icons-shape11");
        jm(".modifyShipDetails .faisco-icons-shape11").each(function(k, l) {
            if (jm(this).parent().find(".J_shipPrice").attr("shiptype") == j) {
                jm(this).removeAttr("style").attr("style", "margin-right:0.15rem;height:2.5rem;line-height:2.5rem;float:right;").removeAttr("class").attr("class", "faisco-icons-right g_color J_selectShip")
            }
        })
    })
};
Mobi.changeBankList = function() {
    jm(".bankListArea").click(function() {
        var c = jm(this),
            d = c.find(".bankItemValue").eq(2).text(),
            a = c.find(".bankItemValue").eq(0).text(),
            b = c.find(".bankItemValue").eq(1).text();
        jm(".orderDetail_line .bankDetailArea").find(".bankItemValue").eq(2).text(d);
        jm(".orderDetail_line .bankDetailArea").find(".bankItemValue").eq(0).text(a);
        jm(".orderDetail_line .bankDetailArea").find(".bankItemValue").eq(1).text(b);
        jm(".modifyBankList .g_close").click()
    })
};
Mobi.getRootFontSize = function() {
    var a = jm("html").css("font-size");
    a = a.substring(0, a.length - 2);
    return Number(a)
};
Mobi.initUseCoupon = (function(j) {
    var e = b.prototype,
        k, l = {};
    function b(m) {
        this.selectCoupon = {};
        k = this;
        l.couponList = m;
        l.couponColorList = ["red", "orange", "yellow", "green", "blue", "pink", "purple"],
            d(m);
        c();
        h()
    }
    function d(u) {
        Mobi.defaultCouponSelect = -1;
        var p = parseFloat(jm("#cartTotalPrice").attr("totalPrice"));
        if (u != "undefined" && u.length != 0) {
            var n = u[0];
            if (n != "undefined") {
                Mobi.defaultCouponSelectId = n.cdId;
                var m = n.savePrice;
                var t = n.orderMinPrice;
                jm("#couponOffsetMoney").text(jm.format(LS.settlementCoupon, m, t));
                jm("#couponOffsetMoney").attr("_offsetmoney", m);
                Mobi.selectCoupon.saveMoney = m;
                Mobi.selectCoupon.id = n.cdId;
                Mobi.selectCoupon.orderMinPrice = n.orderMinPrice;
                var q = jm("#useItg");
                if (p - m <= 0) {
                    q.val(0);
                    jm("#itgOffsetMoney").text("0.00");
                    jm("#canUse").text(0)
                } else {
                    var o = p - m;
                    var r = parseInt(q.attr("_needitg"));
                    var s = parseInt(q.attr("_maxuse"));
                    var v = Math.floor((p - m) * r);
                    if (v < s) {
                        s = v
                    }
                    jm("#canUse").text(s);
                    jm("#itgOffsetMoney").text((s / r).toFixed(2))
                }
                Mobi.mallStlCalcTotal()
            } else {
                Mobi.selectCoupon = {}
            }
        } else {
            jm("#showCouponCount").css("display", "inline-block")
        }
    }
    function c() {
        Mobi.onTouchAndClickEvent(".coupon-warp",
            function() {
                var o = jm(".fk-select-layer"),
                    n = Mobi.getRootFontSize(),
                    m = jm(this)[0].offsetTop;
                k.selectCoupon.id = jm(this).attr("data_id");
                k.selectCoupon.saveMoney = jm(this).find(".couponPrice").text();
                o.css({
                    top: m + "px"
                });
                o.show();
                Mobi.mallStlCalcTotal()
            });
        Mobi.onTouchAndClickEvent(".fk-select-layer",
            function() {
                jm(".fk-select-layer").hide();
                k.selectCoupon = {};
                jm("#couponOffsetMoney").text(LS.notUse);
                Mobi.mallStlCalcTotal()
            });
        Mobi.onTouchAndClickEvent("#editCouponPanel .fk-coupon-opera .g_button",
            function(m) {
                if ("id" in k.selectCoupon) {
                    var p = Fai.top._choiceCurrencyVal;
                    var r = k.selectCoupon.saveMoney;
                    var t = k.selectCoupon.orderMinPrice;
                    if (jm("#editUseItgPanel").length > 0) {
                        var n = jm("#useItg"),
                            q = parseInt(n.attr("_needitg")),
                            s = parseInt(n.attr("_maxuse"));
                        var o = parseFloat(jm("#cartTotalPrice").attr("totalPrice"));
                        if (isNaN(o)) {
                            return
                        }
                        var u = Math.floor((o - r) * q);
                        if (u < s) {
                            jm(".useTips .maxUse").text(u)
                        } else {
                            jm(".useTips .maxUse").text(s)
                        }
                    }
                    jm("#couponOffsetMoney").attr("_offsetmoney", r);
                    jm("#couponOffsetMoney").text(jm.format(LS.settlementCoupon, parseFloat(r).toFixed(2), t));
                    Mobi.mallStlCalcTotal();
                    jm("#editCouponPanel .g_close").click();
                    return false
                } else {
                    Mobi.ing(LS.plsSelectCoupon)
                }
            });
        Mobi.onTouchAndClickEvent("#editCouponPanel #validCode",
            function() {
                var m = jm("#redeemCode").val();
                if (redeemCodee) {
                    $.ajax({
                        url: "ajax/mallCoupon_h.jsp?cmd=checkSetCoupon",
                        data: "code=" + jm.encodeUrl(redeemCodee),
                        dataType: "json",
                        success: function(o) {
                            if (o.success) {} else {}
                        },
                        error: function() {
                            Mobi.ing(LS.systemError)
                        }
                    })
                }
                if ("id" in k.selectCoupon) {
                    var n = Fai.top._choiceCurrencyVal;
                    jm("#couponOffsetMoney").text("-" + n + k.selectCoupon.saveMoney);
                    jm("#editCouponPanel .g_close").click()
                } else {
                    Mobi.ing(LS.plsSelectCoupon)
                }
            });
        Mobi.onTouchAndClickEvent("#editCouponPanel .notUseBtn",
            function() {
                jm(".fk-select-layer").hide();
                k.selectCoupon = {};
                jm("#couponOffsetMoney").text(LS.notUse);
                Mobi.mallStlCalcTotal();
                jm("#editCouponPanel .g_close").click()
            })
    }
    function f() {
        var m = [];
        m.push("<div class='couponPanel' id='editCouponPanel' style='display:none;'>");
        m.push("<div class='ShipDetailsHeader webHeaderBg'>");
        m.push("<span class='g_close icon-gClose'></span><span class='title pageTitle'>" + LS.coupon);
        m.push("</span></div>");
        m.push("<div class='fk-coupon-panel couponListPanel'>");
        m.push("<div class='fk-rc' style='display:none'>");
        m.push('<input type="text" id="redeemCode" class="g_input fk-rc-input" placeholder="我有兑换码"/>');
        m.push("<div class='g_button' id='validCode'>验证</div>");
        m.push("</div>");
        m.push("<div class='coupon-empty' style='display:none;'>");
        m.push("<div class='icon-coupons1'></div>");
        var n = "暂无可使用优惠券";
        m.push("<div class='showMsg'>" + n + "</div>");
        m.push("</div>");
        m.push("<div class='show-coupon-list'>");
        m.push("<div style='padding: 0.5rem;'>" + LS.plsSelectUseCoupon + "</div>");
        jm.each(l.couponList,
            function(p, o) {
                m.push("<div class='coupon-warp' data_id='" + o.cdId + "' data_min='" + o.orderMinPrice + "'>");
                m.push("<div class='coupon-code'>" + LS.coupon.substring(2) + LS.serialNumber + "：" + o.redeemCode + "</div>");
                m.push("<div class='coupon-data'>");
                m.push("<div>" + LS.Event + LS.name + "：" + jm.encodeHtml(o.couponName) + "</div>");
                m.push("<div>" + LS.useConditionOrderOver + Fai.top._choiceCurrencyVal + o.orderMinPrice + "</div>");
                m.push("<div>" + LS.vilidaty + "：" + o.validity + "</div>");
                m.push("</div>");
                m.push("<div class='coupon' data_id='" + o.cdId + "'>");
                m.push("<div class='coupon-left coupon-" + l.couponColorList[o.bg] + "-left'></div>");
                m.push("<div class='coupon-content coupon-color-" + l.couponColorList[o.bg] + "'>");
                m.push("<div class='couponSavePrice'><span class='priceSign'>" + Fai.top._choiceCurrencyVal + "</span><span class='couponPrice'>" + o.savePrice + "</span></div>");
                m.push("</div>");
                m.push("<div class='coupon-right coupon-" + l.couponColorList[o.bg] + "-right'></div>");
                m.push("<div class='coupon-watermark'>券</div>");
                m.push("</div>");
                m.push("</div>")
            });
        m.push("<div class='fk-select-layer'><div></div><em><span class='faisco-icons-select'></span></em></div>");
        m.push("</div>");
        m.push("</div>");
        m.push("<div class='fk-coupon-opera'>");
        m.push("<div class='g_color g_bdColor  notUseBtn'><span>" + LS.doNotUsed + "<span class=''></div>");
        m.push("<div class='g_button'>" + LS.sureUse + "</div>");
        m.push("</div>");
        return m.join("")
    }
    function a() {
        var o = [];
        var m = [];
        jm.each(l.couponList,
            function(p, q) {
                m.push("<div class='couponUseListItem' couponId='" + q.cdId + "' onclick='Mobi.changeCheckButtonRight(" + q.cdId + ")'>");
                m.push("<span>" + jm.format(LS.settlementCoupon, q.savePrice, q.orderMinPrice) + "</span>");
                m.push("<span>");
                if (Mobi.defaultCouponSelectId == q.cdId) {
                    m.push("<div class='faisco-icons-right couponCheckBox g_color' order_min_price='" + q.orderMinPrice + "' coupon_value='" + q.savePrice + "' id='selectBtn" + q.cdId + "'></div>")
                } else {
                    m.push("<div class='faisco-icons-shape11 couponCheckBox' order_min_price='" + q.orderMinPrice + "' coupon_value='" + q.savePrice + "' id='selectBtn" + q.cdId + "' onclick='Mobi.changeCheckButtonRight(" + q.cdId + ")' ></div>")
                }
                m.push("</span>");
                m.push("</div>")
            });
        m.push("<div class='couponUseListItem' couponId='-1' onclick='Mobi.changeCheckButtonRight(-1)' style='margin-bottom:3rem;'>");
        m.push("<span>" + LS.doNotUsed + "</span>");
        m.push("<span>");
        m.push("<div class='faisco-icons-shape11 couponCheckBox' id='selectBtn-1' order_min_price ='-1'  coupon_value='-1' onclick='Mobi.changeCheckButtonRight(-1)' ></div>");
        m.push("</span>");
        m.push("</div>");
        var n = "<div class='couponUseListPanel' style='display:none; ' id='couponUseListPanel'><div style='position: absolute;bottom: 0;width: 100%;'><div class='couponListTitle'>" + LS.coupon + "</div><div class='couponUseListContent' id='couponUseListContent'><div id='couponListItems' style='max-height:10rem; overflow: auto;'><div class='couponListContainer'>" + m.join("") + "</div></div></div></div></div>";
        return n
    }
    function h() {
        var m = {
            triggerId: "couponLine",
            pageHtml: a(),
            direction: "bottom",
            pageBg: true,
            callback: function() {
                jm(".couponListTitle,#couponUseListContent").bind("click mousedown touchstart",
                    function(n) {
                        n.stopPropagation()
                    });
                jm("#couponListItems").css("overflow", "auto");
                jm("#couponLine").bind("click",
                    function(n) {
                        jm("#webPagePanelcouponLine .webPagePanelBg").css("display", "block");
                        jm("#webPagePanelcouponLine").addClass("webPagePanelcouponLine")
                    })
            },
            closeWebPage: "#couponUseListPanel"
        };
        Mobi.initWebPage(m)
    }
    return b
})();
Mobi.setUseIntegral = function() {
    var a = Fai.top._choiceCurrencyVal;
    if (jm.os.supportsTouch) {
        jm("#editUseItgPanel .g_button").off("touchend").on("touchend",
            function() {
                setTimeout(function() {
                        if (Mobi.initPresentIpt()) {
                            jm("#editUseItgPanel .g_close").click()
                        }
                    },
                    300)
            })
    } else {
        jm("#editUseItgPanel .g_button").off("mousedown").on("mousedown",
            function() {
                if (Mobi.initPresentIpt()) {
                    jm("#editUseItgPanel .g_close").click()
                }
            })
    }
    if (jm.os.supportsTouch) {
        jm("#editUseItgPanel .notUseBtn").off("touchend").on("touchend",
            function() {
                setTimeout(function() {
                        jm("#offsetMoney").attr("_offsetmoney", "0");
                        jm("#useItg").val("0");
                        Mobi.initPresentIpt();
                        Mobi.mallStlCalcTotal();
                        jm("#editUseItgPanel .g_close").click()
                    },
                    300)
            })
    } else {
        jm("#editUseItgPanel .notUseBtn").off("mousedown").on("mousedown",
            function() {
                jm("#offsetMoney").attr("_offsetmoney", "0");
                jm("#useItg").val("0");
                Mobi.initPresentIpt();
                Mobi.mallStlCalcTotal();
                jm("#editUseItgPanel .g_close").click()
            })
    }
};
Mobi.mallStlCalcTotal = function() {
    var f = parseFloat(jm("#cartTotalPrice").attr("totalPrice"));
    if (isNaN(f)) {
        return
    }
    var a = parseFloat(jm("#shipPrice").attr("value"));
    if (isNaN(a)) {
        a = 0
    }
    if (jm("#mallShipTemplate_province").length > 0) {
        var l = jm("#shipValue");
        l.attr("provinceCode", jm("#mallShipTemplate_areaBoxInput").attr("area1"));
        l.attr("cityCode", jm("#mallShipTemplate_areaBoxInput").attr("area2"));
        l.attr("countyCode", jm("#mallShipTemplate_areaBoxInput").attr("area3"));
        l.attr("streetCode", jm("#mallShipTemplate_areaBoxInput").attr("area4"));
        var b = jm("#shipValue").attr("shiptype")
    } else {
        if (jm("#mallShip").length == 1) {
            var b = jm("#shipValue").attr("shiptype");
            jm("#mallShip").attr("shipType", b)
        }
    }
    var h = 0;
    if (jm("#offsetMoney").length > 0) {
        var k = jm("#offsetMoney").attr("_offsetmoney");
        if (!isNaN(k) && !Mobi.isNull(k)) {
            h = parseFloat(k);
            if ((f + a) < h) {
                Mobi.ing(jm.format(LS.integral_maxUse, jm("#useItg").attr("_maxuse"), jm.encodeHtml(jm("#useItg").attr("_itegName"))));
                module.find(".mallStlTotal .totalValue").text((f + a).toFixed(2));
                return
            }
        }
    }
    if (Mobi.selectCoupon && "id" in Mobi.selectCoupon && Mobi.selectCoupon.id) {
        h += Number(Mobi.selectCoupon.saveMoney)
    }
    var e = parseInt(jm("#presentItg").attr("value"));
    jm("#mallShipCount").text((a).toFixed(2));
    jm("#totalValue").text((f + a - h).toFixed(2));
    var d = parseFloat(jm("#cartTotalPrice").attr("saleSaveMoney"));
    var j = jm("#couponOffsetMoney").attr("_offsetmoney");
    j = parseFloat((typeof j == "undefined" || j == null || j == "") ? 0 : j);
    var c = jm("#offsetMoney").attr("_offsetmoney");
    c = parseFloat((typeof c == "undefined" || c == null || c == "") ? 0 : c);
    var m = d + j + c;
    jm("#saleSavePrice").text(m.toFixed(2));
    if (m == 0) {
        jm(".sale_price").hide()
    } else {
        jm(".sale_price").show()
    }
};
Mobi.editInfoSave = function(c) {
    var b = jm(".editPanel");
    var C = new Array();
    var y = false;
    var l = {};
    var z = {};
    b.find(".propItemValue").each(function() {
        var G = jm(this).val();
        var F = jm(this).attr("id");
        var M = jm(this).attr("_field");
        var D = jm(this).attr("proptype");
        var E = jm(this).attr("_prop");
        var L = jm(this).attr("_required") == 1 || jm(this).attr("_required") == "true";
        if (L && !G && !y) {
            msg = LS.mallStlSubmitInput + jm(this).attr("_prop");
            Mobi.ing(msg);
            jm("#" + F).trigger("focus");
            y = true;
            return false
        }
        if (G && G.length > 0) {
            if (D == 8 || D == 10) {
                if (!jm.isNationMobile(G)) {
                    msg = LS.mobileNumRegular;
                    Mobi.ing(msg);
                    jm("#" + F).trigger("focus");
                    y = true;
                    return false
                }
            }
            if (D == 3 || D == 12) {
                if (!jm.isEmail(G)) {
                    msg = LS.mallStlSubmitInput2 + jm(this).attr("_prop");
                    Mobi.ing(msg);
                    jm("#" + F).trigger("focus");
                    y = true;
                    return false
                }
            }
            var N = {};
            if (D == 9) {
                if (G.length > 0) {
                    N.s = G;
                    var K = F.replace("input", "") + "_endinput";
                    var J = b.find("#" + K);
                    if (J.length > 0) {
                        var I = J.val();
                        if (I == "") {
                            msg = LS.mallStlSubmitInput2 + jm(this).attr("_prop");
                            Mobi.ing(msg);
                            y = true;
                            return false
                        } else {
                            N.e = I
                        }
                    }
                }
                G = N
            }
        }
        if (typeof M !== "undefined") {
            var H = {};
            H.field = M;
            H.value = G;
            H.type = D;
            H.name = E;
            C.push(H);
            z[M] = G
        }
    });
    if (y) {
        return
    }
    var r = "";
    var A = jm("#mallShipTemplate_province").length == 1;
    if (A) {
        var w = parseInt(jm("#mallShipTemplate_areaBoxInput").attr("area2"));
        var t = parseInt(jm("#mallShipTemplate_areaBoxInput").attr("isCus"));
        if (isNaN(w) && !t) {
            Mobi.ing(LS.mallStlSubmitAddrErr);
            return false
        } else {
            if (Fai.top._lcid == 2052 || Fai.top.lcid == 1028) {
                r = jm("#mallShipTemplate_areaBoxInput").val().replace(/-/g, "") + jm("#edit_addrDetal").val()
            } else {
                r = jm("#mallShipTemplate_areaBoxInput").val().replace(/-/g, " ") + " " + jm("#edit_addrDetal").val()
            }
        }
    }
    if (jm("#allArea").length == 1) {
        r = "";
        var s = jm("#areaBoxInput");
        var j = jm("#addrInfo_street");
        var f = parseInt(s.attr("area2"));
        var n = parseInt(s.attr("area1"));
        var v = parseInt(s.attr("area3"));
        var u = parseInt(s.attr("area4"));
        var k = parseInt(s.attr("isCus"));
        var m = (j.attr("_required") == "1");
        if (m && isNaN(n)) {
            Mobi.ing(LS.mallStlSubmitAddrErr);
            return false
        } else {
            if (m && isNaN(f) && !k) {
                Mobi.ing(LS.mallStlSubmitAddrErr);
                return false
            } else {
                if (Fai.top._lcid == 2052 || Fai.top.lcid == 1028) {
                    r = s.val().replace(/-/g, "") + jm("#addrInfo_street").val()
                } else {
                    r = s.val().replace(/-/g, " ") + " " + jm("#addrInfo_street").val()
                }
            }
        }
        if (isNaN(f)) {
            f = -1
        }
        if (isNaN(v)) {
            v = -1
        }
        if (isNaN(u)) {
            u = -1
        }
        if (c != 0) {
            l.provinceCode = n;
            l.cityCode = f;
            l.countyCode = v;
            l.streetCode = u;
            l.streetAddr = j.val();
            l.isCus = !!k;
            z.addr_info = l;
            z.addr = r;
            z.isDefault = 1
        }
        var x = {};
        x.field = "addr";
        x.value = r;
        C.push(x);
        z.addr = r
    }
    if (c != 0) {
        var a = {};
        a.opera = "addAddr";
        a.addrInfo = z;
        jm.ajax({
            type: "post",
            url: action = "ajax/member_h.jsp?cmd=set&id=" + c,
            data: "info=" + jm.encodeUrl(jm.toJSON(a)),
            success: function(D) {},
            error: function() {
                Mobi.ing(LS.systemError)
            }
        })
    }
    if (jm(".assignItem_line").length < 1) {
        var d = "";
        var B = "";
        var p = "";
        var o = "";
        jm(".orderAssign_line .shipTopBg:last-child").remove();
        if (jm("#allArea").length == 0 && !A) {
            var h = 1;
            d += "<div class='assignItem_line' id='assignItemline'  style='background-color:#fafafa;'></div>";
            d += "<div id='noAddrListInfo' style='background-color:#fafafa;'>";
            d += "	<div class='noAddrPanel'>";
            jm.each(C,
                function(D) {
                    if (h > 3) {
                        return
                    }
                    if (C[D].field != undefined && C[D].field != "" && C[D].field != null) {
                        d += "<div class='noAddrLine'><span style='color:#333'>" + C[D].name + "：</span>";
                        var F = C[D].value;
                        if (C[D].type == 9) {
                            if (F != undefined) {
                                var E = F;
                                if (E.s != undefined) {
                                    F = E.s;
                                    if (E.e != undefined) {
                                        F += " " + LS.to + " " + E.e
                                    }
                                }
                            }
                        }
                        d += "<span class='noAddr_prop' propType='" + C[D].type + "' id='info_" + C[D].field + "'>" + F + "</span>";
                        h++;
                        d += "</div>"
                    }
                });
            if (h > 3) {
                d += "<span class='icon-rightIcon rightToward'></span>"
            }
            d += " </div>"
        } else {
            d += "<div class='assignItem_line' id='assignItemline'>";
            d += "<div class='receiverLine'>";
            d += "<span class='icon-toAddrListArrow'></span>";
            var e = false;
            jm.each(C,
                function(D) {
                    if ((C[D])["field"] === "name") {
                        d += "<span class='addr_value flex1 info_" + (C[D])["field"] + "' id='info_" + (C[D])["field"] + "'>" + ((C[D])["value"] || "") + "</span>"
                    } else {
                        if (((C[D])["field"] === "mobile")) {
                            if (e) {
                                return
                            }
                            e = true;
                            d += "<span class='addr_value flex1 info_phone' id='info_phone'>" + (C[D])["value"] + "</span>"
                        } else {
                            if ((C[D])["field"] === "addr") {
                                B = (C[D])["value"];
                                p = (C[D])["field"]
                            }
                        }
                    }
                });
            d += "</div>";
            d += "<div class='item_value flex1'>";
            d += "<span class='icon-addrSelected'></span>";
            if (B != "" && p != "") {
                o = B
            } else {
                if (r != "") {
                    o = r
                }
            }
            d += "<span class='info_addr' id='info_addr'>" + (o || "") + "</span>";
            d += "</div>";
            d += "</div>"
        }
        d += "<div class='shipTopBg'></div>";
        jm("#linetitle1").removeClass("noAddrMsgList");
        jm(".orderAssign_line").append(d);
        if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
            jm("#assignItemline").off("click.mall").on("click.mall",
                function() {
                    jm("#linetitle1").click()
                })
        }
    } else {
        if (jm("#allArea").length == 0) {
            jm(".noAddrPanel .noAddr_prop").each(function() {
                var H = jm(this).attr("id");
                var F = jm(this).attr("proptype");
                var E = H.replace("info_", "");
                var D = z[E];
                if (F != undefined && F == 9 && D != "") {
                    var G = D;
                    if (G.s != undefined) {
                        D = G.s;
                        if (G.e != undefined) {
                            D += " " + LS.to + " " + G.e
                        }
                    }
                }
                jm("#" + H).text(D)
            })
        }
        var q = jm(".assignItem_line");
        q.find("#info_name").text("");
        q.find("#info_phone").text("");
        q.find("#info_addr").text("");
        if (z.name) {
            q.find("#info_name").text(z.name)
        }
        if (z.mobile) {
            q.find("#info_phone").text(z.mobile)
        }
        if (z.addr) {
            q.find("#info_addr").text(z.addr)
        }
    }
    jm("#editCusInfo .g_close").click()
};
Mobi.mallSubmiting = false;
Mobi.mallSubmit = function(y, e, p, f, F, I, v, x, j) {
    if (!p && y === 0) {
        Mobi.ing("您目前处于管理状态，您的订单为示例数据。");
        return
    }
    v = v || {};
    var s = jm("#mstlBtn");
    var h = jm(".orderSettle"),
        H = {},
        C = false,
        q = "",
        n = {};
    h.find(".propItemValue").each(function() {
        var Q = jm(this),
            L = Q.val(),
            K = Q.attr("id");
        required = Q.attr("_required") == 1 || Q.attr("_required") == "true";
        if (required && !L && !C) {
            q = LS.mallStlSubmitInput + Q.attr("_prop");
            Mobi.ing(q);
            jm("#linetitle1").click();
            jm("#" + K).trigger("focus");
            C = true;
            return false
        }
        var S = Q.attr("_field");
        var J = Q.attr("proptype");
        if (L && L.length > 0) {
            if (J == 8 || J == 10) {
                if (!jm.isNationMobile(L)) {
                    jm("#" + K).trigger("focus");
                    q = LS.mobileNumRegular;
                    Mobi.ing(q);
                    C = true;
                    return false
                }
            }
            if (J == 3 || J == 12) {
                if (!jm.isEmail(L)) {
                    jm("#linetitle1").click();
                    jm("#" + K).trigger("focus");
                    q = LS.mallStlSubmitInput2 + jm(this).attr("_prop");
                    Mobi.ing(q);
                    C = true;
                    return false
                }
            }
            if (J == 9) {
                var R = "";
                if (L.length > 0) {
                    var T = {};
                    T.s = L;
                    var P = K.replace("input", "") + "_endinput";
                    var O = h.find("#" + P);
                    if (O.length > 0) {
                        var N = O.val();
                        if (N == "") {
                            jm("#linetitle1").click();
                            jm("#" + K).trigger("focus");
                            q = LS.mallStlSubmitInput2 + jm(this).attr("_prop");
                            Mobi.ing(q);
                            C = true;
                            return false
                        } else {
                            T.e = N
                        }
                    }
                    R = JSON.stringify(T)
                }
                L = R
            }
        }
        if (typeof S !== "undefined") {
            if (S !== "addrDetail" && S !== "addrInfo_street") {
                H[S] = L;
                n[S] = L;
                if (S == "mobile") {
                    var M = jm("#mobileCt").val();
                    if (L.length <= 0) {
                        M = ""
                    }
                    H.mobileCt = M
                }
            }
        }
    });
    var w = jm("#areaBoxInput");
    if (H.addr == null && w.length == 1) {
        var t = "";
        if (Fai.top._lcid == 2052 || Fai.top.lcid == 1028) {
            t = w.val().replace(/-/g, "") + jm("#addrInfo_street").val()
        } else {
            t = w.val().replace(/-/g, " ") + " " + jm("#addrInfo_street").val()
        }
        H.addr = t
    }
    if (Mobi.orderLvMessageOpen) {
        var A = jm("#orderLeveaMsgIn").val();
        if (A.length > Mobi.orderLvMessageMaxNum) {
            A = A.substring(0, Mobi.orderLvMessageMaxNum)
        }
        H.msg = A
    } else {
        H.msg = ""
    }
    if (C) {
        return
    }
    var b = jm("#shipValue");
    if (jm("#mallShipTemplate_province").length == 1 && b.length == 1) {
        var m = parseInt(b.attr("provinceCode"));
        var u = parseInt(b.attr("cityCode"));
        var l = parseInt(b.attr("countyCode"));
        var o = parseInt(b.attr("streetCode"));
        var B = (jm("#mallShipTemplate_areaBoxInput").attr("isCus") == 1);
        if (!m || isNaN(m)) {
            q = LS.mallStlSubmitAddrErr;
            jm("#linetitle1").click()
        } else {
            if ((!u || isNaN(u)) && !B) {
                q = LS.mallStlSubmitAddrErr;
                jm("#linetitle1").click()
            }
        }
        if (isNaN(o)) {
            o = -1
        }
        if (isNaN(l)) {
            l = -1
        }
        if (isNaN(u)) {
            submitCiCode = -1
        }
        var r = {
            type: parseInt(b.attr("shipType")),
            templateId: parseInt(b.attr("templateId")),
            provinceCode: m,
            cityCode: u,
            countyCode: l,
            streetCode: o,
            isCus: B,
            streetAddr: jm.trim(jm("#edit_addrDetal").val())
        };
        H.shipType = r
    } else {
        H.shipType = parseInt(jm("#shipValue").attr("shipType"))
    }
    if (q != "") {
        Mobi.ing(q);
        return
    }
    var z = jm("#onlineBankType");
    var c = 0;
    if (z.length == 1) {
        c = parseInt(z.attr("_paymode"));
        if (c < 3) {
            H.payMode = c
        }
    }
    if ((z.length == 1) && (c > 2)) {
        c = parseInt(z.attr("_paymode"));
        if (c != 9 && c != 8 && c != 7) {
            H.payBankType = parseInt(z.attr("_type"))
        }
        H.payMode = parseInt(z.attr("_paymode"))
    }
    if (isNaN(c)) {
        Mobi.ing(LS.mallStlPayOnlineType);
        return
    }
    var G = jm("#useItg");
    if (G.length > 0) {
        var d = G.val();
        if (jm.isInteger(d)) {
            var k = parseInt(G.attr("_maxUse"));
            var a = parseInt(G.attr("_currentitg"));
            var D = G.attr("_itegName");
            if (d > a) {
                Mobi.ing(jm.format(LS.integral_notOverCurrent, jm.encodeHtml(D), jm.encodeHtml(D)));
                G.focus();
                return
            }
            if (d > k) {
                Mobi.ing(jm.format(LS.integral_notOver, jm.encodeHtml(D), k));
                G.focus();
                return
            }
            if (d < 0) {
                Mobi.ing(LS.integral_inputInteger);
                G.focus();
                return
            }
            H.useItg = parseInt(d)
        }
    }
    if (jm("#presentItgShow").length > 0) {
        H.presentItg = true
    }
    if (Mobi.selectCoupon && "id" in Mobi.selectCoupon && Mobi.selectCoupon.id) {
        H.cdId = Number(Mobi.selectCoupon.id)
    }
    Mobi.ing(LS.mallStlSubmitting, -1);
    var E = jm("#onlineBankType").attr("_paymode");
    urlArg = "orderId=" + y;
    if (p) {
        if (window.self != window.top && /(iPhone|iPad|iPod|safari)/i.test(navigator.userAgent.toLowerCase())) {
            urlArg = "imme&immeData=" + jm.encodeUrl(jm.toJSON(I))
        } else {
            urlArg = "imme"
        }
    }
    s.attr("disabled", "disabled");
    if (!p && f.length > 0) {
        jm.ajax({
            type: "post",
            url: "ajax/order_h.jsp?cmd=delItem&orderId=" + y,
            data: "itemIds=[" + f + "]",
            error: function() {
                Mobi.ing(LS.mallCartUpdateError)
            },
            success: function(J) {
                var J = jm.parseJSON(J);
                if (J.success) {
                    Mobi.ajaxSettleOrder(urlArg, H, F, p, E, y, v, x)
                } else {
                    if (J.rt == -9) {
                        Mobi.ing(LS.mallStlSubmitStatusError);
                        setTimeout(function() {
                                window.location.href = "mcart.jsp"
                            },
                            2000)
                    } else {
                        Mobi.ing(LS.mallStlSubmitError)
                    }
                }
            }
        })
    } else {
        Mobi.ajaxSettleOrder(urlArg, H, F, p, E, y, v, x)
    }
    s[0].disabled = false
};
Mobi.ajaxSettleOrder = function(j, e, f, c, h, a, d, b) {
    if (Mobi.mallSubmiting) {
        return
    }
    Mobi.mallSubmiting = true;
    jm.ajax({
        type: "post",
        url: "ajax/order_h.jsp?cmd=settle&" + j,
        data: "data=" + jm.encodeUrl(jm.toJSON(e)) + "&groupBuyOptions=" + jm.encodeUrl(jm.toJSON(d)) + "&cutPriceOptions=" + jm.encodeUrl(jm.toJSON(b)),
        error: function() {
            Mobi.mallSubmiting = false;
            Mobi.ing(LS.mallStlSubmitError)
        },
        success: function(k) {
            var k = jm.parseJSON(k);
            if (k.success) {
                jm.ajax({
                    type: "post",
                    url: "ajax/order_h.jsp?cmd=addAfterShop",
                    data: "data=" + jm.encodeUrl(jm.toJSON(f)),
                    error: function() {
                        Mobi.mallSubmiting = false;
                        stlMsg.html(LS.mallStlSubmitError)
                    },
                    success: function(m) {
                        if (h == "10" || h == "11") {
                            var n = Fai.top._lcid ? "&lcid=" + Fai.top._lcid: "";
                            window.location.href = "/wxPay/mdetail.jsp?id=" + (c ? k.oid: a) + n + "&wxFirst=true#firstSubmit"
                        } else {
                            if (h == "1" || h == "2") {
                                window.location.href = "mdetail.jsp?id=" + (c ? k.oid: a) + "&suc=true"
                            } else {
                                window.location.href = "mdetail.jsp?id=" + (c ? k.oid: a) + "#firstSubmit"
                            }
                        }
                    }
                })
            } else {
                Mobi.mallSubmiting = false;
                if (k.rt == -3) {
                    Mobi.ing(LS.mallStlSubmitNotFound)
                } else {
                    if (k.rt == -9) {
                        Mobi.ing(LS.mallStlSubmitStatusError);
                        setTimeout(function() {
                                window.location.href = "mcart.jsp"
                            },
                            2000)
                    } else {
                        if (k.rt == Mobi.MallAjaxErrno.mallAmountZero) {
                            Mobi.ing(jm.format(LS.oAmountIsZero))
                        } else {
                            if (k.rt == Mobi.MallAjaxErrno.outOfMallAmount) {
                                Mobi.ing(jm.format(LS.outOfMallAmount))
                            } else {
                                if (k.rt == Mobi.MallAjaxErrno.OutOfAllowAmount) {
                                    Mobi.ing(jm.format(LS.allowAmountOverNameList, k.productsName))
                                } else {
                                    if (k.rt == Mobi.MallAjaxErrno.couponOverTime) {
                                        Mobi.ing(LS.couponOverTime)
                                    } else {
                                        if (k.rt == Mobi.MallAjaxErrno.couponUnavail) {
                                            Mobi.ing(LS.couponUnavail)
                                        } else {
                                            if (k.rt == Mobi.MallAjaxErrno.couponNotFound) {
                                                Mobi.ing(LS.couponNotFound)
                                            } else {
                                                if (k.rt <= -600 && k.rt >= -609) {
                                                    var l;
                                                    if (k.rt == -608) {
                                                        l = {
                                                            textClass: "goToPay",
                                                            cancelClass: "giveUpJoin",
                                                            content: "非常抱歉，该团已满，继续支付会自动为您开新团",
                                                            callback: function() {
                                                                d.groupBuyDetailId = 0;
                                                                Mobi.ajaxSettleOrder(j, e, f, c, h, a, d)
                                                            }
                                                        };
                                                        Mobi.prompt(l)
                                                    } else {
                                                        if (k.rt == -605) {
                                                            l = {
                                                                textClass: "goToPay",
                                                                cancelClass: "giveUpJoin",
                                                                content: "不好意思，已经超出成团时间，继续支付将自动为您开新团",
                                                                callback: function() {
                                                                    d.groupBuyDetailId = 0;
                                                                    Mobi.ajaxSettleOrder(j, e, f, c, h, a, d)
                                                                }
                                                            };
                                                            Mobi.prompt(l)
                                                        } else {
                                                            if (k.rt == -609) {
                                                                Mobi.ing("不好意思，您已经参与该团")
                                                            } else {
                                                                Mobi.ing("参团失败，请稍后再试")
                                                            }
                                                        }
                                                    }
                                                } else {
                                                    Mobi.returnMallErrorMsg(k.rt)
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    })
};
Mobi.orderLvMessageOpen = false;
Mobi.orderLvMessageMaxNum = 0;
Mobi.initOrderLvMsgPrm = function(b, a) {
    Mobi.orderLvMessageOpen = b;
    Mobi.orderLvMessageMaxNum = a
};
Mobi.mallSettle = function(a) {
    if (a > 0) {
        var b = [];
        jm(".mallCart .invalidItem").each(function() {
            b.push(jm(this).attr("itemId"))
        });
        jm(".mallCart .J_noSelect").each(function() {
            b.push(jm(this).attr("itemId"))
        });
        if (jm(".mallCart").children().length - 1 == b.length) {
            Mobi.ing(LS.settleFailplsModifyCart);
            return
        }
        if (jm(".mallCart").children().length - 1 > 500) {
            Mobi.ing(LS.mcartTooLong);
            return
        }
        var c = false;
        jm(".mallCart .J_select").each(function() {
            var d = Number(jm(this).find(".buyNumber").val());
            var f = Number(jm(this).attr("realamount"));
            var e = jm(this).attr("enableAmount");
            if ((d > f) && e == "true") {
                c = true;
                return false
            }
        });
        if (c) {
            Mobi.ing(LS.mallAmountOverFlow);
            return
        }
        window.location.href = "mstl.jsp?id=" + a + "&invalidIds=" + b
    } else {
        window.location.href = "mstl.jsp"
    }
};
Mobi.initPresentIpt = function() {
    var a = jm("#useItg");
    if (a.length > 0) {
        var f = Fai.top._choiceCurrencyVal;
        var h = parseInt(a.attr("_needitg"));
        var d = parseInt(a.val());
        var k = a.attr("_itegName");
        var j = parseInt(a.attr("_maxuse"));
        var e = parseFloat(jm("#cartTotalPrice").attr("totalPrice"));
        if (isNaN(e)) {
            return false
        }
        if (!jm.isInteger(d) || d < 0) {
            jm("#offsetMoney").attr("_offsetmoney", "");
            Mobi.ing(LS.integral_inputOverZero);
            a.focus;
            d = 0
        }
        if (jm("#couponOffsetMoney").length > 0) {
            var b = jm("#couponOffsetMoney").attr("_offsetmoney");
            if (!isNaN(b)) {
                b = parseInt(b);
                var l = Math.floor((e - b) * h);
                if (l < j) {
                    j = l
                }
            }
        }
        if (d > j) {
            Mobi.ing(jm.format(LS.integral_maxUse, j, jm.encodeHtml(jm("#useItg").attr("_itegName"))));
            jm("#useItg").val(j);
            jm("#canUse").text(j);
            var c = (j / h).toFixed(2);
            jm("#offsetMoney").attr("_offsetmoney", c);
            jm("#itgOffsetMoney").text(c);
            Mobi.mallStlCalcTotal();
            return false
        }
        if (d > parseInt(a.attr("_currentItg"))) {
            Mobi.ing(jm.format(LS.integral_notOverCurrent, jm.encodeHtml(k), jm.encodeHtml(k)));
            d = 0;
            a.focus();
            return false
        }
        var c = (d / h).toFixed(2);
        jm("#offsetMoney").attr("_offsetmoney", c);
        Mobi.mallStlCalcTotal();
        if (d == 0) {
            return false
        }
    }
    return true
};
Mobi.printPromoWithdrawMode = function(c, b) {
    var a = "";
    a += "<div class='pgListDiv' id='pgListDiv' style='background-color: inherit;'>";
    a += "    <div class='g_close' style='width: 100%;height: 100%;'></div>";
    a += "    <div id='onlinePayType' class='pgDetail onlinePayType'>";
    a += "        <div id='pgBox' class='pgBox' style='position: fixed;bottom: 0;z-index: 100;'>";
    jm.each(c,
        function(d) {
            var e = c[d];
            a += "        <div id=group_" + e.mode + " class='line'>";
            a += "            <div class='pgBoxItem'>";
            if (e.mode === 0) {
                a += "            <span class='icon-payMode payMode4'></span>"
            } else {
                a += "            <span class='icon-payMode payMode1'></span>"
            }
            a += "                <a class='pgName payMode' onclick='Mobi.changePromoWithdrawMode(" + e.mode + ")' _payMode='" + e.mode + "'>" + e.name + "</a>";
            if (b == e.mode) {
                a += "            <i class='faisco-icons-right g_color J_selectPay' style='height: 2.5rem;line-height: 2.5rem;margin-left: 0.1rem;'></i>"
            } else {
                a += "            <i class='faisco-icons-shape11' style='font-size: 1rem;height: 2.5rem;line-height: 2.5rem;'></i>"
            }
            a += "            </div";
            a += "        </div>"
        });
    a += "        </div>";
    a += "    </div>";
    a += "</div>";
    return a
};
Mobi.printOnlinePayType = function(b) {
    var d = jm("#onlineBankType").attr("_paymode");
    var a = Fai.top._recomentPayMode;
    var c = new Array();
    c.push("<div class='pgListDiv' id='pgListDiv' style='background-color: inherit;'>");
    c.push("<div class='g_close' style='width: 100%;height: 100%;'></div>");
    c.push("<div id='onlinePayType' class='pgDetail onlinePayType'>");
    c.push("<div id='pgBox' class='pgBox' style='position: fixed;bottom: 0;z-index: 100;'>");
    jm.each(b,
        function(e) {
            var f = b[e];
            if (!f.desc) {
                return true
            }
            if (a == f.payMode) {
                c.push("<div id=group_" + f.payMode + " class='line'>");
                c.push("<div class='pgBoxItem'><span class='icon-payMode payMode" + f.payMode + "'></span><a class='pgName payMode'  onclick='Mobi.setPayOnlineType(this);' _payMode='" + f.payMode + "' _name='" + f.desc + "'>" + f.desc + "<span class='icon-b0276' style='margin-left: 0.156rem;'></span></a>" + (d == f.payMode ? "<i class='faisco-icons-right g_color J_selectPay' style='height: 2.5rem;line-height: 2.5rem;margin-left: 0.1rem;'></i>": "<i class='faisco-icons-shape11' style='font-size: 1rem;height: 2.5rem;line-height: 2.5rem;'></i>") + "</div>");
                c.push("</div>");
                return false
            }
        });
    jm.each(b,
        function(e) {
            var f = b[e];
            if (!f.desc) {
                return true
            }
            if (a == f.payMode) {
                return true
            }
            c.push("<div id=group_" + f.payMode + " class='line'>");
            c.push("<div class='pgBoxItem'><span class='icon-payMode payMode" + f.payMode + "'></span><a class='pgName payMode'  onclick='Mobi.setPayOnlineType(this);' _payMode='" + f.payMode + "' _name='" + f.desc + "'>" + f.desc + "</a>" + (d == f.payMode ? "<i class='faisco-icons-right g_color J_selectPay' style='height: 2.5rem;line-height: 2.5rem;margin-left: 0.1rem;'></i>": "<i class='faisco-icons-shape11' style='font-size: 1rem;height: 2.5rem;line-height: 2.5rem;'></i>") + "</div>");
            c.push("</div>")
        });
    c.push("</div></div></div>");
    return c.join("")
};
Mobi.toggleItemLine = function(c) {
    var d = jm(c);
    if (d.hasClass("opened")) {
        d.parent().find(".pgBox2Item").height(0);
        d.removeClass("opened")
    } else {
        jm(".pgBox2Item").height(0);
        jm(".pgBoxItem").removeClass("opened");
        var a = jm(c).parent().find(".pgBox2Item .pgName").length;
        var b = 0;
        if (a >= 6) {
            b = "15rem"
        } else {
            b = a * 2.5 + "rem"
        }
        d.addClass("opened").parent().find(".pgBox2Item").height(b)
    }
};
Mobi.setPayOnlineType = function(e, a) {
    var c = Fai.top._recomentPayMode;
    var e = jm(e),
        d = "",
        b = "",
        a = e.attr("_name");
    if (e.hasClass("payMode")) {
        d = e.attr("_payMode");
        jm("#onlineBankType").attr("_payMode", d)
    } else {
        if (e.hasClass("bank")) {
            d = e.attr("_payMode");
            b = e.attr("_type");
            jm("#onlineBankType").attr("_payMode", d);
            jm("#onlineBankType").attr("_type", b)
        }
    }
    jm(".icon-selectedPayMode").removeAttr("class").attr("class", "icon-selectedPayMode payMode" + d);
    jm("#onlineBankType").text(a);
    if (c == d) {
        jm("#onlineBankTip").css("display", "unset")
    } else {
        jm("#onlineBankTip").css("display", "none")
    }
    jm("#pgListDiv .J_selectPay").removeAttr("style").attr("style", "font-size:1rem;height:2.5rem;line-height:2.5rem;").removeAttr("class").attr("class", "faisco-icons-shape11");
    jm("#pgListDiv .payMode").each(function(f, h) {
        if (jm(this).attr("_paymode") == d) {
            jm(this).parent().find(".faisco-icons-shape11").removeAttr("style").attr("style", "margin-left:0.1rem;height:2.5rem;line-height:2.5rem;").removeAttr("class").attr("class", "faisco-icons-right g_color J_selectPay")
        }
    });
    jm("#pgListDiv .g_close").click()
};
Mobi.initpayOrder = function(a) {
    var b = new Mobi.payOrder(a);
    b.init();
    var c = Fai.top.location.hash;
    if (c.indexOf("firstSubmit") > 0) {
        Fai.top.location.hash = "";
        jm(".J_payBtn").click()
    }
};
Mobi.setOrderDetailPageHeaderColor = function(c) {
    var a;
    if (c) {
        a = ".orderDetailTop"
    } else {
        a = ".orderDetail_header"
    }
    var b = jm(a).find(".g_color").css("color");
    b = b.substring(b.indexOf("(") + 1, b.indexOf(")"));
    b += ", 0.08";
    jm(a).css("background-color", "rgba(" + b + ")")
};
Mobi.payOrder = function(a) {
    this.orderId = a
};
Mobi.checkOrderStatue = function(a) {
    $.ajax({
        type: "post",
        url: "ajax/mall_h.jsp?cmd=checkOrderStatue",
        data: "orderId=" + a,
        error: function() {
            Fai.ing("系统错误。")
        },
        success: function(b) {
            var c = $.parseJSON(b);
            if (c.success) {
                Fai.top.location.href = "mdetail.jsp?id=" + a + "&suc=true"
            }
        }
    })
}; (function(c, b, h) {
    var f = b.prototype,
        a, j;
    f.init = function() {
        a = this.orderId;
        d()
    };
    function d() {
        j = c(".payButton");
        j.on("click",
            function() {
                var l = c(this).attr("_href");
                var o = c(this).attr("_orderId");
                if (typeof o != "undefined" && o != null) {
                    a = o
                }
                var n = Mobi.checkOrderPayLimit(a);
                if (n != "") {
                    Mobi.ing(n);
                    return
                }
                var m = (l == "WXPAY");
                var p = c(this).attr("_appId");
                var k = e(m, p, l);
                if (k) {
                    if (!m) {
                        document.location.href = l
                    } else {
                        Mobi.getWxpayUrl(p, a)
                    }
                }
            })
    }
    function e(n, p, k) {
        var m = window.location.href,
            o = "";
        if (m.indexOf("lcid") > 0) {
            var q = Mobi.getUrlParam(m, "lcid");
            if (q) {
                o += "&lcid=" + q
            }
        }
        var l = true;
        c.ajax({
            type: "post",
            url: "ajax/order_h.jsp?cmd=checkOrder" + o,
            data: "orderId=" + a + "&isWX=" + n,
            async: false,
            dataType: "json",
            error: function() {
                Mobi.ing(LS.mallStlSubmitError)
            },
            success: function(r) {
                if (!r.success) {
                    l = false;
                    if (r.rt == -3) {
                        Mobi.ing(LS.mallStlSubmitNotFound)
                    } else {
                        if (r.rt == -9) {
                            Mobi.ing(LS.mallStlSubmitStatusError)
                        } else {
                            if (r.rt == Mobi.MallAjaxErrno.mallAmountZero) {
                                Mobi.ing(c.format(LS.oAmountIsZero))
                            } else {
                                if (r.rt == Mobi.MallAjaxErrno.outOfMallAmount) {
                                    Mobi.ing(c.format(LS.outOfMallAmount))
                                } else {
                                    if (r.rt == Mobi.MallAjaxErrno.OutOfAllowAmount) {
                                        Mobi.ing(c.format(LS.allowAmountOverNameList, Mobi.encodeHtml(r.productsName)))
                                    } else {
                                        if (r.rt == Mobi.MallAjaxErrno.payDomainError) {
                                            Mobi.ing(c.format(LS.mallPayDomainError))
                                        } else {
                                            if (r.rt == Mobi.MallAjaxErrno.notAdded) {
                                                Mobi.ing(c.format(LS.mallProductNotAdded))
                                            } else {
                                                if (r.rt <= -600 && r.rt >= -609) {
                                                    var s;
                                                    if (r.rt == -608) {
                                                        s = {
                                                            textClass: "goToPay",
                                                            cancelClass: "giveUpJoin",
                                                            content: "非常抱歉，该团已满，继续支付会自动为您开新团",
                                                            callback: function() {
                                                                c.ajax({
                                                                    type: "post",
                                                                    url: "ajax/order_h.jsp?cmd=setOrderNewGroupBuyDetail",
                                                                    data: "orderId=" + a,
                                                                    dataType: "json",
                                                                    error: function() {
                                                                        Mobi.ing(LS.mallStlSubmitError)
                                                                    },
                                                                    success: function(t) {
                                                                        if (t.success) {
                                                                            if (!n) {
                                                                                document.location.href = k
                                                                            } else {
                                                                                Mobi.getWxpayUrl(p, a)
                                                                            }
                                                                        } else {
                                                                            if (t.rt == -9) {
                                                                                window.location.reload()
                                                                            } else {
                                                                                Mobi.ing("当前网络异常，请刷新后重试")
                                                                            }
                                                                        }
                                                                    }
                                                                })
                                                            }
                                                        };
                                                        Mobi.prompt(s)
                                                    } else {
                                                        if (r.rt == -605) {
                                                            s = {
                                                                textClass: "goToPay",
                                                                cancelClass: "giveUpJoin",
                                                                content: "不好意思，已经超出成团时间，继续支付将自动为您开新团",
                                                                callback: function() {
                                                                    c.ajax({
                                                                        type: "post",
                                                                        url: "ajax/order_h.jsp?cmd=setOrderNewGroupBuyDetail",
                                                                        data: "orderId=" + a,
                                                                        dataType: "json",
                                                                        error: function() {
                                                                            Mobi.ing(LS.mallStlSubmitError)
                                                                        },
                                                                        success: function(t) {
                                                                            if (t.success) {
                                                                                if (!n) {
                                                                                    document.location.href = k
                                                                                } else {
                                                                                    Mobi.getWxpayUrl(p, a)
                                                                                }
                                                                            } else {
                                                                                if (t.rt == -9) {
                                                                                    window.location.reload()
                                                                                } else {
                                                                                    Mobi.ing("当前网络异常，请刷新后重试")
                                                                                }
                                                                            }
                                                                        }
                                                                    })
                                                                }
                                                            };
                                                            Mobi.prompt(s)
                                                        } else {
                                                            if (r.rt == -604) {
                                                                Mobi.ing("不好意思，活动已结束")
                                                            } else {
                                                                if (r.rt == -609) {
                                                                    Mobi.ing("不好意思，您已经参与该团")
                                                                } else {
                                                                    Mobi.ing("参团失败，请稍后再试")
                                                                }
                                                            }
                                                        }
                                                    }
                                                } else {
                                                    Mobi.ing(LS.mallStlSubmitError)
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        });
        return l
    }
})(jm, Mobi.payOrder);
Mobi.checkOrderPayLimit = function(a) {
    var b = "";
    jm.ajax({
        type: "post",
        url: "ajax/order_h.jsp?cmd=checkOrderPayLimit",
        data: "orderId=" + a,
        async: false,
        dataType: "json",
        error: function() {
            b = ""
        },
        success: function(c) {
            if (!c.success && c.isOverTime) {
                b = c.msg
            } else {
                b = ""
            }
        }
    });
    return b
};
Mobi.getWxpayUrl = function(d, b) {
    var f = location.href,
        c = false;
    var a = "wxPay/";
    if (f.indexOf("h-mlist.html") >= 0) {
        if (f.indexOf("wxPay/") >= 0) {
            a = ""
        }
        f = f.replace("h-mlist.html", a + "mdetail.jsp");
        c = true
    } else {
        if (f.indexOf("mlist.jsp") >= 0) {
            if (f.indexOf("wxPay/") >= 0) {
                a = ""
            }
            f = f.replace("mlist", a + "mdetail");
            c = true
        }
    }
    if (c) {
        if (f.indexOf("?") >= 0) {
            f = f.substring(0, f.indexOf("?"))
        }
        f += "?id=" + b
    }
    var e = navigator.userAgent.toLowerCase();
    if (! (e.match(/MicroMessenger/i) == "micromessenger")) {
        Mobi.callPay(0, b);
        return
    }
    f = encodeURIComponent(f);
    window.location.href = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + d + "&redirect_uri=" + f + "&response_type=code&scope=snsapi_base&state=1#wechat_redirect"
};
Mobi.callPay = function(d, a) {
    Mobi.showLoading();
    var b = window.location.href,
        c = "";
    if (b.indexOf("lcid") > 0) {
        var e = Mobi.getUrlParam(b, "lcid");
        if (e) {
            c += "&lcid=" + e
        }
    }
    jm.ajax({
        type: "post",
        url: "ajax/mall_h.jsp?cmd=getWxpayCallPayParam&orderId=" + a + "&code=" + d + c,
        error: function() {
            Mobi.closeLoading();
            Mobi.ing(LS.systemError)
        },
        success: function(f) {
            var j = jm.parseJSON(jm.decodeUrl(f));
            Mobi.closeLoading();
            if (j.success) {
                Mobi.callPayAPI(j)
            } else {
                Mobi.closeLoading();
                var h = navigator.userAgent.toLowerCase();
                if (! (h.match(/MicroMessenger/i) == "micromessenger")) {
                    Mobi.ing("使用微信支付购买商品请在微信端打开网站")
                } else {
                    Mobi.ing(j.errMsg + "(请联系网站管理员)")
                }
            }
        }
    })
};
Mobi.callPayAPI = function(j) {
    var f = navigator.userAgent.toLowerCase();
    if (! (f.match(/MicroMessenger/i) == "micromessenger")) {
        if (j.result != "SUCCESS") {
            Mobi.ing((j.errMsg ? j.errMsg: "微信支付失败，请尝试在微信端进行支付"));
            return
        }
        var a = window.location.href,
            b = "";
        if (a.indexOf("lcid") > 0) {
            var k = Mobi.getUrlParam(a, "lcid");
            if (k) {
                b = Mobi.getLanCodeFromLcid(k);
                b = b ? b + "/": ""
            }
        }
        var d = window.location.href;
        window.location.href = j.url + "&redirect_url=" + d;
        return
    }
    try {
        if (typeof WeixinJSBridge == "undefined") {
            if (document.addEventListener) {
                document.addEventListener("WeixinJSBridgeReady", c, false)
            } else {
                if (document.attachEvent) {
                    document.attachEvent("WeixinJSBridgeReady", c);
                    document.attachEvent("onWeixinJSBridgeReady", c)
                }
            }
        } else {
            c()
        }
        function c() {
            var e = {
                appId: j.appId,
                nonceStr: j.nonceStr,
                timeStamp: j.timeStamp,
                paySign: j.paySign,
                "package": j.pak,
                signType: "MD5"
            };
            WeixinJSBridge.invoke("getBrandWCPayRequest", e,
                function(m) {
                    if (m.err_msg != "get_brand_wcpay_request:cancel") {
                        WeixinJSBridge.log(m.err_msg)
                    }
                    if (m.err_msg != "get_brand_wcpay_request:ok") {
                        if (m.err_msg == "get_brand_wcpay_request:cancel") {
                            Mobi.ing(LS.wxpayCancel)
                        } else {
                            Mobi.ing(LS.wxpayErr)
                        }
                        Mobi.showLoading();
                        var l = window.location.href,
                            n = "";
                        if (l.indexOf("lcid") > 0) {
                            var o = Mobi.getUrlParam(l, "lcid");
                            if (o) {
                                n += "&lcid=" + o
                            }
                        }
                        if (l.indexOf("?") >= 0) {
                            l = l.substring(0, l.indexOf("?"))
                        }
                        l += "?id=" + jm("#wxpayBtn").attr("_orderid") + n;
                        setTimeout(function() {
                                window.location.replace(l)
                            },
                            3000)
                    } else {
                        Mobi.showLoading();
                        setTimeout(function() {
                                var p = window.location.href,
                                    q = "";
                                if (p.indexOf("lcid") > 0) {
                                    var r = Mobi.getUrlParam(p, "lcid");
                                    if (r) {
                                        q = Mobi.getLanCodeFromLcid(r);
                                        q = q ? q + "/": ""
                                    }
                                }
                                window.location.href = "/" + q + "mdetail.jsp?id=" + jm("#wxpayBtn").attr("_orderid") + "&suc=true"
                            },
                            1000)
                    }
                })
        }
    } catch(h) {
        alert(h.message)
    }
};
Mobi.backOff = function(a) {
    if (Fai.top._manageMode) {
        var b = {};
        b.fun = top.Mobi.saveDesignToCheckUpRedirectUrl;
        b.args = new Array();
        b.args.push("../mcart.jsp");
        if (top.Mobi.checkSaveBar(b, true)) {
            return false
        }
        window.location.href = "index.jsp"
    } else {
        history.go( - 1)
    }
};
Mobi.getNewFlowInfo = function(c, a, d) {
    var b = jm("#module" + c);
    if (typeof d != "undefined" && d) {
        b.find(".J-newFlowInfo").append("<div>无需配送</div>");
        return
    } else {
        jm.ajax({
            type: "post",
            url: "ajax/flowInfo_h.jsp?cmd=flowMsg",
            data: "id=" + a,
            success: function(e) {
                var j = jm.parseJSON(e);
                flowMsgList = [];
                if (j.msgList == null || j.msgList.length === 0 || !j.success) {
                    var f = [];
                    flowMsgList.push("<div class='flowInfo'>");
                    flowMsgList.push("<div class='flowBusMsg'>");
                    flowMsgList.push("<span class='flowBusName'>" + j.flowCorpName + "</span>");
                    flowMsgList.push("<span class='flowBusNumber'>" + j.flowBillNum + "</span>");
                    flowMsgList.push("<span class='icon-rightIcon' style='position: absolute;right: 0;color: #ccc;'></span>");
                    flowMsgList.push("</div>");
                    flowMsgList.push("<div class='flowFlag icon-flowFlag'></div>");
                    flowMsgList.push("</div>");
                    flowMsgList.push("</div>");
                    b.find(".noflowInfo").eq(0).show()
                } else {
                    var k = "",
                        h = j.msgList.length;
                    if (h > 0) {
                        flowMsgList.push("<div class='flowInfo'>");
                        flowMsgList.push("<div class='flowBusMsg'>");
                        flowMsgList.push("<span class='flowBusName'>" + j.flowCorpName + "</span>");
                        flowMsgList.push("<span class='flowBusNumber'>" + j.flowBillNum + "</span>");
                        flowMsgList.push("<span class='icon-rightIcon' style='position: absolute;right: 0;color: #ccc;'></span>");
                        flowMsgList.push("</div>");
                        flowMsgList.push("<div class='flowFlag icon-flowFlag'></div>");
                        flowMsgList.push("<div class='flowLastNews'><span>" + j.msgList[0].context + "</span></div>");
                        flowMsgList.push("<div><span class='flowMsgTime'>" + j.msgList[0].time + "</span>");
                        flowMsgList.push("</div>");
                        flowMsgList.push("</div>")
                    }
                }
                b.find(".orderDetail_addr").css("border-top", "1px solid #f2f2f2");
                b.find(".J-newFlowInfo").append(flowMsgList.join(""));
                if (j.success) {
                    b.find(".J-newFlowInfo").eq(0).click(function() {
                        Mobi.getAllFlowInfo(c, a)
                    })
                } else {
                    if (j.msg != undefined) {
                        Mobi.ing(j.msg)
                    }
                }
            }
        })
    }
};
Mobi.setFlowDivSwipeLis = function() {
    var a, d, c, b;
    jm("#J-flowClickDiv").bind("click",
        function() {
            Mobi.ing("aaaa")
        });
    jm("#J-flowSwipeDiv").bind("mousedown",
        function(f) {
            a = f.clientX - jm("#J-flowSwipeDiv").offset().left;
            d = f.clientY - jm("#J-flowSwipeDiv").offset().top;
            jm("#J-flowSwipeDiv").bind("mousemove",
                function(h) {}).bind("mouseup",
                function(j) {
                    jm("#J-flowSwipeDiv").unbind("mousemove").unbind("mouseup");
                    c = j.clientX - jm("#J-flowSwipeDiv").offset().left;
                    b = j.clientY - jm("#J-flowSwipeDiv").offset().top;
                    Mobi.ing(b);
                    var h = j;
                    if (a == c && d == b) {
                        Mobi.ing(j.offsetX + "," + j.offsetY);
                        jm("#J-flowClickDiv").css("margin-left", (j.offsetX - 10) + "px");
                        jm("#J-flowClickDiv").css("margin-top", (j.offsetY + 5) + "px");
                        jm("#J-flowSwipeDiv").css("display", "none");
                        setTimeout(function() {
                                jm("#J-flowClickDiv").click();
                                jm("#J-flowClickDiv").click();
                                jm("#J-flowClickDiv").click();
                                jm("#J-flowSwipeDiv").css("display", "block")
                            },
                            100)
                    }
                })
        })
};
Mobi.getAllFlowInfo = function(d, a) {
    var c = jm("#module" + d),
        e = jm("#flowDetailPanel" + a),
        b = jm("#g_web");
    if (e.length < 1) {
        jm.ajax({
            type: "post",
            url: "ajax/flowInfo_h.jsp?cmd=show",
            data: "id=" + a,
            success: function(f) {
                var h = jm.parseJSON(f);
                b.append(h.flowDetailHtml);
                Mobi.initFlowDetailEvent(d, a)
            }
        })
    }
    setTimeout(function() {
            jm.ajax({
                type: "post",
                url: "ajax/flowInfo_h.jsp?cmd=flowMsg",
                data: "id=" + a,
                success: function(h) {
                    var l = jm.parseJSON(h),
                        n = jm("#flowDetailPanel" + a);
                    if (l.msgList == null || l.msgList.length === 0 || !l.success) {
                        if (l.success) {
                            n.find(".flowDetail .flowDiv .noflowInfo").eq(0).show()
                        } else {
                            n.find(".flowDetail .flowDiv .flowErr").eq(0).show();
                            if (l.msg != undefined) {
                                Mobi.ing(l.msg)
                            }
                        }
                    } else {
                        var m = "",
                            f = [],
                            k = l.msgList.length;
                        n.find(".flowDetail .flowDiv .flowPanel").eq(0).remove();
                        f.push("<div class='flowPanel'>");
                        for (var j = 0; j < k; j++) {
                            f.push("<div class='flowInfo'>");
                            f.push("<div class='flowFlag'></div>");
                            f.push("<div><span>" + l.msgList[j].context + "</span></div>");
                            f.push("<div><span " + (j == 0 ? "": "class='flowTime'") + ">" + l.msgList[j].time + "</span>");
                            if (j == 0) {
                                f.push("<span class='icon-flowCurrent'></span>")
                            }
                            f.push("</div>");
                            f.push("</div>");
                            f.push("<div class='seperate'></div>")
                        }
                        f.push("</div>");
                        n.find(".flowDetail .flowDiv").eq(0).append(f.join(""))
                    }
                    Mobi.showFlowDetailPanel(d, a)
                }
            })
        },
        100)
};
Mobi.initFlowDetailEvent = function(b, a) {
    var c = jm("#flowDetailPanel" + a);
    moreButton = jm("#moreOrderProductList" + a);
    c.find(".loginHeader .g_close").eq(0).click(function() {
        Mobi.hideFlowDetailPanel(b, a)
    });
    c.bind("scroll",
        function(d) {
            d.stopPropagation();
            d.cancelBubble = true
        })
};
Mobi.showFlowDetailPanel = function(b, a) {
    var c = jm("#flowDetailPanel" + a);
    c.css("margin-left", 0)
};
Mobi.hideFlowDetailPanel = function(b, a) {
    var c = jm("#flowDetailPanel" + a);
    c.css("margin-left", "")
};
Mobi.moreOrderProductList = function(d, b) {
    var e = jm("#orderProductList" + b),
        c = jm("#moreOrderProductList" + b),
        h = jm("#flowDetailPanel" + b);
    var f = (parseInt(e.find(".line_item").eq(0).height()) + parseInt(e.find(".line_item").eq(0).css("padding-top"))) * 2,
        a = parseInt(e.find(".orderProductList_inner").eq(0).height());
    if (c.attr("type") == "0") {
        e.css("height", a + "px");
        c.attr("type", "1");
        if (c.attr("is_cn") == "0") {
            c.removeClass("icon-more");
            c.addClass("icon-less")
        } else {
            c.find(".more").eq(0).hide();
            c.find(".less").eq(0).show()
        }
    } else {
        e.css("height", f + "px");
        c.attr("type", "0");
        if (c.attr("is_cn") == "0") {
            c.removeClass("icon-less");
            c.addClass("icon-more")
        } else {
            c.find(".less").eq(0).hide();
            c.find(".more").eq(0).show()
        }
    }
};
Mobi.initFlowDetailHeight = function(c, a) {
    var d = jm("#orderProductList" + a),
        e = jm("#flowDetailPanel" + a);
    d.css("height", "");
    e.css("height", "");
    e.attr("tmp_h", e.height());
    if (d.find(".line_item").length > 2) {
        var b = jm("#moreOrderProductList" + a);
        b.attr("type", "0");
        if (b.attr("is_cn") == "0") {
            b.removeClass("icon-less");
            b.addClass("icon-more")
        } else {
            b.find(".less").eq(0).hide();
            b.find(".more").eq(0).show()
        }
        d.height((parseInt(d.find(".line_item").eq(0).height()) + parseInt(d.find(".line_item").eq(0).css("padding-top"))) * 2 + "px")
    }
};
Mobi.initFlowButton = function(b) {
    var a = jm("#module" + b);
    a.find(".J-flowView").unbind().bind("click",
        function() {
            var d = jm(this);
            var c = d.attr("_oid");
            Mobi.getAllFlowInfo(b, c)
        })
};
Mobi.initPayOrderImmediately = function(b) {
    var a = jm("#module" + b);
    a.find(".j-payOrderImmediately").unbind().bind("click",
        function() {
            var d = jm(this);
            var c = d.attr("_oid");
            Mobi.mallSettle(c)
        })
};
Mobi.initOrderSureButton = function(b) {
    var a = jm("#module" + b);
    a.find(".J-orderSureRpt").unbind().bind("click",
        function() {
            var h = jm(this),
                e = h.parent().parent(),
                d = h.attr("_oid");
            var c = function(k, j) {
                jm.ajax({
                    type: "post",
                    url: "ajax/order_h.jsp",
                    data: "cmd=setStatus&id=" + j + "&status=20",
                    error: function() {
                        Mobi.ing(LS.systemError)
                    },
                    success: function(l) {
                        var m = jm.parseJSON(l);
                        if (m.success) {
                            jm("#mobiPrompt").remove();
                            Mobi.ing(LS.orderSureMsg, 1);
                            setTimeout(function() {
                                    document.location.reload()
                                },
                                200)
                        } else {
                            Mobi.ing(m.msg)
                        }
                    }
                })
            };
            var f = {
                content: LS.orderConfirmMsg,
                callback: function() {
                    c(e, d)
                }
            };
            jm.ajax({
                type: "post",
                url: "ajax/order_h.jsp",
                data: "cmd=orderHasBeenSigned&id=" + d,
                error: function() {
                    Mobi.ing(LS.systemError)
                },
                success: function(j) {
                    var k = jm.parseJSON(j);
                    if (k.success) {
                        if (k.hasSigned) {
                            Mobi.ing(LS.orderSureMsg);
                            setTimeout(function() {
                                    document.location.reload()
                                },
                                200)
                        } else {
                            Mobi.prompt(f)
                        }
                    } else {
                        Mobi.ing(k.msg)
                    }
                }
            })
        })
};
Mobi.initOrderCancelButton = function(b) {
    var a = jm("#module" + b);
    a.find(".J-orderCancel").unbind().bind("click",
        function() {
            var h = jm(this),
                e = h.parent().parent(),
                d = h.attr("_oid");
            var c = function(k, j) {
                jm.ajax({
                    type: "post",
                    url: "ajax/order_h.jsp",
                    data: "cmd=setStatus&id=" + j + "&status=25",
                    error: function() {
                        Mobi.ing(LS.systemError)
                    },
                    success: function(l) {
                        var m = jm.parseJSON(l);
                        if (m.success) {
                            jm("#mobiPrompt").remove();
                            Mobi.ing(LS.orderCancel, 1);
                            setTimeout(function() {
                                    window.location.href = "mlist.jsp"
                                },
                                200)
                        } else {
                            Mobi.ing(m.msg)
                        }
                    }
                })
            };
            var f = {
                textClass: "confirm",
                content: LS.orderCancelMsg,
                callback: function() {
                    c(e, d)
                }
            };
            Mobi.prompt(f)
        })
};
Mobi.initOrderDeleteButton = function(b) {
    var a = jm("#module" + b);
    a.find(".J-orderDelete").unbind().bind("click",
        function() {
            var f = jm(this),
                d = f.attr("_oid");
            var c = function(h) {
                jm.ajax({
                    type: "post",
                    url: "ajax/order_h.jsp",
                    data: "cmd=memberDeleteOrder&id=" + h,
                    error: function() {
                        Mobi.ing(LS.systemError)
                    },
                    success: function(j) {
                        var k = jm.parseJSON(j);
                        if (k.success) {
                            jm("#mobiPrompt").remove();
                            Mobi.ing(LS.orderCancel, 1);
                            setTimeout(function() {
                                    window.location.href = "mlist.jsp"
                                },
                                200)
                        } else {
                            Mobi.ing(k.msg)
                        }
                    }
                })
            };
            var e = {
                textClass: "confirm",
                content: LS.orderDeleteMsg,
                callback: function() {
                    c(d)
                }
            };
            jm.ajax({
                type: "post",
                url: "ajax/order_h.jsp",
                data: "cmd=orderHasDelete&id=" + d,
                error: function() {
                    Mobi.ing(LS.systemError)
                },
                success: function(h) {
                    var j = jm.parseJSON(h);
                    if (j.success) {
                        if (j.hasDelete) {
                            Mobi.ing(LS.mallStlSubmitNotFound)
                        } else {
                            Mobi.prompt(e)
                        }
                    } else {
                        Mobi.ing(j.msg)
                    }
                }
            })
        })
};
Mobi.showShipDetails = function() {
    if (!Fai.top._shipList || !Fai.top._choiceCurrencyVal) {
        return
    }
    var j = jm("#shipValue").attr("shiptype");
    var a = Fai.top._shipList;
    var f = Fai.top._choiceCurrencyVal;
    var h = [];
    h.push("<div id='modifyShipDetails'  class='modifyShipDetails' style='background-color: inherit;'>");
    h.push("<div class='g_close' style='width: 100%;height: 100%;'></div>");
    h.push("<div class='profileContent'>");
    for (var c = 0; c < a.length; c++) {
        var b = a[c].show;
        if (b == 0) {
            continue
        }
        var d = a[c].type;
        var e = a[c].price;
        h.push("<div class='count_line wekitBox ShipItem'>");
        h.push("<div class='left J_shipName'>" + d + "</div>");
        h.push("<div class='flex1 J_shipPrice' value='" + e + "' shipType='" + c + "'>" + f + e + "</div>");
        h.push((j == c ? "<i class='faisco-icons-right g_color J_selectShip' style='height: 2.5rem;line-height: 2.5rem;float: right;margin-right: 0.15rem;'></i>": "<i class='faisco-icons-shape11' style='font-size: 1rem;height: 2.5rem;line-height: 2.5rem;float: right;'></i>"));
        h.push("</div>")
    }
    h.push("</div>");
    h.push("</div>");
    Mobi.changeShipType();
    return h.join("")
};
Mobi.showBanksDetails = function() {
    if (!Fai.top._banksList) {
        return
    }
    var a = Fai.top._banksList;
    var e = "<div id='modifyBankList'  class='modifyBankList'>";
    e += "<div class='BanksDetailHeader webHeaderBg'>";
    e += "<span class='g_close icon-gClose'></span><span class='title pageTitle'>" + LS.receAcctList;
    e += "</span></div>";
    e += "<div class='bankPanelDes'>" + LS.payTips + "</div>";
    e += "<div class='g_separator separatorLine'></div>";
    for (var d = 0; d < a.length; d++) {
        var f = a[d].acct,
            b = a[d].bank,
            c = a[d].name;
        leaveMsg = a[d].leaveMsg;
        e += "<div class='bankListArea'>";
        e += "<div class='bankList'>";
        e += "<table class='bankListTable'>";
        e += "<tbody>";
        e += "<tr>";
        e += "<td class='bankItemValue'>" + LS.orderDetailBank + "：" + b + "</td>";
        e += "</tr>";
        e += "<tr>";
        e += "<td class='bankItemValue'>" + LS.orderDetailBankName + "：" + c + "</td>";
        e += "</tr>";
        e += "<tr>";
        e += "<td class='bankItemValue'>" + LS.orderDetailBankAcct + "：" + f + "</td>";
        e += "</tr>";
        e += "<td class='bankItemValue bankLeaveMsg' colspan='2'>" + leaveMsg + "</td>";
        e += "</tr>";
        e += "</tbody>";
        e += "</table>";
        e += "</div>";
        e += "</div>";
        if (d != (a.length - 1)) {
            e += "<div class='g_breakline g_separator separatorLine'></div>"
        }
    }
    e += "</div>";
    Mobi.changeBankList();
    return e
};
Mobi.initOrderPopUpPanel = function() {
    var a = {
        triggerId: "editAddr",
        panelId: "editCusInfo",
        callback: function() {
            c("editCusInfo", "editAddr")
        },
        closeWebPage: "#editCusInfo .g_close"
    };
    if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000 && jm("#assignItemline").length > 0) {
        jm("#assignItemline").off("click.mall").on("click.mall",
            function() {
                jm("#linetitle1").click()
            })
    }
    Mobi.initWebPage(a);
    setTimeout(function() {
            jm("#editCusInfo").css("overflow-y", "auto");
            jm("#editCusInfo").css("height", "100%")
        },
        400);
    var b = {
        triggerId: "shipLine",
        pageHtml: Mobi.showShipDetails(),
        callback: function() {
            Mobi.showShipDetails()
        },
        closeWebPage: "#modifyShipDetails .g_close",
        direction: "bottom",
        pageBg: true
    };
    Mobi.initWebPage(b);
    b = {
        triggerId: "shipTplLine",
        panelId: "modifyShipTemplate",
        callback: function() {
            Mobi.changeShipType();
            c("modifyShipTemplate", "shipTplLine")
        },
        closeWebPage: "#modifyShipTemplate .g_close",
        direction: "bottom",
        pageBg: true
    };
    Mobi.initWebPage(b);
    b = {
        triggerId: "pay_line",
        pageHtml: Mobi.printOnlinePayType(Fai.top._payTypeList),
        callback: function() {
            c("pgListDiv", "pay_line")
        },
        closeWebPage: "#pgListDiv .g_close",
        direction: "bottom",
        pageBg: true
    };
    Mobi.initWebPage(b);
    b = {
        triggerId: "banks",
        panelId: "modifyBankList",
        pageHtml: Mobi.showBanksDetails(),
        callback: function() {
            Mobi.changeBankList();
            c("modifyBankList", "banks")
        },
        closeWebPage: "#modifyBankList .g_close"
    };
    Mobi.initWebPage(b);
    var b = {
        triggerId: "orderAddAddrInfo",
        panelId: "editAddrInfo",
        callback: function() {
            c("editAddrInfo", "orderAddAddrInfo")
        },
        closeWebPage: "#editAddrInfo .g_close"
    };
    Mobi.initWebPage(b);
    var b = {
        triggerId: "orderDetailProp",
        panelId: "editAddrInfo",
        closeWebPage: "#editAddrInfo .g_close"
    };
    Mobi.initWebPage(b);
    jm("#useItgLine .jz-switch").click(function() {
        var d = parseInt(jm("#useItg").attr("_maxUse"));
        if (jm(this).hasClass("jz-switch-checked")) {
            jm(this).removeClass("jz-switch-checked");
            jm("#useItg").val(0)
        } else {
            jm(this).addClass("jz-switch-checked");
            jm("#useItg").val(d)
        }
        jm("#useItg").trigger("change");
        Mobi.mallStlCalcTotal()
    });
    if (document.querySelector(".mall_allPrice") != null && document.querySelector("#mstlBtn") != null && !(Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000)) {
        if (document.querySelector(".mall_allPrice").offsetLeft == document.querySelector("#mstlBtn").offsetLeft) {
            jm(".orderSettle").css("margin-bottom", "5.8rem")
        }
    }
    function c(e, j) {
        if (e == "editCusInfo" || e == "editAddrInfo") {
            if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) {
                jm("#" + e).find("input,select,textarea").bind("blur",
                    function() {
                        document.querySelector("body").scrollTop = 0
                    });
                jm("#" + e).find("input,select,textarea").bind("focus",
                    function() {
                        jm("#" + e).attr("ontouchmove", "return false;")
                    }).bind("blur",
                    function() {
                        jm("#" + e).parent().css("position", "fixed");
                        jm("#" + e).css("position", "");
                        jm("#" + e).removeAttr("ontouchmove")
                    });
                jm("#areaBox").bind("touchmove",
                    function(l) {
                        l.preventDefault()
                    });
                jm("#areaBox .J_areaHead").bind("touchmove",
                    function(l) {
                        l.preventDefault()
                    });
                jm("#areaBox1").bind("touchmove",
                    function(l) {
                        l.stopPropagation()
                    });
                jm("#areaBox2").bind("touchmove",
                    function(l) {
                        l.stopPropagation()
                    })
            }
        }
        var f = Fai.top.document.querySelector("#" + e);
        var d = Fai.top.document.querySelector("#webPagePanel" + j);
        window.ontouchmove = function(n) {
            if (f.scrollHeight == f.offsetHeight && jm(d).css("display") != "none") {
                var m = n.target;
                var l = (jm(m).parents(".areaBox").length > 0 || jm(m).parents(".areaBox2").length > 0);
                if (!l) {
                    n.preventDefault()
                }
            }
        };
        var h = 1;
        requestAnimationFrame(function k() {
            f = Fai.top.document.querySelector("#" + e);
            var m = 0,
                l = f.scrollHeight - f.clientHeight;
            if ((l - m) == h) {
                h = 0.5
            }
            var n = f.scrollTop;
            if (n === m) {
                f.scrollTop += h
            } else {
                if (n === l) {
                    f.scrollTop -= h
                }
            }
            requestAnimationFrame(k)
        })
    }
};
Mobi.seeMoreGoodsInOrder = function() {
    jm(".moreGoods").toggle();
    jm(".smText1").toggle();
    jm(".smText2").toggle()
};
Mobi.seeMoreItemsInOrderList = function(a) {
    jm(".moreGoods" + a).toggle();
    jm(".smText1" + a).toggle();
    jm(".smText2" + a).toggle()
};
Mobi.changePayMode = function(b, a) {
    commentOption = {
        triggerId: "morePayMode",
        pageHtml: c(a),
        callback: function() {},
        closeWebPage: "#pgListDiv .g_close",
        direction: "bottom",
        pageBg: true
    };
    Mobi.initWebPage(commentOption);
    function c(d) {
        var f = jm("#morePayMode").attr("_paymode");
        var e = [];
        e.push("<div class='pgListDiv' id='pgListDiv' style='background-color: inherit;'>");
        e.push("<div class='g_close' style='width: 100%;height: 100%;'></div>");
        e.push("<div id='onlinePayType' class='pgDetail onlinePayType'>");
        e.push("<div id='pgBox' class='pgBox' style='position: fixed;bottom: 0;'>");
        jm.each(d,
            function(h) {
                var k = d[h];
                if (!k.desc) {
                    return true
                }
                e.push("<div id=group_" + k.payMode + " class='line'>");
                var j = "";
                if (k.payMode == 10 || k.payMode == 11) {
                    j = " _appId='" + k.appId + "' "
                }
                e.push("<div class='pgBoxItem'><span class='icon-payMode payMode" + k.payMode + "'></span><a class='pgName payMode'  onclick='Mobi.changePayModeEvent(this);' _orderId='" + b + "'" + j + " _payMode='" + k.payMode + "' _name='" + k.desc + "'>" + k.desc + "</a>" + (f == k.payMode ? "<i class='faisco-icons-right g_color J_selectPay' style='height: 2.5rem;line-height: 2.5rem;margin-left: 0.1rem;'></i>": "<i class='faisco-icons-shape11' style='font-size: 1rem;height: 2.5rem;line-height: 2.5rem;'></i>") + "</div>");
                e.push("</div>")
            });
        e.push("</div></div></div>");
        return e.join("")
    }
};
Mobi.changePayModeEvent = function(e) {
    var k = jm(e).attr("_payMode"),
        d = jm(e).attr("_orderId"),
        c = {};
    if (!isNaN(k)) {
        k = parseInt(k)
    }
    c.payMode = k;
    var a = window.location.href,
        j = "",
        b = "";
    if (a.indexOf("lcid") > 0) {
        var h = Mobi.getUrlParam(a, "lcid");
        if (h) {
            j += "&lcid=" + h;
            b = Mobi.getLanCodeFromLcid(h);
            b = b ? "/" + b + "/": ""
        }
    }
    jm.ajax({
        type: "post",
        url: "ajax/order_h.jsp?cmd=setOrder" + j,
        data: "id=" + d + "&info=" + jm.toJSON(c),
        dataType: "json",
        error: function() {
            Mobi.ing(LS.mallStlSubmitError)
        },
        success: function(l) {
            if (l.success) {
                var o = false;
                if (k == 10 || k == 11) {
                    o = true
                }
                var m = f(o);
                if (m) {
                    var n;
                    if (k == 3) {
                        n = b + "tenpay.jsp?orderId=" + d
                    } else {
                        if (k == 4 || k == 5 || k == 6 || k == 8 || k == 12 || k == 13) {
                            n = b + "alipay.jsp?orderId=" + d
                        } else {
                            if (k == 7) {
                                n = b + "paypal.jsp?orderId=" + d
                            } else {
                                if (k == 9) {
                                    n = b + "cbpay.jsp?orderId=" + d
                                } else {
                                    if (k == 10 || k == 11) {
                                        n = "/wxPay/mdetail.jsp?id=" + d + j
                                    } else {
                                        document.location.reload();
                                        return
                                    }
                                }
                            }
                        }
                    }
                    if (n.indexOf("#") >= 0) {
                        n = n.substring(0, n.indexOf("#"))
                    }
                    document.location.href = n
                }
            } else {
                Mobi.ing(l.msg)
            }
        }
    });
    function f(m) {
        var l = true;
        jm.ajax({
            type: "post",
            url: "ajax/order_h.jsp?cmd=checkOrder",
            data: "orderId=" + d + "&isWX=" + m,
            async: false,
            dataType: "json",
            error: function() {
                Mobi.ing(LS.mallStlSubmitError)
            },
            success: function(n) {
                if (!n.success) {
                    l = false;
                    if (n.rt == -3) {
                        Mobi.ing(LS.mallStlSubmitNotFound)
                    } else {
                        if (n.rt == -9) {
                            Mobi.ing(LS.mallStlSubmitStatusError)
                        } else {
                            if (n.rt == Mobi.MallAjaxErrno.mallAmountZero) {
                                Mobi.ing(jm.format(LS.oAmountIsZero))
                            } else {
                                if (n.rt == Mobi.MallAjaxErrno.outOfMallAmount) {
                                    Mobi.ing(jm.format(LS.outOfMallAmount))
                                } else {
                                    if (n.rt == Mobi.MallAjaxErrno.OutOfAllowAmount) {
                                        Mobi.ing(jm.format(LS.allowAmountOverNameList, Mobi.encodeHtml(n.productsName)))
                                    } else {
                                        if (n.rt == Mobi.MallAjaxErrno.payDomainError) {
                                            Mobi.ing(jm.format(LS.mallPayDomainError))
                                        } else {
                                            if (n.rt == Mobi.MallAjaxErrno.notAdded) {
                                                Mobi.ing(jm.format(LS.mallProductNotAdded))
                                            } else {
                                                Mobi.ing(LS.mallStlSubmitError)
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        });
        return l
    }
};
Mobi.jumpToProductDetail = function(b, a) {
    if (window.sessionStorage) {
        window.sessionStorage._isJumpFromMlist = true;
        window.sessionStorage._jumpMlistUrl = window.location.href;
        if (a == 1 && Mobi.checkWindowSeStgValue(window.sessionStorage._commClickItemId)) {
            window.sessionStorage._commClickItemId = false
        }
    }
    window.location.href = "pd.jsp?pid=" + b
};
Mobi.setWebContainerBoxShow = function() {
    setTimeout(function() {
            jm("#footer").css("visibility", "visible");
            jm("#cusInfo").css("visibility", "visible");
            window.sessionStorage._backFromProDetail = false
        },
        500)
};
Mobi.checkWindowSeStgValue = function(a) {
    if (a && a != "false") {
        return true
    }
    return false
};
Mobi.selectedOrderStatus = function(c, b) {
    var a = jm("#module" + c);
    a.find(".orderStatusSelectDiv").click(function() {
        a.find(".orderStatusSelectDiv").addClass("oderStatusDivFontColor").removeClass("g_color").removeClass("g_bdColor").removeClass("orderStatusBeenSelected");
        var e = jm(this);
        var d = e.attr("status");
        e.removeClass("oderStatusDivFontColor").addClass("g_bdColor").addClass("g_color").addClass("orderStatusBeenSelected");
        Mobi.shanghuaLoading.initOrderListByStatus(c, b, d)
    })
};
Mobi.clickForSelectedOrderStatus = function(b, c) {
    var a = jm("#module" + b);
    a.find(".J-" + c).removeClass("oderStatusDivFontColor").addClass("g_color").addClass("g_bdColor").addClass("orderStatusBeenSelected")
};
Mobi.initCommentBtn = function(d, a) {
    var c = jm("#module" + d),
        b = jm("#g_web");
    c.find(".J-comment").unbind().bind("click",
        function() {
            document.body.style.overflow = "hidden";
            var k = jm(this),
                f = k.attr("_oid");
            if (window.sessionStorage) {
                window.sessionStorage._commClickOrderId = f
            }
            var h = jm("#pd-ct-panel" + f);
            if (h.length > 0) {
                h.css("margin-left", 0);
                return
            }
            var e = false;
            if (window.sessionStorage) {
                if (Mobi.checkWindowSeStgValue(window.sessionStorage._backFromProDetail)) {
                    e = true
                }
            }
            var j = {
                oid: f,
                marginFlag: e
            };
            jm.ajax({
                type: "post",
                url: "ajax/order_h.jsp?cmd=getCtPanel",
                data: j,
                success: function(l) {
                    var m = jm.parseJSON(l);
                    if (m.success == false) {
                        Mobi.ing(m.msg);
                        return
                    }
                    h = jm(m.html);
                    b.append(h);
                    setTimeout(function() {
                            h.css("margin-left", 0)
                        },
                        100);
                    h.bind("scroll",
                        function(n) {
                            n.stopPropagation();
                            n.cancelBubble = true
                        });
                    h.find(".loginHeader .g_close").eq(0).click(function() {
                        if (h.find(".J-ct-item").length == 0) {
                            k.removeClass("orderButton").addClass("comment-txt  orderButtonHas orderButton").text(LS.commentExist)
                        }
                        _hidePanel("pd-ct-panel" + f)
                    });
                    h.find(".J-ct-item").click(function() {
                        document.body.style.overflow = "hidden";
                        var r = jm(this),
                            q = r.attr("_iid"),
                            o = r.attr("_pid");
                        if (window.sessionStorage) {
                            window.sessionStorage._commClickItemId = q
                        }
                        var p = jm("#pd-item-" + f + "-" + q);
                        if (p.length > 0) {
                            p.css("margin-left", 0);
                            var n = p.find(".J-ct-area");
                            if (typeof(n) != "undefined" && n != null && n.length > 0) {
                                n[0].focus()
                            }
                            return
                        }
                        _initItemCommentPanel(f, q, r, h, o)
                    });
                    h.find(".loginHeader.webHeaderBg").click(function() {
                        document.body.style.overflow = "scroll"
                    });
                    if (window.sessionStorage) {
                        if (Mobi.checkWindowSeStgValue(window.sessionStorage._commClickItemFlag)) {
                            Mobi.checkWindowSeStgValue(window.sessionStorage._commClickItemFlag);
                            if (Mobi.checkWindowSeStgValue(window.sessionStorage._commClickItemId)) {
                                setTimeout(function() {
                                        jm(".J-ct-item[_iid='" + window.sessionStorage._commClickItemId + "']").click()
                                    },
                                    30)
                            }
                            window.sessionStorage._commClickItemFlag = false
                        }
                    }
                }
            })
        });
    if (window.sessionStorage) {
        if (Mobi.checkWindowSeStgValue(window.sessionStorage._backFromProDetail)) {
            if (Mobi.checkWindowSeStgValue(window.sessionStorage._commClickOrderId)) {
                setTimeout(function() {
                        jm(".J-comment[_oid='" + window.sessionStorage._commClickOrderId + "']").click();
                        window.sessionStorage._commClickItemFlag = true;
                        Mobi.setWebContainerBoxShow()
                    },
                    120)
            }
        } else {
            Mobi.setWebContainerBoxShow()
        }
    } else {
        Mobi.setWebContainerBoxShow()
    }
    _hidePanel = function(e) {
        jm("#" + e).css("margin-left", "")
    };
    _initItemCommentPanel = function(o, w, h, r, t) {
        var s = h.attr("_iprice"),
            z = h.attr("_iname"),
            p = h.attr("_ipath"),
            A = h.attr("_maxlen"),
            q = h.attr("_minlen"),
            m = h.attr("_showflag"),
            f = h.attr("_comment"),
            x = h.attr("_pathList"),
            B = h.attr("_star");
        var C = "' class='ct-panel order-ext-panel'>";
        if (window.sessionStorage) {
            if (Mobi.checkWindowSeStgValue(window.sessionStorage._backFromProDetail)) {
                C = "' class='ct-panel order-ext-panel' style='margin-left:0;'>";
                window.sessionStorage._backFromProDetail = false
            }
        }
        if (typeof(m) != "undefined" && m != null) {
            if (typeof(x) != "undefined" && x != null) {
                x = jm.parseJSON(x)
            }
            var v = [];
            var u = "";
            if (typeof(x) != "undefined" && x != null && x.length > 0) {
                v.push("<div class='ct-s-content-m'>");
                v.push("<table>");
                v.push("<tr>");
                for (var n = 0; n < x.length; n++) {
                    v.push("<td class='s-img-f-tb'>");
                    v.push("<table class='s-img-tb' cellpadding='0' cellspacing='0'>");
                    v.push("<tr>");
                    v.push("<td class='s-img-bd' valign='middle'   align='center'>");
                    v.push("<img src='" + x[n].path + "'  class='s-img-set'>");
                    v.push("</td>");
                    v.push("</tr>");
                    v.push("</table>");
                    v.push("</td>")
                }
                v.push("</tr>");
                v.push("</table>");
                v.push("</div>")
            }
            if (v != "[]") {
                u = v.join("")
            }
            var k = [];
            if (a) {
                k.push("<div class='l-comm-star'>");
                for (var y = 0; y < 5; y++) {
                    if (y < B) {
                        k.push("<li class='faisco-icons-star3 select_more'></li>")
                    } else {
                        k.push("<li class='faisco-icons-star3 select_less'></li>")
                    }
                }
                k.push("</div>")
            }
            var e = ["<div id='pd-item-", o, "-", w, C, "<div class='loginHeader webHeaderBg'>", "<span class='g_close icon-gClose'></span>", "<span class='title  pageTitle' style='padding-right:0px;'>", LS.commentPub, "</span>", "<span class='homeIcon icon-homeIcon' onclick='window.location.href=\"index.jsp\"'></span>", "</div>", "<div class='l-comm-item'>", "<div class='d-click' onclick=Mobi.jumpToProductDetail('" + t + "',2)></div>", "<div class='i-block1 i-block1-w'>", "<img class='b-comm-img' src='", p, "' alt=''/>", "</div>", "<div class='i-block2'>", "<div class='pd-n pd-n-p' >", jm.encodeHtml(z), "</div>", "</div>", "</div>", "<div class='l-s-item'>", "<div class='tipImg'>", "</div>", "<div class='ct-s-content'>", f, "</div>", u, k.join(""), "</div>", "</div>", ];
            e = jm(e.join(""));
            b.append(e);
            setTimeout(function() {
                    e.css("margin-left", 0);
                    var F = e.find(".ct-s-content-m");
                    if (typeof(F) != "undefined" && F != null) {
                        for (var G = 0; G < F.length; G++) {
                            var E = F.eq(G)[0].querySelectorAll("img");
                            if (typeof(E) != "undefined" && E != null && E.length > 0) {
                                Mobi.bindCommImgShow(E, false, 0)
                            }
                        }
                    }
                },
                100);
            e.bind("scroll",
                function(E) {
                    E.stopPropagation();
                    E.cancelBubble = true
                });
            e.find(".loginHeader .g_close").eq(0).click(function() {
                _hidePanel("pd-item-" + o + "-" + w)
            })
        } else {
            var l = 5;
            if (typeof(_commUploadImgParam) != "undefined" && _commUploadImgParam != null) {
                l = _commUploadImgParam.upImgMaxNum
            }
            var k = [];
            if (a) {
                k = ["<div class='l-star-list J-star-list'>", "<li class='faisco-icons-star3'></li>", "<li class='faisco-icons-star3'></li>", "<li class='faisco-icons-star3'></li>", "<li class='faisco-icons-star3'></li>", "<li class='faisco-icons-star3'></li>", "<li class='score-tip'></li>", "</div>"]
            }
            var e = ["<div id='pd-item-", o, "-", w, C, "<div class='loginHeader webHeaderBg'>", "<span class='g_close icon-gClose'></span>", "<span class='title  pageTitle' style='padding-right:0px;'>", LS.commentPub, "</span>", "<span class='homeIcon icon-homeIcon' onclick='window.location.href=\"index.jsp\"'></span>", "</div>", "<div class='l-comm-item'>", "<div class='d-click'  onclick=Mobi.jumpToProductDetail('" + t + "',2)></div>", "<div class='i-block1 i-block1-w'>", "<img class='b-comm-img' src='", p, "' alt=''/>", "</div>", "<div class='i-block2'>", "<div class='pd-n pd-n-p'>", jm.encodeHtml(z), "</div>", "</div>", "</div>", k.join(""), "<div class='l-area-item'>", "<div class='tipImg'></div>", "<textarea class='J-ct-area g_textArea comm_input' placeholder='", LS.commentUpInTip, "' minlength='", q, "' maxlength='", A, "'></textarea>", "</div>", "<div class='img-area-item'>", "<table cellpadding='0' cellspacing='0' id='msg_add_img_tb_" + _commUploadImgParam.countNumber + "' >", "<tr>", "<td id='msgBoardAddImgBtn_" + _commUploadImgParam.countNumber + "' class='comm-find-tb' maxNum='" + l + "'> ", "<div  id='comm-img-swfu-placeholder-" + _commUploadImgParam.countNumber + "'>", "</td> ", "</tr>", "</table>", "</div>", "<div class='l-sb-item'>", "<div class='J-ct-submit g_button'>", LS.commentSumit, "</div>", "</div>", "</div>", ];
            e = jm(e.join(""));
            b.append(e);
            Mobi.setStarSelect();
            setTimeout(function() {
                    e.css("margin-left", 0)
                },
                100);
            if (_commUploadImgParam.isIE == "true") {
                var j = _commUploadImgParam.countNumber;
                Mobi.mobiCommUploadImgSWF("comm-img-swfu-placeholder-" + _commUploadImgParam.countNumber, _commUploadImgParam.upImgMaxSize, _commUploadImgParam.imgType, _commUploadImgParam.upImgMaxNum, j)
            } else {
                Mobi.mobiCommUploadImgHtml("comm-img-swfu-placeholder-" + _commUploadImgParam.countNumber, _commUploadImgParam.upImgMaxSize, _commUploadImgParam.imgType, _commUploadImgParam.siteMainDomain)
            }
            e.bind("scroll",
                function(E) {
                    E.stopPropagation();
                    E.cancelBubble = true
                });
            e.find(".loginHeader .g_close").eq(0).click(function() {
                _hidePanel("pd-item-" + o + "-" + w)
            });
            var D = e.find(".J-ct-area");
            if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) {
                jm(".J-ct-area").bind("focus",
                    function() {
                        jm("#pd-item-" + o + "-" + w).css("position", "absolute");
                        jm("body").attr("ontouchmove", "return false;")
                    }).bind("blur",
                    function() {
                        jm("#pd-item-" + o + "-" + w).css("position", "");
                        jm("body").removeAttr("ontouchmove")
                    })
            }
            e.find(".J-ct-submit").click(function() {
                if (Fai.top._manageMode) {
                    Mobi.ing("您目前处于网站管理状态，请先退出再登录");
                    return
                }
                var M = jm.trim(D.val());
                if (typeof(M) != "string" || "" == M) {
                    D[0].focus();
                    Mobi.ing(LS.commentNotEmpty);
                    return
                }
                var K = e.find(".img-area-item").find("img");
                var F = [];
                if (typeof(K) != "undefined" && K != null) {
                    var I = K.length;
                    if (I > 0) {
                        for (var J = 0; J < I; J++) {
                            var O = K.eq(J);
                            if (O != null && O != "undefined") {
                                var G = {};
                                var E = O.attr("_id");
                                var P = O.attr("_name");
                                var N = O.attr("_file_size");
                                var Q = O.attr("_file_id");
                                G.imgId = E;
                                G.imgName = P;
                                G.imgSize = N;
                                G.tempFileId = Q;
                                F.push(G)
                            }
                        }
                    }
                }
                var L = jm(".J-star-list").attr("_star");
                if (!L) {
                    L = 5
                }
                var H = {
                    oid: o,
                    iid: w,
                    commImgList: JSON.stringify(F),
                    comment: M,
                    star: L
                };
                jm.ajax({
                    type: "post",
                    url: "ajax/order_h.jsp?cmd=addPC",
                    data: H,
                    error: function() {
                        Mobi.ing(LS.systemError)
                    },
                    success: function(R) {
                        var T = jm.parseJSON(R);
                        if (T.success) {
                            Mobi.ing(LS.submitSuccess);
                            pdItem = r.find(".J-l-item-" + w);
                            pdItem.find(".J-ct-item").remove();
                            pdItem.append("<div class='orderButton' _star=" + L + " _iid=" + w + " _iprice='" + s + "' _ipath='" + p + "' _showFlag='check'  _iname='" + z + "' _pid='" + t + "'  _comment='" + jm.encodeHtml(M) + "' _pathList='" + JSON.stringify(T.imgsPathStr) + "'>" + LS.commentView + "</div>");
                            pdItem.find(".orderButton").click(function() {
                                var Y = jm(this),
                                    X = Y.attr("_iid"),
                                    V = Y.attr("_pid");
                                var W = jm("#pd-item-" + o + "-" + X);
                                if (W.length > 0) {
                                    W.css("margin-left", 0);
                                    var U = W.find(".J-ct-area");
                                    if (typeof(U) != "undefined" && U != null && U.length > 0) {
                                        U[0].focus()
                                    }
                                    return
                                }
                                _initItemCommentPanel(o, X, Y, r, V)
                            });
                            e.remove()
                        } else {
                            var S = "";
                            switch (T.rt) {
                                case 1:
                                    S = LS.commentError;
                                    break;
                                case 2:
                                    S = LS.mallStlSubmitNotFound;
                                    break;
                                case 3:
                                    S = LS.commentError;
                                    break;
                                case 5:
                                    S = LS.paramError;
                                    break;
                                case 7:
                                    S = LS.commentClosed;
                                    break;
                                case 8:
                                    S = LS.commentExist;
                                    break;
                                case 9:
                                    S = LS.commentCountLimit;
                                    break;
                                default:
                                    S = LS.systemError;
                                    break
                            }
                            Mobi.ing(S)
                        }
                    }
                })
            })
        }
    }
};
Mobi.initcommUploadImgParam = function(c, d, j, k, f, h, l, b) {
    _commUploadImgParam = {
        upImgMaxSize: c,
        imgType: d,
        upImgMaxNum: j,
        jsJquery: k,
        jsUpload: f,
        countNumber: 2,
        swfUpload: l,
        isIE: b,
        swfObjList: [],
        siteMainDomain: h
    };
    var a = document.createElement("script");
    a.type = "text/javascript";
    a.src = k;
    a.onload = function() {
        var m = document.createElement("script");
        if (b == "true") {
            m.src = l
        } else {
            m.src = f
        }
        m.type = "text/javascript";
        e.appendChild(m)
    };
    var e = document.documentElement || document.body;
    e.appendChild(a)
};
Mobi.showSingalInstCommImg = function(b) {
    var a = jm("#msg_add_img_tb_" + b).eq(0)[0].querySelectorAll("img");
    if (typeof(a) != "undefined" && a != null && a.length > 0) {
        Mobi.bindCommImgShow(a, true, b)
    }
};
Mobi.mobiCommUploadImgSWF = function(d, b, h, a, f) {
    var e = h.split(",");
    var c = {
        file_post_name: "Filedata",
        upload_url: "/ajax/commUpsiteimg_h.jsp",
        button_placeholder_id: d,
        file_size_limit: b + "MB",
        button_image_type: 3,
        file_queue_limit: 1,
        button_width: "50px",
        button_height: "50px",
        button_cursor: SWFUpload.CURSOR.HAND,
        button_image_url: _resRoot + "/image/mobi/msgUpImg/upload.png",
        requeue_on_error: false,
        post_params: {
            ctrl: "Filedata",
            app: 21,
            type: 0,
            fileUploadLimit: a
        },
        file_types: e.join(";"),
        file_dialog_complete_handler: function(j) {
            this._allSuccess = false;
            this.startUpload()
        },
        file_queue_error_handler: function(k, j, l) {
            switch (j) {
                case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:
                    Mobi.ing(LS.mobiFormSubmitCheckFileSizeErr, true);
                    break;
                case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:
                    Mobi.ing(LS.mobiFormSubmitFileUploadNotAllow, true);
                    break;
                case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadOneTimeNum, "1"), true);
                    break;
                default:
                    Mobi.ing(LS.mobiFormSubmitFileUploadReSelect, true);
                    break
            }
        },
        upload_success_handler: function(k, j) {
            var l = jQuery.parseJSON(j);
            this._allSuccess = l.success;
            this._sysResult = l.msg;
            if (l.success) {
                setTimeout(function() {
                        Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSucess, jm.encodeHtml(k.name)), true)
                    },
                    1800);
                Mobi.onCommFileUploadEvent("upload", l, f)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadFile + k.name + "   " + l.msg)
            }
        },
        upload_error_handler: function(k, j, l) {
            if (j == -280) {
                Mobi.ing(LS.mobiFormSubmitFileUploadFileCancle, false)
            } else {
                if (j == -270) {
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadFileExist, jm.encodeHtml(k.name)), true)
                } else {
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSvrBusy, jm.encodeHtml(k.name)))
                }
            }
        },
        upload_complete_handler: function(j) {
            if (j.filestatus == SWFUpload.FILE_STATUS.COMPLETE) {
                if (typeof(_commUploadImgParam.swfObjList) == "undefined") {
                    _commUploadImgParam.swfObjList = []
                }
                swfObj = _commUploadImgParam.swfObjList[f];
                setTimeout(function() {
                        swfObj.startUpload()
                    },
                    swfObj.upload_delay)
            } else {
                if (j.filestatus == SWFUpload.FILE_STATUS.ERROR) {
                    Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSvrBusy, jm.encodeHtml(j.name)))
                }
            }
        },
        upload_start_handler: function(j) {
            Mobi.ing(LS.mobiFormSubmitFileUploadPrepare, false)
        },
        view_progress: function(j, m, l, k) {
            var k = Math.ceil((m / l) * 100);
            if (isNaN(k)) {
                return
            }
            if (k == 100) {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + k + "%", true)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + k + "%", false)
            }
        }
    };
    if (typeof(_commUploadImgParam.swfObjList) == "undefined") {
        _commUploadImgParam.swfObjList = []
    }
    _commUploadImgParam.swfObjList[f] = SWFUploadCreator.create(c);
    _commUploadImgParam.countNumber++
};
Mobi.mobiCommUploadImgHtml = function(h, c, d, f) {
    var a = d.split(",");
    var k = _commUploadImgParam.countNumber;
    var j = {
        siteFree: false,
        updateUrlViewRes: "",
        auto: true,
        fileTypeExts: a.join(";"),
        multi: false,
        fileSizeLimit: c * 1024 * 1024,
        breakPoints: true,
        saveInfoLocal: false,
        showUploadedPercent: true,
        removeTimeout: 9999999,
        getFileSizeUrlFlag: true,
        post_params: {
            app: 21,
            type: 0,
            fileUploadLimit: c,
            isSiteForm: true
        },
        isOrnotButton: true,
        buttonText: "",
        uploader: "http://" + f + '/ajax/commUpsiteimg_h.jsp?cmd="mobiUpload"',
        onUploadStart: function(m) {
            _uTime = new Date().getTime()
        },
        onUploadSuccess: function(n, p) {
            var o = jm.parseJSON(p);
            if (o.success) {
                var m = {
                    status: "end",
                    id: n.id,
                    title: "上传成功。"
                };
                e(m);
                setTimeout(function() {
                        Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSucess, jm.encodeHtml(n.name)), true)
                    },
                    1800);
                Mobi.onCommFileUploadEvent("upload", o, k)
            } else {
                var m = {
                    status: "end",
                    id: n.id,
                    title: o.msg
                };
                e(m);
                Mobi.ing(LS.mobiFormSubmitFileUploadFile + n.name + "   " + o.msg)
            }
        },
        onUploadError: function(m, n) {
            jm("#progressBody_ " + m.id).remove();
            jm("#progressWrap_" + m.id).remove();
            Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSvrBusy, jm.encodeHtml(m.name)));
            _uTime = new Date().getTime() - _uTime
        },
        view_progress: function(m) {
            var m = Math.ceil(m);
            if (isNaN(m)) {
                return
            }
            if (m == 100) {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + m + "%", true)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + m + "%", false)
            }
        }
    };
    function e(m) {
        if (isNaN(Math.round(m.percent))) {
            return
        }
        if (m.status == "start") {
            var n = ['<div id="progressBody_' + m.id + '" class="bodyDisable"></div>', '<div id="progressWrap_' + m.id + '" class="bodyProgressWrap">', '<div class="progressCenter"></div>', '<div class="progressIngBody">', '<div id="progressTitle' + m.id + '" class="progressIngTitle">' + m.title + "</div>", '<div class="progressIngMission">', '<div class="mission"><div id="progress' + m.id + '" class="progress" style="width:1%;"></div></div>', '<div id="progressNum' + m.id + '" class="progressNum">0%</div>', "</div>", '<div class="progressInfo"><span id="progressTips' + m.id + '" class="progressFileSize"></span><a class="progressCancel" href="javascript:uploadCancel(\'' + m.id + "');\">取消</a></div>", "</div>", "</div>"];
            jm("body").append(n.join(""))
        } else {
            if (m.status == "ing") {
                jm("#progressTitle" + m.id).text(m.title);
                jm("#progress" + m.id).css("width", Math.round(m.percent) + "%");
                jm("#progressNum" + m.id).html(Math.round(m.percent) + "%")
            } else {
                if (m.status == "end") {
                    jm("#progressTitle" + m.id).text(m.title);
                    jm("#progressBody_" + m.id).remove();
                    jm("#progressWrap_" + m.id).remove()
                } else {
                    if (m.status == "error") {
                        jm("#progress" + m.id).addClass("progressError")
                    }
                }
            }
        }
    }
    upload = jm("#" + h).uploadify(j);
    var l = "file_upload_" + _commUploadImgParam.countNumber;
    var b = "select_btn_" + _commUploadImgParam.countNumber;
    jm("#file_upload_1-button").attr("id", l);
    jm("#select_btn_1").attr("id", b);
    _commUploadImgParam.countNumber++
};
Mobi.onCommFileUploadEvent = function(l, h, d) {
    if (l == "upload") {
        var c = h.id;
        var k = h.name;
        var f = h.size;
        var e = h.path;
        var m = h.pathSmall;
        var b = h.fileId;
        var a = h.width;
        var j = h.height;
        Mobi.mListCommImgTableCtrl(e, k, c, f, b, d)
    }
};
Mobi.mListCommImgTableCtrl = function(m, a, b, j, d, h) {
    var k = $("#msg_add_img_tb_" + h).eq(0);
    var l = k.find(".comm-find-tb").length;
    var e = k.find(".comm-find-tb").eq(l - 1);
    var c = e.attr("maxNum");
    if (parseInt(l - 1) >= c) {
        return
    }
    var f = [];
    f.push("<td  class='comm-find-tb'>");
    f.push("<table style='width:100%; height:100%; table-layout:fixed;' cellpadding='0'  cellspacing='0'>");
    f.push(" <tr>");
    f.push("    <td valign='middle'   align='center' class='comm-show-td-bd'>");
    f.push("      <img src='" + m + "'  alt=''  _name='" + a + "' _id='" + b + "' _file_size='" + j + "' _file_id='" + d + "' class='comm-up-set'>");
    f.push("     </td>");
    f.push(" </tr>");
    f.push("</table>");
    f.push("<div class='comm-up-div'>");
    f.push("  <span onclick=Mobi.mListCommTableImgDelete(this,'" + h + "') class='comm-up-div-set'/>");
    f.push("</div>");
    f.push("</td>");
    e.before(f.join(""));
    l = k.find(".comm-find-tb").length;
    if (parseInt(l - 1) >= c) {
        e.css("display", "none")
    }
    Mobi.showSingalInstCommImg(h)
};
Mobi.mListCommTableImgDelete = function(a, c) {
    var e = jm("#msg_add_img_tb_" + c).eq(0);
    var b = e.find(".comm-find-tb").length;
    for (var d = 0; d < b; d++) {
        if (e.find(".comm-find-tb").eq(d).find(".comm-up-div-set")[0] === a) {
            e.find(".comm-find-tb").eq(d).remove();
            break
        }
    }
    b = e.find(".comm-find-tb").length;
    var f = e.find(".comm-find-tb").eq(b - 1);
    if (b <= f.attr("maxNum")) {
        f.css("display", "block")
    }
    Mobi.showSingalInstCommImg(c)
};
Mobi.calculate = function(j, f, k) {
    var m = 0,
        d = 0,
        b = 0;
    try {
        d = j.toString().split(".")[1].length
    } catch(c) {
        d = 0
    }
    try {
        b = f.toString().split(".")[1].length
    } catch(c) {
        b = 0
    }
    switch (k) {
        case 0:
            var l = Math.pow(10, Math.max(d, b));
            m = (j * l + f * l) / l;
            break;
        case 1:
            var a;
            var l = Math.pow(10, Math.max(d, b));
            a = (d >= b) ? d: b;
            m = ((j * l - f * l) / l).toFixed(a);
            break;
        case 2:
            m = h(j, f);
            break;
        case 3:
            m = h((Number(j.toString().replace(".", "")) / Number(f.toString().replace(".", ""))), Math.pow(10, b - d));
            break
    }
    return m;
    function h(p, n) {
        var o = 0;
        try {
            o += p.toString().split(".")[1].length
        } catch(q) {}
        try {
            o += n.toString().split(".")[1].length
        } catch(q) {}
        return Number(p.toString().replace(".", "")) * Number(n.toString().replace(".", "")) / Math.pow(10, o)
    }
};
Mobi.mallProductDetailFixedBar = function() {
    if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
        jm("#fixedAreaBox").find(".productMallShop").remove();
        jm(".productMallShop").appendTo(jm("#fixedAreaBox"));
        var c = Fai.top._onlineServiceJson.phone,
            f = Fai.top._onlineServiceJson.qq,
            b = Fai.top._onlineServiceJson.baiduBridge;
        var e = c && c.phoneInfo && c.phoneInfo.length > 0,
            d = f && f.qqInfo && f.qqInfo.length > 0,
            a = b > 0;
        jm("#serviceBtnOuter").show()
    }
};
Mobi.refreshMallCartNum = function() {
    jm.ajax({
        type: "post",
        url: "ajax/order_h.jsp?cmd=getMallCartProductNum",
        data: "",
        success: function(a) {
            var c = jm.parseJSON(a);
            if (c.success) {
                if (c.rt == 1) {
                    var b = jm.trim(c.productAmount);
                    b = (b > 99) ? "99+": b;
                    jm("#mallCartIcon .proNum").text("(" + b + ")")
                }
            }
        }
    })
};
Mobi.initRefundDetail = function(b, h, d, f) {
    jm("#backToRemark").click(function() {
        jm("#editRemark").hide();
        jm("#remarkListContainer").show()
    });
    jm("#leaveMsgBtn").click(function() {
        jm("#remarkListContainer").hide();
        jm("#editRemark").show()
    });
    jm("#showRemark").click(function() {
        jm("#refundDetail").hide();
        jm("#remarkListContainer").show()
    });
    jm("#backToDetail").click(function() {
        jm("#remarkListContainer").hide();
        jm("#refundDetail").show()
    });
    jm("#refundEditFlow").click(function() {
        jm("#refundDetail").hide();
        jm("#refundFlowEditContainer").show()
    });
    jm("#flowBackToDetail").click(function() {
        jm("#refundFlowEditContainer").hide();
        jm("#refundDetail").show()
    });
    jm(".J_delBtn").on("click.delRefundIcon",
        function() {
            jm(this).parent().remove();
            jm("#uploadRefundPicBtn").css("display", "inline-block")
        });
    var e = false;
    jm("#submitRemark").click(function() {
        if (e) {
            return
        }
        var j = jm("#refundRemarkArea").val();
        if (j.length > 200) {
            Mobi.ing(LS.refundRemarkTooLong);
            return
        }
        if (j.length == 0) {
            Mobi.ing(LS.refundRemarkNotEmpty);
            return
        }
        e = true;
        Mobi.ing(LS.refundRemarkSubmiting);
        jm.ajax({
            type: "post",
            url: "ajax/order_h.jsp?cmd=setRefundRemark",
            data: "orderId=" + b + "&speaker=1&itemId=" + h + "&remark=" + jm.encodeUrl(j),
            error: function() {
                e = false;
                Mobi.ing("系统繁忙，请稍后重试。")
            },
            success: function(t) {
                var t = jm.parseJSON(t);
                if (t.success) {
                    Mobi.ing(LS.submitSuccess);
                    var s = new Date(t.remarkTime);
                    var q = s.getFullYear(),
                        p = s.getMonth() + 1,
                        r = s.getDate(),
                        n = s.getHours(),
                        m = s.getMinutes(),
                        l = s.getSeconds();
                    var k = q + "-" + p + "-" + r + " " + n + ":" + m + ":" + l;
                    var o = "";
                    o += "<div class='refundItem memberContent'>";
                    o += "<div class='icon-arrow'></div>";
                    o += "<div class='remarkTitle'>";
                    o += "<div class='item1'>" + d + "</div>";
                    o += "<div class='item2'>" + k + "</div>";
                    o += "</div>";
                    o += "<div class='remarkStatus'>" + jm.encodeHtml(j) + "</div>";
                    o += "</div>";
                    jm("#remarkList").prepend(o);
                    jm("#editRemark").hide();
                    jm("#remarkListContainer").show();
                    jm("#refundRemarkArea").val("");
                    e = false
                } else {
                    Mobi.ing(t.msg, true);
                    e = false
                }
            }
        })
    });
    var c = {
        textClass: "confirm",
        content: LS.refundCancelTips,
        callback: function() {
            jm.ajax({
                type: "post",
                url: "ajax/order_h.jsp?cmd=setRefundStatus&type=del&nowStatus=" + f,
                data: "orderId=" + b + "&itemId=" + h,
                error: function() {
                    Mobi.ing("系统繁忙，请稍后重试。")
                },
                success: function(j) {
                    var j = jm.parseJSON(j);
                    if (j.success) {
                        location.reload()
                    } else {
                        Mobi.ing(j.msg, true)
                    }
                }
            })
        }
    };
    jm("#cancelRefund").click(function() {
        Mobi.prompt(c)
    });
    var a = false;
    jm("#editRefundInfo").click(function() {
        if (a) {
            jm("#refundEditContainer").show();
            jm("#refundDetail").hide()
        }
        if (e) {
            return
        }
        e = true;
        jm.ajax({
            type: "post",
            url: "ajax/order_h.jsp?cmd=setRefundStatus&type=edit&nowStatus=" + f,
            data: "orderId=" + b + "&itemId=" + h,
            error: function() {
                e = false;
                Fai.ing("系统繁忙，请稍后重试。")
            },
            success: function(j) {
                var j = jm.parseJSON(j);
                if (j.success) {
                    jm("#refundEditContainer").show();
                    jm("#refundDetail").hide();
                    a = true;
                    Mobi.refundDetailSubmit(b, h, 15)
                } else {
                    Mobi.ing(j.msg, true);
                    e = false
                }
            }
        })
    });
    jm("#refundFlowSub").click(function() {
        if (e) {
            return
        }
        var t = jm.trim(jm("#flowName").val());
        if (!t) {
            Mobi.ing(LS.refundEnterFlowName);
            return
        }
        if (t.length > 30) {
            Mobi.ing(LS.refundFlowNameTooLong);
            return
        }
        var k = jm.trim(jm("#flowId").val());
        if (!k) {
            Mobi.ing(LS.refundEnterFlowCode);
            return
        }
        if (k.length > 30) {
            Mobi.ing(LS.refundFlowCodeTooLong);
            return
        }
        var s = jm.trim(jm("#refundPhone").val());
        if (!s) {
            Mobi.ing(LS.refundNeedPhone);
            return
        }
        if (s.length > 30) {
            Mobi.ing(LS.refundPhoneTooLong);
            return
        }
        var n = jm.trim(jm("#flowDetail").val());
        if (n.length > 200) {
            Mobi.ing(LS.refundFlowDetailTooLong);
            return
        }
        e = true;
        var q = {
            company: t,
            flowId: k,
            phone: s,
            refundArea: n
        };
        var o = jm(".J_picDiv");
        if (o.length > 0) {
            var v = [];
            var m = jm(".J_picDiv");
            for (var p = 0; p < m.length; p++) {
                var j = jm(m[p]);
                var r = j.attr("_fileId");
                if (!r) {
                    continue
                }
                var l = {
                    ii: r
                };
                var u = j.attr("_tmpFileId");
                if (u) {
                    l["in"] = j.attr("_fileName");
                    l.tfi = u;
                    l.is = j.attr("_fileSize")
                }
                v.push(l)
            }
            if (v.length > 0) {
                q.flowImgList = v
            }
        }
        jm.ajax({
            type: "post",
            url: "ajax/order_h.jsp?cmd=setRefundFlow&orderId=" + b + "&itemId=" + h + "&nowStatus=" + f,
            data: "flowInfo=" + jm.encodeUrl(jm.toJSON(q)),
            error: function() {
                e = false;
                Mobi.ing("系统繁忙，请稍后重试。")
            },
            success: function(w) {
                var w = jm.parseJSON(w);
                if (w.success) {
                    Mobi.ing(LS.submitSuccess);
                    location.reload()
                } else {
                    Mobi.ing(w.msg);
                    e = false
                }
            }
        })
    })
};
Mobi.initRefundPicUpload = function(d, c, e, b, j, a) {
    var h = document.createElement("script");
    h.type = "text/javascript";
    h.src = j;
    var f = document.documentElement || document.body;
    h.onload = function() {
        var k = document.createElement("script");
        k.src = a;
        k.type = "text/javascript";
        f.appendChild(k);
        setTimeout(function() {
                Mobi.mobiRefundUpload(d, c, e, b)
            },
            1000)
    };
    f.appendChild(h)
};
Mobi.mobiRefundUpload = function(d, b, f, a) {
    var e = f.split(",");
    var c = {
        siteFree: false,
        updateUrlViewRes: "",
        auto: true,
        fileTypeExts: e.join(";"),
        multi: false,
        fileSizeLimit: b * 1024 * 1024,
        breakPoints: true,
        saveInfoLocal: false,
        showUploadedPercent: true,
        removeTimeout: 9999999,
        getFileSizeUrlFlag: true,
        post_params: {
            app: 21,
            type: 0,
            fileUploadLimit: b,
            isSiteForm: true
        },
        isOrnotButton: true,
        buttonText: "",
        uploader: "http://" + a + '/ajax/commUpsiteimg_h.jsp?cmd="mobiUpload"',
        onUploadStart: function(j) {
            _uTime = new Date().getTime()
        },
        onUploadSuccess: function(k, m) {
            var l = jm.parseJSON(m);
            if (l.success) {
                var j = {
                    status: "end",
                    id: k.id,
                    title: "上传成功。"
                };
                h(j);
                setTimeout(function() {
                        Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSucess, jm.encodeHtml(k.name)), true)
                    },
                    1800);
                Mobi.refundPicUploadCallBack(l)
            } else {
                var j = {
                    status: "end",
                    id: k.id,
                    title: l.msg
                };
                h(j);
                Mobi.ing(LS.mobiFormSubmitFileUploadFile + k.name + "   " + l.msg)
            }
        },
        onUploadError: function(j, k) {
            jm("#progressBody_ " + j.id).remove();
            jm("#progressWrap_" + j.id).remove();
            Mobi.ing(jm.format(LS.mobiFormSubmitFileUploadSvrBusy, jm.encodeHtml(j.name)));
            _uTime = new Date().getTime() - _uTime
        },
        view_progress: function(j) {
            var j = Math.ceil(j);
            if (isNaN(j)) {
                return
            }
            if (j == 100) {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + j + "%", true)
            } else {
                Mobi.ing(LS.mobiFormSubmitFileUploadIng + j + "%", false)
            }
        }
    };
    function h(j) {
        if (isNaN(Math.round(j.percent))) {
            return
        }
        if (j.status == "start") {
            var k = ['<div id="progressBody_' + j.id + '" class="bodyDisable"></div>', '<div id="progressWrap_' + j.id + '" class="bodyProgressWrap">', '<div class="progressCenter"></div>', '<div class="progressIngBody">', '<div id="progressTitle' + j.id + '" class="progressIngTitle">' + j.title + "</div>", '<div class="progressIngMission">', '<div class="mission"><div id="progress' + j.id + '" class="progress" style="width:1%;"></div></div>', '<div id="progressNum' + j.id + '" class="progressNum">0%</div>', "</div>", '<div class="progressInfo"><span id="progressTips' + j.id + '" class="progressFileSize"></span><a class="progressCancel" href="javascript:uploadCancel(\'' + j.id + "');\">取消</a></div>", "</div>", "</div>"];
            jm("body").append(k.join(""))
        } else {
            if (j.status == "ing") {
                jm("#progressTitle" + j.id).text(j.title);
                jm("#progress" + j.id).css("width", Math.round(j.percent) + "%");
                jm("#progressNum" + j.id).html(Math.round(j.percent) + "%")
            } else {
                if (j.status == "end") {
                    jm("#progressTitle" + j.id).text(j.title);
                    jm("#progressBody_" + j.id).remove();
                    jm("#progressWrap_" + j.id).remove()
                } else {
                    if (j.status == "error") {
                        jm("#progress" + j.id).addClass("progressError")
                    }
                }
            }
        }
    }
    upload = jm("#" + d).uploadify(c)
};
Mobi.refundPicUploadCallBack = function(b) {
    var c = b.id;
    var j = b.name;
    var h = b.size;
    var f = b.path;
    var k = b.pathSmall;
    var a = b.fileId;
    var d = "";
    d += "<div class='picDiv J_picDiv' _tmpFileId='" + c + "' _fileName='" + j + "' _fileSize='" + h + "' _fileId='" + a + "'>";
    d += "<img src='" + f + "' class='refundImg'/>";
    d += "<span class='delBtn J_delBtn'>-</span>";
    d += "</div>";
    var e = jm(".J_picDiv").length;
    if (e >= 4) {
        jm("#uploadRefundPicBtn").hide()
    }
    if (e < 5) {
        jQuery("#uploadRefundPicBtn").before(d)
    }
    jm(".J_delBtn").off("click.delRefundIcon").on("click.delRefundIcon",
        function() {
            jm(this).parent().remove();
            jm("#uploadRefundPicBtn").css("display", "inline-block")
        })
};
Mobi.refundDetailSubmit = function(a, d, c) {
    jm("#refundType").change(function() {
        var e = jm("#refundType").val();
        if (e == 0) {
            jm("#hasRecvGoodLine").show()
        } else {
            if (e == 1) {
                jm("#hasRecvGoodLine").hide()
            }
        }
    });
    var b;
    jm("#refundDetailSub").click(function() {
        if (b) {
            return
        }
        var o = jm("#refundPrice").val();
        var p = parseFloat(o);
        if (isNaN(p)) {
            Mobi.ing(LS.refundPriceErr);
            return
        }
        if (p < 0) {
            Mobi.ing(LS.refundPriceErr);
            return
        }
        var t = parseFloat(jm("#refundPrice").attr("_max"));
        if (t < p) {
            Mobi.ing(LS.refundPriceTooMuchErr);
            return
        }
        var r = jm("#refundPhone").val();
        if (jm.trim(r).length == 0) {
            Mobi.ing(LS.refundNeedPhone);
            return
        }
        var j = jm("#refundReason").val();
        if (jm.trim(j).length == 0) {
            Mobi.ing(LS.refundEnterReason);
            return
        }
        var w = jm("#refundType").val();
        var m = {};
        m.refundType = parseInt(w);
        m.refundPrice = p;
        m.refundPhone = r;
        m.refundReason = j;
        var f = jm("#hasRecvGood");
        if (f.length == 1 && f.css("display") != "none") {
            var s = f.val();
            if (s == "1") {
                m.hasRecvGood = true
            } else {
                m.hasRecvGood = false
            }
        }
        var l = jm(".J_picDiv");
        if (l.length > 0) {
            var v = [];
            var k = jm(".J_picDiv");
            for (var n = 0; n < k.length; n++) {
                var e = jm(k[n]);
                var q = e.attr("_fileId");
                if (!q) {
                    continue
                }
                var h = {
                    ii: q
                };
                var u = e.attr("_tmpFileId");
                if (u) {
                    h["in"] = e.attr("_fileName");
                    h.tfi = u;
                    h.is = e.attr("_fileSize")
                }
                v.push(h)
            }
            if (v.length > 0) {
                m.refundImgList = v
            }
        }
        b = true;
        jm.ajax({
            type: "post",
            url: "ajax/order_h.jsp?cmd=setOrderNoRefund&orderId=" + a + "&itemId=" + d + "&nowStatus=" + c,
            data: "refundInfo=" + jm.encodeUrl(jm.toJSON(m)),
            error: function() {
                b = false;
                Mobi.ing("系统繁忙，请稍后重试。")
            },
            success: function(x) {
                var x = jm.parseJSON(x);
                if (x.success) {
                    location.reload()
                } else {
                    Mobi.ing(x.msg, true);
                    b = false
                }
            }
        })
    })
};
Mobi.changeCheckButtonRight = function(f) {
    var d = parseFloat(jm("#cartTotalPrice").attr("totalPrice"));
    jm(".faisco-icons-right").each(function(m, n) {
        jm(n).removeClass().addClass("faisco-icons-shape11").addClass("couponCheckBox")
    });
    if (jm("#selectBtn" + f).hasClass("faisco-icons-right")) {
        jm("#selectBtn" + f).removeClass().addClass("faisco-icons-shape11").addClass("couponCheckBox")
    } else {
        jm("#selectBtn" + f).removeClass().addClass("faisco-icons-right").addClass("couponCheckBox").addClass("g_color");
        var c = jm("#selectBtn" + f).attr("coupon_value");
        var k = jm("#selectBtn" + f).attr("order_min_price");
        if (c != undefined && c != -1) {
            jm("#couponOffsetMoney").text(jm.format(LS.settlementCoupon, c, k));
            jm("#couponOffsetMoney").attr("_offsetmoney", c);
            Mobi.selectCoupon.saveMoney = c;
            Mobi.selectCoupon.id = f;
            jm("#showCouponCount").hide()
        } else {
            jm("#couponOffsetMoney").text(LS.notUse);
            jm("#couponOffsetMoney").attr("_offsetmoney", "");
            jm("#showCouponCount").css("display", "inline-block");
            Mobi.selectCoupon = {}
        }
        var e = jm("#useItg");
        if (c == undefined || c == -1) {
            c = 0
        }
        var h = parseInt(e.attr("_needitg"));
        var j = parseInt(e.attr("_maxuse"));
        var l = Math.floor((d - c) * h);
        if (l < j) {
            j = l
        }
        jm("#canUse").text(j);
        var a = (j / h).toFixed(2);
        jm("#itgOffsetMoney").text(a);
        var b = jm("#useItgLine #offsetMoney").hasClass("jz-switch-checked");
        if (b) {
            jm("#offsetMoney").attr("_offsetmoney", a);
            e.val(j)
        } else {
            jm("#offsetMoney").attr("_offsetmoney", 0);
            e.val(0)
        }
    }
    Mobi.mallStlCalcTotal();
    jm("#webPagePanelcouponLine .webPagePanelBg").css("display", "none");
    jm("#couponUseListPanel").removeClass("webPagePanelShow")
};
Mobi.initOrderPropDateType = function(c) {
    var a = c.dateSetting;
    var f = (a.type == undefined ? 0 : a.type) == 1;
    Mobi.initmobiFormTimeBtn({
        moduleId: c.moduleId,
        siteFormItemId: c.siteFormItemId,
        minDate: new Date(),
        yearChangeable: true,
        monthChangeable: true,
        swipeable: true,
        placeholder: LS.mallPleaseChoose,
        dateSetting: a
    });
    if (f) {
        jm("<span class='orderPropUtil' id='Mobi" + c.moduleId + "CalendarInput" + c.siteFormItemId + "'>" + LS.to + "</span>\n").insertAfter("#module" + c.moduleId + " #orderPropId" + c.siteFormItemId + " .fk-dateInputMaskWrap")
    }
    if (c.panel == "mstl") {
        var d = c.defaultDateTime;
        var b = "#Mobi" + c.moduleId + "Calendar" + c.siteFormItemId + "Pluginsinput";
        var e = "#Mobi" + c.moduleId + "Calendar" + c.siteFormItemId + "Plugins_endinput";
        jm(b).addClass("propItemValue g_input").css({
            border: "0",
            outline: "none",
            height: "2.25rem",
            color: "#333"
        }).val(d.s || "");
        if (f) {
            jm(b).css("width", "5rem")
        } else {
            jm(b).css("width", "13rem")
        }
        jm(b).attr("proptype", 9).attr("_required", c.required).attr("_field", c.field).attr("_prop", c.name).val(d.s || "");
        jm(e).addClass("g_input").css({
            width: "5rem",
            border: "0",
            outline: "none",
            height: "2.25rem",
            color: "#333"
        }).val(d.e || "")
    } else {
        var b = "#Mobi" + c.moduleId + "Calendar" + c.siteFormItemId + "Pluginsinput";
        var e = "#Mobi" + c.moduleId + "Calendar" + c.siteFormItemId + "Plugins_endinput";
        if (f) {
            jm(b).addClass("g_input propItemValue").css("width", "8rem")
        } else {
            jm(b).addClass("g_input propItemValue").css("width", "12rem")
        }
        jm(b).attr("proptype", 9).attr("_required", c.required).attr("_field", c.field).attr("_prop", c.name);
        jm(e).addClass("orderPropTimeEndInput")
    }
    jm(".editPanel .fk-dateInputMask,.noAddrPropInfoContain .fk-dateInputMask").css({
        position: "absolute",
        top: "0",
        height: "100%",
        width: "100%"
    })
};
Mobi.initNewGuestGiftInfo = function() {
    jm(".J_showGiftPage").bind("click",
        function() {
            jm(".newGuestGiftSreen").show();
            jm(".newGuestGiftContainer").show()
        });
    jm(".J_hiddenGiftPage").bind("click",
        function() {
            jm(".newGuestGiftSreen").hide();
            jm(".newGuestGiftContainer").hide()
        });
    jm(".J_receiveBtn").bind("click",
        function() {
            if (Fai.top._manageMode == true) {
                var c = [];
                c.push('<div class="mobiCouponMsgPanl2">');
                c.push('<div class="mobiCouponMsg">');
                c.push('<div class="fTop">领取失败</div>');
                c.push('<div class="fBottom">当前为管理状态!</div>');
                c.push("</div>");
                c.push("</div>");
                popupCouponMsg(c.join(""))
            } else {
                if (Fai.top.sessionMemberId == 0) {
                    Fai.top.location.href = "login.jsp?returnUrl=" + Fai.top.location.href
                }
            }
        });
    var a = jm(".newGuestGiftContainer .giftItem").length || 0;
    if (a == 1) {
        jm(".newGuestGiftContainer").css("top", "14%")
    } else {
        if (a == 2) {
            jm(".newGuestGiftContainer").css("top", "10%")
        } else {
            jm(".newGuestGiftContainer").css("top", "3%")
        }
    }
    var b = jm(".newGuestGiftContainer .giftItem");
    b.each(function() {
        jm(this).bind("click",
            function() {
                var c = jm(this).attr("couponid");
                Fai.top.location.href = "pr.jsp?couponId=" + c
            })
    })
};
Mobi.setCpTriangle = function() {
    var a = jm(".cpCurrPriceTip").css("background-color");
    var c = jm(".cpCurrPriceTip").css("width");
    c = parseFloat(c.substring(0, c.indexOf("p")));
    c /= 40;
    var b = parseFloat(c / 2 + 0.1);
    jm(".cpCurrPriceTipTriangle").css("border-top-color", a);
    jm(".cpCurrPriceTipTriangle").css("left", b + "rem");
    jm(".cpCurrPriceTipTriangle").css("top", ".9rem");
    jm(".cpCurrPriceTipTriangle").css("display", "inline-block")
};
Mobi.initCutPriceRibbon = function(c, a, d, b) {
    setInterval(function() {
            var e = new Date().getTime();
            var j = a == 0 ? d - e: b - e;
            var h = Mobi.translateDiffTime(j);
            var f = a == 0 ? "开始": "结束";
            var k = "距活动" + f + "仅剩：" + h;
            jm(".imgRibbon" + c).find("span").text(k)
        },
        1000)
};
Mobi.initCutPriceDetailCD = function(a, c, b) {
    if (a < 10) {
        setInterval(function() {
                var d = new Date().getTime();
                var h = a == 0 ? c - d: b - d;
                var f = Mobi.translateDiffTime(h);
                var e = a == 0 ? "开始": "结束";
                var j = "距活动" + e + "仅剩：" + f;
                jm(".cpCountDown").text(j)
            },
            1000)
    } else {
        jm(".cpCountDown").text("活动已结束")
    }
};
Mobi.initCutPricePdDetail = function(a, d, c, e, b) {
    window.onload = function() {
        jm(".showSaleTimeImg").css("display", "block")
    };
    if (a != 0) {
        jm(".J_salePromotionNewMessage").html(LS.salePromotionNewEndMessage)
    }
    if ((e || Fai.top._manageMode) && b != 1) {
        jm(".J_salePromotionDay").html(LS.salePromotionDay);
        jm(".J_salePromotionHour").html(LS.salePromotionHour);
        jm(".J_salePromotionMinute").html(LS.salePromotionMinute);
        jm(".J_salePromotionSecond").html(LS.salePromotionSecond)
    }
    setInterval(function() {
            var h = new Date().getTime();
            var p = a == 0 ? d - h: c - h;
            var j = Mobi.translateDiffTime(p);
            var l = a == 0 ? "开始": "结束";
            var m = "距砍价活动" + l + "仅剩：" + j;
            if (a == 0 && (e || Fai.top._manageMode) && b != 1) {
                jm(".J_showCountDownClass").html("&nbsp;&nbsp;" + m)
            }
            if (!e || Fai.top._manageMode || b == 1) {
                jm(".showSaleTimeClass").html("&nbsp;&nbsp;" + m)
            }
            if ((e || Fai.top._manageMode) && b != 1) {
                var k = j.split(/[^0-9]/ig);
                var q = k[0];
                var n = k[1];
                var f = k[2];
                var o = k[3];
                if (q < 10) {
                    q = "0" + q
                }
                if (n < 10) {
                    n = "0" + n
                }
                if (f < 10) {
                    f = "0" + f
                }
                if (o < 10) {
                    o = "0" + o
                }
                jm(".J_salePromotionDayNum").html(q);
                jm(".J_salePromotionHourNum").html(n);
                jm(".J_salePromotionMinuteNum").html(f);
                jm(".J_salePromotionSecondNum").html(o)
            }
        },
        1000)
};
Mobi.translateDiffTime = function(a) {
    var c = [["天", 86400000], ["时", 3600000], ["分", 60000], ["秒", 1000]];
    var b = "";
    jm.each(c,
        function(e, f) {
            var d = Math.floor(a / f[1]);
            b += d + f[0];
            a -= d * f[1]
        });
    return b
};
Mobi.cutPrice = function(k, l) {
    var f = "cpId=" + k + "&pdId=" + l,
        e = [],
        a = jm(".J-op"),
        m = true;
    jm(a).each(function() {
        var r = jm(this),
            o = r.attr("option_name"),
            q = r.attr("data"),
            p = r.attr("type"),
            j = r.attr("option_data");
        if (j) {
            var s = {};
            s.name = q;
            s.value = parseInt(j);
            if (p != null) {
                s.name = q.replace(/^opIndept/, "");
                s.type = parseInt(p)
            }
            e.push(s)
        } else {
            Mobi.ing(jm.format(LS.mallCartChoiceItemError, jm.encodeHtml(o)));
            m = false;
            return false
        }
    });
    var n = "oldOptionsStr";
    n += l;
    if (Mobi.optionsStr[n] != "null" && Mobi.optionsStr[n]) {
        var h = Mobi.optionsStr[n].split("_"),
            b = [];
        for (var d = 0; d < h.length; d++) {
            for (var c = 0; c < e.length; c++) {
                if (e[c].name == h[d]) {
                    b.push(e[c])
                }
            }
        }
        e = b
    }
    if (!m) {
        Mobi.mallBuying[l] = false;
        return false
    }
    if (e.length > 0) {
        f += "&optionList=" + jm.encodeUrl(jm.toJSON(e))
    }
    jm.ajax({
        type: "post",
        url: "ajax/cutPrice_h.jsp?cmd=cutPrice",
        data: f,
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(j) {
            j = jm.parseJSON(j);
            if (j.success) {
                var o = true;
                if (j.alreadyHave) {
                    o = false
                }
                var r = j.cpDetailId;
                var p = j.memId;
                Mobi.setCpDetailCookie(k, r, p);
                location.href = "cpDetail.jsp?cpId=" + k + "&cpDetailId=" + r + "&pdId=" + l + "&isInit=true&showAnime=" + o
            } else {
                if (j.rt == -100) {
                    var q = "login.jsp?returnUrl=" + jm.encodeUrl(jm.getUrlRoot(location.href)) + "&errno=11";
                    location.href = q
                } else {
                    Mobi.ing(LS.argsError)
                }
            }
        }
    })
};
Mobi.showCutPriceAnime = function(e, j, c, f) {
    var b = Fai.top.document.body.clientWidth;
    var a = Fai.top.document.body.clientHeight;
    var d = "";
    d += "<div style='display: flex; flex-flow: column; justify-content: center; align-items: center; margin: 0 auto; width: 13rem; height: 13rem; z-index: 9999; background: url(" + _resRoot + "/image/cutPricePopup.png) no-repeat; background-size: contain;'>";
    d += "    <div style='display: flex; flex-flow: column; margin-top: 6rem; margin-bottom: 1.5rem;'>";
    d += "        <div style='display: inline-block; font-size: .75rem; color: #333; text-align: center;'>厉害了！你一出手</div>";
    var h = "自己";
    if (!e) {
        h = "好友"
    }
    d += "        <div style='display: inline-block; font-size: .75rem; color: #333; text-align: center; line-height: 1.2rem;'>就帮" + h + "砍掉了<span style='display: inline-block; font-size: .9rem; color: #ff4444; position: relative; top: .08rem;'>" + f + c + "</span></div>";
    d += "    </div>";
    var k = function() {};
    if (e) {
        d += "    <div class='J-prompt-callback' style='display: inline-block; width: 7.605rem; height: 3rem; z-index: 9999; text-align: center; background: url(" + _resRoot + "/image/initCpBtn.png) no-repeat; background-size: contain; cursor: pointer;'></div>";
        k = function() {
            jm(".J_cpInvite").click()
        }
    } else {
        d += "    <div class='J-prompt-callback' style='display: inline-block; width: 7.605rem; height: 3rem; z-index: 9999; text-align: center; background: url(" + _resRoot + "/image/partiCpBtn.png) no-repeat; background-size: contain; cursor: pointer;'></div>";
        k = function() {
            location.href = "pd.jsp?pid=" + j
        }
    }
    d += "</div>";
    d += "<div class='J-prompt-cancel' style='display: inline-block; width: 2rem; height: 2rem; margin-top: 1rem; z-index: 9999; cursor: pointer;'>";
    d += "    <img src='" + _resRoot + "/image/hdCouponClose.png'>";
    d += "</div>";
    var l = "";
    l += "<div style='display: inline-block; width: 14rem; height: 16rem; margin-top: 5rem; z-index: 9999; background: url(" + _resRoot + "/image/cutPriceGif.gif) no-repeat; background-size: contain;'></div>";
    var m = {
        prelude: l,
        content: d,
        mainFrameTimeout: 1000,
        callback: k,
        cancelCallback: function() {
            var n = location.href;
            if (n.indexOf("&showAnime") > 0) {
                n = n.substring(0, n.indexOf("&showAnime"))
            }
            if (n.indexOf("&cutWhenBack") > 0) {
                n = n.substring(0, n.indexOf("&cutWhenBack"))
            }
            location.href = n
        }
    };
    Mobi.customPopup(m)
};
Mobi.cutPriceImmeBuy = function(k, d, l, h) {
    var n = {};
    n.isCutPrice = true;
    n.cutPriceId = k;
    n.cutPriceDetailId = d;
    if (typeof(Mobi.mallBuying[l]) == "undefined") {
        Mobi.mallBuying[l] = false
    }
    var e = false;
    jm.each(Mobi.mallBuying,
        function(p, o) {
            if (o) {
                e = true;
                return false
            }
        });
    if (e) {
        return
    }
    Mobi.mallBuying[l] = true;
    var j = "id=" + l + "&fromDetail=true",
        f = [],
        b = h,
        m = true;
    var c = false;
    if ( !! h) {
        j += "&optionList=" + jm.encodeUrl(jm.toJSON(h))
    }
    j += "&amount=" + 1;
    var a = {
        pid: l,
        amount: 1,
        optList: h,
        isCutPrice: true,
        cutPriceId: k,
        cutPriceDetailId: d
    };
    if (a.optList == null || a.optList.length == 0 || !a.optList || a.optList == "null") {
        a.optList = jm.toJSON(f)
    }
    j += "&codata=" + jm.toJSON(a);
    jm.ajax({
        type: "post",
        url: "ajax/order_h.jsp?cmd=addIme",
        data: j,
        error: function() {
            Mobi.ing(LS.systemError);
            Mobi.mallBuying[l] = false
        },
        success: function(o) {
            var q = jm.parseJSON(o);
            if (q.success) {
                var p = "";
                p += "&isCutPrice=" + true;
                p += "&cutPriceId=" + k;
                p += "&cutPriceDetailId=" + d;
                if (window.self != window.top && /(iPhone|iPad|iPod|safari)/i.test(navigator.userAgent.toLowerCase())) {
                    location.href = "mstl.jsp?immeData=" + jm.encodeUrl(jm.toJSON(a)) + p
                } else {
                    location.href = "mstl.jsp?imme" + p
                }
                Mobi.mallBuying[l] = false
            } else {
                if (q.rt == Mobi.MallAjaxErrno.authMemberNotAllow) {
                    Mobi.ing(q.data + LS.authLevelBuy)
                } else {
                    if (q.rt == Mobi.MallAjaxErrno.login) {
                        Mobi.ing(LS.memberLoginFirst)
                    } else {
                        Mobi.returnMallErrorMsg(q.rt)
                    }
                }
                Mobi.mallBuying[l] = false
            }
        }
    })
};
Mobi.setCpDetailCookie = function(b, c, a) {
    jm.cookie("cp_" + b + "_cpDetail_" + c, true, {
        path: "/"
    })
};
Mobi.setCpDetailCookieBeforeHand = function(b, c, a) {
    var a = jm.cookie("cp_" + b + "_cpDetail_" + c);
    if (a == null || typeof a == "undefined") {
        jm.cookie("cp_" + b + "_cpDetail_" + c, false, {
            path: "/"
        })
    }
};
Mobi.checkCpDetailCookie = function(b, c, a) {
    var a = jm.cookie("cp_" + b + "_cpDetail_" + c);
    if (a) {
        return true
    } else {
        return false
    }
};
Mobi.helpCutPrice = function(d, e, a, c) {
    var b = jm.cookie("cp_" + d + "_cpDetail_" + e);
    if (b == null) {
        return Mobi.ing("您的浏览器暂不支持砍价功能")
    }
    if (b === "true") {
        return Mobi.ing("您已经砍过价了")
    }
    jm.ajax({
        type: "post",
        url: "ajax/cutPrice_h.jsp?cmd=helpCutPrice&cpId=" + d + "&cpDetailId=" + e + "&pdId=" + a + "&memId=" + c,
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(f) {
            f = jm.parseJSON(f);
            if (f.success) {
                Mobi.setCpDetailCookie(d, e, c);
                Mobi.showCutPriceAnime(false, f.pdId, f.reducedMoney, f.choiceCurrencyVal)
            } else {
                if (f.rt == -100) {
                    var j = jm.getUrlRoot(location.href);
                    if (j.indexOf("?") > 0) {
                        j += "&cutWhenBack=true"
                    } else {
                        j += "?cutWhenBack=true"
                    }
                    var h = "login.jsp?returnUrl=" + jm.encodeUrl(j) + "&errno=11";
                    location.href = h
                } else {
                    Mobi.ing(LS.argsError)
                }
            }
        }
    })
};
Mobi.newsCommentAddCom = function() {
    var e = jm.trim(jm("#newsCommentCreator").val());
    var d = jm("#newsCommentCreator").attr("minlength");
    var j = jm("#newsCommentInput").val();
    var a = jm("#newsCommentInput").attr("minlength");
    var f = jm("#validateCodeInput").val();
    var b = jm("#newsCommentInput").attr("newsId");
    if (typeof(e) != "string") {
        Mobi.ing(LS.creatorTips);
        return
    }
    if (typeof(j) != "string" || "" == j) {
        Mobi.ing(LS.commentNotEmpty);
        return
    }
    if (j.length < a) {
        Mobi.ing(jm.format(LS.commentLenTips, jm.encodeHtml(a)));
        return
    }
    if (!jm(".J_newsCommentCaptcha").hasClass("captchaHide")) {
        if (typeof(f) != "string" || "" == f) {
            Mobi.ing(LS.memberInputCaptcha);
            return
        }
    }
    var h = "ajax/newsComment_h.jsp?cmd=submitComment";
    var c = {
        validateCode: f,
        newsId: b,
        creator: e,
        comment: j
    };
    Mobi.ing(LS.siteFormSubmitIng);
    jm.ajax({
        type: "POST",
        url: h,
        data: c,
        error: function() {
            Mobi.ing(LS.systemError);
            jm("#captchaChange").click()
        },
        success: function(k) {
            var m = jm.parseJSON(k);
            if (!m || !m.success) {
                jm("#captchaChange").click()
            }
            if (m.hasFW) {
                Mobi.ing(m.msg);
                return
            }
            switch (m.msg) {
                case 1:
                    Mobi.ing(LS.captchaError);
                    break;
                case 2:
                    Mobi.ing(LS.creatorError);
                    break;
                case 3:
                    Mobi.ing(LS.commentError);
                    break;
                case 4:
                    Mobi.getCommentDiv("news", b);
                    if (m.autoOpenComm || m.autoOpenComm == undefined) {
                        Mobi.ing(LS.commentSuccess, 1)
                    } else {
                        Mobi.ing(LS.commentSuccessNeedReview, 1)
                    }
                    break;
                case 5:
                    Mobi.ing(LS.paramError);
                    break;
                case 6:
                    var l = jm.encodeUrl(window.location.href);
                    window.location.href = "login.jsp?returnUrl=" + l + "&errno=11";
                    break;
                case 7:
                    Mobi.ing(LS.commentClosed);
                    break;
                case 8:
                    Mobi.ing(LS.commentSubmitError);
                    break;
                case 9:
                    Mobi.ing(LS.commentCountLimit);
                    break;
                case 10:
                    Mobi.ing(LS.msgBoardInputValidateCode);
                    if (m.needCode) {
                        jm(".J_newsCommentCaptcha").removeClass("captchaHide")
                    }
                    break;
                default:
            }
        }
    })
};
Mobi.initMixNews = function(c) {
    var b = jm("#newsList" + c.moduleId);
    var f = b.children().eq(0);
    var e = f.find(".mixNewsStyleTitleContainer  a");
    var d = parseInt(f.width());
    var a = parseInt(c.imgWidth);
    var h = d - a - 48;
    e.css({
        width: h + "px"
    })
};
Mobi.showMore = function() {
    var b = document.getElementById("sharePanel");
    var a = document.getElementById("showOrHide");
    if (b && b.style) {
        if (b.style.height == "auto") {
            b.style.height = "";
            a.className = a.className.replace("hideIcon", "showIcon");
            b.style.background = ""
        } else {
            b.style.height = "auto";
            a.className = a.className.replace("showIcon", "hideIcon")
        }
    }
};
Mobi.showBg = function() {
    Mobi.mobiHideScroll();
    var b = document.body.clientHeight;
    var f = document.body.clientWidth;
    var j = document.body;
    var k = document.createElement("div");
    var h = document.createElement("div");
    var d = document.createElement("div");
    k.id = "shareParentDiv";
    h.id = "shareFullbg";
    h.className = "shareFullbg";
    d.id = "shareTipsDiv";
    d.className = "shareTips";
    j.appendChild(k);
    var a = document.getElementById("shareParentDiv");
    a.appendChild(h);
    a.appendChild(d);
    var e = document.getElementById("shareFullbg");
    var c = document.getElementById("shareTipsDiv");
    e.style.height = b + "px";
    e.style.width = f + "px";
    e.style.position = "fixed";
    e.onclick = function() {
        var l = document.getElementById("shareParentDiv");
        Mobi.mobiShowScroll();
        l.parentNode.removeChild(l)
    }
};
Mobi.initNewsEvent = function(c, o, l, n) {
    if (!c) {
        return
    }
    var e = document.getElementById("productDetailHeader" + c),
        b = document.getElementById("newsDetailShare"),
        d = e.querySelector(".icon-gClose"),
        f;
    if (n === 2) {
        f = "newsDetailV3Share"
    } else {
        f = "newsDetailShare"
    }
    var h = {
        triggerId: f,
        pageBg: true,
        pageHtml: Mobi.sharePage(Fai.top._shareData),
        direction: "bottom",
        callback: function() {
            Mobi.initProductSwipe("shareListShowSwipe")
        },
        closeWebPage: ".shareListPanelBg"
    };
    Mobi.initWebPage(h);
    jm(d).bind("click",
        function() {
            Fai.top._isExternalLinks = false;
            if (window.history.length <= 1) {
                window.location.href = "index.jsp"
            } else {
                if (l && l.length > 0) {
                    window.location.href = l
                } else {
                    if (Fai.top._manageMode) {
                        if (sessionStorage.getItem("historyList")) {
                            jm(Fai.top.document.getElementById("jz_designerOperate").querySelector(".j_designerBack")).click()
                        } else {
                            window.location.href = "index.jsp"
                        }
                    } else {
                        history.back();
                        setTimeout(function() {
                                if (!Fai.top._manageMode) {
                                    history.back()
                                }
                                var q = setTimeout(function() {
                                        window.location.href = "index.jsp";
                                        q = null
                                    },
                                    500)
                            },
                            300)
                    }
                }
            }
            return false
        });
    Mobi.scrollFadeIn("productDetailHeader" + c, "newsFigure" + c, o);
    var k = "ajax/newsComment_h.jsp?cmd=submitNewComment";
    var p = {
        triggerId: "postComment",
        panelId: "userCommentPanel",
        callback: function() {
            Mobi.postUserComment(k)
        },
        closeWebPage: "#userCommentPanel .userCommentGoBack"
    };
    Mobi.initWebPage(p);
    var j = jm("#newsDetailPanel");
    var a = j.find("video");
    var m = a.length;
    if (m > 0) {
        jm("#postComment").on("click",
            function() {
                for (var q = 0; q < m; q++) {
                    a[q].pause()
                }
                if (jm.os.android) {
                    a.hide();
                    Mobi.bindTouchAndClickEvent(jm("#userCommentPanel .userCommentGoBack"),
                        function() {
                            a.show()
                        })
                }
            })
    }
    Mobi.hidePlaceholder()
};
Mobi.setNewDetailPanelHeight = function() {
    var d = jm("#newsDetailPanel")[0].offsetHeight;
    var a = jm(".newsBottom");
    var b = 0;
    if (a.length > 0) {
        b = jm(".newsBottom")[0].offsetHeight
    } else {
        var c = jm("#g_web").css("paddingTop");
        if (c) {
            c = Number(c.substring(0, c.length - 2));
            if (!isNaN(c)) {
                d = d - c
            }
        }
    }
    jm(".formMiddle").css({
        height: (d) + "px",
        paddingBottom: "0",
        border: "none"
    });
    jm(".newsDetail").css({
        height: (d - b) + "px"
    })
};
Mobi.getCommentsInfo = function(c, e, d, b) {
    if (!c) {
        Mobi.ing(LS.mallStlSubmitError);
        return
    }
    if (isNaN(e)) {
        Mobi.ing(LS.mallStlSubmitError);
        return
    }
    var a = "id=" + e;
    if (!isNaN(d)) {
        jm(".getMoreComments").remove();
        a += ("&pageno=" + d)
    }
    Mobi.showLoading();
    jm.ajax({
        type: "post",
        url: "ajax/other_h.jsp?cmd=" + c,
        data: a,
        error: function() {
            Mobi.closeLoading();
            Mobi.ing(LS.systemError)
        },
        success: function(h) {
            var j = jm.parseJSON(h);
            if (j.success) {
                jm("#newsDetailPanel").append(j.html)
            }
            Mobi.closeLoading();
            Mobi.hidePlaceholder();
            if (c !== "newsV3") {
                if (jm("#postComment").length > 0 && jm("#module" + b).length > 0) {
                    var f = jm("#g_web").height();
                    if ((f - jm("#webContainerBox").height()) > 5) {
                        jm("#webContainerBox").css("height", f + "px");
                        jm("#module" + b).css("height", f + "px").find(".formMiddle").css("height", f + "px")
                    }
                }
            }
        }
    })
};
Mobi.getNewsCommentAjaxPagenation = function(d, c, b) {
    if (!d) {
        return
    }
    var a = "id=" + d + "&pageno=" + c + "&ajaxPage=" + true;
    jm.ajax({
        type: "post",
        url: "ajax/other_h.jsp?cmd=" + b,
        data: a,
        error: function() {
            Mobi.ing("error")
        },
        success: function(e) {
            var j = jm.parseJSON(e);
            if (!j.html) {
                j.html = ""
            }
            jm("#newsDetailPanel .commentBox").remove();
            jm("#newsDetailPanel").append(j.html);
            var f = parseInt(jm("#newsDetailPanel .commentBox").offset().top);
            var k = 0;
            var h = jm(".productDetailHeader");
            if (h.css("display") == "none") {
                k = f
            } else {
                k = f - parseInt(h.height())
            }
            window.scrollTo(0, k)
        }
    })
};
Mobi.changeTheUrlToAdaptApple = function(a, d) {
    var c;
    if (a != "" && a != null) {
        var b = navigator.userAgent.toLowerCase();
        if (/iphone|ipad|ipod/.test(b)) {
            if (d != "" && d != null) {
                c = d
            }
        } else {
            c = a
        }
        window.location.href = c
    }
};
Mobi.initModuleCardGraphicNewsList = function(t) {
    var h = t.moduleId,
        d = jm("#newsList" + h),
        B = d.width(),
        l = t.picNum,
        L = 0,
        A,
        F,
        J,
        K,
        I = 0,
        x,
        c,
        r,
        b,
        q,
        f,
        v,
        n,
        M = jm(window),
        w,
        u,
        D,
        C,
        m,
        E = jm("body");
    function p(P) {
        var P = P || window.event;
        v = P.pageX;
        M.off("mousemove.newsListSlide").on("mousemove.newsListSlide", s);
        M.off("mouseup.newsListSlide").on("mouseup.newsListSlide", z);
        P.preventDefault()
    }
    function s(Q) {
        var U = document.documentElement.scrollLeft || document.body.scrollLeft;
        var Q = Q || window.event;
        n = Q.pageX;
        var T = n - v,
            S = parseInt(e.css("left") || 0) + T,
            P = r - c,
            R = parseInt(d.offset().left);
        if (S > 0) {
            S = 0
        } else {
            if (S < P) {
                S = P
            }
        }
        if (d.find(".J_newsListSlideCover").length == 0) {
            j.append("<div class='J_newsListSlideCover' style='position:absolute;left:0;width:" + x + "px;height:" + L + "px;z-index:2;'></div>")
        } else {
            d.find(".J_newsListSlideCover").show()
        }
        e.css("left", S + "px");
        v = n;
        if (parseInt(B) == 640) {
            if (n <= R || n >= (r + R)) {
                M.off("mousemove.newsListSlide");
                M.off("mouseup.newsListSlide");
                v = null;
                n = null;
                d.find(".J_newsListSlideCover").hide()
            }
        } else {
            if (n <= 0 || n >= r) {
                M.off("mousemove.newsListSlide");
                M.off("mouseup.newsListSlide");
                v = null;
                n = null;
                d.find(".J_newsListSlideCover").hide()
            }
        }
        Q.preventDefault()
    }
    function z(P) {
        var P = P || window.event;
        M.off("mousemove.newsListSlide");
        M.off("mouseup.newsListSlide");
        v = null;
        n = null;
        d.find(".J_newsListSlideCover").hide();
        P.preventDefault()
    }
    function y(P) {
        var P = P || window.event,
            Q = P.changedTouches.length > 0 ? P.changedTouches[0] : P.touches[0];
        return {
            pageX: Q.pageX,
            pageY: Q.pageY
        }
    }
    function H(S, U, R, T) {
        var Q = Math.abs(S - R),
            P = Math.abs(U - T);
        if (Q === 0 && P === 0) {
            return
        }
        if (Q === 0 && P > 0) {
            return true
        }
        if (P === 0 && Q > 0) {
            return false
        }
        return P / Q > 1 ? true: false
    }
    function k(P) {
        var Q = y(P);
        D = w = Q.pageX;
        C = u = Q.pageY;
        e.off("touchmove.newlist").on("touchmove.newlist", O);
        e.off("touchend.newlist").on("touchend.newlist", o)
    }
    function O(P) {
        var Q = y(P);
        D = Q.pageX;
        C = Q.pageY;
        if (m === undefined) {
            if (w !== undefined && u !== undefined && w !== undefined) {
                m = H(w, u, D, C)
            }
        }
        if (m !== undefined) {
            e.off("touchmove.newlist")
        }
        w = Q.pageX;
        u = Q.pageY
    }
    function o(P) {
        m = undefined;
        e.off("touchmove.newlist");
        e.off("touchend.newlist")
    }
    if (d.length == 0) {
        return
    }
    if (l != 5) {
        return
    }
    var j = jm(d).find(".J_newsListPanel"),
        e = jm(d).find(".J_newsListSlidePanel"),
        G = jm(d).find(".J_cardGraphicNewsStyle"),
        a = jm(d).find(".J_mixNewsStyleTitleContainer5");
    for (var N = 0; q = G.length, N < q; N++) {
        A = jm(G[N]);
        F = parseInt(A.height());
        J = parseInt(A.width());
        x = q * J;
        b = parseInt(G.find(".lineBody").eq(0).css("padding-left").replace("px", ""));
        c = x + b;
        if (q == 1) {
            e.css({
                right: "0",
                margin: "0 auto",
                width: c + "px"
            });
            j.css("height", F + "px");
            return
        }
        if (F > L) {
            L = F
        }
        K = parseInt(A.find(".J_mixNewsStyleTitleContainer5").height());
        if (K > I) {
            I = K
        }
    }
    j.css("height", L + "px");
    G.css("height", L + "px");
    e.css("height", L + "px").css("width", c + "px");
    a.css("height", I + "px");
    r = j.width();
    if (r < x) {
        if (Mobi.isPC()) {
            e.off("mousedown.newsListSlide").on("mousedown.newsListSlide", p)
        } else {
            f = new iScroll("J_newsListPanel" + h, {
                onBeforeScrollStart: null
            });
            E.off("touchmove.newlist" + h).on("touchmove.newlist" + h,
                function(P) {
                    if (m === false) {
                        P.preventDefault()
                    }
                });
            G.off("touchmove.newlist").on("touchmove.newlist",
                function(P) {
                    if (m === true) {
                        P.stopPropagation()
                    }
                });
            e.off("touchstart.newlist").on("touchstart.newlist", k)
        }
    }
};
Mobi.initModuletimeAxisNewsList = function(s) {
    var b = s.moduleId;
    var c = jm("#newsList" + b);
    var r = s.picNum;
    if (c.length == 0) {
        return
    }
    if (r != 7) {
        return
    }
    var p = c.find(".J_newsTitlePic");
    var l;
    var a = parseInt(p.width());
    var e = parseInt(p.height());
    var d = Math.ceil(0.04 * a) + " 0";
    var f = a + " 0";
    var k = a + " " + e;
    var h = Math.ceil(0.04 * a) + " " + e;
    var o = Math.ceil(0.04 * a) + " " + Math.ceil(0.38 * e);
    var m = Math.ceil(0.01 * a) + " " + Math.ceil(0.33 * e);
    var q = Math.ceil(0.04 * a) + " " + Math.ceil(0.27 * e);
    var n = d + "," + f + "," + k + "," + h + "," + o + "," + m + "," + q;
    for (var j = 0; l = p.length, j < l; j++) {
        jm(p[j]).find("polygon").attr("points", n);
        jm(p[j]).find("svg").attr("width", a).attr("height", e);
        jm(p[j]).find("image").attr("width", a).attr("height", e)
    }
};
Mobi.fixIphoneMargin = function(a) {
    var c = a.moduleId;
    var b = jm("#newsList" + c);
    if (b.length == 0) {
        return
    }
    if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) {
        b.find(".J_newsElementsPanel .ne_separatorLine").css("vertical-align", "middle").css("padding-top", "0.05rem");
        b.find(".J_newsElementsPanel .ne_newsSort").css("vertical-align", "middle");
        b.find(".J_newsElementsPanel .ne_newsTime").css("vertical-align", "middle")
    }
};
Mobi.fixFormMiddleContentBottom = function(d, a) {
    var c = jm("#module" + d);
    if (c.length === 0) {
        return
    }
    var b = c.find(".formMiddleContent");
    if (a) {
        b.removeAttr("style")
    } else {
        b.css("margin-bottom", 0)
    }
};
Mobi.fixModuleTop = function(b) {
    var a = jm("#module" + b);
    if (a.length === 0) {
        return
    }
    if (parseInt(a.css("top")) > 0) {
        a.css("top", 0)
    }
    if (parseInt(a.css("border-radius")) > 0) {
        a.css("border-radius", 0)
    }
};
Mobi.vote = function(e, h, c, d) {
    var k = true;
    var a = new Array();
    jm(".voteItems" + e + h).each(function() {
        var m = {};
        var l = new Array();
        jm(this).find(".voteItems").find("input:checked").each(function() {
            var n = jm(this).val();
            if (!isNaN(n)) {
                l.push(parseInt(n))
            }
        });
        if (l.length == 0) {
            Mobi.ing(LS.voteNotSelect);
            k = false;
            return
        }
        m.itemList = l;
        a.push(m)
    });
    var f = parseInt(jm.getCookie("vote" + e));
    if (!k) {
        return
    }
    var j = (jm("#voteCodePanel" + e + h).css("display") == "none") ? false: true;
    var b = jm("#needVoteCode" + e + h).val();
    if (j && b == "") {
        jm("#needVoteCode" + e + h).css("border-color", "#ff0000");
        return
    }
    Mobi.ing(LS.voteBeing, -1);
    jm("#vote" + e + h).attr("disabled", true);
    jm(".voteCodePic").attr("src", "validateCode.jsp?" + Math.random() * 1000 + "&validateCodeRegType=3");
    jm.ajax({
        type: "post",
        url: "ajax/vote_h.jsp?cmd=voteItem",
        data: "vid=" + e + "&list=" + jm.encodeUrl(jm.toJSON(a)) + "&verificationCode=" + jm.encodeUrl(b),
        error: function() {
            Mobi.ing(LS.voteError);
            setTimeout(function() {
                    jm("#vote" + e + h).removeAttr("disabled")
                },
                3000)
        },
        success: function(m) {
            var l = jm.parseJSON(m);
            if (l.success) {
                jm("#needVoteCode" + e + h).val("");
                Mobi.ing(LS.voteSuccess, 1);
                jm(".voteItems" + e + h).find(".voteItems").find("input:checked").each(function() {
                    jm(this).attr("checked", false)
                });
                if (c > 0) {
                    if (jm.getCookie("vote" + e) === "" || jm.getCookie("vote" + e) === "null") {
                        var n = new Date();
                        n.setHours(n.getHours() + c);
                        jm.setCookie("vote" + e, c, {
                            expires: n
                        })
                    }
                } else {
                    if (c == 0) {
                        jm.setCookie("vote" + e, null)
                    } else {
                        jm.setCookie("vote" + e, -1, {
                            expires: 30
                        })
                    }
                }
            } else {
                if (l.login) {
                    Mobi.ing(LS.voteErrorByNotLogin)
                } else {
                    Mobi.ing(l.msg);
                    if (l.needCode) {
                        jm("#voteCodePanel" + e + h).show()
                    } else {
                        if (l.codeErr) {
                            jm("#needVoteCode" + e + h).css("border-color", "#ff0000")
                        }
                    }
                }
            }
            setTimeout(function() {
                    jm("#vote" + e + h).removeAttr("disabled")
                },
                3000)
        }
    })
};
Mobi.initModuleVote = function(e) {
    var f = e.id,
        c = e.delay,
        b = e.mid,
        a = e.isVoted;
    if (c == 0) {
        jm.setCookie("vote" + f, null)
    } else {
        if (c == -1) {
            if (jm.getCookie("vote" + f) === "null") {
                jm.setCookie("vote" + f, -1, {
                    expires: 30
                })
            }
        } else {
            if (jm.getCookie("vote" + f) === "-1") {
                jm.setCookie("vote" + f, null)
            }
            if (jm.getCookie("vote" + f) !== "" && parseInt(jm.getCookie("vote" + f)) != c) {
                var h = new Date();
                h.setHours(h.getHours() + c);
                jm.setCookie("vote" + f, c, {
                    expires: h
                })
            }
        }
    }
    jm("#vote" + f + b).click(function() {
        Mobi.vote(f, b, c, a)
    })
};
Mobi.showVoteResult = function(c, a) {
    var b = new Array();
    jm("#vote" + a).find("input:checked").each(function() {
        var d = jm(this).val();
        if (!isNaN(d)) {
            b.push(parseInt(d))
        }
    });
    jm("#voteResult").addClass("showFullScreen");
    if (jm("#voteResult").length > 0) {
        jm("#voteResult").remove()
    }
    jm("#fullScreenDivCotainer").append("<div id='voteResult'  class=' webBackground webContainerBox voteResultDiv moduleContent fk-body-bg' style='overflow-y:auto;'></div>");
    jm.ajax({
        type: "post",
        url: "ajax/vote_h.jsp?cmd=voteResult",
        data: "id=" + c + "&list=" + b,
        error: function() {
            Mobi.ing(LS.systemError)
        },
        success: function(d) {
            var e = jm.parseJSON(d);
            var f = e.msg;
            if (e.success) {
                jm("#voteResult").append(e.html);
                jm("#voteResult").addClass("showVoteResult");
                if (f.length > 0) {
                    Mobi.ing(f)
                }
            }
        }
    })
};
Mobi.closeVoteResult = function() {
    jm("#voteResult").removeClass("showVoteResult");
    setTimeout(function() {
            jm("#voteResult").remove()
        },
        600)
};
Mobi.popupSearch = function(b) {
    if (!b || !typeof b.moduleType || !typeof b.moduleColor || !typeof b.hotTopic) {
        return
    }
    var j;
    if (b.searchProduct) {
        if (jm.getCookie("productSearchHistory")) {
            j = JSON.parse(jm.getCookie("productSearchHistory"))
        }
    } else {
        if (jm.getCookie("searchHistory")) {
            j = JSON.parse(jm.getCookie("searchHistory"))
        }
    }
    var h = "icon-closeSearch";
    if (b.isSysProductGroupCol) {
        h = "icon-offSearch"
    }
    var f;
    var e = [];
    e.push('<div id="searchWindow" class="searchWindow">');
    e.push('	<div class="searchInputBar">');
    e.push('		<div id="icon-closeSearch" class="' + h + '"></div>');
    e.push('		<div class="popupSearchWrap popupSearchWrap' + b.moduleType + '">');
    e.push('			<div class="icon-popupSearchIcon"></div>');
    e.push('			<form><input id="searchInput" class="popupSearchInput" type="search" placeholder="' + b.searchTip + '"></form>');
    e.push('			<div class="icon-popupSearchBtn" id="icon-searchSubmit"></div>');
    e.push("		</div>");
    e.push("	</div>");
    if (b && b.hotTopic && b.hotTopic.length) {
        e.push('	<div class="hotTopicWrap">');
        e.push("		<h3>" + LS.hostSearch + "</h3>");
        for (var d = 0,
                 a = b.hotTopic.length; d < a; d++) {
            e.push('<span class="topicItem">' + b.hotTopic[d] + "</span>")
        }
        e.push("	</div>")
    }
    if (b.historySearch && j) {
        e.push('<div class="historyTopicWrap">');
        e.push("		<h3>" + LS.historySearch + "</h3>");
        if (j) {
            for (var d = 0,
                     a = j.length; d < a; d++) {
                e.push('<span class="topicItem">' + j[d] + "</span>")
            }
        }
        e.push("</div>");
        e.push('<div id="clearHistoryBtn" class="clearHistoryBtn">' + LS.clearHistory + "</div>")
    }
    e.push("</div>");
    var c = jm(e.join(""));
    switch (b.moduleType) {
        case 0:
            c.find("#searchInput").css("padding-right", "1.8rem");
            break;
        case 1:
            c.find("#searchInput").css("padding-right", "2.5rem");
            break;
        case 2:
            c.find("#searchInput").css("padding-right", "2.5rem");
            break;
        case 3:
            c.find("#searchInput").css("padding-right", "1.8rem");
            break;
        case 4:
            c.find("#searchInput").css("padding-right", "3.3rem");
            break;
        case 5:
            c.find("#searchInput").css("padding-right", "1.8rem");
            break
    }
    jm("#g_web").append(c);
    jm("#icon-closeSearch").on("click",
        function() {
            jm("#searchWindow").on("animationend webkitAnimationEnd msAnimationEnd oAnimationEnd oanimationend",
                function() {
                    jm("#searchWindow").remove();
                    jm(this).off("animationend webkitAnimationEnd msAnimationEnd oAnimationEnd oanimationend")
                });
            jm("#searchWindow").addClass("searchWindowOff");
            jm(this).off("click")
        });
    jm("#icon-searchSubmit").on("click",
        function() {
            f = jm.trim(jm("#searchInput").val());
            if (f == "") {
                jm("#searchInput").get(0).focus();
                return
            }
            Mobi.searchInMobi(f, b)
        });
    jm("#searchWindow").on("keypress", "#searchInput",
        function(k) {
            if (k.which === 13) {
                f = jm.trim(jm("#searchInput").val());
                Mobi.searchInMobi(f, b);
                return false
            }
        });
    jm("#searchWindow").on("click", ".topicItem",
        function() {
            f = jm(this).text();
            Mobi.searchInMobi(f, b);
            jm(".topicItem").off("click")
        });
    jm("#searchWindow").on("click", "#clearHistoryBtn",
        function() {
            jm(".historyTopicWrap").remove();
            jm(this).remove();
            if (b.searchProduct) {
                jm.setCookie("productSearchHistory", "", -1)
            } else {
                jm.setCookie("searchHistory", "", -1)
            }
        });
    jm("#searchInput").get(0).focus()
};
Mobi.searchInMobi = function(e, d) {
    var f = d.moduleId;
    var c = d.lanCode;
    var h = e;
    var a = d.nSL;
    var b = "searchResult.jsp?searchword=" + jm.encodeUrl(jm.trim(h)) + "&nSL=" + a;
    if (d.searchProduct == 1) {
        b = "pr.jsp?psId=" + f + "&searchword=" + jm.encodeUrl(jm.trim(h))
    }
    window.location.href = b;
    var j = [];
    if (d.searchProduct) {
        if (jm.getCookie("productSearchHistory")) {
            j = JSON.parse(jm.getCookie("productSearchHistory")) || []
        }
    } else {
        if (jm.getCookie("searchHistory")) {
            j = JSON.parse(jm.getCookie("searchHistory")) || []
        }
    }
    if (j.indexOf(h) !== -1) {
        return
    }
    j.unshift(h);
    j = j.slice(0, 10);
    if (d.searchProduct) {
        jm.setCookie("productSearchHistory", jm.toJSON(j), 7)
    } else {
        jm.setCookie("searchHistory", jm.toJSON(j), 7)
    }
}; (function(b, a, c) {
    a.manageFaiscoAd = function(d) {
        var e = jm.cookie("faiscoAd", {
            path: "/"
        });
        if (e !== "true") {
            jm("#mobiAdvertisement_box").css("display", "block");
            if (Fai.top._manageMode == false) {
                Mobi.logDog(200010, 7)
            }
            if (d == 4 && jm("#mobiAdvertisement_adImg").length > 0 && Mobi.getStyle(Mobi.getPreviewObject("mobiAdvertisement_box"), "display") != "none") {
                jm("#header .navButton").css("bottom", (parseInt(jm("#header .navButton").css("bottom")) + 40) + "px");
                jm("#navbar").css("bottom", (parseInt(jm("#navbar").css("bottom")) + 40) + "px")
            }
            if (jm("#webCustomerServiceBox").length > 0 && jm("#webCustomerServiceBox").css("display") != "none") {
                jm("#mobiAdvertisement_adImg").css("opacity", "0.8")
            }
        }
        jm("#mobiAdClose").click(function() {
            if (Fai.top._manageMode == true) {
                jm.cookie("faiscoAd", true, {
                    path: "/"
                })
            } else {
                Mobi.logDog(200010, 9)
            }
            jm("#mobiAdvertisement_box").remove()
        });
        jm("#mobiAdvertisement_adImg").click(function() {
            if (Fai.top._manageMode == true) {
                Mobi.logDog(200010, 1)
            } else {
                Mobi.logDog(200010, 0);
                Mobi.logDog(200010, 8)
            }
        });
        a.initAdvertisementForWechat();
        a.initAdvertisement()
    }
} (jm, Mobi)); (function(h, a, d) {
    var k = 200010;
    var j = {
        NORMAL_EXPOSURE_FREE: 10,
        NORMAL_CLICK_FREE: 11,
        WECHAT_EXPOSURE_FREE: 12,
        WECHAT_CLICK_FREE: 13
    };
    a.initAdvertisement = function() {
        var n = h("#mobiAdvertisement_box");
        if (n.length === 0) {
            return
        }
        m(n);
        l(n)
    };
    function m(o) {
        var q = h("#mobiAdvertisement_adImg");
        var p = "click.logAdv";
        var n = !a.isPC();
        if (n) {
            p = "touchend.logAdv"
        }
        q.off(p).on(p, f)
    }
    function l(q) {
        var t = h(window);
        var o = "scroll.exposureAdv";
        var p = "resize.exposureAdv";
        r();
        s();
        function r() {
            var u = a.throttle(s);
            n();
            t.on(o, u).on(p, u)
        }
        function n() {
            t.off(o).off(p)
        }
        function s() {
            var v = h("#mobiAdvertisement_adImg");
            var u = a.isInViewArea(t, v);
            if (u) {
                c();
                n()
            }
        }
    }
    function f() {
        if (b()) {
            a.logDog(k, j.NORMAL_CLICK_FREE)
        }
        if (e()) {
            a.logDog(k, j.WECHAT_CLICK_FREE)
        }
    }
    function c() {
        if (b()) {
            a.logDog(k, j.NORMAL_EXPOSURE_FREE)
        }
        if (e()) {
            a.logDog(k, j.WECHAT_EXPOSURE_FREE)
        }
    }
    function e() {
        return a.isWechat()
    }
    function b() {
        return ! e()
    }
} (jm, Mobi)); (function(b, a, c) {
    a.initAdvertisementForWechat = function() {
        if (a.isWechat()) {
            jm("#mobiAdvertisement_adImg").attr("href", "javascript:void(0);");
            jm("body").append("<div class='popupWXQrCode' id='popupWXQrCode' ><div class='wxQrBg'></div><img class='J_bigPic bgPic' src='" + Fai.top._resRoot + "/image/wx/wxQrCodeBack.png'/><div class='wxQrTip'>免费建站</div><img class='wxQrCodePic' src='" + Fai.top._resRoot + "/image/mobiFooterWechatQrCode.gif'/></div>");
            jm("#mobiAdvertisement_adImg").click(function() {
                jm(".popupWXQrCode").show()
            });
            jm(".wxQrBg").click(function() {
                jm(".popupWXQrCode").hide()
            });
            d()
        }
        function d() {
            var p = b("#popupWXQrCode");
            if (p.length === 0) {
                return
            }
            var f = p.find(".J_bigPic");
            var l = "touchstart.longPress";
            var k = 500;
            var q = "touchend.longPress";
            var j = null;
            var m = null;
            f.off(l).on(l, o);
            f.off(q).on(q, e);
            function o() {
                j = r()
            }
            function e() {
                m = r();
                var s = m - j;
                if (n(s)) {
                    h()
                }
            }
            function r() {
                return (new Date().getTime())
            }
            function n(s) {
                return s > k
            }
            function h() {
                if (a.isWechat()) {
                    var t = 200010;
                    var s = 14;
                    a.logDog(t, s)
                }
            }
        }
    }
} (jm, Mobi));
Mobi.logoSizeCompressByMargin = function() {
    if (jm("#pageLogo").length < 1) {
        return
    }
    var o = jm("#pageLogo"),
        l = jm("#webHeader");
    if (l.css("display") == "none") {
        return
    }
    o.height(0);
    var b = parseFloat(o.css("margin-top").replace("px", "")),
        j = parseFloat(o.css("margin-bottom").replace("px", "")),
        c = parseFloat(o.css("margin-left").replace("px", "")),
        n = parseFloat(o.css("margin-right").replace("px", "")),
        k = parseFloat(o.height()),
        a = parseInt(o.attr("sid")),
        m = parseInt(o.attr("pw")),
        e = parseInt(o.attr("ph")),
        d = parseFloat(l.height()),
        f = 0,
        h;
    f = Math.floor(d - b - j);
    o.height(f + "px");
    if (a != 0) {
        o.width(parseInt(o.height()) + "px")
    } else {
        h = parseInt(o.height()) * m / e;
        h = (h > l.width()) ? (l.width() - c - n) : h;
        o.width(h + "px")
    }
    jm("#webHeaderBox #header").removeClass("header-forLogo");
    o.css("visibility", "visible")
};
Mobi.titlePositionRefreshByLogo = function() {
    if (jm("#pageLogo").length < 1) {
        return
    }
    var l = jm("#pageLogo"),
        j = jm("#header"),
        f = jm("#pageTitle"),
        c = jm("#webHeader");
    if (c.css("display") == "none") {
        return
    }
    l.css({
        position: "",
        "float": "",
        left: "",
        right: ""
    });
    var a = "right";
    if (Fai.top._mobiSiteTitle.align == 0) {
        a = ""
    } else {
        if (Fai.top._mobiSiteTitle.align == 1) {
            a = "left"
        } else {
            if (Fai.top._mobiSiteTitle.align == 2) {
                a = "center"
            }
        }
    }
    j.css("text-align", a);
    j.css("padding", "");
    f.css("max-width", "");
    var k = parseInt(j.width());
    logoWidth = parseInt(l.width()),
        logoMarginLeft = parseInt(l.css("margin-left").replace("px", "")),
        logoMarginRight = parseInt(l.css("margin-right").replace("px", "")),
        headerPaddingLeft = parseInt(j.css("padding-left").replace("px", "")),
        headerPaddingRight = parseInt(j.css("padding-right").replace("px", "")),
        titlePaddingLeft = parseInt(f.css("padding-left").replace("px", "")),
        titlePaddingRight = parseInt(f.css("padding-right").replace("px", ""));
    if (l.css("display") != "none") {
        f.css("max-width", (k - logoWidth - logoMarginLeft - logoMarginRight - titlePaddingLeft - titlePaddingRight - 10) + "px");
        if (j.css("text-align") == "center" && (l.hasClass("left") || l.hasClass("right"))) {
            l.css({
                position: "absolute",
                "float": "none"
            });
            j.css("padding", 0);
            if (l.hasClass("left")) {
                if (headerPaddingLeft > 0) {
                    l.css("left", headerPaddingLeft + "px")
                } else {
                    l.css("left", 0)
                }
                if (jm("#pageTitle").text() != "" && f.offset().left < (l.offset().left + logoWidth)) {
                    j.css("padding", "0 0 0 " + (headerPaddingLeft + logoMarginLeft + logoMarginRight + logoWidth) + "px");
                    j.css("text-align", "left")
                }
            } else {
                if (l.hasClass("right")) {
                    if (headerPaddingRight > 0) {
                        l.css("right", headerPaddingRight + "px")
                    } else {
                        l.css("right", 0)
                    }
                    if (jm("#pageTitle").text() != "" && (f.offset().left + parseInt(f.width())) > l.offset().left) {
                        j.css("padding", "0 " + (headerPaddingRight + logoMarginLeft + logoMarginRight + logoWidth) + "px 0 0");
                        j.css("text-align", "right")
                    }
                }
            }
        } else {
            if (j.css("text-align") == "center") {
                j.css("padding", 0);
                if (headerPaddingLeft > 0) {
                    var d = ((l.offset().left) <= (j.offset().left + headerPaddingLeft));
                    var h = (f.offset().left) <= (j.offset().left + headerPaddingLeft);
                    var e = (f.css("display") === "none");
                    if (e) {
                        h = false
                    }
                    var b = (d || h);
                    if (b) {
                        j.css("padding", "");
                        j.css("text-align", "left")
                    }
                } else {
                    if (headerPaddingRight > 0) {
                        if ((l.offset().left + logoWidth) >= (j.offset().left + k) || (f.offset().left + parseInt(f.width())) >= (j.offset().left + k)) {
                            j.css("padding", "");
                            j.css("text-align", "right")
                        }
                    }
                }
            }
        }
        if ((l.height() <= f.offset().top) && f.text() == "") {
            f.addClass("fk-pageTitleFix");
            if ( !! Fai.top._manageMode) {
                Mobi.autoFixGWebTop(Fai.top._templateLayoutId)
            }
        } else {
            f.removeClass("fk-pageTitleFix")
        }
    } else {
        f.css("max-width", (k - titlePaddingLeft - titlePaddingRight) + "px");
        if (j.css("text-align") == "center") {
            j.css("padding", 0);
            if (headerPaddingLeft > 0 && (f.offset().left <= (j.offset().left + headerPaddingLeft))) {
                j.css("padding", "")
            } else {
                if (headerPaddingRight > 0 && (parseInt(f.width()) >= (j.offset().left + k - headerPaddingRight))) {
                    j.css("padding-right", "1.5rem")
                }
            }
        }
    }
};
Mobi.countSiteTitleBgHeiht = 0;
Mobi.changeTempCountSiteBgHeight = function() {
    if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
        return
    }
    if (jm("#headerBg").length < 1) {
        return
    }
    var a = jm("#headerBg"),
        e = jm("#headerWhiteBg"),
        h = jm("#navButton"),
        c = jm("#webHeader"),
        l = parseFloat(c.height()),
        m = parseFloat(c.css("padding-top")),
        b = parseFloat(c.css("padding-bottom")),
        d = parseFloat(c.css("border-top-width")),
        f = parseFloat(c.css("border-bottom-width")),
        j = l + m + b + d + f,
        k = j.toString() + "px";
    a.css("height", (j / _htmlFontSize) + "rem");
    if (b > 0) {
        a.css("padding-bottom", (b / _htmlFontSize) + "rem")
    }
    e.css("height", (j / _htmlFontSize) + "rem");
    Mobi.countSiteTitleBgHeiht = k;
    if (Mobi.showSiteTitleBgGloable.bgType !== "undefined" && Mobi.showSiteTitleBgGloable.bgType != "null") {
        Mobi.changeSiteTitleBg(Mobi.showSiteTitleBgGloable.bgType, Mobi.showSiteTitleBgGloable.bgImgStyle, Mobi.showSiteTitleBgGloable.bgFontColor, Mobi.showSiteTitleBgGloable.bgFontAlpha, Mobi.showSiteTitleBgGloable.linkCoverPreViewPath)
    }
};
Mobi.showSiteTitleBgGloable = {};
Mobi.showSiteTitleBgGloable.showSiteTitleBgFlag = false;
Mobi.setShowSiteTitleBgFlag = function(b) {
    var a = jm("#webHeader");
    if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
        return
    }
    if (b == 0) {
        Mobi.showSiteTitleBgGloable.showSiteTitleBgFlag = true;
        a.removeClass("mobiTitleClose")
    } else {
        Mobi.showSiteTitleBgGloable.showSiteTitleBgFlag = false;
        a.addClass("mobiTitleClose")
    }
    setTimeout(function() {
            Mobi.changeTempCountSiteBgHeight()
        },
        1000)
};
Mobi.changeSiteTitleBg = function(b, f, d, e, k) {
    Mobi.showSiteTitleBgGloable.bgType = b;
    Mobi.showSiteTitleBgGloable.bgImgStyle = f;
    Mobi.showSiteTitleBgGloable.bgFontColor = d;
    Mobi.showSiteTitleBgGloable.bgFontAlpha = e;
    Mobi.showSiteTitleBgGloable.linkCoverPreViewPath = k;
    var a = jm("#headerBg");
    var c = jm("#webHeader");
    var j = jm("#headerWhiteBg");
    var h = jm("#webHeaderBox");
    if (b != null && b != "") {
        if (b == 1) {
            a.css("background", "transparent");
            a.css("background-color", "#fff");
            a.css("opacity", "1");
            a.css("filter", (opacity = "100"));
            if (Mobi.showSiteTitleBgGloable.showSiteTitleBgFlag) {
                a.css("display", "block");
                j.css("display", "block")
            } else {
                a.css("display", "none");
                j.css("display", "none")
            }
        } else {
            if (b == 2) {
                if (k != null && k != "") {
                    a.css("background-image", "url(" + k + ")")
                }
                if (f == 2) {
                    a.css("background-color", d);
                    a.css("opacity", e / 100);
                    a.css("background-size", "cover");
                    a.css("background-repeat", "inherit");
                    a.css("filter", (opacity = e))
                } else {
                    if (f == 3) {
                        a.css("background-color", d);
                        a.css("opacity", e / 100);
                        a.css("background-size", "100% 100%");
                        a.css("background-repeat", "inherit");
                        a.css("filter", (opacity = e))
                    } else {
                        if (f == 4) {
                            a.css("background-color", d);
                            a.css("opacity", e / 100);
                            a.css("background-size", "inherit");
                            a.css("background-repeat", "repeat");
                            a.css("filter", (opacity = e))
                        } else {
                            if (f == 5) {
                                a.css("background-color", d);
                                a.css("opacity", e / 100);
                                a.css("background-size", "inherit");
                                a.css("background-repeat", "no-repeat");
                                a.css("filter", (opacity = e))
                            } else {
                                a.css("background-image", "none");
                                a.css("background-color", d);
                                a.css("filter", (opacity = e));
                                a.css("opacity", e / 100)
                            }
                        }
                    }
                }
                if (Mobi.showSiteTitleBgGloable.showSiteTitleBgFlag) {
                    a.css("display", "block");
                    j.css("display", "block")
                } else {
                    a.css("display", "none");
                    j.css("display", "none")
                }
            } else {
                a.css("display", "none");
                j.css("display", "none");
                c.css("background-image", "");
                c.css("background-color", "")
            }
        }
    }
    if (Fai.top._templateFrameId >= 2000 && Fai.top._templateFrameId < 3000) {
        return
    }
    window.onload = function() {
        Mobi.changeTempCountSiteBgHeight()
    };
    Mobi.countSiteTitleBgHeiht = c.height();
    a.css("height", (Mobi.countSiteTitleBgHeiht / _htmlFontSize) + "rem");
    j.css("height", (Mobi.countSiteTitleBgHeiht / _htmlFontSize) + "rem")
};
Mobi.bindTopIconBack = function() {
    if (Fai.top._templateFrameId === 2004) {
        var a = jm(".J_to_back");
        if (!a.length) {
            return
        }
        a.off("click.tb").on("click.tb",
            function() {
                if (Fai.top._manageMode) {
                    jm(Fai.top.document.getElementById("jz_designerOperate").querySelector(".j_designerBack")).click()
                } else {
                    if (window.history.length <= 1) {
                        window.location.href = "index.jsp"
                    } else {
                        window.history.back()
                    }
                }
            })
    }
};
Mobi.iframeToEmbed = function(b, f, a) {
    var e = jm("#" + b + " iframe");
    var c;
    if (jm.os.ie) {
        if (a == "v.youku.com" || a == "player.youku.com") {
            c = "http://player.youku.com/player.php/sid/" + f + "/v.swf"
        } else {
            if (a == "v.qq.com" || a == "static.video.qq.com") {
                c = "http://static.video.qq.com/TPout.swf?vid=" + f + "&auto=0"
            } else {
                return false
            }
        }
        var d = "<embed class='mobiVideoOnlineIframe' src='" + c + "' allowFullScreen='true' wmode='Opaque' quality='high'  align='middle' allowScriptAccess='always' type='application/x-shockwave-flash'></embed>";
        jm(d).insertBefore(e);
        e.remove()
    }
    return
};
Mobi.videoPoster = function(c, b) {
    var a = jm("#" + c);
    a[0].addEventListener("loadedmetadata",
        function() {
            var d = a.height(),
                h = a.width(),
                e = d / _htmlFontSize,
                f = h / _htmlFontSize;
            a.css("max-height", "20rem").css("max-width", f + "rem")
        })
};
Mobi.videoDialog = function(a) {
    jm.ajax({
        type: "post",
        url: "ajax/flv_h.jsp",
        data: "cmd=getFLvDialog&moduleId=" + a,
        error: function() {},
        success: function(b) {
            b = jm.parseJSON(b);
            var d = "<div class='videoDialog' id='videoDialog'><div class=\"cancelVideo faisco-icons-\" onclick=\"Mobi.cancelVideoDialog(" + a + ')"></div>' + b.data + "</div>";
            jm("#g_body").append(d);
            var c = document.getElementById("g_body");
            c.style.overflowY = "hidden"
        }
    })
};
Mobi.cancelVideoDialog = function(b) {
    jm("#videoDialog").remove();
    var a = document.getElementById("g_body");
    a.style.overflowY = ""
};
Mobi.initModuleCubeNavItemHeight = function(b, c) {
    if (b == 5 || b == 6 || b == 8 || b == 11 || b == 15 || b == 16) {
        return
    }
    var a = ".cubeLink_row";
    if (b == 14) {
        a = ".cubeLink_row_head"
    }
    var d = jm("#module" + c).find(a);
    if (d.length > 0) {
        d.each(function() {
            var f = jm(this).find(".cubeLink");
            var e = 0;
            f.each(function() {
                var h = Number(jm(this).height());
                if (h > e) {
                    e = h
                }
            });
            jm(this).find(".cubeLink_a").css("height", e + "px");
            if (b != 13 && b != 14) {
                f.css("height", e + "px")
            }
        })
    }
};
Mobi.initBackTop = function(a) {
    var c = jm("#backTop");
    var b = jm("#J_showGiftPage");
    clientHeight = document.body.offsetHeight;
    if (Mobi.initBackToprManage) {
        Mobi.initBackToprManage()
    }
    if (a) {} else {
        if (document.body.scrollTop < clientHeight || document.documentElement.scrollTop < clientHeight) {
            c.hide()
        }
    }
    document.addEventListener("touchmove", d);
    document.addEventListener("scroll", d);
    function d() {
        if (document.body.scrollTop > clientHeight || document.documentElement.scrollTop > clientHeight) {
            c.show();
            if (b != undefined) {
                b.css("bottom", "4.8rem")
            }
        } else {
            c.hide();
            if (b != undefined) {
                b.css("bottom", "2.8rem")
            }
        }
    }
    c.on("click",
        function() {
            var f = document.body.scrollTop + document.documentElement.scrollTop,
                e, h;
            h = setInterval(function(j) {
                    e = f / 4;
                    f = parseInt(f - e);
                    document.body.scrollTop = f;
                    document.documentElement.scrollTop = f;
                    if (f <= 0) {
                        clearInterval(h)
                    }
                },
                1000 / 60)
        })
};
Mobi.initBgm = function(d) {
    var b = jm("#bgmAudio"),
        e = Mobi.getPreviewWindow();
    b.attr("src", d);
    var h;
    jm("#bgMusic").bind("click",
        function() {
            var j = jm("#bgMusic .bgm_icon_inner");
            if (j.hasClass("bgm_on")) {
                Mobi.bgmPause();
                jm.cookie("_bgmIsPause", 1);
                h = false
            } else {
                Mobi.bgmPlay();
                jm.cookie("_bgmIsPause", 0);
                h = true
            }
        });
    jm(e).off("beforeunload.bgMusic").on("beforeunload.bgMusic",
        function() {
            e.Mobi.recordLastPlayerTime("bgmAudio", "bgplayerTime")
        });
    b.off("ended.bgm").on("ended.bgm",
        function(k) {
            var j = jm("#bgMusic .bgm_icon_inner");
            j.removeClass("bgm_on")
        });
    b.off("durationchange.bgm").on("durationchange.bgm",
        function() {
            var j = Mobi.callLastPlayerTime("bgplayerTime", 0);
            if (this.duration >= j) {
                this.currentTime = j
            }
        });
    if (jm("#bgmAudio").attr("autoplay")) {
        var c = navigator.userAgent;
        if (/(iPhone|iPad|iPod|Android)/i.test(c)) {
            var a = jm("#bgMusic .bgm_icon_inner");
            jm("body").off("touchstart.bgm").on("touchstart.bgm",
                function(j) {
                    if (!parseInt(jm.cookie("_bgmIsPause")) && !(j.target == a[0])) {
                        Mobi.bgmPlay()
                    }
                });
            if (!jm("#bgmAudio").attr("loop")) {
                jm("#bgmAudio").off("playing.bgm").on("playing.bgm",
                    function(j) {
                        jm("body").off("touchstart.bgm")
                    })
            }
        }
        Mobi.bgmPlay();
        h = true
    }
    if (jm.cookie("_bgmIsPause")) {
        var f = parseInt(jm.cookie("_bgmIsPause"));
        if (f == 1) {
            Mobi.bgmPause();
            h = false
        } else {
            Mobi.bgmPlay();
            h = true
        }
    }
    Mobi.initBgmPosition();
    Mobi.bindBodyScrollEvent();
    jm("video").on("play",
        function() {
            Mobi.bgmPause();
            jm.cookie("_bgmIsPause", 1)
        });
    jm("video").on("pause",
        function() {
            if (h) {
                Mobi.bgmPlay();
                jm.cookie("_bgmIsPause", 0)
            }
        })
};
Mobi.initBgmPosition = function() {
    var b = jm("#bgMusic .bgm_icon");
    if (b.length < 1) {
        return
    }
    var a = 0;
    b.css({
        top: "",
        bottom: ""
    });
    if (b.hasClass("bgm_rightUp") || b.hasClass("bgm_leftUp")) {
        Mobi.scrollBgmPosition()
    } else {
        if (b.hasClass("bgm_rightDown") || b.hasClass("bgm_leftDown")) {
            if (jm("#customerServiceDiv").length < 1 || jm("#customerServiceDiv").find(".service").length < 1) {
                a = 20
            } else {
                a = parseInt(jm("#customerServiceDiv").height()) + 20
            }
            b.css("bottom", a + "px")
        }
    }
};
Mobi.scrollBgmPosition = function() {
    var a = jm("#bgMusic .bgm_icon"),
        h = jm("#webMultilingualArea"),
        j = jm("#webHeaderBox"),
        b = jm(".loginHeader.webHeaderBg"),
        e = parseInt(j.height()),
        d = jm("body"),
        k = Fai.top._templateFrameId;
    var l = 0,
        f = 10,
        c = document.documentElement.scrollTop || document.body.scrollTop;
    if (a.hasClass("bgm_rightUp") || a.hasClass("bgm_leftUp")) {
        if (h.length > 0) {
            l = h.offset().top + parseInt(h.height()) - c
        } else {
            l = j.offset().top + e - c
        }
        if (!l) {
            if (d.hasClass("mobiCol20") || d.hasClass("mobiCol21") || d.hasClass("mobiCol24") || d.hasClass("mobiCol28")) {
                if (k >= 2000) {
                    l = e + 10
                } else {
                    if (jm(".productDetailHeader").height() > 0) {
                        l = parseInt(jm(".productDetailHeader").height()) + 10
                    } else {
                        if (jm(".photoGroupDetailHeader").height() > 0) {
                            l = parseInt(jm(".photoGroupDetailHeader").height()) + 10
                        }
                    }
                }
            } else {
                if (b.length > 0) {
                    l = b.offset().top + parseInt(b.height()) - c + 10
                }
                l = l > 0 ? l: 10;
                if (k === 2004) {
                    l = l + e
                }
            }
            a.css("top", l + "px");
            return
        }
        if (j.css("position") == "fixed") {
            if (l >= e) {
                f = l + 10
            } else {
                f = e + 10
            }
        } else {
            if (l >= 0) {
                f = l + 10
            }
        }
        a.css("top", f + "px")
    }
};
Mobi.initBgmCookie = function() {
    jm.cookie("_bgmIsPause", null)
};
Mobi.resetBgmCookie = function() {
    var a = jm("#bgMusic .bgm_icon_inner");
    if (a.hasClass("bgm_on")) {
        jm.cookie("_bgmIsPause", 0)
    } else {
        jm.cookie("_bgmIsPause", 1)
    }
};
Mobi.bgmPause = function() {
    var b = jm("#bgMusic .bgm_icon_inner");
    var a = document.getElementById("bgmAudio");
    a.pause();
    b.removeClass("bgm_on")
};
Mobi.bgmPlay = function() {
    var b = jm("#bgMusic .bgm_icon_inner");
    var a = document.getElementById("bgmAudio");
    a.play();
    b.addClass("bgm_on")
};
Mobi.recordLastPlayerTime = function(b, d) {
    var a = Mobi.getPreviewObject(b),
        c = parseFloat(a ? a.currentTime: defaultTime);
    sessionStorage[d] = c
};
Mobi.callLastPlayerTime = function(c, a) {
    var b = parseFloat(sessionStorage[c]);
    return b >= 0 ? b: a
};
Mobi.checkBrowser = (function() {
    var c = ["animation", "MozAnimation", "webkitAnimation", "msAnimation", "OAnimation"],
        e = ["transform", "MozTransform", "webkitTransform", "msTransform", "OTransform"],
        b = ["opacity", "MozOpacity", "webkitOpacity", "msOpacity", "OOpacity"],
        d = document.createElement("div"),
        a = {};
    return function(h) {
        if (typeof a[h] == "boolean") {
            return a[h]
        }
        switch (h) {
            case "animation":
                props = c;
                break;
            case "transform":
                props = e;
                break;
            case "opacity":
                props = b;
                break;
            default:
                props = c
        }
        for (var j = 0,
                 f = props.length; j < f; j++) {
            if (d.style[props[j]] !== undefined) {
                a[h] = true;
                return a[h]
            }
        }
        a[h] = false;
        return a[h]
    }
})();
Mobi.initBannerDefaultDom = function(s) {
    var c = s.et,
        p = s.b,
        t = p.length,
        k, h, l = [],
        f = s.sd;
    l.push("<div id='bannerSwipe' class='swipe'>");
    l.push("<div id='bannerSwipeContainer' class='bannerSwipeContainer defaultBanner'>");
    for (k = 0; k < t; k++) {
        var b = p[k].i,
            a = p[k].lt,
            n = p[k].w,
            e = p[k].h,
            o = p[k].t,
            r = p[k].p,
            q = p[k].aj,
            m = p[k].des;
        l.push("<div id='bannerItem" + b + "'>");
        l.push('<a href="' + (a != 0 ? q: "javascript:;") + "\" vheight='" + e + "' vwidth='" + n + "' class='bannerImageDiv " + (o == 0 ? "systemtBanner": "customBanner") + "' style='display:block; background-image:url(" + r + ");'></a>");
        if (f) {
            l.push("<div class='bannerDescription'><div class='description'>" + d(m) + "</div></div>")
        }
        l.push("</div>")
    }
    l.push("</div>");
    if (f) {
        l.push("<div id='bannerBullet' class='bannerBullet2'>")
    } else {
        l.push("<div id='bannerBullet' class='bannerBullet'>")
    }
    l.push("<ul id='bullets' class='bullets'>");
    if (t > 1) {
        for (h = 0; h < t; h++) {
            l.push("<li " + (h == 0 ? "class='on'": "") + "></li>")
        }
    }
    l.push("</ul>");
    l.push("</div>");
    l.push("</div>");
    jm("#webBanner").html("").append(l.join(""));
    function d(j) {
        return j && j.replace ? (j.replace(/&/g, "&amp;").replace(/ /g, "&nbsp;").replace(/\b&nbsp;+/g, " ").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\\/g, "&#92;").replace(/\'/g, "&#39;").replace(/\"/g, "&quot;").replace(/\n/g, "<br/>").replace(/\r/g, "")) : j
    }
};
Mobi.initSwipe = function(a, o, h) {
    var t = Mobi.getJQMobi();
    var w = f(a);
    var m = jm("#webBanner")[0];
    if (!w) {
        return
    }
    if (jm._swipehandle) {
        jm._swipehandle.kill()
    }
    var d = w.querySelectorAll(".bannerImageDiv.customBanner"),
        y = w.querySelectorAll(".bannerImageDiv"),
        z = d.length,
        j = y.length,
        l = w.offsetWidth,
        c = "",
        p = 0,
        r,
        A,
        B;
    for (var x = 0; x < z; x++) {
        r = parseInt(d[x].getAttribute("vwidth"));
        A = parseInt(d[x].getAttribute("vheight"));
        B = A / r;
        if (B > p) {
            p = B
        }
    }
    if (j === 0) {
        var s = Mobi.preciseDecimal(l * 300 / 640, 2);
        w.querySelector(".defaultBanner").style.height = s + "px"
    } else {
        c = u();
        w.style.height = c + "px";
        m.style.height = c + "px"
    }
    if (!h) {
        if (!Mobi.checkBrowser() || o.et == 1) {
            jm._swipehandle = t("#" + a).swipehandle(w, {
                auto: 3000,
                continuous: true,
                bulletsClick: true,
                speed: o.st * 100,
                callback: function(D) {
                    var C = e.length;
                    while (C--) {
                        e[C].className = " "
                    }
                    if (!e[D]) {
                        e[D - e.length].className = "on"
                    } else {
                        e[D].className = "on"
                    }
                }
            })
        } else {
            w.style.visibility = "visible";
            var k = w.getBoundingClientRect().width,
                b = w.children[0],
                v = b.children;
            var n = v.length;
            while (n--) {
                v[n].style.width = k + "px"
            }
        }
        if (!w.querySelector(".bullets")) {
            return
        }
        var e = w.querySelector(".bullets").getElementsByTagName("li");
        return
    }
    function f(E) {
        var C = Mobi.getPreviewObject(E);
        if (C !== null) {
            var D = q(C);
            if (!D) {
                C = document.querySelector("#" + E)
            }
        }
        return C
    }
    function q(D) {
        var E = D.baseURI;
        var C = location.host;
        return E.indexOf(C) > -1
    }
    function u() {
        var C = 0;
        var D = (j - z > 0);
        if (D) {
            C = (l * p < l * 300 / 640 ? Mobi.preciseDecimal(l * 300 / 640, 2) : Mobi.preciseDecimal(l * p, 2))
        } else {
            C = Mobi.preciseDecimal(l * p, 2)
        }
        return C
    }
};
Mobi.bannerAnimate = {}; (function(n, N, o) {
    var f = false,
        T = 1,
        j = 0,
        X = -1,
        G = -1,
        u = false,
        P = true,
        D, h = 0,
        Q = {
            duration: 3000
        },
        W = {},
        E = 0,
        c = 0,
        R,
        U = n("#bannerSwipe"),
        H = U.find(".bannerSwipeContainer"),
        w = H.find(".billboard_item"),
        h = w.length;
    N.init = function(aa) {
        var Z = aa;
        if (n("#webBanner").length < 1) {
            return
        }
        if (Z.b.length < 2) {
            return
        }
        if (Z.showType == 3) {
            return
        }
        var ab = Mobi.checkBrowser();
        if (!ab || Z.et == 1) {
            return false
        }
        clearTimeout(D);
        j = 0;
        u = false;
        O(Z);
        I(Z);
        Mobi.initSwipe("bannerSwipe", Z);
        F(Z);
        V(Z);
        Y();
        return true
    };
    function O(Z) {
        if (Z != o) {
            R = Z;
            W.effectType = Z.et;
            W.switchingTime = Z.st * 100;
            W.duration = Q.duration;
            T = Z.et;
            showDesc = Z.sd
        }
        if (W.effectType == 0) {
            T = y(0, 13)
        }
    }
    function F(Z) {
        U = n("#bannerSwipe");
        H = U.find(".bannerSwipeContainer");
        w = H.find(".billboard_item");
        h = w.length;
        var aa = n("#bullets"),
            ab = aa.find("li");
        ab.removeClass("on");
        ab.eq(j).addClass("on")
    }
    function I(ap) {
        var ao = T,
            ab = ap.w,
            an = ap.h,
            am = ap.b,
            al = am.length,
            aq = 0,
            ak, aj, ae, ac;
        switch (ao) {
            case 9:
            case 10:
                aq = 4;
                break;
            case 11:
            case 12:
            case 13:
                aq = 5;
                break;
            default:
                aq = 0
        }
        var ad = [];
        ad.push("<div id='bannerSwipe' class='swipe'>");
        ad.push("<div id='bannerSwipeContainer' class='bannerSwipeContainer defaultBanner billboard billboard" + ao + "'>");
        var ai, af, ar, aa, ah, Z, ag, ar, ae, ac;
        for (ak = 0; ak < al; ak++) {
            ai = am[ak].i;
            af = am[ak].lt;
            ar = "";
            aa = am[ak].w;
            ah = am[ak].h;
            Z = am[ak].t;
            ag = am[ak].p;
            ar = am[ak].aj;
            ae = 1;
            ac = 1;
            des = am[ak].des;
            if (aq == 0) {
                ad.push("<div id='bannerItem" + ai + "' class='billboardAnim billboard_item " + (aq != 0 ? "billboard_item" + ak: "") + "  billboardItem_" + ao + "' _des='" + des + "'>");
                ad.push('<a href="' + (af != 0 ? ar: "javascript:;") + "\" vheight='" + ah + "' vwidth='" + aa + "' class='bannerImageDiv " + (Z == 0 ? "systemtBanner": "customBanner") + "' style='display:block; background-image:url(" + ag + ");'></a>")
            } else {
                if (aq == 4) {
                    ad.push("<div class='billboard_item billboardItem_" + ao + " billboardItem_" + ao + "_" + (ak + 1) + "' _des='" + des + "'>");
                    for (ac = 1; ac < aq; ac++) {
                        ad.push("<div class='billboardTile billboardTile_" + ac + " billboardAnim'>");
                        ad.push("<div class='billboardImg'>");
                        ad.push("<a class='bannerImageDiv J_bannerItem systemtBanner billboardImgInner " + (Z == 0 ? "systemtBanner": "customBanner") + "' hidefocus='true' title='' href=\"" + (af != 0 ? ar: "javascript:;") + "\" vheight='" + ah + "' vwidth='" + aa + "' target='' style='overflow: hidden; display: block; outline: none; margin: 0px auto; position: relative; z-index: 1; background-image: url(" + ag + "); background-position: 50% 50%; background-repeat: no-repeat;'>");
                        ad.push("</a>");
                        ad.push("</div>");
                        ad.push("</div>")
                    }
                } else {
                    ad.push("<div class='billboard_item billboardItem_" + ao + " billboardItem_" + ao + "_" + (ak + 1) + "' _des='" + des + "'>");
                    for (ae = 1; ae < aq; ae++) {
                        ad.push("<div class='billboardTile billboardTile_" + ae + "'>");
                        ad.push("<div class='billboardAnim billboardTileImg'>");
                        ad.push("<div class='billboardImg'>");
                        ad.push("<a class='bannerImageDiv J_bannerItem systemtBanner billboardImgInner " + (Z == 0 ? "systemtBanner": "customBanner") + "' hidefocus='true' title='' href=\"" + (af != 0 ? ar: "javascript:;") + "\" vheight='" + ah + "' vwidth='" + aa + "' target='' style='overflow: hidden; display: block; outline: none; margin: 0px auto; position: relative; z-index: 1; background-image: url(" + ag + "); background-position: 50% 50%; background-repeat: no-repeat;'>");
                        ad.push("</a>");
                        ad.push("</div>");
                        ad.push("</div>");
                        ad.push("</div>")
                    }
                }
            }
            if (showDesc) {
                ad.push("<div class='bannerDescription'><div class='description'>" + m(des) + "</div></div>")
            }
            ad.push("</div>")
        }
        ad.push("</div>");
        if (showDesc) {
            ad.push("<div id='bannerBullet' class='bannerBullet2' style='" + (al < 2 ? "display:none;": "") + "' >")
        } else {
            ad.push("<div id='bannerBullet' class='bannerBullet' style='" + (al < 2 ? "display:none;": "") + "' >")
        }
        ad.push("<ul id='bullets' class='bullets'>");
        for (aj = 0; aj < al; aj++) {
            ad.push("<li " + (aj == j ? "class='on'": "") + "></li>")
        }
        ad.push("</ul>");
        ad.push("</div>");
        ad.push("</div>");
        n("#webBanner").html(ad.join(""))
    }
    function Y() {
        var Z = n("#webBanner").height() || 0;
        if (W.effectType == 0 && Z != 0) {
            n("#webBanner").css("height", Z + "px")
        } else {
            n("#webBanner").css("height", "")
        }
    }
    function b() {
        E = H.width() || 0;
        c = n("#webBanner").height() || 0;
        itemMaxHeight1 = n("#bannerSwipe").height() || 0;
        var aa = w.eq(j);
        aa.addClass("billboardItem_" + T + "_start");
        var ab, ad;
        if (W.effectIndex == 0) {
            H.addClass("billboard" + effectIndex)
        }
        for (var Z = 0; Z < w.length; Z++) {
            ab = w.eq(Z);
            z(ab, "animationDuration", W.switchingTime + "ms");
            ad = ab.find(".billboardAnim");
            switch (T) {
                case 3:
                    z(ab, "transformOrigin", "50% 50% " + ( - E / 2) + "px");
                    break;
                case 4:
                    z(ab, "transformOrigin", "50% 50% " + ( - c / 2) + "px");
                    break;
                case 9:
                    z(ad, "transformOrigin", "50% 50% " + ( - E / 2) + "px");
                    z(ad, "animationDuration", W.switchingTime + "ms");
                    break;
                case 10:
                    z(ad, "transformOrigin", "50% 50% " + ( - ab.find(".billboardAnim").height() / 2) + "px");
                    z(ad, "animationDuration", W.switchingTime + "ms");
                    ab.css("height", itemMaxHeight1);
                    break;
                case 11:
                case 12:
                case 13:
                    z(ad, "animationDuration", W.switchingTime + "ms");
                    if (T === 11 || T === 12) {
                        var ac = navigator.userAgent.toLowerCase();
                        if (ac.indexOf("se 2.x") > -1 || ac.indexOf("36") > -1) {
                            z(ad.find(".customBanner"), "backgroundSize", "contain")
                        }
                    }
                    break;
                default:
            }
        }
        w.css("display", "none");
        aa.css("display", "block")
    }
    function V() {
        b();
        t();
        L();
        A()
    }
    function A() {
        var Z = Q.duration;
        if (R.atOnce && R.et != 0) {
            Z = 1000
        }
        R.atOnce = false;
        if (!u) {
            clearTimeout(D);
            D = setTimeout(e, Z)
        }
    }
    function k() {
        P = true;
        A()
    }
    function s() {
        if (!P) {
            return
        }
        clearTimeout(D)
    }
    function t() {
        var Z = n("#bannerBullet"),
            aa = Z.find("li");
        aa.click(function(ac) {
            ac.stopPropagation();
            var ab = aa.index(this);
            g = ab;
            s();
            S(ab)
        })
    }
    function x(aa) {
        var Z = n("#bullets"),
            ab = Z.find("li");
        ab.removeClass("on");
        ab.eq(aa).addClass("on")
    }
    function p(ab, ac) {
        var aa = w.eq(j),
            Z = w.eq(ab);
        Z.css("display", "block");
        if (showDesc) {
            aa.find(".bannerDescription").css("display", "none");
            Z.find(".bannerDescription").css("display", "block")
        }
        aa.removeClass("billboardItem_" + T + "_on billboardItem_" + T + "_on_reverse").addClass("billboardItem_" + T + "_off");
        Z.removeClass("billboardItem_" + T + "_off billboardItem_" + T + "_off_reverse").addClass("billboardItem_" + T + "_on");
        if (ac) {
            aa.addClass("billboardItem_" + T + "_off_reverse");
            Z.addClass("billboardItem_" + T + "_on_reverse")
        }
    }
    function S(aa, ab) {
        if (isNaN(aa) || aa >= h || aa < 0 || aa == j) {
            return
        }
        if (u) {
            return
        }
        if (typeof ab === "undefined") {
            var ab = (aa > j ? false: true)
        }
        var Z = w.eq(aa);
        x(aa);
        p(aa, ab);
        X = j;
        j = aa;
        u = true;
        J(Z[0], B)
    }
    function B() {
        if (q(w.eq(j)[0], B)) {
            u = false;
            w.eq(X).css("display", "none");
            if (showDesc) {
                w.eq(X).find(".bannerDescription").css("display", "none")
            }
            if (P) {
                clearTimeout(D);
                if (W.effectType == 0) {
                    M()
                } else {
                    D = setTimeout(function() {
                            e()
                        },
                        Q.duration)
                }
            } else {
                if (W.effectType == 0) {
                    M()
                }
            }
        }
    }
    function J(Z, aa) {
        Z.addEventListener("animationend", aa, false);
        Z.addEventListener("webkitAnimationEnd", aa, false);
        Z.addEventListener("oAnimationEnd", aa, false);
        Z.addEventListener("oanimationend", aa, false);
        Z.addEventListener("msAnimationEnd", aa, false);
        return true
    }
    function q(Z, aa) {
        Z.removeEventListener("animationend", aa, false);
        Z.removeEventListener("webkitAnimationEnd", aa, false);
        Z.removeEventListener("oAnimationEnd", aa, false);
        Z.removeEventListener("oanimationend", aa, false);
        Z.removeEventListener("msAnimationEnd", aa, false);
        return true
    }
    function e() {
        var Z = j + 1;
        if (Z >= w.length) {
            Z = 0
        }
        S(Z, false)
    }
    function C() {
        var Z = j - 1;
        if (Z < 0) {
            Z = w.length - 1
        }
        S(Z, true)
    }
    var a, d, r;
    function L() {
        var Z = !!("ontouchstart" in window) || window.DocumentTouch && document instanceof DocumentTouch;
        if (Z) {
            H[0].addEventListener("touchstart", K, false)
        }
    }
    function m(Z) {
        return Z && Z.replace ? (Z.replace(/&/g, "&amp;").replace(/ /g, "&nbsp;").replace(/\b&nbsp;+/g, " ").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\\/g, "&#92;").replace(/\'/g, "&#39;").replace(/\"/g, "&quot;").replace(/\n/g, "<br/>").replace(/\r/g, "")) : Z
    }
    function K(Z) {
        var aa = Z.targetTouches[0];
        a = 0;
        d = {
            x: aa.pageX,
            y: aa.pageY,
            time: +new Date
        };
        H[0].addEventListener("touchmove", l, false);
        H[0].addEventListener("touchend", v, false)
    }
    function l(Z) {
        if (Z.targetTouches.length > 1 || Z.scale && Z.scale !== 1) {
            return
        }
        var aa = Z.targetTouches[0];
        r = {
            x: aa.pageX - d.x,
            y: aa.pageY - d.y,
            time: +new Date
        };
        a = Math.abs(r.x) < Math.abs(r.y) ? 1 : 0;
        if (a === 0) {}
    }
    function v(Z) {
        var aa = +new Date - d.time;
        if (a === 0) {
            if (Number(r.x) > 10 && Number(r.y) < 40) {
                C()
            } else {
                if (Number(r.x) < -10 && Number(r.y) < 40) {
                    e()
                }
            }
        }
        H[0].removeEventListener("touchmove", this, false);
        H[0].removeEventListener("touchend", this, false)
    }
    function z(ab, ac, aa) {
        var Z = ac.substring(0, 1).toUpperCase() + ac.substring(1);
        ab.css("Webkit" + Z, aa);
        ab.css("Moz" + Z, aa);
        ab.css("ms" + Z, aa);
        ab.css("O" + Z, aa);
        ab.css(ac, aa)
    }
    function M() {
        O(R);
        I(R);
        Mobi.initSwipe("bannerSwipe", R);
        F();
        V()
    }
    function y(ac, aa) {
        var ab = aa - ac + 1,
            Z = 0;
        while (Z == 0) {
            Z = Math.floor(Math.random() * ab + ac)
        }
        return Z
    }
})(jm, Mobi.bannerAnimate);
var couponClickLock = true;
Mobi.initMallCoupon = function(c) {
    var b = jm("#couponList" + c);
    if (Fai.top._lcid != 2052 && b.find(".couponPrice2").length > 0) {
        jm.each(b.find(".couponPrice2"),
            function(d, e) {
                if (jm.isInteger(d) && b.find(".couponPrice2").eq(d).html().length == 4) {
                    b.find(".couponSavePrice2").eq(d).css("margin-left", "0").css("margin-right", "0.75rem");
                    b.find(".couponPrice2").eq(d).css("font-size", "1.4rem")
                }
            })
    }
    if ((window.chrome || 0) != 0) {
        if (window.frames.length != parent.frames.length) {
            b.find(".couponUseCondition2up").css("-webkit-transform", "scale(0.8)");
            b.find(".couponUseCondition2low").css("-webkit-transform", "scale(0.8)");
            b.find(".off2").css("-webkit-transform", "scale(0.8)");
            if (b.find(".validTime2").length > 0) {
                for (var a = 0; a < b.find(".validTime2").length; a++) {
                    if (b.find(".validTime2")[a].innerHTML.indexOf("-") <= 0) {
                        continue
                    }
                    b.find(".validTime2").eq(a).css("-webkit-transform", "scale(0.8)").css("margin-left", "-0.7rem")
                }
            }
            if (Fai.top._lcid != 2052) {
                b.find(".couponSavePrice2").css("margin-right", "0.2rem");
                jm.each(b.find(".couponPrice2"),
                    function(d, e) {
                        if (jm.isInteger(d) && b.find(".couponPrice2").eq(d).html().length == 4) {
                            b.find(".couponSavePrice2").eq(d).css("margin-left", "-0.3rem").css("margin-right", "0.6rem");
                            b.find(".couponPrice2").eq(d).css("font-size", "1.4rem")
                        }
                    })
            }
        }
    }
    b.find(".buttonWords").bind("click",
        function() {
            if (couponClickLock) {
                Mobi.clickCoupon(jm(this).parents(".coupon3"))
            }
        });
    b.find(".coupon1, .coupon2, .coupon3,.couponItem").bind("click",
        function() {
            if (couponClickLock) {
                Mobi.clickCoupon(this)
            }
        })
};
Mobi.dealReceiveMessage = function(b) {
    var a = jm("#couponList" + b);
    a.find(".coupon1").each(function(d, f) {
        var c = jm(f).find(".scale_coupon_receive");
        var h = jm(f).find(".coupon_content_right");
        var e = parseInt(c.width());
        var j = parseInt(h.width());
        if (e > 11) {
            if (Fai.top._lcid != 2052) {
                c.css("line-height", "1")
            } else {
                c.css("-webkit-transform", "unset")
            }
            c.css("letter-spacing", "0.075rem")
        }
    });
    a.find(".coupon3").each(function(e, f) {
        var d = jm(f).find(".couponUseTime");
        var j = jm(f).find(".conditionContain");
        var h = parseInt(d.width());
        var c = parseInt(j.width());
        if (h > c) {
            j.css("-webkit-transform", "scale(.90)");
            j.css("margin-left", "0")
        }
    })
};
Mobi.clickCoupon = function(a) {
    if (!couponClickLock) {
        return
    }
    couponClickLock = false;
    var d = jm(a).attr("received") || false;
    d = d == "true" ? true: false;
    var c = jm(a).attr("couponId");
    var e = jm(a).attr("bgId");
    if (Fai.top._manageMode == true) {
        var b = [];
        b.push('<div class="mobiCouponMsgPanl2">');
        b.push('<div class="mobiCouponMsg">');
        b.push('<div class="fTop">领取失败</div>');
        b.push('<div class="fBottom">当前为管理状态!</div>');
        b.push("</div>");
        b.push("</div>");
        popupCouponMsg(b.join(""))
    } else {
        if (Fai.top.sessionMemberId == 0) {
            Mobi.storageReturnUrl(Fai.top.location.href);
            Fai.top.location.href = "login.jsp"
        } else {
            if (d) {
                Fai.top.location.href = "pr.jsp?couponId=" + c
            } else {
                receiveCoupon(c, e)
            }
        }
    }
    window.setTimeout(function() {
            couponClickLock = true
        },
        1600)
};
function popupCouponMsg(b) {
    var a = jm(".mobiCouponMsgBox");
    a.remove();
    jm("<div class='mobiCouponMsgBox'></div>").appendTo("body");
    a = jm(".mobiCouponMsgBox");
    jm(b).appendTo(a);
    window.setTimeout(function() {
            a.css("visibility", "hidden");
            a.css("opacity", "0")
        },
        1500)
}
function receiveCoupon(a, b) {
    jm.ajax({
        type: "post",
        url: "ajax/mallCoupon_h.jsp",
        data: "cmd=receiveCoupon&bgId=" + b + "&cid=" + a,
        dataType: "json",
        success: function(c) {
            if (c.success) {
                var e = c.coupon;
                var f = [];
                f.push('<div class="mobiCouponMsgPanl">');
                f.push('<div class="mobiCouponMsg">');
                f.push('<div class="sTop">' + LS.successGet + "</div>");
                f.push("</div>");
                f.push("</div>");
                popupCouponMsg(f.join(""));
                window.setTimeout(function() {
                        location.reload(true)
                    },
                    1500)
            } else {
                var d = c.rt;
                if (d == -23) {
                    Fai.top.location.href = "login.jsp"
                } else {
                    if (d == -4) {
                        var f = [];
                        f.push('<div class="mobiCouponMsgPanl2">');
                        f.push('<div class="mobiCouponMsg">');
                        f.push('<div class="fBottom">' + LS.overGet + "</div>");
                        f.push("</div>");
                        f.push("</div>");
                        popupCouponMsg(f.join(""))
                    } else {
                        var f = [];
                        f.push('<div class="mobiCouponMsgPanl2">');
                        f.push('<div class="mobiCouponMsg">');
                        f.push('<div class="fBottom">' + LS.isNoneCoupon + "</div>");
                        f.push("</div>");
                        f.push("</div>");
                        popupCouponMsg(f.join(""))
                    }
                }
            }
        },
        error: function() {
            Mobi.ing(LS.systemError)
        }
    })
}
Mobi.initCouponPromotion = function(c) {
    var b = jm("#module" + c);
    jm(b).find(".formMiddleContent").css("margin-bottom", "0");
    var d = jm(b).find(".couponReceive");
    jm(d).bind("click",
        function() {
            var e = jm(this).attr("couponId");
            if (e > 0) {
                if (Fai.top.sessionMemberId == 0) {
                    Fai.top.location.href = "login.jsp?returnUrl=" + Fai.top.location.href
                } else {
                    receiveCoupon(e, 0)
                }
            }
        });
    var a = jm(b).find(".J_received");
    jm(a).bind("click",
        function() {
            var e = jm(this).attr("couponId");
            Fai.top.location.href = "pr.jsp?couponId=" + e
        });
    jm(b).find(".toMallIndex,.toMallIndexContent").bind("click",
        function() {
            Fai.top.location.href = "index.jsp"
        })
};
Mobi.removeFrameBottomMargin = function(b) {
    var a = jm("#module" + b);
    jm(a).find(".formMiddleContent").css("margin-bottom", "0")
}; (function(b, e, a, d) {
    a.init = function(x, n, p) {
        var u = 5,
            h = e.getPreviewObject("module" + x),
            w = h.querySelectorAll(n + x + "")[0],
            l = h.querySelectorAll(".J_marqueeContainer" + x)[0],
            B;
        if (typeof h != "object" || typeof w != "object" || typeof l != "object") {
            return
        }
        var k = {
            s: true,
            d: "up",
            sp: "normal",
            mm: true,
            i: true
        };
        b.extend(k, p);
        if (k.sp == "normal") {
            if (k.d == "up" || k.d == "down") {
                u = ((5 * w.offsetWidth) / h.offsetWidth) * (w.offsetHeight / w.offsetWidth)
            } else {
                u = (5 * w.offsetWidth) / h.offsetWidth
            }
        } else {
            if (k.sp == "slow") {
                if (k.d == "up" || k.d == "down") {
                    u = ((10 * w.offsetWidth) / h.offsetWidth) * (w.offsetHeight / w.offsetWidth)
                } else {
                    u = (10 * w.offsetWidth) / h.offsetWidth
                }
            } else {
                if (k.d == "up" || k.d == "down") {
                    u = ((2.5 * w.offsetWidth) / h.offsetWidth) * (w.offsetHeight / w.offsetWidth)
                } else {
                    u = (2.5 * w.offsetWidth) / h.offsetWidth
                }
            }
        }
        b.extend(k, {
            sp: u
        });
        var y = w.className,
            r = e.createElementByHtml("<div class='J_contentPanelCopy" + x + " f-contentPanel " + y + "'></div>"),
            s = w.parentNode,
            t = b(w).offset(),
            o = "infinite",
            z = "",
            j = 1,
            v = navigator.userAgent,
            m,
            A;
        var f = b(w).find("img"),
            q;
        if (f && f.length > 0) {
            f[f.length - 1].onload = function() {
                q = b(w).offset().height;
                if (t.height != q) {
                    b(l).css("height", q + "px");
                    if (k.d == "left" || k.d == "right") {
                        b(r).css("height", q + "px")
                    }
                }
            }
        }
        b(l).css({
            width: t.width + "px",
            height: t.height + "px"
        });
        if (k.d == "up") {
            m = "buttomToTop"
        } else {
            if (k.d == "down") {
                m = "topToButtom"
            } else {
                if (k.d == "left" || k.d == "right") {
                    m = (k.d == "left") ? "rightToLeft": "leftToRight";
                    b(r).css({
                        width: t.width + "px",
                        height: t.height + "px",
                        position: "absolute",
                        left: t.width + "px",
                        top: 0
                    })
                }
            }
        }
        if (k.i) {
            r.innerHTML = w.innerHTML;
            s.appendChild(r)
        }
        if (!k.mm) {
            b(s).one("webkitAnimationStart mozAnimationStart MSAnimationStart oanimationstart animationstart",
                function() {
                    b(s).removeClass("fk-marqueeMoveInStyle")
                })
        }
        if (!k.mm && k.i) {
            z = "_moveIn";
            o = 1;
            j = 1
        } else {
            if (k.mm && !k.i) {
                z += "_discontinuous";
                o = 1;
                j = 2
            } else {
                if (k.mm && k.i) {
                    z = ""
                } else {
                    if (!k.mm && !k.i) {
                        z = "_moveIn_discontinuous"
                    }
                }
            }
        }
        A = m + z + " " + (k.sp / j) + "s linear " + o;
        if (Fai.top.Fai.isIE10 && k.mm && k.i && (k.d == "down" || k.d == "right")) {
            setTimeout(function() {
                    c(b(s), "animation", A)
                },
                0)
        } else {
            c(b(s), "animation", A)
        }
        if (!k.mm && k.i) {
            b(s).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",
                function() {
                    A = m + " " + k.sp + "s linear infinite";
                    c(b(s), "animation", A)
                })
        } else {
            if (k.mm && !k.i) {
                b(s).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",
                    function() {
                        A = m + "_moveIn_discontinuous " + k.sp + "s linear infinite";
                        c(b(s), "animation", A)
                    })
            }
        }
        if (! (/(iPhone|iPad|iPod|Android)/i.test(v))) {
            b(h).on("mouseover",
                function() {
                    c(b(s), "animation-play-state", "paused")
                }).on("mouseout",
                function() {
                    c(b(s), "animation-play-state", "running")
                })
        } else {
            b(h).on("touchstart",
                function() {
                    c(b(s), "animation-play-state", "paused")
                }).on("touchend",
                function() {
                    c(b(s), "animation-play-state", "running")
                })
        }
    };
    function c(k, f, j) {
        var l = ["", "-webkit-", "-moz-", "-ms-"],
            h = l.length;
        while (h) {
            h--;
            k.css(l[h] + f, j)
        }
    }
})(jm, Mobi, Mobi.richMarquee || (Mobi.richMarquee = {
    utils: {},
    event: {},
    dom: {},
    data: {}
}));
Mobi.shanghuaLoading = {}; (function(w, t, o) {
    var h = new Array(),
        e,
        A,
        p = 0,
        l = 0,
        z = 0,
        r = 0,
        a = "",
        q = "",
        j = "",
        c,
        b,
        y,
        m = 0;
    t.init = function(G, H, F) {
        A = G;
        e = w("#module" + A);
        c = H;
        m = parseInt(F) || 0;
        a = "<div class='getMInfo'><div class='mListLoadingPic'><img src=" + Fai.top._resRoot + "/images/loading/loading_2.gif?v=201509211806></div><div class='mListLoadingTxt'>正在加载更多订单</div></div>";
        E(A);
        return true
    };
    function E(G) {
        var F = {
            page: l,
            orderStatus: m
        };
        w.ajax({
            type: "post",
            url: "ajax/order_h.jsp?cmd=getMInfo&moduleId=" + G,
            data: F,
            error: function() {
                Mobi.ing(LS.systemError)
            },
            success: function(H) {
                var K = w.parseJSON(H);
                if (K.success) {
                    h.push(K.data);
                    r = K.totalSize;
                    j = Math.ceil(r / 100);
                    q = "<div class='pagenationSelectDiv'><select class='pageSelect' onchange='Mobi.shanghuaLoading.jump(this.options[this.selectedIndex].value)'>";
                    for (var J = 0; J < j; J++) {
                        var I = J + 1 + "/" + j;
                        q += "<option class='pageOptions' value=" + J + ">" + I + "</option>"
                    }
                    q += "</select></div>";
                    z = h[l].length;
                    if (h[l].length != 0) {
                        w.each(h[l],
                            function(L, M) {
                                if (L == 10) {
                                    return false
                                }
                                p = L;
                                e.find(".orderList").append(M)
                            });
                        p++
                    }
                    x();
                    f();
                    w("#webFooter").css("height", 0)
                } else {
                    e.find(".orderList").append(K.data)
                }
                Mobi.initFooterHeight()
            }
        })
    }
    t.jump = function(F) {
        e.find(".orderList").empty();
        if (F > l && F >= h.length) {
            l++;
            v(F)
        } else {
            if (F > l && F < h.length) {
                d(F)
            } else {
                u(F)
            }
        }
        f();
        window.scrollTo(0, 0)
    };
    function u(F) {
        l = F;
        if (h[F].length != 0) {
            z = h[F].length;
            w.each(h[F],
                function(G, H) {
                    if (G == 10) {
                        return false
                    }
                    p = G;
                    e.find(".orderList").append(H)
                });
            p++
        }
        e.find("#cusInfo").append(a)
    }
    function v(F) {
        w.ajax({
            type: "post",
            url: "ajax/order_h.jsp?cmd=getMInfo&moduleId=" + A,
            data: "page=" + l,
            error: function() {
                Mobi.ing(LS.systemError)
            },
            success: function(G) {
                var H = w.parseJSON(G);
                if (H.success) {
                    h.push(H.data.split("|"));
                    z = h[l].length
                } else {
                    e.find(".orderList").append(H.data)
                }
                if (F > l) {
                    l++;
                    v(F)
                } else {
                    if (h[l].length != 0) {
                        w.each(h[l],
                            function(J, K) {
                                if (J == 10) {
                                    return false
                                }
                                p = J;
                                e.find(".orderList").append(K)
                            });
                        p++
                    }
                    var I = e.find(".orderList_line").length;
                    if (I <= 10 && I == z) {
                        e.find(".orderList").append("<div class='pagenation'><div class='pagePrev icon-pagePrev icon-cnListP'></div>" + q + "</div>");
                        e.find(".pageSelect").val(l);
                        e.find(".pagePrev").unbind().bind("click",
                            function() {
                                l--;
                                B()
                            })
                    } else {
                        e.find("#cusInfo").append(a)
                    }
                }
            }
        })
    }
    function d(F) {
        l = F;
        z = h[l].length;
        if (h[l].length != 0) {
            w.each(h[l],
                function(H, I) {
                    if (H == 10) {
                        return false
                    }
                    p = H;
                    e.find(".orderList").append(I)
                });
            p++
        }
        var G = e.find(".orderList_line").length;
        if (G <= 10 && G == z) {
            e.find(".orderList").append("<div class='pagenation'><div class='pagePrev icon-pagePrev icon-cnListP'></div>" + q + "</div>");
            e.find(".pageSelect").val(l);
            e.find(".pagePrev").unbind().bind("click",
                function() {
                    l--;
                    B()
                })
        } else {
            e.find("#cusInfo").append(a)
        }
    }
    function x() {
        if (r > 10) {
            e.find("#cusInfo").append(a)
        } else {
            e.find(".orderList").append("<div class='pagenation'>" + q + "</div>");
            e.find(".pageSelect").val(l)
        }
        window.onscroll = function() {
            if ((l == 0 && e.find(".orderList_line").length >= z) || (l * 100 + e.find(".orderList_line").length >= l * 100 + z)) {
                e.find(".getMInfo").remove();
                return
            }
            b = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;
            y = e.find(".getMInfo").offset().top;
            if (y - b <= 740) {
                e.find(".getMInfo").remove();
                D();
                f()
            }
        }
    }
    function D() {
        var F = p + 10;
        w.each(h[l],
            function(H, I) {
                if (H < p) {
                    return true
                }
                if (H >= F) {
                    return false
                }
                p = H;
                e.find(".orderList").append(I)
            });
        p++;
        var G = e.find(".orderList_line").length;
        if (G == 100 && G < r && l == 0) {
            e.find(".orderList").append("<div class='pagenation'><div class='pageNext icon-pageNext icon-cnListN'></div>" + q + "</div>");
            e.find(".pageSelect").val(l);
            e.find(".pageNext").unbind().bind("click",
                function() {
                    l++;
                    C()
                })
        } else {
            if (G <= 100 && l == 0 && G == z) {
                e.find(".orderList").append("<div class='pagenation'>" + q + "</div>");
                e.find(".pageSelect").val(l)
            } else {
                if (G <= 100 && ((l * 100 + G) == r) && G == z) {
                    e.find(".orderList").append("<div class='pagenation'><div class='pagePrev icon-pagePrev icon-cnListP'></div>" + q + "</div>");
                    e.find(".pageSelect").val(l);
                    e.find(".pagePrev").unbind().bind("click",
                        function() {
                            l--;
                            B()
                        })
                } else {
                    if (G == 100 && G < r && l != 0) {
                        s()
                    } else {
                        e.find("#cusInfo").append(a)
                    }
                }
            }
        }
    }
    function C() {
        e.find(".orderList").empty();
        if (h.length > l) {
            if (h[l].length != 0) {
                w.each(h[l],
                    function(G, H) {
                        p = G;
                        e.find(".orderList").append(H)
                    });
                p++
            }
            f();
            var F = e.find(".orderList_line").length;
            if (F <= 100 && ((l * 100 + F) == r)) {
                e.find(".orderList").append("<div class='pagenation'><div class='pagePrev icon-pagePrev icon-cnListP'></div>" + q + "</div>");
                e.find(".pageSelect").val(l);
                e.find(".pagePrev").unbind().bind("click",
                    function() {
                        l--;
                        B()
                    })
            } else {
                if (F == 100 && F < r && l != 0) {
                    s()
                } else {
                    e.find("#cusInfo").append(a)
                }
            }
            window.scrollTo(0, 60000)
        } else {
            w.ajax({
                type: "post",
                url: "ajax/order_h.jsp?cmd=getMInfo",
                data: "page=" + l,
                error: function() {
                    Mobi.ing(LS.systemError)
                },
                success: function(G) {
                    var H = w.parseJSON(G);
                    if (H.success) {
                        h.push(H.data);
                        z = h[l].length;
                        if (h[l].length != 0) {
                            w.each(h[l],
                                function(J, K) {
                                    if (J == 10) {
                                        return false
                                    }
                                    p = J;
                                    e.find(".orderList").append(K)
                                });
                            p++
                        }
                        f();
                        window.scrollTo(0, 0);
                        var I = e.find(".orderList_line").length;
                        if (I <= 10 && I == z) {
                            e.find(".orderList").append("<div class='pagenation'><div class='pagePrev icon-pagePrev icon-cnListP'></div>" + q + "</div>");
                            e.find(".pageSelect").val(l);
                            e.find(".pagePrev").unbind().bind("click",
                                function() {
                                    l--;
                                    B()
                                })
                        } else {
                            e.find("#cusInfo").eq(1).append(a)
                        }
                    } else {
                        e.find(".orderList").append(H.data)
                    }
                }
            })
        }
    }
    function B() {
        e.find(".orderList").empty();
        if (h[l].length != 0) {
            w.each(h[l],
                function(G, H) {
                    p = G;
                    e.find(".orderList").append(H)
                });
            p++;
            f();
            var F = e.find(".orderList_line").length;
            if (F == 100 && F < r && l == 0) {
                e.find(".orderList").append("<div class='pagenation'><div class='pageNext icon-pageNext icon-cnListN'></div>" + q + "</div>");
                e.find(".pageSelect").val(l);
                e.find(".pageNext").unbind().bind("click",
                    function() {
                        l++;
                        C()
                    })
            } else {
                if (F == 100 && F < r && l != 0) {
                    s()
                }
            }
        }
        f();
        window.scrollTo(0, 60000)
    }
    function s() {
        e.find(".orderList").append("<div class='pagenation'><div class='pagePrev icon-pagePrev icon-cnListP'></div>" + q + "<div class='pageNext icon-pageNext icon-cnListN'></div></div>");
        e.find(".pageSelect").val(l);
        e.find(".pagePrev").unbind().bind("click",
            function() {
                l--;
                B()
            });
        e.find(".pageNext").unbind().bind("click",
            function() {
                l++;
                C()
            })
    }
    function f() {
        Mobi.initOrderDeleteButton(A);
        Mobi.initPayOrderImmediately(A);
        Mobi.initOrderCancelButton(A);
        Mobi.initOrderSureButton(A);
        Mobi.initFlowButton(A);
        Mobi.initCommentBtn(A, c);
        n()
    }
    function n() {
        e.find(".payButton").unbind().bind("click",
            function() {
                var H = w(this).attr("_href");
                var K = w(this).attr("_orderId");
                var F;
                if (typeof K != "undefined" && K != null) {
                    F = K
                }
                var J = Mobi.checkOrderPayLimit(F);
                if (J != "") {
                    Mobi.ing(J);
                    return
                }
                var I = (H == "WXPAY");
                var L = w(this).attr("_appId");
                var G = k(F, I, L, H);
                if (G) {
                    if (!I) {
                        document.location.href = H
                    } else {
                        Mobi.getWxpayUrl(L, F)
                    }
                }
            })
    }
    function k(G, I, J, F) {
        var H = true;
        w.ajax({
            type: "post",
            url: "ajax/order_h.jsp?cmd=checkOrder",
            data: "orderId=" + G + "&isWX=" + I,
            async: false,
            dataType: "json",
            error: function() {
                Mobi.ing(LS.mallStlSubmitError)
            },
            success: function(K) {
                if (!K.success) {
                    H = false;
                    if (K.rt == -3) {
                        Mobi.ing(LS.mallStlSubmitNotFound)
                    } else {
                        if (K.rt == -9) {
                            Mobi.ing(LS.mallStlSubmitStatusError)
                        } else {
                            if (K.rt == Mobi.MallAjaxErrno.mallAmountZero) {
                                Mobi.ing(w.format(LS.oAmountIsZero))
                            } else {
                                if (K.rt == Mobi.MallAjaxErrno.outOfMallAmount) {
                                    Mobi.ing(w.format(LS.outOfMallAmount))
                                } else {
                                    if (K.rt == Mobi.MallAjaxErrno.OutOfAllowAmount) {
                                        Mobi.ing(w.format(LS.allowAmountOverNameList, Mobi.encodeHtml(K.productsName)))
                                    } else {
                                        if (K.rt == Mobi.MallAjaxErrno.payDomainError) {
                                            Mobi.ing(w.format(LS.mallPayDomainError))
                                        } else {
                                            if (K.rt == Mobi.MallAjaxErrno.notAdded) {
                                                Mobi.ing(w.format(LS.mallProductNotAdded))
                                            } else {
                                                if (K.rt <= -600 && K.rt >= -609) {
                                                    var L;
                                                    if (K.rt == -608) {
                                                        L = {
                                                            textClass: "goToPay",
                                                            cancelClass: "giveUpJoin",
                                                            content: "非常抱歉，该团已满，继续支付会自动为您开新团",
                                                            callback: function() {
                                                                w.ajax({
                                                                    type: "post",
                                                                    url: "ajax/order_h.jsp?cmd=setOrderNewGroupBuyDetail",
                                                                    data: "orderId=" + G,
                                                                    dataType: "json",
                                                                    error: function() {
                                                                        Mobi.ing(LS.mallStlSubmitError)
                                                                    },
                                                                    success: function(M) {
                                                                        if (M.success) {
                                                                            if (!I) {
                                                                                document.location.href = F
                                                                            } else {
                                                                                Mobi.getWxpayUrl(J, G)
                                                                            }
                                                                        } else {
                                                                            if (M.rt == -9) {
                                                                                window.location.reload()
                                                                            } else {
                                                                                Mobi.ing("当前网络异常，请刷新后重试")
                                                                            }
                                                                        }
                                                                    }
                                                                })
                                                            }
                                                        };
                                                        Mobi.prompt(L)
                                                    } else {
                                                        if (K.rt == -605) {
                                                            L = {
                                                                textClass: "goToPay",
                                                                cancelClass: "giveUpJoin",
                                                                content: "不好意思，已经超出成团时间，继续支付将自动为您开新团",
                                                                callback: function() {
                                                                    w.ajax({
                                                                        type: "post",
                                                                        url: "ajax/order_h.jsp?cmd=setOrderNewGroupBuyDetail",
                                                                        data: "orderId=" + G,
                                                                        dataType: "json",
                                                                        error: function() {
                                                                            Mobi.ing(LS.mallStlSubmitError)
                                                                        },
                                                                        success: function(M) {
                                                                            if (M.success) {
                                                                                if (!I) {
                                                                                    document.location.href = F
                                                                                } else {
                                                                                    Mobi.getWxpayUrl(J, G)
                                                                                }
                                                                            } else {
                                                                                if (M.rt == -9) {
                                                                                    window.location.reload()
                                                                                } else {
                                                                                    Mobi.ing("当前网络异常，请刷新后重试")
                                                                                }
                                                                            }
                                                                        }
                                                                    })
                                                                }
                                                            };
                                                            Mobi.prompt(L)
                                                        } else {
                                                            if (K.rt == -604) {
                                                                Mobi.ing("不好意思，活动已结束")
                                                            } else {
                                                                if (K.rt == -609) {
                                                                    Mobi.ing("不好意思，您已经参与该团")
                                                                } else {
                                                                    Mobi.ing("参团失败，请稍后再试")
                                                                }
                                                            }
                                                        }
                                                    }
                                                } else {
                                                    Mobi.ing(LS.mallStlSubmitError)
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        });
        return H
    }
})(jm, Mobi.shanghuaLoading);
Mobi.initShare = function(b, d, c) {
    var a = b;
    jm("#" + a).unbind("click").bind("click",
        function() {
            if (!Mobi.isWechat()) {
                var e = [];
                e.push("<div class='shareCover' style='background-color:white;opacity:1;'>");
                e.push("		<img class='shareCoverIcon shareCoverContent' src='" + Fai.top._resRoot + "/image/v2/shareIcon.png?v=201703240921'/>");
                e.push("		<div class='shareCoverTip shareCoverContent'>请使用浏览器的分享功能分享到微信</div>");
                e.push("		<div class='shareCoverBtn shareCoverContent'>知道了</div>");
                e.push("</div>");
                if (jm(".shareCover").length == 0) {
                    jm("#g_web").append(e.join(""));
                    jm(".shareCoverBtn").bind("click",
                        function() {
                            jm(".shareCoverBtn").unbind();
                            jm(".shareCover").remove()
                        })
                }
            } else {
                var e = [];
                e.push("<div class='shareCover'>");
                e.push("		<img class='shareCoverImg' src='" + Fai.top._resRoot + "/image/v2/shareTip.png?v=201703240921'/>");
                e.push("</div>");
                if (jm(".shareCover").length == 0) {
                    jm("#g_web").append(e.join(""));
                    jm(".shareCover").bind("click",
                        function() {
                            jm(".shareCover").unbind().remove()
                        })
                }
            }
        });
    if (d == null) {
        return
    }
    a = d;
    jm("#" + a).unbind("click").bind("click",
        function() {
            window.open("http://service.weibo.com/share/share.php?title= &url=http%3A%2F%2Fm.jack.iii.cc.jack.dev.cc%2Fpd.jsp%3Fpid%3D123%26_sc%3D2&pic=")
        });
    a = c;
    jm("#" + a).unbind("click").bind("click",
        function() {
            if (!Mobi.isQQ()) {
                var e = [];
                e.push("<div class='shareCover' style='background-color:white;opacity:1;'>");
                e.push("		<img class='shareCoverIcon shareCoverContent' src='" + Fai.top._resRoot + "/image/v2/shareIcon.png?v=201703240921'/>");
                e.push("		<div class='shareCoverTip shareCoverContent'>请使用浏览器的分享功能分享到QQ</div>");
                e.push("		<div class='shareCoverBtn shareCoverContent'>知道了</div>");
                e.push("</div>");
                if (jm(".shareCover").length == 0) {
                    jm("#g_web").append(e.join(""));
                    jm(".shareCoverBtn").bind("click",
                        function() {
                            jm(".shareCoverBtn").unbind();
                            jm(".shareCover").remove()
                        })
                }
            } else {
                var e = [];
                e.push("<div class='shareCover'>");
                e.push("		<img class='shareCoverImg' src='" + Fai.top._resRoot + "/image/v2/shareTip02.png?v=201703240921' style=''/>");
                e.push("</div>");
                if (jm(".shareCover").length == 0) {
                    jm("#g_web").append(e.join(""));
                    jm(".shareCover").bind("click",
                        function() {
                            jm(".shareCover").unbind().remove()
                        })
                }
            }
        })
};
Mobi.initFixAreaEvent = function() {
    var a = 0,
        b = jm(".J_mallNavBtn");
    b.on("click.clickAnimate",
        function() {
            var c = jm(this);
            b.removeClass("f-navCheck");
            b.find(".J_clickAnimate").css("opacity", "0");
            c.addClass("f-navCheck");
            c.find(".clickAnimate").css("opacity", "0.2").css("transform", "scale(1.4)");
            c.find(".mallNavText").addClass("mallTextAnimate");
            c.find(".icon-navItemIcon").addClass("iconAnimate");
            event.stopPropagation();
            if (a > 1) {
                window.location.href = jm(this).attr("href")
            }
            return false
        });
    b.off("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",
        function(d) {
            var e = jm(this);
            e.find(".J_clickAnimate").css("opacity", "0");
            a++;
            if (a > 1) {
                return
            }
            var c = jm(this).attr("href");
            if (typeof c == "string" && c == "javascript:;") {
                return
            }
            if (Fai.top._manageMode && Fai.top._changeStyleNum > 0) {
                var f = e.attr("id").replace("mallNavItem_");
                Fai.top.Mobi.checkSaveBar()
            } else {
                window.location.href = c
            }
        })
}; (function(b, a, d) {
    a.initFooter = function() {
        var m = b("#webFooterBox");
        var k = 200039;
        var f = {
            CLICK_FREE: 3,
            CLICK_PAY: 4,
            EXPOSURE_FREE: 5,
            EXPOSURE_PAY: 6
        };
        j(m);
        l(m);
        function j(p) {
            var o = p.find(".J_supportLink");
            var q = "touchend.logClick";
            var r = a.isPC();
            if (!r) {
                q = "click.logClick"
            }
            o.off(q).on(q, n);
            function n(s) {
                if (e()) {
                    a.logDog(k, f.CLICK_PAY)
                }
                if (h()) {
                    a.logDog(k, f.CLICK_FREE)
                }
            }
        }
        function l(r) {
            var q = r.find(".J_supportLink");
            if (q.length === 0) {
                return
            }
            var u = b(window);
            var p = "scroll.footerSupportLinkExposure";
            var t = "resize.footerSupportLinkExposure";
            var s = a.throttle(o);
            u.off(p).on(p, s);
            u.off(t).on(t, s);
            o();
            function o() {
                var v = a.isInViewArea(u, q);
                if (v) {
                    if (e()) {
                        a.logDog(k, f.EXPOSURE_PAY)
                    }
                    if (h()) {
                        a.logDog(k, f.EXPOSURE_FREE)
                    }
                    n()
                }
            }
            function n() {
                u.off(p).off(t)
            }
        }
        function e() {
            var o = (Fai.top._oem !== true);
            var n = !h();
            return o && n
        }
        function h() {
            var n = (Fai.top._oem !== true);
            return n && Fai.top._isFreeVer === true
        }
    };
    a.throttle = function(e, f) {
        e._throttleTime = f || 300;
        return function() {
            clearTimeout(e._throttleTimer);
            e._throttleTimer = setTimeout(function() {
                    e.apply(this, arguments)
                },
                e._throttleTime)
        }
    };
    a.isInViewArea = function(n, h) {
        if (h.length === 0) {
            return false
        }
        var v = h[0];
        var k = b("#fixedAreaBox").offset().height;
        var f = v.getBoundingClientRect();
        var p = f.top;
        var l = f.bottom - f.height / 2;
        var j = f.left;
        var w = f.right;
        var m = b("#g_web");
        var o = m.offset();
        var u = o.width;
        var e = b("body").offset().height - k;
        var q = o.left;
        var x = q + u;
        var r = (j >= q && w <= x);
        var t = (p >= 0 && l < e);
        var s = false;
        if (r && t) {
            s = true
        }
        return s
    };
    function c(j) {
        var p = b(j);
        var k = p.offset();
        var o = p.css("padding-top");
        var f = p.css("padding-bottom");
        var e = p.css("margin-top");
        var h = p.css("margin-bottom");
        var n = k.height;
        var l = [o, f, e, h, n];
        var m = 0;
        l.forEach(function(q) {
            q = parseInt(q) || 0;
            m += q
        });
        return m
    }
} (jm, Mobi));
Mobi.initTabModuleStyle = function(B, H) {
    var b = jm("#module" + B),
        D = b.find(".J_formTabButtonWrap"),
        p = D.find(".J_formTabButtonList"),
        e = D.parent(),
        t = p.find(".J_formTabButton"),
        s = b.find(".J_formTabContent"),
        r = /(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent),
        a = D.offset(),
        n = 0,
        x = 0,
        u = 0,
        w = 0,
        C,
        o,
        j,
        q,
        v,
        m,
        z,
        F,
        f,
        y;
    t.off("mouseover.action").on("mouseover.action",
        function() {
            jm(this).addClass("formTabButtonHover")
        }).off("mouseleave.action").on("mouseleave.action",
        function() {
            jm(this).removeClass("formTabButtonHover")
        }).off("click.action").on("click.action",
        function() {
            o = jm(this);
            t.removeClass("formTabButtonClick");
            o.addClass("formTabButtonClick");
            C = o.attr("tabmoduleid");
            y = jm("#module" + C);
            if (typeof C == "undefined") {
                return
            }
            b.find(".J_formTabContent").removeClass("formTabCntIdClick");
            b.find("#formTabContent" + C).removeClass("f-hideTabModule").addClass("formTabCntIdClick");
            Mobi.triggerAllLazyLoad();
            Mobi.inTabMaqueeHelper.runInTabMarquee(C);
            if (Fai.top._manageMode) {
                Mobi.refreshEditTabLayoutBorder(B)
            }
            Mobi.tabModuleHelper.autoMoveTabPos(o, D, a);
            Mobi.initFooterHeight()
        });
    if (Fai.top.Mobi.getPreviewDocument().URL.length > 0) {
        var l = Fai.top.Mobi.getPreviewDocument().location.search,
            d = l.indexOf("pageno"),
            k,
            h,
            A,
            G,
            k,
            E,
            c;
        if (d > -1) {
            h = l.substring(0, d);
            c = h.split("").reverse().join("");
            k = c.indexOf("m");
            E = parseInt(c.substring(0, k).split("").reverse().join(""));
            if (E > 0) {
                t.each(function(I, J) {
                    if (parseInt(jm(this).attr("tabmoduleid")) == E) {
                        w = I;
                        return false
                    }
                })
            }
        }
    }
    if ( !! H && t.length > 0) {
        jm(t[w]).trigger("click")
    }
    Mobi.tabModuleHelper.initTabCallBack(b);
    if (!e.hasClass("wrapOpen")) {
        D.find(".J_preBtn").show();
        D.find(".J_nextBtn").show()
    } else {
        D.find(".J_preBtn").hide();
        D.find(".J_nextBtn").hide();
        p.css("width", "100%");
        p.css("left", "");
        return
    }
    t.each(function(I, J) {
        x = J.offsetWidth;
        u += x + 1;
        if (x > n) {
            n = x
        }
    });
    p.width(u + "px");
    j = D.width();
    if (u <= j) {
        p.css("width", "100%");
        D.find(".J_preBtn").hide();
        D.find(".J_nextBtn").hide();
        return
    }
    if (D.find(".J_preBtn").length > 0 || r) {
        return
    }
    jm("<div class='J_preBtn f-preBtn faisco-icons'></div><div class='J_nextBtn f-nextBtn faisco-icons'></div>").appendTo(D);
    q = D.offset();
    D.find(".J_preBtn").on("click",
        function() {
            preBtn = jm(this);
            z = preBtn.siblings(".J_nextBtn");
            t = p.find(".J_formTabButton");
            F = p.offset();
            v = t.eq(0).offset();
            if (v.left >= q.left) {
                return
            }
            f = F.left + n;
            f = f > q ? f: D[0].offsetLeft;
            p.css("left", f + "px");
            preBtn.addClass("disable");
            z.addClass("disable");
            setTimeout(function() {
                    preBtn.removeClass("disable");
                    z.removeClass("disable")
                },
                450)
        });
    D.find(".J_nextBtn").on("click",
        function() {
            z = jm(this);
            preBtn = z.siblings(".J_preBtn");
            t = p.find(".J_formTabButton");
            F = p.offset();
            v = t.eq(t.length - 1).offset();
            if (v.right <= q.right) {
                return
            }
            f = F.left - n;
            f = f + q.width < q.right ? f: (q.width - (p[0].offsetLeft + p.width()));
            p.css("left", f + "px");
            preBtn.addClass("disable");
            z.addClass("disable");
            setTimeout(function() {
                    preBtn.removeClass("disable");
                    z.removeClass("disable")
                },
                450)
        })
};
Mobi.getHideDivOffset = function(e) {
    var d = {
            position: "absolute",
            visibility: "hidden",
            display: "block"
        },
        a,
        c,
        b = {};
    if (!e) {
        return
    }
    for (c in d) {
        b[c] = e.style[c];
        e.style[c] = d[c]
    }
    a = {
        offsetHeight: e.offsetHeight || 0,
        offsetWidth: e.offsetWidth || 0
    };
    for (c in d) {
        e.style[c] = b[c]
    }
    return a
};
Mobi.inTabMaqueeHelper = {
    setInTabMarquee: function(c) {
        var f = c.moduleId,
            h = c.funcName,
            b = c.args || [],
            a = c.runTime || 1;
        if (typeof h != "string") {
            return
        }
        var d = Fai.top.inTabMaqueeHelper,
            e = (d[f] instanceof Array) ? d[f] : (d[f] = []);
        e.push({
            funcName: h,
            args: b,
            runTime: a,
            hasRunTime: 0
        })
    },
    runInTabMarquee: function(e) {
        var c = Fai.top.inTabMaqueeHelper;
        if (! (e in c)) {
            return
        }
        var d = c[e],
            f,
            a,
            b;
        for (b = 0; b < d.length; b++) {
            f = d[b].funcName;
            a = d[b].args;
            if (typeof Mobi[f] == "function" && (d[b].hasRunTime < d[b].runTime || d.runTime == -1)) {
                Mobi[f].apply(Mobi[f], a);
                d[b].hasRunTime++
            }
        }
    }
}; (function(b, a, c) {
    a.initTabCallBack = function(e) {
        var f = e.find(".J_formTabContent");
        var d = 3;
        f.each(function(j, k) {
            var h = jm(k);
            if (parseInt(h.attr("styleid")) == 41) {
                setTimeout(function() {
                        var l = h.find(".form img"),
                            o = l.length,
                            n = 0;
                        for (var m = 0; m < l.length; m++) {
                            var p = new Image();
                            p.src = l.eq(m).attr("src");
                            p.onload = function() {
                                n++;
                                if (n == o) {
                                    h.addClass("f-formTabContent").removeClass("f-hideTabModule");
                                    h = null
                                }
                            }
                        }
                    },
                    0)
            } else {
                h.addClass("f-formTabContent").removeClass("f-hideTabModule")
            }
        })
    };
    a.autoMoveTabPos = function(k, e, s) {
        var o = k.offset(),
            j = parseInt(k.width()),
            l = o.left,
            r = l + j,
            p = /(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent),
            d,
            q,
            h,
            n;
        if (p) {
            d = s.left;
            q = s.right
        } else {
            var f = e.find(".J_nextBtn"),
                m = e.find(".J_preBtn");
            q = f.offset().left;
            d = m.offset().left
        }
        if (r >= q) {
            if (p) {
                n = -j;
                h = setInterval(function() {
                        if (n < 0) {
                            n += 2;
                            e[0].scrollLeft += 2
                        } else {
                            clearInterval(h)
                        }
                    },
                    1)
            } else {
                f.trigger("click")
            }
        } else {
            if (l <= d) {
                if (p) {
                    n = e[0].scrollLeft >= j ? j: e[0].scrollLeft;
                    h = setInterval(function() {
                            if (n > 0) {
                                n -= 2;
                                e[0].scrollLeft -= 2
                            } else {
                                clearInterval(h)
                            }
                        },
                        1)
                }
            }
        }
    }
})(jm, Mobi.tabModuleHelper || (Mobi.tabModuleHelper = {}));
Mobi.initSimpleTextContent = function(b, o, h) {
    var c = jm("#module" + b),
        j = c.find(".fkEditor"),
        d = c.find(".simpleText"),
        m = parseInt(c.css("top") || 0),
        f = parseInt(c.css("left") || 0),
        e = h || _htmlFontSize,
        a = c.width().replace("rem", ""),
        n = 0,
        k = "",
        l = "";
    AJump = j.find("a");
    k = Fai.top._manageMode ? j: d;
    if (o != 1) {
        if (c.is(":visible")) {
            c.css("height", "auto");
            c.css("height", c.height())
        } else {
            if (Fai.top._manageMode) {
                n = parseInt(j.attr("_autowidth") || 1);
                n && (a = parseInt(j.attr("_width") || 180) / e)
            } else {
                parseInt(c.attr("_autowidth") || 1) && (a = 180 / e)
            }
            c.find(".fk-editor").css({
                height: "auto",
                width: a + "rem"
            });
            c.css({
                height: "auto",
                width: a + "rem"
            });
            if (Fai.top._manageMode) {
                c.find(".fk-editor").css("height", c.height())
            }
        }
    } else { ! Fai.top._manageMode && c.css("overflow", "visible") && c.find(".formMiddle").css("overflow", "visible")
    }
    if (Fai.top._manageMode) {
        AJump.each(function(r, p) {
            var q = $(p).attr("href");
            if (q.indexOf("http") != -1 || q.indexOf("https") != -1) {
                $(p).click(function() {
                    Fai.top.Fai.ing("管理状态不支持跳转外部链接", true);
                    return false
                })
            }
        })
    } else {
        c.find(".fk-editor a").each(function(q, r) {
            var p = jm(r).attr("_href");
            if (p) {
                jm(r).attr("href", p)
            }
        })
    }
    checkNode.traverseTagStyle(k, e)
};
var checkNode = {
    defaultPropertyValue: ["font-size", "line-height", "top", "left", "height", "width"],
    isToRem: true,
    _htmlFontSize: _htmlFontSize,
    setPropertyValue: function(a) {
        this.defaultPropertyValue = a
    },
    getPropertyValue: function() {
        return this.defaultPropertyValue
    },
    setIstoRem: function(a) {
        this.isToRem = a
    },
    getIstoRem: function() {
        return this.isToRem
    },
    resetValue: function() {
        this.defaultPropertyValue = ["font-size", "line-height", "top", "left", "height", "width"];
        this.isToRem = true
    },
    returnChangeUnit: function(a, b) {
        var d = -1,
            c = b || this._htmlFontSize;
        if (this.getIstoRem()) {
            d = a.indexOf("px");
            return (d >= 0) ? parseInt(a) / c + "rem": a
        } else {
            d = a.indexOf("rem");
            return (d >= 0) ? Math.round(a.replace("rem", "") * c) + "px": a
        }
    },
    checkInArray: function(c, b) {
        for (var a = 0; a < c.length; a++) {
            if (c[a] == b) {
                return true
            }
        }
        return false
    },
    checkCurrentTagStyle: function(b, d) {
        var h = this.getPropertyValue(),
            e = "",
            a = [],
            j = "",
            c = "",
            k = "",
            f = 0;
        e = b.attr("style");
        if (!e) {
            return
        }
        a = e.split(";");
        if (a.length <= 0) {
            return
        }
        for (f = 0; f < a.length; f++) {
            j = a[f].split(":");
            if (typeof(j) == undefined || j.length != 2) {
                continue
            }
            c = jm.trim(j[0]);
            k = jm.trim(j[1]);
            if (this.checkInArray(h, c)) {
                if (k != undefined) {
                    b.css(c, this.returnChangeUnit(k, d))
                }
            }
        }
    },
    traverseTagStyle: function(d, a) {
        if (!d.length) {
            return
        } else {
            this.checkCurrentTagStyle(d, a)
        }
        var c = d.children(),
            b = 0;
        if (c.length <= 0) {
            this.resetValue();
            return
        }
        for (b = 0; b < c.length; b++) {
            this.traverseTagStyle(jm(c[b]), a)
        }
    }
};
Mobi.simpletext = {
    checkNode: checkNode
};
Mobi.hexToRgba = function(b, a) {
    return "rgba(" + parseInt("0x" + b.slice(1, 3)) + "," + parseInt("0x" + b.slice(3, 5)) + "," + parseInt("0x" + b.slice(5, 7)) + "," + a + ")"
};
Mobi.rgbToRgba = function(c) {
    var f = c.split(",");
    if (c.indexOf("rgb(") != -1 && f.length == 3) {
        var e = f[0].substr(4);
        var d = f[1].substr(0);
        var a = f[2].substr(0, f[2].length - 1);
        return "rgba(" + e + "," + d + "," + a + ",1)"
    } else {
        return c
    }
};
Mobi.getGradientColor = function(b, e) {
    if (b.indexOf("#") !== -1) {
        b = Mobi.hexToRgba(b, 1)
    }
    if (b.indexOf("rgb(") !== -1) {
        b = Mobi.rgbToRgba(b)
    }
    if (b.indexOf("transparent") !== -1) {
        return b
    }
    var d = b.split(",");
    var a = [];
    a.push(d[0].substr(5));
    a.push(d[1].substr(0));
    a.push(d[2].substr(0));
    a.push(d[3].substr(0, d[3].length - 1));
    for (var c = 0; c < 3; c++) {
        a[c] = Math.floor((255 - parseInt(a[c])) * e + parseInt(a[c]))
    }
    return "rgba(" + a[0] + "," + a[1] + "," + a[2] + "," + a[3] + ")"
};
Mobi.adjustFlBtnPos = function(b) {
    var a = jm("#module" + b);
    a.css({
        border: "10px solid transparent",
        "margin-top": "-10px",
        "margin-left": "-10px"
    })
};
Mobi.initFoldModuleStyle = function(a, e) {
    var b = jm("#module" + a),
        d = b.find(".J_formFoldButton"),
        h = b.find(".J_formFoldContentList"),
        f = jm(h).attr("_display"),
        j = parseInt(jm("html").css("fontSize"));
    if (f == 0) {
        d.off("click.action").on("click.action",
            function() {
                var o = jm(this).parent();
                var n = jm(this).parent().find(".J_formFoldContent");
                var m = parseInt(n[0].offsetHeight) + parseInt(b.height());
                c(f, n);
                if (jm(this).hasClass("active")) {
                    jm(this).removeClass("active");
                    o.removeAttr("style")
                } else {
                    if (n.find(".form").hasClass("formStyle30")) {
                        k(n)
                    }
                    var l = parseInt(jm(this)[0].offsetHeight) + 1 + parseInt(n[0].offsetHeight);
                    jm(this).parent().parent().find(".J_formFoldButton").each(function(p, q) {
                        jm(q).removeClass("active")
                    });
                    jm(this).parent().parent().find(".J_formFoldItem").each(function(p, q) {
                        jm(q).removeAttr("style")
                    });
                    o.css("height", l + "px");
                    jm(this).addClass("active");
                    if (Fai.top._manageMode) {
                        Mobi.removeMoveFrame("module" + a);
                        Mobi.addMoveFrame("module" + a, undefined, m)
                    }
                }
            })
    } else {
        if (f == 1) {
            d.off("click.action").on("click.action",
                function() {
                    var o = jm(this).parent();
                    var n = jm(this).parent().find(".J_formFoldContent");
                    var m = parseInt(n[0].offsetHeight) + b.height();
                    c(f, n);
                    if (jm(this).hasClass("active")) {
                        jm(this).removeClass("active");
                        o.removeAttr("style")
                    } else {
                        if (n.find(".form").hasClass("formStyle30")) {
                            k(n)
                        }
                        var l = parseInt(jm(this)[0].offsetHeight) + 1 + parseInt(n[0].offsetHeight);
                        jm(this).addClass("active");
                        o.css("height", l + "px");
                        if (Fai.top._manageMode) {
                            Mobi.removeMoveFrame("module" + a);
                            Mobi.addMoveFrame("module" + a, undefined, m)
                        }
                    }
                })
        }
    }
    function k(l) {
        l.find(".form").find(".mobiVideo").css("display", "block")
    }
    function c(l, m) {
        if (l == 1) {
            b.find(".form").find(".mobiVideo").each(function(n, o) {
                o.pause()
            });
            if (m.find(".form").hasClass("formStyle30")) {
                m.find(".form").find(".mobiVideo").css("display", "none")
            }
        } else {
            b.find(".form").find(".mobiVideo").css("display", "none");
            b.find(".form").find(".mobiVideo").each(function(n, o) {
                o.pause()
            })
        }
    }
};
Mobi.initTemplate2 = function(f) {
    var e = Mobi.getJQMobi(),
        a = f.layout,
        h = f.moduleStyle,
        d = f.designType,
        c = Mobi.getPreviewObject("navbar"),
        b = Mobi.getPreviewObject("navbarList");
    if (c) {
        c.setAttribute("style", "")
    }
    if (b) {
        b.setAttribute("style", "")
    }
    jm(Mobi.getPreviewObject("webTop")).css("height", "");
    Mobi.removeAllSwipeMenuClass();
    if (a == 1) {
        jm(Mobi.getPreviewObject("webFooterBox")).append(Mobi.getPreviewObject("navbar"));
        Mobi.showNavItemContainer();
        if (d === 1) {
            Mobi.navSwipeMenu(a)
        }
    } else {
        if (a == 2 || a == 4 || a == 5 || a == 7) {
            if (a !== 5 && a !== 7) {
                Mobi.getPreviewObject("webTop").appendChild(Mobi.getPreviewObject("navbar"))
            } else {
                Mobi.getPreviewObject("webHeaderBox").appendChild(Mobi.getPreviewObject("navbar"))
            }
            Mobi.autoSetNavBarBottom(a);
            Mobi.navSwipeMenu(a)
        } else {
            if (a == 3 || a == 0 || a == 8) {
                jm(Mobi.getPreviewObject("webHeaderBox")).append(Mobi.getPreviewObject("navbar"));
                if (a == 0) {
                    Mobi.showNavItemContainer()
                } else {
                    if (a == 8) {
                        Mobi.showNavItemContainer();
                        Mobi.navSwipeMenu(a)
                    } else {
                        if (d === 1) {
                            Mobi.navSwipeMenu(a)
                        }
                    }
                }
            } else {
                if (a == 6) {
                    jm(Mobi.getPreviewObject("webBannerBox")).append(Mobi.getPreviewObject("navbar"));
                    Mobi.showNavItemContainer()
                }
            }
        }
    }
    Mobi.autoSetNavBarBottom(a);
    Mobi.autoFixGWebTop(a);
    Mobi.topTipMarquee();
    if (Mobi.getPreviewObject("webMultilingualArea")) {
        if (a == 4) {
            jm(Mobi.getPreviewObject("webHeaderBox")).append(Mobi.getPreviewObject("webMultilingualArea"))
        } else {
            jm(Mobi.getPreviewObject("webBannerBox")).prepend(Mobi.getPreviewObject("webMultilingualArea"))
        }
    }
    if (Fai.top._templateFrameId === 1005 || Fai.top._templateFrameId === 1004 || Fai.top._templateFrameId === 1019 || Fai.top._templateFrameId === 1023 || Fai.top._templateFrameId === 1024 || Fai.top._templateFrameId === 1021) {
        Mobi.scrollNavFix();
        jm(window).bind("load",
            function() {
                Mobi.scrollNavFix()
            })
    }
    if (Mobi.getPreviewObject("navButton")) {
        if (Fai.top._templateFrameId === 1004 || Fai.top._templateFrameId === 1023) {
            jm(Mobi.getPreviewObject("navbar")).append(Mobi.getPreviewObject("navButton"))
        } else {
            jm(Mobi.getPreviewObject("webHeaderBox")).prepend(Mobi.getPreviewObject("navButton"))
        }
    }
    Mobi.scrollHeaderTop();
    Mobi.changeMorePosition(h)
};
Mobi.changeMorePosition = function(d) {
    var e = document.querySelectorAll("#webModuleContainer>.form"),
        a = e.length;
    if (d === 1) {
        for (var b = 0; b < a; b++) {
            var j = e[b],
                h = j.id || "",
                c = j.querySelector(".formBannerMore" + h.replace("module", ""));
            if (!c) {
                continue
            }
            j.appendChild(c)
        }
    } else {
        for (var b = 0; b < a; b++) {
            var j = e[b],
                f = j.querySelector(".formBannerTitle>.titleCenter"),
                h = j.id || "",
                c = j.querySelector(".formBannerMore" + h.replace("module", "")); !! f && f.appendChild(c)
        }
    }
};
Mobi.scrollHeaderTop = function() {
    document.addEventListener("touchstart",
        function(b) {
            a()
        },
        false);
    document.addEventListener("touchmove",
        function(b) {
            a()
        },
        false);
    document.addEventListener("touchend",
        function(b) {
            a()
        },
        false);
    document.addEventListener("touchcancel",
        function(b) {
            a()
        },
        false);
    document.addEventListener("scroll",
        function() {
            a()
        },
        false);
    function a() {
        if (document.getElementsByClassName("J_registerHeader").length) {
            var d = document.getElementById("g_body"),
                c = document.getElementsByClassName("J_registerHeader")[0],
                f = false;
            var h = c.offsetTop,
                b = c.clientHeight;
            var e = d.scrollTop;
            if ((e > h || e < h) && !f) {
                jm(c).addClass("headerScroll_fix");
                f = true
            }
            if ((e - b) < h && f) {
                jm(c).removeClass("headerScroll_fix");
                f = false
            }
        }
    }
};
Mobi.scrollNavFix = function() {
    var e = document.getElementById("navbar"),
        f = document.getElementById("g_body"),
        c = e.clientHeight,
        b = false,
        h = e.offsetTop,
        d = f.scrollTop;
    if (e.parentNode == document.getElementById("webBannerBox")) {
        h += 180
    }
    document.addEventListener("touchstart",
        function(j) {
            a()
        },
        false);
    document.addEventListener("touchmove",
        function(j) {
            a()
        },
        false);
    document.addEventListener("touchend",
        function(j) {
            a()
        },
        false);
    document.addEventListener("touchcancel",
        function(j) {
            a()
        },
        false);
    document.addEventListener("scroll",
        function() {
            a()
        },
        false);
    function a() {
        var k = f.scrollTop,
            j = document.getElementById("webContainerBox").offsetTop - k;
        if (k > d) {
            if (j < 0) {
                jm(e).addClass("scroll_fix")
            }
        } else {
            if (j >= 0) {
                jm(e).removeClass("scroll_fix")
            }
        }
        d = k
    }
};
Mobi.initFooterHeight = function() {
    var b = Mobi.getPreviewObject("webFooter");
    b.style.height = "";
    jm("#webModuleContainer").css({
        overflow: "hidden"
    });
    var e = 0,
        a = b.clientHeight,
        c = document.documentElement.clientHeight,
        f = jm("#g_web>div");
    for (var d = 0; d < f.length; d++) {
        e += f[d].clientHeight
    }
    if (e <= c) {
        b.style.display="none"
        //b.style.height = (c - e) + a + "px"
    } else {
        b.style.height = ""
    }
};
Mobi.autoSetNavBarHeight = function(a) {
    var h = Mobi.getPreviewObject("webHeader").offsetHeight,
        e = Mobi.getPreviewObject("webTips") ? Mobi.getPreviewObject("webTips").offsetHeight: 0,
        c = 0,
        d = Fai.top._openOnlineService ? parseInt(jm("#customerServiceDiv").height()) : 0,
        f = 4 + parseInt(jm(Mobi.getPreviewObject("navbar")).css("bottom").replace("px", ""));
    if (jm.os.iphone) {
        if (a == 4) {
            f = Fai.top._openOnlineService ? parseInt(jm("#customerServiceDiv").height()) + 35 : f;
            c = Mobi.getPreviewWindow().innerHeight - f - e - d
        }
    } else {
        if (jm.os.android) {
            c = Mobi.getPreviewWindow().screen.height / Mobi.getPreviewWindow().devicePixelRatio - Mobi.getPreviewWindow().screenTop;
            if (a == 4) {
                f = Fai.top._openOnlineService ? parseInt(jm("#customerServiceDiv").height()) + 35 : f;
                c = Mobi.getPreviewWindow().innerHeight - f - d
            }
        } else {
            if (!jm.os.supportsTouch) {
                c = Mobi.getPreviewWindow().innerHeight - e;
                if (a == 4) {
                    f = Fai.top._openOnlineService ? parseInt(jm("#customerServiceDiv").height()) + 35 : f;
                    c = Mobi.getPreviewWindow().innerHeight - f - d
                }
            }
        }
    }
    if (c > 0) {
        if (a == 4) {
            var b = parseInt(jm("#navbarList").height()) + parseInt(jm("#navbarList").css("padding-bottom").replace("px", ""));
            if (b > c) {
                jm("#navbar").css("height", c + "px")
            }
        } else {
            jm("#navbar").css("height", c + "px")
        }
    }
};
Mobi.autoSetNavBarBottom = function(a) {
    var b = jm("#navbar"),
        c;
    if (a == 4) {
        if (Fai.top._openOnlineService) {
            jm("#navButton").css("bottom", (parseInt(jm("#customerServiceDiv").height()) + 15) / _htmlFontSize + "rem");
            b.css("bottom", (parseInt(jm("#customerServiceDiv").height()) + 35) / _htmlFontSize + "rem")
        } else {
            if (/height/.test(b.attr("style"))) {
                c = b.height();
                b.removeAttr("style");
                b.css("height", c + "px")
            } else {
                b.removeAttr("style")
            }
            jm("#navButton").removeAttr("style")
        }
    } else {
        jm("#navButton").removeAttr("style");
        b.removeAttr("style")
    }
};
Mobi.handlePirtureSize = function() {
    var b = document.getElementById("webContainerBox");
    if (!b) {
        return
    }
    var c = b.querySelectorAll("img");
    for (var a = 0; a < c.length; a++) {
        if (c[a].offsetWidth <= 0 || c[a].offsetHeight <= 0) {
            c[a].style.visibility = "hidden"
        }
        c[a].onload = function() {
            this.style.visibility = "visible"
        }
    }
};
Mobi.fixImageHeight = function(b, d) {
    if (!b) {
        return
    }
    var c = document.getElementById(b);
    if (!c) {
        return
    }
    var a = c.querySelectorAll("img"),
        f = 1,
        k = 0,
        j = a.length;
    for (var e = 0; e < j; e++) { (function(m) {
        var n = new Image();
        n.src = a[m].src;
        n.onload = function() {
            if (n.height > k) {
                k = n.height
            }
            h()
        };
        if (n.height != 0) {
            if (n.height > k) {
                k = n.height
            }
        }
        if (f % 2 === 0 || m === a.length - 1) {
            if (k > 0 && k < 160) {
                if (f % 2 === 1 && m === a.length - 1) {
                    a[m].parentNode.style.height = (k / _htmlFontSize) + "rem"
                }
                if (f % 2 === 0) {
                    for (var l = 0; l < 2; l++) {
                        a[m + l - 1].parentNode.style.height = (k / _htmlFontSize) + "rem"
                    }
                }
            }
            k = 0
        }++f
    })(e)
    }
    if (d) {
        h()
    }
    function h() {
        var n = 0,
            m = 0,
            o = jm("#" + b).find(".photoListImg"),
            l = jm("#" + b).find(".imgClass_160");
        o.each(function() {
            m = parseInt(jm(this).height());
            if (m > n) {
                n = m
            }
        });
        if (n != 0) {
            l.css("height", (n / _htmlFontSize) + "rem")
        }
    }
};
Mobi.fixImageHeightPhoList = function(b, e) {
    if (!b) {
        return
    }
    var c = document.getElementById(b);
    if (!c) {
        return
    }
    var h = jm("#" + b).find(".photoDiv");
    var d = jm("#" + b).find(".imgClass_160");
    var a = c.querySelectorAll("img"),
        j = 1,
        n = 0,
        m = a.length;
    var p = jm("#" + b).find(".imgName");
    var k = jm("#" + b).find(".imageMiddle");
    var o = 0;
    for (var f = 0; f < m; f++) { (function(r) {
        var s = new Image();
        s.src = jm(a[r]).attr("src");
        s.onload = function() {
            if (s.height > n) {
                n = s.height
            }
            l();
            if (e == 2 && o == m) {
                for (var x = 0; x < m; x++) {
                    var z = a[x].width;
                    var w = a[x].height;
                    var t = d.eq(0).width();
                    var v = d.eq(0).height();
                    var y = z / w;
                    var u = t / v;
                    if (u <= y) {
                        jm(a[x]).css("width", y * v + "px");
                        jm(a[x]).css("height", v + "px");
                        jm(a[x]).css("maxWidth", "initial");
                        jm(d[x]).css("marginLeft", ((t - y * v) / 2) + "px");
                        jm(h[x]).css({
                            position: "relative",
                            overflow: "hidden"
                        });
                        jm(k[x]).css("display", "none")
                    } else {
                        jm(a[x]).css("height", t / y + "px");
                        jm(a[x]).css("width", t + "px");
                        jm(a[x]).css("marginTop", ((v - t / y) / 2) + "px");
                        jm(d[x]).css("overflow", "hidden");
                        jm(k[x]).css("display", "none")
                    }
                }
            }
        };
        if (e == 0) {
            l()
        }
        if (s.height != 0) {
            if (s.height > n) {
                n = s.height
            }
        }
        if (j % 2 === 0 || r === a.length - 1) {
            if (n > 0 && n < 160) {
                if (j % 2 === 1 && r === a.length - 1) {
                    a[r].parentNode.style.height = (n / _htmlFontSize) + "rem"
                }
                if (j % 2 === 0) {
                    for (var q = 0; q < 2; q++) {
                        a[r + q - 1].parentNode.style.height = (n / _htmlFontSize) + "rem"
                    }
                }
            }
            n = 0
        }++j
    })(f)
    }
    function l() {
        var s = 0,
            r = 0,
            t = jm("#" + b).find(".photoListImg"),
            q = jm("#" + b).find(".imgClass_160");
        t.each(function() {
            r = Math.ceil(parseFloat(jm(this).height()));
            if (r > s) {
                s = r
            }
        });
        if (e == 2) {
            q.css("height", s + "px")
        } else {
            if (s != 0) {
                q.css("height", (s / _htmlFontSize) + "rem")
            }
        }
        o++
    }
};
Mobi.defImageHeightType2 = function(b, e) {
    if (!b) {
        return
    }
    var c = document.getElementById(b);
    if (!c) {
        return
    }
    var h = jm("#" + b).find(".photoCrossedSlideSec");
    var d = jm("#" + b).find(".imgClass_160");
    var a = c.querySelectorAll("img"),
        k = 1,
        p = 0,
        n = a.length;
    var l = c.querySelectorAll(".imageMiddle");
    var r = c.querySelectorAll(".imgName");
    var f, o, s;
    var q = 0;
    for (var j = 0; j < n; j++) { (function(u) {
        var v = new Image();
        v.src = jm(a[u]).attr("src");
        v.onload = function() {
            if (v.height > p) {
                p = v.height
            }
            m();
            if (e == 2 && q == n) {
                for (var A = 0; A < n; A++) {
                    var C = v.width;
                    var z = v.height;
                    var w = d.eq(0).width();
                    var y = d.eq(0).height();
                    var B = C / z;
                    var x = w / y;
                    if (x <= B) {
                        jm(a[A]).css("width", B * y + "px");
                        jm(a[A]).css("height", y + "px");
                        jm(a[A]).css("maxWidth", "initial");
                        jm(a[A]).css("marginLeft", ((w - B * y) / 2) + "px");
                        jm(h[A]).css({
                            position: "relative",
                            overflow: "hidden"
                        });
                        jm(l[A]).css("display", "none")
                    } else {
                        jm(a[A]).css("height", w / B + "px");
                        jm(a[A]).css("width", w + "px");
                        jm(a[A]).css("marginTop", ((y - w / B) / 2) + "px");
                        jm(l[A]).css("display", "none")
                    }
                }
            }
            if (q == n) {
                s = b.replace("module", "");
                f = jm("#" + b).find(".J_marqueeContainer" + s);
                if (f.length > 0) {
                    o = jm("#" + b).find("#photoSlideList" + s).offset().height;
                    f.css("height", o + "px");
                    f.find(".J_contentPanelCopy" + s).css("height", o + "px")
                }
            }
        };
        if (v.height != 0) {
            if (v.height > p) {
                p = v.height
            }
        }
        if (k % 2 === 0 || u === a.length - 1) {
            if (p > 0 && p < 160) {
                if (k % 2 === 1 && u === a.length - 1) {
                    a[u].parentNode.style.height = (p / _htmlFontSize) + "rem"
                }
                if (k % 2 === 0) {
                    for (var t = 0; t < 2; t++) {
                        a[u + t - 1].parentNode.style.height = (p / _htmlFontSize) + "rem"
                    }
                }
            }
            p = 0
        }++k
    })(j)
    }
    if (e == 0) {
        m()
    }
    function m() {
        var v = 0,
            u = 0,
            w = jm("#" + b).find(".photoListImg"),
            t = jm("#" + b).find(".imgClass_160");
        divWidth = t.eq(0).width();
        divHeight = t.eq(0).height();
        w.each(function() {
            u = parseInt(jm(this).height());
            imgClassW = parseInt(jm(this).width());
            if (u > v) {
                v = u
            }
        });
        if (e == 2) {
            t.css("height", divWidth * (v / imgClassW) + "px")
        } else {
            if (v != 0) {
                t.css("height", (v / _htmlFontSize) + "rem")
            }
        }
        q++
    }
};
Mobi.initTemplate = function(a) {
    var b = Mobi.getJQMobi();
    if (a == 0 || a == 1 || a == 6) {
        Mobi.showNavItemContainer()
    } else {
        if (a == 2 || a == 4 || a == 5) {
            Mobi.autoSetNavBarBottom(a);
            Mobi.navSwipeMenu(a)
        }
    }
    Mobi.handlePirtureSize()
};
Mobi.fixGwebHieght = function() {
    var a = Mobi.getPreviewWindow().innerHeight,
        c = Mobi.getPreviewObject("g_web"),
        b = c.offsetHeight;
    if (a > b) {
        c.style.height = a + "px"
    }
};
Mobi.initMobiPage = function(a) {
    if (!jm.os.supportsTouch) {
        Mobi.resetHtmlFontSize()
    }
    Mobi.initTemplate2(a);
    if (Fai.top._manageMode) {
        Mobi.initLocater()
    }
    Mobi.unloadForATag();
    Mobi.initOnlineServiceWidth();
    Fai.top.window.onresize = function() {
        if (!Mobi.bannerAnimate.init(Fai.top._bannerData)) {
            Mobi.initBannerDefaultDom(Fai.top._bannerData);
            Mobi.initSwipe("bannerSwipe", Fai.top._bannerData)
        }
        Mobi.resetHtmlFontSize();
        Mobi.logoSizeCompressByMargin();
        Mobi.titlePositionRefreshByLogo();
        Mobi.autoFixGWebTop(Fai.top._templateLayoutId);
        Mobi.initBgmPosition()
    };
    Mobi.initForms();
    Mobi.fixFontSizeDeviation();
    Mobi.onlineServiceInputWord();
    Mobi.closeLoading();
    Mobi.bindBodyScrollTypeWritingEvent();
    Mobi.initMobiPageWithLogDog();
    setTimeout(function() {
            jm("#jiaxin-mcs-fixed-btn").off("click.log").on("click.log",
                function() {
                    Mobi.logDog(200171, 6)
                })
        },
        1000);
    window.Fai && (window.Fai.top._popupZone = {});
    window.Fai && (window.Fai.top._popupZone.openZone = function() {});
    if (!Fai.top.Mobi.getPreviewWindow()._hmt && jm("a[href*='Mobi.showBaiduBridge']").length > 0) {
        jm("#g_body").append("<div id='baiduBridgeScript'></div>");
        jm("#baiduBridgeScript").append(Fai.top.Mobi.getPreviewWindow()._baiduBridgeCodes);
        jm.fkEval.call(window, jm("#baiduBridgeScript script").html())
    }
};
Mobi.initMobiPageWithLogDog = function() {
    a();
    function a() {
        var n = 200100,
            d = Fai.top.devicePixelRatio,
            b = Fai.top.screen,
            j, m = "fkLogDog-screenResolution",
            f, l, o, h;
        if (localStorage.getItem(m)) {
            return
        }
        f = {
            "1920*1080": 1,
            "1366*768": 2,
            "1440*900": 3,
            "1600*900": 4,
            other: 5,
            "1680*1050": 6,
            "1280*800": 7,
            "1280*1024": 8,
            "1360*768": 9,
            "1280*720": 10,
            "1024*768": 11,
            "1280*768": 12,
            "1600*1200": 13,
            "1600*1024": 14
        };
        l = {
            "1080*1920": 15,
            "720*1280": 16,
            "480*854": 17,
            "540*960": 18,
            "1080*1812": 19,
            "720*1184": 20,
            "1080*1776": 21,
            "1080*1794": 22,
            "750*1334": 23,
            "1242*2208": 24,
            "640*960": 25,
            "768*1024": 26,
            "1125*2001": 27,
            other: 28,
            "640*1136": 29,
            "1440*2560": 30,
            "1140*2960": 31
        };
        function c(p) {
            var q, r, e;
            for (q in p) {
                if (q.indexOf("*") > -1) {
                    r = q.split("*");
                    e = r[0] * r[1];
                    p[e] = p[q];
                    delete p[q]
                }
            }
            return p
        }
        o = Fai.top._manageMode ? f: l;
        j = (b.width * d) * (b.height * d);
        o = c(o);
        h = o[j] || o.other;
        if (Mobi.isPC() && !Fai.top._manageMode) {
            h = o.other
        }
        if (n && h) {
            try {
                localStorage.setItem(m, true);
                Mobi.logDog(n, h)
            } catch(k) {}
        }
    }
};
Mobi.bindBodyScrollTypeWritingEvent = function() {
    function d(e, h) {
        var h = h || 100;
        if (e.length == 0) {
            return
        }
        var f = function(j) {
            if (j.target != e && j.target.tagName != "INPUT" && j.target.tagName != "TEXTAREA") {
                setTimeout(function() {
                        e.blur();
                        document.removeEventListener("touchstart", f, false)
                    },
                    h)
            }
        };
        e.addEventListener("focus",
            function() {
                document.addEventListener("touchstart", f, false)
            },
            false)
    }
    var b = document.querySelectorAll("input,textarea");
    for (var c = 0; c < b.length; c++) {
        var a = new d(b[c]);
        a = null
    }
};
Mobi.resetHtmlFontSize = function() {
    var b = document.documentElement ? document.documentElement.clientWidth: document.body.clientWidth,
        a = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
    if (Mobi.getMobiOSType() === 8 && Mobi.getBrowserType() === 4) {
        a = document.documentElement.clientWidth || document.body.clientWidth
    }
    if (a > 768 && a < 1280) {
        b = 768
    } else {
        if (a >= 1280) {
            b = 512
        }
    }
    document.documentElement.style.fontSize = b * 1 / 16 + "px";
    _htmlFontSize = b * 1 / 16
};
Mobi.closeLoading = function() {
    var a = document.getElementById("webLoading");
    if (!a) {
        return
    }
    a.style.display = "none"
};
Mobi.showLoading = function() {
    var a = document.getElementById("webLoading");
    if (!a) {
        return
    }
    a.style.display = "block"
};
Mobi.MobiOSType = {
    UNKNOWN: 0,
    IPHONE: 1,
    IPAD: 2,
    WEBOS: 3,
    ANDROID: 4,
    ANDROIDICS: 5,
    BLACKBERRY: 6,
    WINDOW_DESKTOP: 7,
    MAC: 8,
    ANDROID_2_3: 9,
    ANDROID_4_0: 10,
    ANDROID_4_1: 11,
    ANDROID_4_2: 12,
    ANDROID_4_3: 13,
    ANDROID_4_4: 14,
    ANDROID_5_0: 15,
    IOS_5_0: 16,
    IOS_5_1: 17,
    IOS_6_0: 18,
    IOS_6_1: 19,
    IOS_7_0: 20,
    IOS_7_1: 21,
    IOS_8_0: 22,
    IOS_8_1: 23
};
Mobi.getMobiOSType = function() {
    if (jm.os.IOS_5_0) {
        return Mobi.MobiOSType.IOS_5_0
    } else {
        if (jm.os.IOS_5_1) {
            return Mobi.MobiOSType.IOS_5_1
        } else {
            if (jm.os.IOS_6_0) {
                return Mobi.MobiOSType.IOS_6_0
            } else {
                if (jm.os.IOS_6_1) {
                    return Mobi.MobiOSType.IOS_6_1
                } else {
                    if (jm.os.IOS_7_0) {
                        return Mobi.MobiOSType.IOS_7_0
                    } else {
                        if (jm.os.IOS_7_1) {
                            return Mobi.MobiOSType.IOS_7_1
                        } else {
                            if (jm.os.IOS_8_0) {
                                return Mobi.MobiOSType.IOS_8_0
                            } else {
                                if (jm.os.IOS_8_1) {
                                    return Mobi.MobiOSType.IOS_8_1
                                } else {
                                    if (jm.os.ANDROID_2_3) {
                                        return Mobi.MobiOSType.ANDROID_2_3
                                    } else {
                                        if (jm.os.ANDROID_4_0) {
                                            return Mobi.MobiOSType.ANDROID_4_0
                                        } else {
                                            if (jm.os.ANDROID_4_1) {
                                                return Mobi.MobiOSType.ANDROID_4_1
                                            } else {
                                                if (jm.os.ANDROID_4_2) {
                                                    return Mobi.MobiOSType.ANDROID_4_2
                                                } else {
                                                    if (jm.os.ANDROID_4_3) {
                                                        return Mobi.MobiOSType.ANDROID_4_3
                                                    } else {
                                                        if (jm.os.ANDROID_4_4) {
                                                            return Mobi.MobiOSType.ANDROID_4_4
                                                        } else {
                                                            if (jm.os.ANDROID_5_0) {
                                                                return Mobi.MobiOSType.ANDROID_5_0
                                                            } else {
                                                                if (jm.os.iphone) {
                                                                    return Mobi.MobiOSType.IPHONE
                                                                } else {
                                                                    if (jm.os.ipad) {
                                                                        return Mobi.MobiOSType.IPAD
                                                                    } else {
                                                                        if (jm.os.webos) {
                                                                            return Mobi.MobiOSType.WEBOS
                                                                        } else {
                                                                            if (jm.os.androidICS) {
                                                                                return Mobi.MobiOSType.ANDROIDICS
                                                                            } else {
                                                                                if (jm.os.android) {
                                                                                    return Mobi.MobiOSType.ANDROID
                                                                                } else {
                                                                                    if (jm.os.blackberry) {
                                                                                        return Mobi.MobiOSType.BLACKBERRY
                                                                                    } else {
                                                                                        if (jm.os.WINDOW_DESKTOP) {
                                                                                            return Mobi.MobiOSType.WINDOW_DESKTOP
                                                                                        } else {
                                                                                            if (jm.os.MAC) {
                                                                                                return Mobi.MobiOSType.MAC
                                                                                            } else {
                                                                                                return Mobi.MobiOSType.UNKNOWN
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
};
Mobi.BrowserType = {
    UNKNOWN: 0,
    CHROME: 1,
    FIREFOX: 2,
    MSIE10: 3,
    WEBKIT: 4,
    MSIE9: 5,
    MSIE11: 6,
    OPERA: 7,
    WX_BROWSER: 8,
    UC_BROWSER: 9,
    QQ_BROWSER: 10,
    B360_BROWSER: 11,
    BD_BROWSER: 12,
    SG_BROWSER: 13,
    LB_BROWSER: 14,
    SAFARI: 15
};
Mobi.getBrowserType = function() {
    if (jm.os.WXBrowser) {
        return Mobi.BrowserType.WX_BROWSER
    } else {
        if (jm.os.UCBrowser) {
            return Mobi.BrowserType.UC_BROWSER
        } else {
            if (jm.os.MQQBrowser) {
                return Mobi.BrowserType.QQ_BROWSER
            } else {
                if (jm.os.LieBaoFast) {
                    return Mobi.BrowserType.LB_BROWSER
                } else {
                    if (jm.os.BaiDuBrowser) {
                        return Mobi.BrowserType.BD_BROWSER
                    } else {
                        if (jm.os.Sougou) {
                            return Mobi.BrowserType.SG_BROWSER
                        } else {
                            if (jm.os.B360Browser) {
                                return Mobi.BrowserType.B360_BROWSER
                            } else {
                                if (jm.os.ie10) {
                                    return Mobi.BrowserType.MSIE10
                                } else {
                                    if (jm.os.chrome) {
                                        return Mobi.BrowserType.CHROME
                                    } else {
                                        if (jm.os.fennec) {
                                            return Mobi.BrowserType.FIREFOX
                                        } else {
                                            if (jm.os.safari) {
                                                return Mobi.BrowserType.SAFARI
                                            } else {
                                                if (jm.os.ie9) {
                                                    return Mobi.BrowserType.MSIE9
                                                } else {
                                                    if (jm.os.ie11) {
                                                        return Mobi.BrowserType.MSIE11
                                                    } else {
                                                        if (jm.os.opera) {
                                                            return Mobi.BrowserType.OPERA
                                                        } else {
                                                            if (jm.os.webkit) {
                                                                return Mobi.BrowserType.WEBKIT
                                                            } else {
                                                                return Mobi.BrowserType.UNKNOWN
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
};
Mobi.Screen = function() {
    var a = window.devicePixelRatio || 1;
    return {
        width: window.screen.width * a,
        height: window.screen.height * a
    }
};
Mobi.ScreenType = {
    OTHER: 0,
    W320H480: 1,
    W480H800: 2,
    W480H854: 3,
    W720H1280: 4,
    WINDOW_SCREEN: 5,
    W240H320: 6,
    W600H800: 7,
    W540H960: 8,
    W640H960: 9,
    W768H1024: 10,
    W640H1136: 11,
    W720H1184: 12,
    W1440H2560: 13,
    W800H1280: 14,
    W750H1334: 15,
    W1080H1776: 16,
    W1080H1920: 17,
    W1536H2048: 18,
    W1280H720: 19
};
Mobi.getScreenType = function(b, a) {
    if (b == 320 && a == 480) {
        return Mobi.ScreenType.W320H480
    } else {
        if (b == 480 && a == 800) {
            return Mobi.ScreenType.W480H800
        } else {
            if (b == 480 && a == 854) {
                return Mobi.ScreenType.W480H854
            } else {
                if (b == 720 && a == 1280) {
                    return Mobi.ScreenType.W1720H1280
                } else {
                    if (b == 240 && a == 320) {
                        return Mobi.ScreenType.W240H320
                    } else {
                        if (b == 600 && a == 800) {
                            return Mobi.ScreenType.W600H800
                        } else {
                            if (b == 540 && a == 960) {
                                return Mobi.ScreenType.W540H960
                            } else {
                                if (b == 640 && a == 960) {
                                    return Mobi.ScreenType.W640H960
                                } else {
                                    if (b == 768 && a == 1024) {
                                        return Mobi.ScreenType.W768H1024
                                    } else {
                                        if (b == 640 && a == 1136) {
                                            return Mobi.ScreenType.W640H1136
                                        } else {
                                            if (b == 720 && a == 1184) {
                                                return Mobi.ScreenType.W720H1184
                                            } else {
                                                if (b == 1440 && a == 2560) {
                                                    return Mobi.ScreenType.W1440H2560
                                                } else {
                                                    if (b == 800 && a == 1280) {
                                                        return Mobi.ScreenType.W800H1280
                                                    } else {
                                                        if (b == 750 && a == 1334) {
                                                            return Mobi.ScreenType.W750H1334
                                                        } else {
                                                            if (b == 1080 && a == 1776) {
                                                                return Mobi.ScreenType.W1080H1776
                                                            } else {
                                                                if (b == 1080 && a == 1920) {
                                                                    return Mobi.ScreenType.W1080H1920
                                                                } else {
                                                                    if (b == 1536 && a == 2048) {
                                                                        return Mobi.ScreenType.W1536H2048
                                                                    } else {
                                                                        if (b == 1280 && a == 720) {
                                                                            return Mobi.ScreenType.W1280H720
                                                                        } else {
                                                                            return Mobi.ScreenType.OTHER
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
};
Mobi.getWXShareData = function(e, a) {
    var c = "ajax/wx_h.jsp?cmd=getWXShareData";
    var d = [];
    d.push("ticket=" + e);
    d.push("&url=" + jm.encodeUrl(a));
    var b = {};
    jm.ajax({
        url: c,
        type: "post",
        cache: false,
        data: d.join(""),
        async: false,
        success: function(f) {
            var h = jm.parseJSON(f);
            if (h.success) {
                b.noncestr = h.noncestr;
                b.timestamp = h.timestamp;
                b.signature = h.signature
            }
        }
    });
    return b
};
Mobi.statisticalMobiVisitors = function(l) {
    if (!l) {
        return
    }
    var e = {
        colId: -1,
        pdId: -1,
        ndId: -1
    };
    var a = jm.extend({},
        e, l);
    if (a.colId == null || a.colId == "" || a.colId < 0) {
        a.colId = -1
    }
    if (a.pdId == null || a.pdId == "" || a.pdId < 0) {
        a.pdId = -1
    }
    if (a.ndId == null || a.ndId == "" || a.ndId < 0) {
        a.ndId = -1
    }
    var b = "",
        k = navigator.userAgent;
    if (!k.match(/AppleWebKit.*Mobile.*/) && !k.match(/ipad/i)) {
        b = "pc"
    } else {
        if (k.match(/ipad/i)) {
            b = "ipad"
        } else {
            if (k.match(/android/i)) {
                b = "android"
            } else {
                if (k.match(/iphone/i)) {
                    b = "iphone"
                } else {
                    b = "other"
                }
            }
        }
    }
    var h = "ajax/statistics_h.jsp?cmd=visited";
    var f = [];
    var d, j, c = false;
    if (Fai.top._manageMode) {
        d = Fai.top.Fai.getBrowserType();
        j = Fai.top.Fai.getScreenType(Fai.top.Fai.Screen().width, Fai.top.Fai.Screen().height)
    } else {
        d = Mobi.getBrowserType();
        j = Mobi.getScreenType(Mobi.Screen().width, Mobi.Screen().height);
        c = jm.os.WINDOW_DESKTOP
    }
    f.push("&colId=" + a.colId);
    f.push("&pdId=" + a.pdId);
    f.push("&ndId=" + a.ndId);
    f.push("&windowDesktop=" + c);
    f.push("&mobiOSType=" + Mobi.getMobiOSType());
    f.push("&browserType=" + d);
    f.push("&screenType=" + j);
    f.push("&rf=" + jm.encodeUrl(a.rf));
    f.push("&sc=" + a.sc);
    f.push("&visitUrl=" + jm.encodeUrl(document.location.href));
    f.push("&visitEquipment=" + b);
    f.push("&statId=" + a.statId);
    // jm.ajax({
    //     type: "post",
    //     url: "ajax/mobistatistics_h.jsp?cmd=visited",
    //     data: f.join(""),
    //     success: function(m) {}
    // })
};
Mobi.mobiStatVisitTime = function() {
    window.onbeforeunload = function(c) {
        var a = c.timeStamp;
        var b = "ajax/mobistatistics_h.jsp?cmd=visitTime";
        var d = [];
        d.push("unloadTime=" + a);
        jm.ajax({
            url: b,
            type: "post",
            cache: false,
            data: d.join(""),
            success: function(e) {}
        })
    }
};
Mobi.report = function(a) {
    setTimeout(function() {
            if (window.performance) {
                var d = performance.timing;
                var n = d.fetchStart - d.navigationStart;
                var h = d.redirectEnd - d.redirectStart;
                var k = d.domainLookupStart - d.fetchStart;
                var o = d.unloadEventEnd - d.unloadEventStart;
                var b = d.domainLookupEnd - d.domainLookupStart;
                var e = d.connectEnd - d.connectStart;
                var f = d.responseEnd - d.requestStart;
                var p = d.domInteractive - d.responseEnd;
                var q = d.domComplete - d.domInteractive;
                var m = d.loadEventEnd - d.loadEventStart;
                var j = d.loadEventEnd - d.navigationStart;
                var l = [];
                l.push("&dt=" + b);
                l.push("&ct=" + e);
                l.push("&rt=" + f);
                l.push("&wt=" + p);
                l.push("&pt=" + q);
                l.push("&bt=" + Mobi.getBrowserType());
                var c = "ajax/mobistatistics_h.jsp?cmd=report";
                jm.ajax({
                    url: c,
                    type: "post",
                    cache: false,
                    data: l.join(""),
                    success: function(r) {}
                })
            }
        },
        500)
};
Mobi.scrollToTop = function(b) {
    var c = document.getElementById("g_body"),
        e = c.scrollTop,
        d = 1500;
    var a = document.createElement("div");
    a.setAttribute("id", "scrollHideDiv");
    a.style.cssText = "position:absolute;width:100%;height:100%;top:0;z-index:9999;";
    if (jm("#navbar").hasClass("scroll_fix")) {
        jm("#navbar").removeClass("scroll_fix")
    }
    c.style.marginTop = -e + "px";
    window.scrollTo(0, 0);
    c.appendChild(a);
    c.style[jm.feat.cssPrefix + "Transition"] = "margin-top " + d + "ms cubic-bezier(0.175, 0.885, 0.320, 1.025)";
    c.style.marginTop = 0 + "px";
    setTimeout(function() {
            c.style[jm.feat.cssPrefix + "Transition"] = "none";
            var f = document.getElementById("scrollHideDiv");
            c.removeChild(f)
        },
        d);
    Mobi.scrollBgmPosition()
};
Mobi.logDog = function(b, a) {
    // jm.ajax({
    //     type: "get",
    //     url: "/ajax/log_h.jsp?cmd=dog&dogId=" + jm.encodeUrl(b) + "&dogSrc=" + jm.encodeUrl(a)
    // })
};
Mobi.mobiHideScroll = function() {
    var c = document.getElementById("g_body");
    var d = document.getElementsByTagName("html")[0];
    c.style.overflowY = "hidden";
    d.style.overflowY = "hidden";
    if (Fai.top._manageMode) {
        iFrameObj = window.parent.document.getElementById("mobiReviewPageFrame");
        var b = Fai.top.Fai.getScrollWidth();
        var a = iFrameObj.clientWidth - b
    }
};
Mobi.mobiShowScroll = function() {
    var a = document.getElementById("g_body");
    var b = document.getElementsByTagName("html")[0];
    a.style.overflowY = "";
    b.style.overflowY = "";
    if (Fai.top._manageMode) {
        iFrameObj = window.parent.document.getElementById("mobiReviewPageFrame");
        iFrameObj.style.position = "";
        iFrameObj.style.left = "";
        iFrameObj.setAttribute("width", "100%")
    }
};
Mobi.bindBodyScrollEvent = function() {
    window.onscroll = null;
    window.onscroll = function() {
        Mobi.scrollBgmPosition()
    }
};
Mobi.isWechat = function() {
    var a = window.navigator.userAgent.toLowerCase();
    if (a.match(/MicroMessenger/i) == "micromessenger") {
        return true
    } else {
        return false
    }
};
Mobi.isQQ = function() {
    var b = window.navigator.userAgent.toLowerCase();
    var c = ["qq"];
    function a(d) {
        return b.indexOf(d) > -1
    }
    return c.some(a)
};
Mobi.isMX = function() {
    var b = window.navigator.userAgent.toLowerCase();
    var c = ["mx4 pro"];
    function a(d) {
        return b.indexOf(d) > -1
    }
    return c.some(a)
};
Mobi.isPC = function() {
    var a = navigator.userAgent;
    var d = ["Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod"];
    var b = true;
    for (var c = 0; c < d.length; c++) {
        if (a.indexOf(d[c]) > 0) {
            b = false;
            break
        }
    }
    return b
};
Mobi.setCtrlStyle = function(b, a) {
    var d = $("#" + b);
    var e = new Array();
    if (d.length == 1) {
        var c = d.html();
        c = c.replace(/{\r\n/g, "{").replace(/\t/g, "").replace(/\r\n}/g, ";}");
        e = c.split("\n");
        d.remove()
    }
    e.push(a);
    $("head").append('<style type="text/css" id="' + b + '">' + e.join("\n") + "</style>")
};
Mobi.setCtrlStyleCssList = function(c, b, k, q) {
    var h = jm;
    var a = h("#" + c);
    var l = new Array();
    if (a.length == 1) {
        var j = a.html();
        j = j.replace(/{\r\n/g, "{").replace(/\t/g, "").replace(/\r\n}/g, ";}");
        l = j.split("\n");
        a.remove()
    }
    for (var f = l.length - 1; f >= 0; --f) {
        var p = l[f];
        for (var e = 0; e < k.length; ++e) {
            var o = k[e].cls;
            var m = k[e].key;
            var d = new RegExp("#" + b + " +" + Mobi.fixRegSpecialCharacter(o) + " *{ *" + m + "s*:[^;]*;", "gi");
            if (b == "" || b == "undefined") {
                d = new RegExp(Mobi.fixRegSpecialCharacter(o) + " *{ *" + m + "s*:[^;]*;", "gi")
            }
            if (p.length == 0 || /^\s$/.test(p) || d.test(p)) {
                l.splice(f, 1);
                break
            }
        }
    }
    for (var e = 0; e < k.length; ++e) {
        if (b == "" || b == "undefined") {
            l.push(k[e].cls + "{" + k[e].key + ":" + k[e].value + ";}")
        } else {
            l.push("#" + b + " " + k[e].cls + "{" + k[e].key + ":" + k[e].value + ";}")
        }
    }
    if (q && q.rev) {
        l.reverse()
    }
    h("head").append('<style type="text/css" id="' + c + '">' + l.join("\n") + "</style>")
};
Mobi.removeCtrlStyleCssList = function(c, b, k) {
    var f = jm;
    var a = f("#" + c);
    var l = new Array();
    if (a.length == 1) {
        var j = a.html();
        j = j.replace(/{\r\n/g, "{").replace(/\t/g, "").replace(/\r\n}/g, ";}");
        l = j.split("\n");
        a.remove()
    }
    for (var h = l.length - 1; h >= 0; --h) {
        var p = l[h];
        for (var e = 0; e < k.length; ++e) {
            var o = k[e].cls;
            var m = k[e].key;
            var d = new RegExp("#" + b + " +" + Mobi.fixRegSpecialCharacter(o) + " *{ *" + m + "s*:[^;]*;", "gi");
            if (b == "" || b == "undefined") {
                d = new RegExp(Mobi.fixRegSpecialCharacter(o) + " *{ *" + m + "s*:[^;]*;", "gi")
            }
            if (p.length == 0 || /^\s$/.test(p) || d.test(p)) {
                l.splice(h, 1);
                break
            }
        }
    }
    f("head").append('<style type="text/css" id="' + c + '">' + l.join("\n") + "</style>")
};
Mobi.removeCtrlStyleCssList2 = function(c, b, k) {
    var f = jm;
    var a = f("#" + c);
    var l = new Array();
    if (a.length == 1) {
        var j = a.html();
        j = j.replace(/{\r\n/g, "{").replace(/\t/g, "").replace(/\r\n}/g, ";}");
        l = j.split("\n");
        a.remove()
    }
    for (var h = l.length - 1; h >= 0; --h) {
        var p = l[h];
        for (var e = 0; e < k.length; ++e) {
            var o = k[e].cls;
            var m = k[e].key;
            var d = ("#" + b + " " + o + "{" + m);
            if (p.length == 0 || /^\s$/.test(p) || p.indexOf(d) != -1) {
                l.splice(h, 1);
                break
            }
        }
    }
    f("head").append('<style type="text/css" id="' + c + '">' + l.join("\n") + "</style>")
};
Mobi.fixRegSpecialCharacter = function(b) {
    var d = ["\\", ".", "?", "$", "*", "^", "[", "]", "{", "}", "|", "(", ")", "/"];
    for (var c = 0,
             a = d.length; c < a; c++) {
        b = b.replace(d[c], "\\" + d[c])
    }
    return b
};
Mobi.bindTouchEvent = function(o, u, d) {
    var q = jm(o),
        t = Fai.top.navigator.userAgent,
        k = /(iPhone|iPad|iPod|iOS|Android)/i.test(t),
        m = /(MQQBrowser)/i.test(t),
        e = /(iPhone|iPad|iPod|iOS)/i.test(t),
        f = Mobi.isWechat(),
        l = _htmlFontSize,
        w = _htmlFontSize,
        p = false,
        b,
        n,
        j,
        s,
        a,
        c;
    if (m) {
        w = 8
    }
    if (e) {
        w = 4
    }
    if (q.length < 1) {
        return
    }
    s = "ontouchstart" in window;
    a = s ? "touchstart": "mousedown";
    c = s ? "touchend": "mouseup";
    n = {
        touchMove: false,
        toTop: false,
        toLeft: false,
        toRight: false,
        toBottom: false,
        mouseDownX: 0,
        mouseDownY: 0,
        mouseUpX: 0,
        mouseUpY: 0
    };
    b = {
        stopPropagation: true,
        callBack: "",
        args: []
    };
    u = jm.extend({},
        b, u);
    d = jm.extend({},
        b, d);
    q.each(function(x, y) {
        jm(y).on(a,
            function(z) {
                n = v(n);
                j = h(z);
                n.mouseDownX = j.pageX;
                n.mouseDownY = j.pageY;
                if (!u) {
                    return
                }
                r(this, u, z);
                if (u.stopPropagation && !k) {
                    z.stopPropagation();
                    z.preventDefault()
                }
            }).on(c,
            function(z) {
                j = h(z);
                n.mouseUpX = j.pageX;
                n.mouseUpY = j.pageY;
                if (! (n.mouseDownX == n.mouseUpX && n.mouseDownY == n.mouseUpY)) {
                    n.touchMove = true
                }
                if (n.mouseDownX > (n.mouseUpX + l)) {
                    n.toLeft = true
                } else {
                    if ((n.mouseDownX + l) < n.mouseUpX) {
                        n.toRight = true
                    }
                }
                if (n.mouseUpY - n.mouseDownY > w) {
                    n.toBottom = true
                } else {
                    if (n.mouseDownY - n.mouseUpY > w) {
                        n.toTop = true
                    }
                }
                r(this, d, z);
                if (d.stopPropagation && !k) {
                    z.stopPropagation();
                    z.preventDefault()
                }
            });
        if (k) {
            jm(y).on("touchmove",
                function() {
                    j = h(event);
                    p = Math.abs(j.pageY - n.mouseDownY) >= w;
                    if (d.stopPropagation && !p && !(e && f)) {
                        event.preventDefault()
                    }
                })
        }
    });
    function v(x) {
        x.touchMove = false;
        x.toTop = false;
        x.toLeft = false;
        x.toRight = false;
        x.toBottom = false;
        x.mouseDownX = 0;
        x.mouseDownY = 0;
        x.mouseUpX = 0;
        x.mouseUpY = 0;
        return x
    }
    function r(B, z, A) {
        var x = [],
            y;
        if (typeof z.callBack != "function") {
            return
        }
        for (y = 0; y < z.args.length; y++) {
            x.push(z.args[y])
        }
        x.push(n);
        x.push(A);
        z.callBack.apply(B, x)
    }
    function h(x) {
        var y = x || window.event;
        if ("ontouchstart" in window) {
            y = !!x.changedTouches && x.changedTouches.length > 0 ? x.changedTouches[0] : x.touches[0]
        }
        return {
            pageX: y.pageX,
            pageY: y.pageY
        }
    }
};
Mobi.loadImgAlone = function(j, b) {
    var c = jm("#module" + j),
        d = jm(window).width(),
        h = jm(window).height(),
        a,
        e = -1,
        f = true;
    if (c.hasClass("formStyle3")) {
        a = c.find(".mProductList");
        if (a.length > 0) {
            e = parseInt(a.attr("mType"))
        }
        switch (e) {
            case 1:
                lazyLoadProductList_10(h, j);
                break;
            case 31:
                lazyLoadProductList_2(h, j, 1);
                break;
            case 3:
                lazyLoadProductList_2(h, j, 2);
                break;
            case 7:
                lazyLoadProductList_7(d, j);
                break;
            case 8:
                lazyLoadProductList_8(h, j);
                break;
            case 9:
                lazyLoadProductList_9(d, j);
                break;
            default:
        }
    } else {
        if (c.hasClass("formStyle31")) {
            lazyloadCubeNavigation(h, j)
        } else {
            if (c.hasClass("formStyle41")) {
                e = b;
                if (e == 3) {
                    lazyloadMultiPhotoList_3(h, j)
                }
            } else {
                if (c.hasClass("formStyle5")) {
                    e = parseInt(b.type);
                    f = b.picCompress;
                    if (e == 3) {
                        lazyLoadProductList_2(h, j, 2)
                    }
                }
            }
        }
    }
};
Mobi.triggerAllLazyLoad = function() {
    jm(window).trigger("scroll")
};
function lazyLoadProductList_2(d, c, a) {
    var b;
    if (!d || typeof d != "number") {
        d = jm(window).height()
    }
    if ( !! c) {
        if (a == 2) {
            b = jm("#module" + c).find(".mProductList img.style3Img")
        } else {
            b = jm("#module" + c).find(".mProductList img.style1Img")
        }
    }
    b.lazyload({
        threshold: d,
        load: null
    })
}
function lazyLoadProductList_10(c, b) {
    var a;
    if (!c || typeof c != "number") {
        c = jm(window).height()
    }
    if ( !! b) {
        a = jm("#module" + b).find(".mProductList .style1Img")
    }
    a.lazyload({
        threshold: c,
        load: null
    })
}
function lazyLoadProductList_7(a, c) {
    var b;
    if (!a || typeof a != "number") {
        a = jm(window).width()
    }
    if ( !! c) {
        b = jm("#module" + c).find(".mProductList div.style7Img")
    } else {
        b = jm(".mProductList div.style7Img")
    }
    b.lazyload({
        threshold: a,
        w_threshold: 0,
        otherEvent: "slidePic",
        load_in_viewport: true,
        load: null
    })
}
function lazyLoadProductList_8(c, b) {
    var a;
    if (!c || typeof c != "number") {
        c = jm(window).height()
    }
    if ( !! b) {
        a = jm("#module" + b).find(".mProductList div.style8Img")
    } else {
        a = jm(".mProductList div.style8Img")
    }
    a.lazyload({
        threshold: c,
        failure_limit: 2,
        loadingClass: "loading-for-lazyload",
        load: null
    })
}
function lazyLoadProductList_9(a, c) {
    var b;
    if (!a || typeof a != "number") {
        a = jm(window).width()
    }
    if ( !! c) {
        b = jm("#module" + c).find(".mProductList div.style9Img")
    } else {
        b = jm(".mProductList div.style9Img")
    }
    b.lazyload({
        threshold: a,
        w_threshold: a,
        otherEvent: "horizonScroll",
        load_in_viewport: true,
        load: null
    })
}
function lazyloadCubeNavigation(c, b) {
    var a;
    if (!c || typeof c != "number") {
        c = jm(window).height()
    }
    if ( !! b) {
        a = jm("#module" + b).find(".cubeNavigationArea div.J_cubeLink_bg")
    } else {
        a = jm(".cubeNavigationArea div.J_cubeLink_bg")
    }
    a.lazyload({
        threshold: parseInt(c / 2),
        loadingClass: "",
        load: null
    })
}
function lazyloadMultiPhotoList_3(c, b) {
    var a;
    if (!c || typeof c != "number") {
        c = jm(window).width()
    }
    if ( !! b) {
        a = jm("#module" + b).find(".J_imgContainer img")
    } else {
        a = jm(".J_cardContainer .J_imgContainer img")
    }
    a.lazyload({
        threshold: c,
        w_threshold: 0,
        load: null
    })
}
Mobi.ajaxLoadModuleDom = function(d, b, e) {
    var a = window.location.href,
        c = "";
    if (a.indexOf("lcid") > 0) {
        var f = Mobi.getUrlParam(a, "lcid");
        if (f) {
            c += "?lcid=" + f
        }
    }
    // jm.ajax({
    //     type: "post",
    //     url: "ajax/ajaxLoadModuleDom_h.jsp" + c,
    //     data: "cmd=loadModuleDom&colId=" + d + "&extId=" + b + "&ajaxOptionInfo=" + jm.encodeUrl(jm.toJSON(e)),
    //     error: function() {
    //         Mobi.ing("系统异常，请稍后重试", true)
    //     },
    //     success: function(j) {
    //         var j = jm.parseJSON(j);
    //         if (j.success) {
    //             var n = jm.parseJSON(j.rtInfo);
    //             if (n.topBar) {
    //                 var o = Mobi.getPreviewWindow().jm(".multilingual");
    //                 o.children().remove();
    //                 o.append(n.topBar.dom);
    //                 jm.fkEval.call(window, n.topBar.scripts);
    //                 Mobi.initLocater()
    //             }
    //             if (n.moduleDomList && n.moduleDomList.length > 0) {
    //                 for (var k = 0; k < n.moduleDomList.length; k++) {
    //                     var m = n.moduleDomList[k];
    //                     var l = m.moduleId;
    //                     var p = m.dom;
    //                     var h = m.scripts;
    //                     loadWholeModuleDom(l, p, h)
    //                 }
    //                 Mobi.initFooterHeight()
    //             }
    //         }
    //     }
    // })
};
function loadWholeModuleDom(c, d, a) {
    var b = jm("#module" + c);
    b.children().remove();
    b.append(d);
    jm.fkEval.call(window, a);
    if (Fai.top._templateFrameId == "1005" || Fai.top._templateFrameId == 1019) {
        Mobi.changeMorePosition(1)
    } else {
        Mobi.changeMorePosition(0)
    }
}
Mobi.getUrlParam = function(b, a) {
    var d = b.substring(b.indexOf("?") + 1, b.length).split("&");
    var c;
    jm.each(d,
        function(e, h) {
            var f = decodeURIComponent(h.substring(0, h.indexOf("=")));
            if (f === a) {
                c = decodeURIComponent(h.substring(h.indexOf("=") + 1, h.length));
                return false
            }
        });
    return c
};
Mobi.addDistCode = function() {
    var b = window.location.href;
    if (b.indexOf("dist") > 0) {
        return
    }
    var c = jm.cookie("_distCode") || "";
    if (c.length < 5) {
        return
    }
    if (b.indexOf("mstl.jsp") > 0 || b.indexOf("mdetail.jsp") > 0 || b.indexOf("mlist.jsp") > 0 || b.indexOf("h-mstl") > 0 || b.indexOf("h-mdetail") > 0 || b.indexOf("h-mlist") > 0) {
        return
    }
    var a = "?dist=" + c;
    if (b.indexOf("?") > 0) {
        a += "&" + b.split("?")[1]
    }
    if (history.replaceState) {
        history.replaceState(null, "", a)
    }
};
Mobi.getLanCodeFromLcid = function(a) {
    a = parseInt(a);
    switch (a) {
        case 2052:
            return "cn";
        case 1033:
            return "en";
        case 1028:
            return "tcn";
        case 1041:
            return "jap";
        case 1042:
            return "kor";
        case 1108:
            return "lo";
        case 1054:
            return "th";
        case 11274:
            return "es";
        case 1049:
            return "ru";
        case 1036:
            return "fra";
        case 1040:
            return "it";
        case 1031:
            return "de"
    }
};
Mobi.getUrlParamObj = function(a) {
    var d = new Object();
    if (a.indexOf("?") != -1) {
        var f = a.substr(1);
        strs = f.split("&");
        for (var c = 0; c < strs.length; c++) {
            var b = decodeURIComponent(strs[c].split("=")[0]);
            var e = strs[c].split("=")[1];
            if (e) {
                d[b] = decodeURIComponent(e)
            } else {
                d[b] = ""
            }
        }
    }
    return d
}; (function(a, b) {
    function c() {
        b("#g_web").on("touchmove", d);
        function d(e) {
            if (b("body").data("fk-scroll") === "false") {
                return false
            }
        }
    }
    a.lockDocScroll = function() {
        b("body").data("fk-scroll", "false")
    };
    a.openDocScroll = function() {
        b("body").data("fk-scroll", "true")
    };
    b(c)
} (Mobi, jm));
Mobi.bindInteractive = function(e) {
    var d = Mobi.getPreviewWindow(),
        c = d.Mobi,
        b = d.jm("#module" + e, d.document),
        a = c.photoGroup;
    if (b.hasClass("formStyle34")) {
        if (jm.isFunction(c.photoGroup.bindInteractive)) {
            a.bindInteractive(b)
        }
    }
};
Mobi.forbiddenExternalLinks = function() {
    return
};
Mobi.isContainExternallink = function(b, c) {
    return;
    if (c) {
        if (b.indexOf("http") != -1 || b.indexOf("https") != -1) {
            Fai.top._isExternalLinks = true
        } else {
            Fai.top._isExternalLinks = false
        }
    } else {
        var a = $(b).find("a[href^='http']").length;
        Fai.top._isExternalLinks = a ? true: false
    }
};
Mobi.preciseDecimal = function(d, f) {
    if (isNaN(parseFloat(d)) && !isFinite(d) || !!f || (typeof f == "number" && f <= 0)) {
        return d
    }
    var e = d + "",
        c = e.indexOf("."),
        b,
        a;
    if (c < 0) {
        return d
    }
    b = parseInt(e.slice(0, c));
    a = parseFloat(e.slice(c, e.length));
    return (b + parseFloat(a.toPrecision(f)))
};
Mobi.showBookingPanel = function() {
    Mobi.bookingBoxBind(false);
    jm("#bookingPanelTriggle").data("pid", -1);
    jm("#bookingPanelTriggle").trigger("click")
};
Mobi.encodeHtml = function(a) {
    return a && a.replace ? (a.replace(/&/g, "&amp;").replace(/ /g, "&nbsp;").replace(/\b&nbsp;+/g, " ").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\\/g, "&#92;").replace(/\'/g, "&#39;").replace(/\"/g, "&quot;").replace(/\n/g, "<br/>").replace(/\r/g, "")) : a
};
Mobi.wxShareAlter = function(b) {
    var c = [];
    c.push("<div class='wxShare'>");
    c.push("<div class='wxShareContent'>");
    c.push("<div class='wxShareDesc'>");
    c.push("<span>" + LS.weChatShare + "</span>");
    c.push("</div>");
    c.push("<div class='wxShareQrcode'><img width='190' height='190' alt='' src='" + b + "' /></div>");
    c.push("</div>");
    c.push("</div>");
    var a = {
        title: "微信分享",
        width: 480,
        height: 480,
        divContent: c.join("")
    };
    Fai.top.Fai.popupWindowVersionTwo.createPopupWindow(a).getPopupWindowId()
};
Mobi.logErr = function(a) {
    if (!a) {
        return
    }
    // $.ajax({
    //     type: "GET",
    //     url: "/ajax/log_h.jsp?cmd=err&err=" + Fai.encodeUrl(a)
    // })
};
Mobi.isSupportWebp = function() {
    var a = false;
    try {
        a = document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp") == 0
    } catch(b) {
        console.log(b)
    }
    Mobi.isSupportWebp = function() {
        return a
    };
    return Mobi.isSupportWebp()
};
Mobi.checkNestModule = function(c) {
    var a = {
            nest: false,
            isTab: false,
            isPack: false,
            isFold: false,
            parentId: 0,
            inTab: false,
            inPack: false,
            inFold: false,
            inList: []
        },
        b = parseInt(c.attr("_intab")) || 0,
        d = parseInt(c.attr("_inpack")) || 0;
    inFold = parseInt(c.attr("_infold")) || 0;
    if (c.hasClass("formStyle50")) {
        a.nest = true;
        a.isTab = true;
        c.find(".J_formTabButton").each(function(e, f) {
            tabModuleId = parseInt($(f).attr("tabmoduleid"));
            if (!isNaN(tabModuleId)) {
                a.inList.push(tabModuleId)
            }
        })
    } else {
        if (c.hasClass("formStyle51")) {
            a.nest = true;
            a.isPack = true;
            c.find(".J_formPackContent .form").each(function(e, f) {
                packModuleId = parseInt($(f).attr("id").replace("module", ""));
                if (!isNaN(packModuleId)) {
                    a.inList.push(packModuleId)
                }
            })
        } else {
            if (c.hasClass("formStyle58")) {
                a.nest = true;
                a.isFold = true;
                c.find(".J_formFoldItem .form").each(function(e, f) {
                    foldModuleId = parseInt($(f).attr("id").replace("module", ""));
                    if (!isNaN(foldModuleId)) {
                        a.inList.push(foldModuleId)
                    }
                })
            }
        }
    }
    if (b > 0) {
        a.parentId = b;
        a.inTab = true
    } else {
        if (d > 0) {
            a.parentId = d;
            a.inPack = true
        } else {
            if (inFold > 0) {
                a.parentId = inFold;
                a.inFold = true
            }
        }
    }
    return a
};
Mobi.getModuleAnimationStatus = function(b) {
    var a = jm("#module" + b),
        c = Mobi.checkNestModule(a);
    if (c.inPack) {
        return 1
    } else {
        return - 1
    }
};