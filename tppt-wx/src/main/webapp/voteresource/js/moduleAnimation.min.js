(function(p,l,b){var q=[],g=p(".visualArea_leftTop"),s=p(".visualArea_rightBottom"),i=p("#webCustomerServiceBox"),n=p("#fixedAreaBox"),e;l.scroll=function(){a()};l.subscribe=function(t){d(t)};l.revoke=function(t){k(t)};l.publishOne=function(t){};l.publish=function(){o()};l.playAnimation=function(x){var t=p("#module"+x.id),y=typeof x.type!="undefined"?x.type:0,A=typeof x.direction!="undefined"?x.direction:0,v=typeof x.speed!="undefined"?x.speed:0.6,w=typeof x.delay!="undefined"?x.delay:0,B=f(y,A),z=B+" "+v+"s "+w+"s both",u={module:t,animateStyle:z};if(B.length){c(u)}};function a(){var t=60,u;p(h()).off("scroll.moduleAnimation").on("scroll.moduleAnimation",function(){if(typeof u!="number"){u=setTimeout(function(){o();u=null},t)}})}function h(){if(e){return e}var t=Fai.top||window;e=p(t);if(t._manageMode){e=t.$("#mobiReviewPageFrame")[0].contentDocument}return e}function d(x){var u={},w=p("#module"+x.id),y=Mobi.checkNestModule(w),t=typeof x.only=="boolean"?x.only:true,v=typeof x.refreshSubscribe=="boolean"?x.refreshSubscribe:false;if(w.length<1){return}if(y.inPack||!y.nest){}else{w.removeClass("animateModule");return}u.moduleId=x.id;u.module=w;u.animation=x.animation;if(v){u.runed=true}if(t){k({id:x.id})}q.push(u)}function o(){var t=q.length-1,u;while(t>-1){u=q[t];j(u);t-=1}}function j(B){var L,u=B.module,H=B.moduleId,t=typeof Fai.top._moduleAnimationPercent=="number"&&Fai.top._moduleAnimationPercent>=0&&Fai.top._moduleAnimationPercent<=100?(Fai.top._moduleAnimationPercent/100):0.1,w=false,I=B.runAgain||(B.runAgain=false),E=Mobi.checkNestModule(u),D=u.height()*t,C=u.width()*t,G=B.animation,v=typeof G.tg!="undefined"?G.tg:0,x=typeof G.t!="undefined"?G.t:0,J,F,K,y,A,z;if(x==0){return}if(v==0){if(B.runed){return}z=l.moduleListen({module:u});w=m(z,B)}else{z=l.moduleListen({module:u});if(!B.runed||u.attr("animated")=="true"){B.runAgain=false}else{if(!u.hasClass("J_animateCanRun")){if(z.v==1||z.v==5||z.h==1||z.h==5){B.runAgain=true;u.addClass("animateModule")}}}if(!B.runed||B.runAgain){w=m(z,B);if(w){B.runAgain=false}}}if(!w){return}J=typeof G.r!="undefined"?G.r:0;F=typeof G.s!="undefined"?(G.s||0.6):0.6;K=typeof G.d!="undefined"?G.d:0;y=f(x,J);A=y+" "+F+"s "+K+"s both";L={module:u,animateStyle:A};if(y.length){c(L)}B.runed=true}function c(v){var u=v.module,t=v.animateStyle;if(u.attr("animated")!="true"){u.css("animation",t).addClass("J_animateCanRun").removeClass("animateModule").one("webkitAnimationStart mozAnimationStart MSAnimationStart oanimationstart animationstart",function(){u.removeClass("J_animateCanRun");u.attr("animated","true")}).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){u.removeAttr("animated");p(this).css("animation","none")})}}function f(u,v){var t="";if(u==0){return t}switch(u){case 1:t="fadeIn";break;case 2:t="moveIn";break;case 3:t="zoomIn";break;case 8:t="elasticLarge";break;case 9:t="elasticSmall";break;case 4:t="bounceIn";break;case 6:t="rollIn";break;case 7:t="flip";break;case 5:t="flash";break;default:t="";break}switch(v){case 1:t+="Left";break;case 2:t+="Right";break;case 3:t+="Up";break;case 4:t+="Down";break;case 12:t+="LeftRight";break;case 34:t+="UpDown";break;default:t+="";break}return t}function m(t,z){var w=z.module,A=typeof Fai.top._moduleAnimationPercent=="number"&&Fai.top._moduleAnimationPercent>=0&&Fai.top._moduleAnimationPercent<=100?(Fai.top._moduleAnimationPercent/100):0.1,y=false,x=z.runAgain||(z.runAgain=false),u=w.height()*A,v=w.width()*A;if((t.v==6||t.v==3)&&(t.h==6||t.h==3)){y=true}else{if(t.v==3&&(t.h==2||t.h==4)){if(t.vWidth>=v){y=true}}else{if(t.h==3&&(t.v==2||t.v==4)){if(t.vHeight>=u){y=true}}else{if((t.v==6||t.v==4||t.v==2)&&(t.h==4||t.h==6||t.h==2)){if(t.vHeight>=u&&t.vWidth>=v){y=true}}}}}return y}l.moduleListen=function(A){if(typeof A.module!="object"){return}if(A.module.css("display")=="none"){return{h:0,v:0,vHeight:0,hWidth:0}}var z=0;var v=0;if(i.css("display")!="none"){z=parseInt(i.find("#customerServiceDiv").height())}if(n.css("display")!="none"){v=parseInt(n.height())}var w=A.module,u=w.offset(),C=w[0].clientHeight,D=parseInt(w.width()),H=g.offset(),F=s.offset(),x=H.top,B=F.top-z-v,t=H.left,y=F.left,E={moduleOffset:u,moduleHeight:C,moduleWidth:D,topNum:x,bottomNum:B,leftNum:t,rightNum:y},G;G=r(E);return G};function r(y){var u=y.moduleOffset.top,w=y.moduleOffset.left,v=y.topNum,z=y.bottomNum,t=y.leftNum,x=y.rightNum,B=y.moduleHeight,D=y.moduleWidth,A=u+B,C=w+D,E={h:3,v:3,vHeight:B,hWidth:D};if(A<v){E.v=1;E.vHeight=0}else{if(u<v){E.v=2;if(B>(z-v)){E.v=6}E.vHeight=B+u-v}else{if(A<z){E.v=3;E.vHeight=B}else{if(u<z){E.v=4;if(B>(z-v)){E.v=6}E.vHeight=z-u}else{E.v=5;E.vHeight=0}}}}if(C<t){E.h=1;E.vWidth=0}else{if(w<t){E.h=2;if(D>(x-t)){E.h=6}E.vWidth=w-t+D}else{if(C<=x){E.h=3;E.vWidth=D}else{if(w<x){E.h=4;if(D>(x-t)){E.h=6}E.vWidth=x-w}else{E.h=5;E.vWidth=0}}}}return E}function k(w){var t=q.length-1,u=w.id,v;while(t>-1){v=q[t];if(u==v.moduleId){q.splice(t,1)}t-=1}}})(jm,Mobi.moduleAnimation||(Mobi.moduleAnimation={}));